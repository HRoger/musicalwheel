(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.apiFetch;var r=e.n(t);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}var n=!!EssentialBlocksLocalize&&EssentialBlocksLocalize.rest_rootURL;function o(e,t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)}function i(e){var t=e.querySelector(".ebpg-pagination-item.active");if(t){var r=parseInt(t.dataset.pagenumber),a=e.querySelectorAll(".ebpg-pagination-item"),n=a.length,o=1;a.forEach(function(e){o=parseInt(e.dataset.pagenumber),function(e){e.classList.remove("show"),e.classList.add("hide")}(e),(1===r&&o<=3||o>=r&&o<=r+2||o===n||1===o&&(r>=n-2||r>=4))&&function(e){e.classList.remove("hide"),e.classList.add("show")}(e)});var i=e.querySelectorAll(".ebpg-pagination-item-separator");i.length>0&&i.forEach(function(e){e.remove()});var s='<button class="ebpg-pagination-item-separator">...</button>';r<a.length-2&&a[a.length-1].insertAdjacentHTML("beforebegin",s),(r>=n-2||n>4&&r>=4)&&a[1].insertAdjacentHTML("afterend",s),1===r?(e.querySelector(".ebpg-pagination-item-previous").disabled=!0,e.querySelector(".ebpg-pagination-item-next").disabled=!1):r===n?(e.querySelector(".ebpg-pagination-item-previous").disabled=!1,e.querySelector(".ebpg-pagination-item-next").disabled=!0):(e.querySelector(".ebpg-pagination-item-previous").disabled=!1,e.querySelector(".ebpg-pagination-item-next").disabled=!1)}}function s(e){var t=1,r=e.closest(".ebpg-pagination").querySelector(".ebpg-pagination-item.active");if(r){if(t=r.dataset?r.dataset.pagenumber:1,o(e,"ebpg-pagination-item-next")){for(var a=r.nextElementSibling;a&&!a.classList.contains("ebpg-pagination-item");)a=a.nextElementSibling;a.classList.add("active"),r.classList.remove("active")}else if(o(e,"ebpg-pagination-item-previous")){for(var n=r.previousElementSibling;n&&!n.classList.contains("ebpg-pagination-item");)n=n.previousElementSibling;n.classList.add("active"),r.classList.remove("active")}i(e.closest(".ebpg-pagination"))}return t}r().use(r().createRootURLMiddleware(n)),window.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".eb-post-grid-wrapper").forEach(function(e,t){var n=e.querySelector(".eb-post-grid-search");if(n){var c=n.getAttribute("data-ajax-search"),l=n.querySelector("form");l.addEventListener("submit",function(e){e.preventDefault()});var p=l.querySelector(".eb-post-grid-search-field"),u=n.querySelector(".eb-post-grid-search-result"),d=n.querySelector(".eb-post-grid-search-content"),g=n.querySelector(".eb-post-grid-search-not-found"),b=n.querySelector(".eb-post-grid-search-loader"),f="";p.addEventListener("keyup",function(e){var t=this;setTimeout(function(){var n=e.target.value.trim();if(n!==f){var l;f=n,l="&query_type=search&s=".concat(n);var p="",y=t.closest(".eb-post-grid-category-filter");if(y){var v,h=y.dataset.ebpgtaxonomy,m="",q=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return a(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}(y.querySelectorAll(".ebpg-category-filter-list-item"));try{for(q.s();!(v=q.n()).done;){var S=v.value;if(S.classList.contains("active")){m=S.getAttribute("data-ebpgCategory"),p="all"===m?"&query_type=filter":"&taxonomy=".concat(h,"&category=").concat(m);break}}}catch(e){q.e(e)}finally{q.f()}}var L=t.closest(".eb-post-grid-wrapper").dataset,w=JSON.parse(L.attributes),_=null!=w&&w.version?null==w?void 0:w.version:"";if("1"==c){b.style.display="block";var A=new FormData;A.append("action","post_grid_search_result_content"),A.append("post_grid_search_nonce",EssentialBlocksProLocalize.post_grid_search_nonce),A.append("searchKey",n),A.append("query_data",L.querydata),A.append("attributes",L.attributes),A.append("queryParamString",p),fetch(EssentialBlocksProLocalize.ajax_url,{method:"POST",body:A}).then(function(e){return e.text()}).then(function(e){var t=JSON.parse(e);t.success&&(b.style.display="none",u.style.display="none",g.style.display="none",d.innerHTML="",n.length>0&&(u.style.display="block",(null==t?void 0:t.data.length)>0?(d.style.display="block",d.insertAdjacentHTML("beforeend",t.data)):(d.style.display="none",g.style.display="block")))}).catch(function(e){return console.log(e)})}r()({path:"essential-blocks/v1/queries?query_data=".concat(L.querydata,"&attributes=").concat(L.attributes).concat(p).concat(l),parse:!1}).then(function(e){var a=e.headers.get("X-WP-Total");if(a){var n=new FormData;n.append("action","post_grid_block_pagination"),n.append("post_grid_pagination_nonce",EssentialBlocksLocalize.post_grid_pagination_nonce),n.append("querydata",null==L?void 0:L.querydata),n.append("attributes",null==L?void 0:L.attributes),n.append("totalPosts",a),fetch(EssentialBlocksLocalize.ajax_url,{method:"POST",body:n}).then(function(e){return e.text()}).then(function(e){t.closest(".eb-post-grid-wrapper").querySelector(".ebpg-pagination")&&(t.closest(".eb-post-grid-wrapper").querySelector(".ebpg-pagination").innerHTML=e),function(e,t){if(document.getElementsByClassName("ebpg-pagination").length>0){var a=document.querySelectorAll(".ebpg-pagination button");a.length>0&&(document.querySelectorAll(".ebpg-pagination").forEach(function(e){i(e)}),a.forEach(function(a){var n=1;a.addEventListener("click",function(){var a=this,c=o(this,"ebpg-pagination-button"),l=o(this,"ebpg-pagination-item-previous"),p=o(this,"ebpg-pagination-item-next");n=c?parseInt(n)+1:l?parseInt(s(this))-1:p?parseInt(s(this))+1:parseInt(this.dataset.pagenumber);var u=this.closest(".eb-post-grid-wrapper");if(u){var d=u.dataset,g=e||"",b=t||"";r()({path:"essential-blocks/v1/queries?query_data=".concat(d.querydata,"&attributes=").concat(d.attributes).concat(g).concat(b,"&pageNumber=").concat(n)}).then(function(e){c?e?a.closest(".ebpg-pagination").insertAdjacentHTML("beforebegin",e):(a.closest(".ebpg-pagination").insertAdjacentHTML("beforebegin",'<p class="eb-no-posts">No more Posts</p>'),a.closest(".ebpg-pagination").innerHTML=""):(a.closest(".eb-post-grid-wrapper").querySelectorAll(".ebpg-grid-post").forEach(function(e){e.remove()}),a.closest(".ebpg-pagination").insertAdjacentHTML("beforebegin",e),o(a,"ebpg-pagination-item")&&(a.closest(".ebpg-pagination").querySelectorAll(".ebpg-pagination-item").forEach(function(e){e.classList.remove("active")}),a.classList.add("active")),i(a.closest(".ebpg-pagination")))})}})}))}}(p,l)}).catch(function(e){return console.log(e)}),r()({path:"essential-blocks/v1/queries?query_data=".concat(L.querydata,"&attributes=").concat(L.attributes).concat(p).concat(l)}).then(function(e){t.closest(".eb-post-grid-wrapper").querySelectorAll(".ebpg-grid-post").forEach(function(e){e.remove()}),t.closest(".eb-post-grid-wrapper").querySelector("p")&&t.closest(".eb-post-grid-wrapper").querySelector("p").remove(),"v2"===_?t.closest(".eb-post-grid-wrapper").querySelector(".eb-post-grid-posts-wrapper").insertAdjacentHTML("afterbegin",e):y?t.closest(".eb-post-grid-category-filter").insertAdjacentHTML("afterend",e):t.closest(".eb-post-grid-search").insertAdjacentHTML("afterend",e)})}else t.closest(".eb-post-grid-wrapper").querySelectorAll(".ebpg-grid-post").forEach(function(e){e.remove()}),t.closest(".eb-post-grid-wrapper").querySelector(".ebpg-pagination")&&(t.closest(".eb-post-grid-wrapper").querySelector(".ebpg-pagination").innerHTML=""),t.closest(".eb-post-grid-wrapper").querySelector("p")&&t.closest(".eb-post-grid-wrapper").querySelectorAll("p").forEach(function(e){e.remove()}),t.closest(".eb-post-grid-wrapper").insertAdjacentHTML("beforeend","<p>No Posts Found</p>")},function(e){console.log("error",e)})}},1500)})}})})})();