document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("select-form-list");e&&e.addEventListener("change",function(){var t,o,n,a,i=e.value,r=(t=window.location.href,o="form",n=i,a=new RegExp("\\b(form=).*?(&|$)"),t.search(a)>=0?t.replace(a,"$1"+n+"$2"):t+(t.indexOf("?")>0?"&":"?")+o+"="+n);window.location.href=r});var t=document.getElementById("export");t&&t.addEventListener("click",function(){var t,o,n=null===(t=EssentialBlocksProLocalize)||void 0===t?void 0:t.ajax_url,a={action:"export_csv",form_id:e.value,admin_nonce:null===(o=EssentialBlocksProLocalize)||void 0===o?void 0:o.admin_nonce},i=Object.keys(a).map(function(e){return e+"="+a[e]}).join("&"),r=new XMLHttpRequest;r.open("GET",n+"?"+i,!0),r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var e=JSON.parse(r.responseText);if(e&&e.data){var t=e.title?"exported-"+e.title.replace(/\s+/g,"-").toLowerCase():"exported-form-response.csv";!function(e,t){var o=new Blob([e],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(o,t);else{var n=document.createElement("a");if(void 0!==n.download){var a=URL.createObjectURL(o);n.setAttribute("href",a),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}}(e.data,t)}else console.log("CSV export failed!")}},r.send()})});