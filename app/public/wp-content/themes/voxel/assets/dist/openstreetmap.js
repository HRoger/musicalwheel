(e=>{"function"==typeof define&&define.amd?define("openstreetmap",e):e()})(function(){Voxel.Maps.Autocomplete=function(e,t,o={}){this.init(e,t,o)},Voxel.Maps.Autocomplete.prototype.selectFirstResult=function(e){},Voxel.Maps.Bounds=function(e,t){this.southwest=e,this.northeast=t,this.init(e,t)},Voxel.Maps.Bounds.prototype.extend=function(e){},Voxel.Maps.Bounds.prototype.empty=function(){},Voxel.Maps.Bounds.prototype.getSourceObject=function(){},Voxel.Maps.Bounds.prototype.getSouthWest=function(){return this.southwest},Voxel.Maps.Bounds.prototype.getNorthEast=function(){return this.northeast},Voxel.Maps.Geocoder=function(){this.init()},Voxel.Maps.getGeocoder=function(){return Voxel.Maps._geocoder||(Voxel.Maps._geocoder=new Voxel.Maps.Geocoder),Voxel.Maps._geocoder},Voxel.Maps.Geocoder.prototype.geocode=function(e,t,o){},Voxel.Maps.Geocoder.prototype.formatFeature=function(e){},Voxel.Maps.Geocoder.prototype.getUserLocation=function({fetchAddress:t=!0,receivedPosition:o=e=>{},receivedAddress:s=e=>{},positionFail:e=()=>{},addressFail:i=()=>{}}={}){if(!navigator.geolocation)return e();navigator.geolocation.getCurrentPosition(e=>{e=new Voxel.Maps.LatLng(e.coords.latitude,e.coords.longitude);o(e),!1!==t&&Voxel.Maps.getGeocoder().geocode(e.toGeocoderFormat(),e=>e?s(e):(Voxel.alert(Voxel_Config.l10n.positionFail,"error"),i()))},()=>e())},Voxel.Maps.LatLng=function(e,t){this.init(e,t)},Voxel.Maps.LatLng.prototype.getLatitude=function(){},Voxel.Maps.LatLng.prototype.getLongitude=function(){},Voxel.Maps.LatLng.prototype.getSourceObject=function(){},Voxel.Maps.LatLng.prototype.toGeocoderFormat=function(){},Voxel.Maps.Map=function({el:e,zoom:t=10,center:o=new Voxel.Maps.LatLng(Voxel_Config.maps.default_lat,Voxel_Config.maps.default_lng),minZoom:s=4,maxZoom:i=20,draggable:n=!0}){this.init({el:e,zoom:t,center:o,minZoom:s,maxZoom:i,draggable:n})},Voxel.Maps.Map.prototype.setZoom=function(e){},Voxel.Maps.Map.prototype.getZoom=function(){},Voxel.Maps.Map.prototype.getMinZoom=function(){},Voxel.Maps.Map.prototype.getMaxZoom=function(){},Voxel.Maps.Map.prototype.setCenter=function(e){},Voxel.Maps.Map.prototype.getCenter=function(){},Voxel.Maps.Map.prototype.fitBounds=function(e){},Voxel.Maps.Map.prototype.panTo=function(e){},Voxel.Maps.Map.prototype.getClickPosition=function(e){},Voxel.Maps.Map.prototype.addListener=function(e,t){},Voxel.Maps.Map.prototype.addListenerOnce=function(e,t){},Voxel.Maps.Map.prototype.removeListener=function(e){},Voxel.Maps.Map.prototype.trigger=function(e){},Voxel.Maps.Map.prototype.mapEvent=function(e){return void 0!==this.eventMap[e]?this.eventMap[e]:e},Voxel.Maps.Map.prototype.removeMarkers=function(){for(var e=0;e<this.markers.length;e++)this.markers[e].remove();this.markers=[]},Voxel.Maps.Map.prototype.getSourceObject=function(){},Voxel.Maps.Marker=function({map:e=null,position:t=null,onClick:o=null,template:s=null,data:i=null}){this.template=s,this.init({map:e,position:t,onClick:o,data:i})},Voxel.Maps.Marker.prototype.getPosition=function(){},Voxel.Maps.Marker.prototype.setPosition=function(e){},Voxel.Maps.Marker.prototype.getMap=function(){},Voxel.Maps.Marker.prototype.setMap=function(e){},Voxel.Maps.Marker.prototype.remove=function(){},Voxel.Maps.Marker.prototype.addClass=function(){},Voxel.Maps.Marker.prototype.removeClass=function(){},Voxel.Maps.Marker.prototype.getTemplate=function(){var e=this.template||'<div class="map-marker marker-type-icon"><i class="las la-map-marker"></i></div>';return jQuery(`<div class="marker-wrapper">${e}</div>`)},Voxel.Maps.Popup=function({map:e=null,position:t=null,content:o=null}){this.init({map:e,position:t,content:o})},Voxel.Maps.Popup.prototype.init=function(e){},Voxel.Maps.Popup.prototype.setContent=function(e){},Voxel.Maps.Popup.prototype.setPosition=function(e){},Voxel.Maps.Popup.prototype.setMap=function(e){},Voxel.Maps.Popup.prototype.show=function(){},Voxel.Maps.Popup.prototype.hide=function(){},Voxel.Maps.Circle=function({map:e=null,center:t=null,radius:o=null,visible:s=null,className:i="map-circle"}){this.init({map:e,center:t,radius:o,visible:s,className:i})},Voxel.Maps.Clusterer=function({map:e=null}){this.init({map:e})},Voxel.Maps.Autocomplete.prototype.init=async function(e,t,o){var s;e instanceof Element&&(this.el=e,this.onChange=t,this.input=jQuery(this.el),this.focusedItem=0,this.hasQueried=!1,this.options=o,e=Voxel_Config.openstreetmap?.geocoding_provider||"nominatim",this.useGooglePlaces="google_maps"===e,this.useGooglePlaces?(await this._waitForGoogleMaps(),{AutocompleteSuggestion:t,AutocompleteSessionToken:e,Place:s}=await google.maps.importLibrary("places"),this.requestBase={includedPrimaryTypes:Array.isArray(o?.feature_types)?o.feature_types:void 0,includedRegionCodes:Array.isArray(o?.countries)?o.countries:void 0},this.sessionToken=new e,this._AutocompleteSuggestion=t,this._AutocompleteSessionToken=e,this.attachDropdown(),this.attachAttribution(),o=Voxel.helpers.debounce(this.querySuggestions.bind(this),200),this.input.on("input",o),this.input.on("focusin",this.showDropdown.bind(this)),this.input.on("focusout",this.hideDropdown.bind(this)),this.input.on("keydown click",this.navigateDropdown.bind(this)),this.dropdown.on("mousedown",".suggestion",e=>this.selectItem(jQuery(e.currentTarget).index()))):(this.attachDropdown(),this.input.on("input",Voxel.helpers.debounce(this.querySuggestions.bind(this),300)),this.input.on("focusin",this.showDropdown.bind(this)),this.input.on("focusout",this.hideDropdown.bind(this)),this.input.on("keydown click",this.navigateDropdown.bind(this)),this.dropdown.on("mousedown",".suggestion",e=>this.selectItem(jQuery(e.currentTarget).index()))))},Voxel.Maps.Autocomplete.prototype._waitForGoogleMaps=function(){return new Promise(e=>{if("undefined"!=typeof google&&google.maps&&google.maps.importLibrary)return e();let t=setInterval(()=>{"undefined"!=typeof google&&google.maps&&google.maps.importLibrary&&(clearInterval(t),e())},50);setTimeout(()=>{clearInterval(t),"undefined"!=typeof google&&google.maps&&google.maps.importLibrary||console.error("Google Maps library failed to load"),e()},1e4)})},Voxel.Maps.Autocomplete.prototype.querySuggestions=async function(e){this.resetFocus(),this.showDropdown(),this.onChange();e=(e?.target?.value??this.el.value??"").trim();if(e)if(this.useGooglePlaces)try{var t=(await this._AutocompleteSuggestion.fetchAutocompleteSuggestions({input:e,...this.requestBase,sessionToken:this.sessionToken})).suggestions;this.hasQueried=!0,this.removeSuggestions(),(t||[]).slice(0,5).forEach(e=>{var t=e.placePrediction?.text?.toString?.()||"";this.addSuggestion({text:t,placePrediction:e.placePrediction})})}catch(e){console.log("[Places(New) querySuggestions] failed",e)}else Voxel.Maps.getGeocoder().geocode(e,{limit:5,_ac:this.options},e=>{if(this.hasQueried=!0,this.removeSuggestions(),!e)return!1;e.forEach(this.addSuggestion.bind(this))});else this.removeSuggestions()},Voxel.Maps.Autocomplete.prototype.navigateDropdown=function(e){this.hasQueried||this.input.trigger("input"),this.showDropdown(),40===e.keyCode&&(this.focusedItem++,this.focusItem()),38===e.keyCode&&(this.focusedItem--,this.focusItem()),13===e.keyCode&&(e.preventDefault(),0!==this.focusedItem)&&this.selectItem(this.focusedItem-1)},Voxel.Maps.Autocomplete.prototype.focusItem=function(){this.dropdown.find(".suggestions-list .suggestion").removeClass("active");var e=this.dropdown.find(".suggestions-list .suggestion");this.focusedItem<0&&(this.focusedItem=e.length),this.focusedItem>e.length&&(this.focusedItem=0),0!==this.focusedItem&&this.dropdown.find(".suggestions-list .suggestion").eq(this.focusedItem-1).addClass("active")},Voxel.Maps.Autocomplete.prototype.resetFocus=function(e){this.focusedItem=0,this.dropdown.find(".suggestions-list .suggestion").removeClass("active")},Voxel.Maps.Autocomplete.prototype.showDropdown=function(e){var t,o;this.el?.value&&(this.dropdown.addClass("active"),t=this.input.get(0).getBoundingClientRect(),o=this.input.offset(),this.dropdown.css({top:o.top+t.height+"px",left:o.left+"px",width:t.width+"px"}))},Voxel.Maps.Autocomplete.prototype.hideDropdown=function(e){this.dropdown.removeClass("active")},Voxel.Maps.Autocomplete.prototype.selectItem=async function(e){e=this.dropdown.find(".suggestions-list .suggestion").eq(e).data("place");if(this.useGooglePlaces){if(!e?.placePrediction)return;this.input.val(e.text);try{var t=e.placePrediction.toPlace(),o=(e=>{let t=new Set;return(e||[]).forEach(e=>{switch(e){case"formatted_address":t.add("formattedAddress");break;case"geometry":t.add("location"),t.add("viewport");break;default:t.add(String(e))}}),t.size||t.add("formattedAddress"),[...t]})(this.options.fields||["formatted_address","geometry"]),s=(await t.fetchFields({fields:o}),((e,t)=>{let o=e.formattedAddress,s=(t&&e.formattedAddress!==t&&(o=t),null),i=null;var n,r,a,p;return e.location&&(t="function"==typeof e.location.lat?e.location.lat():e.location.lat,n="function"==typeof e.location.lng?e.location.lng():e.location.lng,s={lat:t,lng:n}),e.viewport&&(t=e.viewport.getSouthWest(),n=e.viewport.getNorthEast(),r="function"==typeof t.lat?t.lat():t.lat,t="function"==typeof t.lng?t.lng():t.lng,a="function"==typeof n.lat?n.lat():n.lat,p="function"==typeof n.lng?n.lng():n.lng,i={south:r,west:t,north:a,east:p}),{formatted_address:o,geometry:{location:s,viewport:i},place_id:e.id||null}})(t,e.text));this.onChange(Voxel.Maps.getGeocoder().formatFeatureGoogleMaps(s)),this.sessionToken=new this._AutocompleteSessionToken}catch(e){console.error("[Places(New) selectItem] details failed",e)}}else{o=e;this.input.val(o.address),this.onChange(o)}this.resetFocus(),this.hideDropdown()},Voxel.Maps.Autocomplete.prototype.selectFirstResult=async function(e){0===this.focusedItem&&this.dropdown.find(".suggestions-list .suggestion").eq(0).length&&(await this.selectItem(0),"function"==typeof e)&&e()},Voxel.Maps.Autocomplete.prototype.attachDropdown=function(){var e=this.useGooglePlaces?"google_maps":"openstreetmap";this.dropdown=jQuery(`<div class="ts-autocomplete-dropdown" data-provider="${e}"><div class="suggestions-list"></div></div>`),this.input.addClass("ts-autocomplete-input").attr("autocomplete","off"),jQuery("body").append(this.dropdown)},Voxel.Maps.Autocomplete.prototype.attachAttribution=function(){var e,t;this.useGooglePlaces&&Voxel_Config.openstreetmap.geocoding.google_maps.logo_url&&((e=jQuery("<img>")).attr("src",Voxel_Config.openstreetmap.geocoding.google_maps.logo_url),(t=jQuery('<div class="ts-autocomplete-attrib"></div>')).append(e),this.dropdown.append(t))},Voxel.Maps.Autocomplete.prototype.removeSuggestions=function(){this.dropdown.find(".suggestions-list").html("")},Voxel.Maps.Autocomplete.prototype.addSuggestion=function(e){var t;this.useGooglePlaces?((t=jQuery('<div class="suggestion"><span class="suggestion--address"></span></div>')).find(".suggestion--address").text(e.text),t.data("place",e),this.dropdown.find(".suggestions-list").append(t)):(t=e,(e=jQuery(['<div class="suggestion">','<span class="suggestion--address"></span>',"</div>"].join(""))).data("place",t),e.find(".suggestion--address").text(t.address),this.dropdown.find(".suggestions-list").append(e))},Voxel.Maps.Bounds.prototype.init=function(e,t){this.southwest=e,this.northeast=t,this.bounds=L.latLngBounds(e?.getSourceObject(),t?.getSourceObject())},Voxel.Maps.Bounds.prototype.getSouthWest=function(){return this.southwest},Voxel.Maps.Bounds.prototype.getNorthEast=function(){return this.northeast},Voxel.Maps.Bounds.prototype.extend=function(e){this.bounds.extend(e.getSourceObject())},Voxel.Maps.Bounds.prototype.empty=function(){return!this.bounds.isValid()},Voxel.Maps.Bounds.prototype.getSourceObject=function(){return this.bounds},Voxel.Maps.Geocoder.prototype.init=function(){this._googleGeocoder=null,this._googleGeocoderReady=!1},Voxel.Maps.Geocoder.prototype.geocode=function(e,t,o){"function"==typeof t&&(o=t,t={});t=jQuery.extend(!0,{},{limit:1},t);var s=Voxel_Config.openstreetmap?.geocoding_provider||"nominatim";switch(s){case"nominatim":return this._geocodeNominatim(e,t,o);case"google_maps":return this._geocodeGoogleMaps(e,t,o);case"mapbox":return this._geocodeMapbox(e,t,o);default:return this._geocodeNominatim(e,t,o)}},Voxel.Maps.Geocoder.prototype._geocodeNominatim=function(e,o,t){var s=Voxel.applyFilters("openstreetmap/geocode",void 0,e,o,t);if(void 0!==s)return s;let i=this,n=!1,r;var s={format:"json",limit:o.limit},a=Voxel_Config.openstreetmap?.geocoding?.nominatim?.language,a=(a&&(s["accept-language"]=a),o._ac);if(delete o._ac,a?.countries?.length&&(s.countrycodes=a.countries.join(",")),"string"==typeof e&&e.includes(",")&&!isNaN(parseFloat(e.split(",")[0]))){a=e.split(",");r="https://nominatim.openstreetmap.org/reverse",s.lat=a[0].trim(),s.lon=a[1].trim()}else{if("string"!=typeof e||!e.length)return t(n);r="https://nominatim.openstreetmap.org/search",s.q=e}jQuery.ajax({url:r,data:s,dataType:"json",success:function(e,t){"success"===t&&e&&(e=Array.isArray(e)?e:[e]).length&&(n=1===o.limit?i.formatFeature(e[0]):e.map(e=>i.formatFeature(e)))},complete:function(){t(n)}})},Voxel.Maps.Geocoder.prototype.formatFeature=function(e){if(!e||!e.lat||!e.lon)return null;var t,o=parseFloat(e.lat),s=parseFloat(e.lon);let i;return i=e.boundingbox?new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(parseFloat(e.boundingbox[0]),parseFloat(e.boundingbox[2])),new Voxel.Maps.LatLng(parseFloat(e.boundingbox[1]),parseFloat(e.boundingbox[3]))):(t=1/370,new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(o-t,s-t),new Voxel.Maps.LatLng(o+t,s+t))),{address:e.display_name||e.name||"",latlng:new Voxel.Maps.LatLng(o,s),viewport:i}},Voxel.Maps.Geocoder.prototype._waitForGoogleMaps=function(){return new Promise(e=>{if("undefined"!=typeof google&&google.maps&&google.maps.Geocoder)return e();let t=setInterval(()=>{"undefined"!=typeof google&&google.maps&&google.maps.Geocoder&&(clearInterval(t),e())},50);setTimeout(()=>{clearInterval(t),"undefined"!=typeof google&&google.maps&&google.maps.Geocoder||console.error("Google Maps library failed to load"),e()},1e4)})},Voxel.Maps.Geocoder.prototype._initGoogleGeocoder=async function(){if(!this._googleGeocoderReady){if(await this._waitForGoogleMaps(),"undefined"==typeof google||!google.maps||!google.maps.Geocoder)return console.error("Google Maps Geocoder not available"),null;this._googleGeocoder||(this._googleGeocoder=new google.maps.Geocoder),this._googleGeocoderReady=!0}return this._googleGeocoder},Voxel.Maps.Geocoder.prototype._geocodeGoogleMaps=async function(e,o,s){let i=this,n=!1;"function"==typeof o&&(s=o,o={});o=jQuery.extend(!0,{},{limit:1},o);var t=await this._initGoogleGeocoder();if(!t)return s(n);var r={};if(e instanceof google.maps.LatLng)r.location=e;else if(e&&"function"==typeof e.getSourceObject){var a=e.getSourceObject();if(!a||"number"!=typeof a.lat||"number"!=typeof a.lng)return s(n);r.location=new google.maps.LatLng(a.lat,a.lng)}else if("string"==typeof e&&e.includes(",")&&!isNaN(parseFloat(e.split(",")[0]))){a=e.split(",");r.location=new google.maps.LatLng(parseFloat(a[0].trim()),parseFloat(a[1].trim()))}else{if("string"!=typeof e||!e.length)return s(n);r.address=e}a=Voxel_Config.openstreetmap?.geocoding?.google_maps?.language,a&&(r.language=a),e=o._ac;delete o._ac,e?.countries?.length&&(r.region=e.countries[0]),t.geocode(r,(e,t)=>("OK"===t&&e&&e.length?n=1===o.limit?i.formatFeatureGoogleMaps(e[0]):e.slice(0,o.limit).map(e=>i.formatFeatureGoogleMaps(e)):console.log("Geocoding failed. ["+t+"]"),s(n)))},Voxel.Maps.Geocoder.prototype.formatFeatureGoogleMaps=function(e){var t=e?.geometry?.location,o=e?.geometry?.viewport;if(!t||!o)return null;var s="function"==typeof t.lat?t.lat():t.lat,t="function"==typeof t.lng?t.lng():t.lng;let i,n,r,a;if("function"==typeof o.getSouthWest){var p=o.getSouthWest(),l=o.getNorthEast();i="function"==typeof p.lat?p.lat():p.lat,n="function"==typeof p.lng?p.lng():p.lng,r="function"==typeof l.lat?l.lat():l.lat,a="function"==typeof l.lng?l.lng():l.lng}else{if("object"!=typeof o||void 0===o.south)return null;i=o.south,n=o.west,r=o.north,a=o.east}return{address:e.formatted_address||"",latlng:new Voxel.Maps.LatLng(s,t),viewport:new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(i,n),new Voxel.Maps.LatLng(r,a))}},Voxel.Maps.Geocoder.prototype._geocodeMapbox=function(e,o,t){var s=this,i=!1;"function"==typeof o&&(t=o,o={});let n=Voxel_Config.openstreetmap.geocoding.mapbox.language;"auto"===n&&(n=null);var r={access_token:Voxel_Config.openstreetmap.geocoding.mapbox.api_key,limit:1,language:n},a=o._ac,o=(delete o._ac,a?.feature_types?.length&&(o.types=a.feature_types.join(",")),a?.countries?.length&&(o.country=a.countries.join(",")),jQuery.extend(!0,{},r,o));if(!encodeURIComponent(e).length)return t(i);let p=e;"string"==typeof e&&e.includes(",")&&(r=(a=e.split(","))[0].trim(),e=a[1]?a[1].trim():"",isNaN(parseFloat(r))||isNaN(parseFloat(e))||(p=e+","+r)),jQuery.get({url:"https://api.mapbox.com/geocoding/v5/mapbox.places/{query}.json".replace("{query}",encodeURIComponent(p)),data:o,dataType:"json",success:function(e,t){"success"===t&&e&&e.features.length&&(i=1===o.limit?s.formatFeatureMapbox(e.features[0]):e.features.map(s.formatFeatureMapbox))},complete:function(){t(i)}})},Voxel.Maps.Geocoder.prototype.formatFeatureMapbox=function(e){var t;return t=e.bbox?new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(e.bbox[1],e.bbox[0]),new Voxel.Maps.LatLng(e.bbox[3],e.bbox[2])):(t=1/370,new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(e.geometry.coordinates[1]-t,e.geometry.coordinates[0]-t),new Voxel.Maps.LatLng(e.geometry.coordinates[1]+t,e.geometry.coordinates[0]+t))),{address:e.place_name,latlng:new Voxel.Maps.LatLng(e.geometry.coordinates[1],e.geometry.coordinates[0]),viewport:t}},Voxel.Maps.LatLng.prototype.init=function(e,t){this.latlng=L.latLng(e,t)},Voxel.Maps.LatLng.prototype.getLatitude=function(){return this.latlng.lat},Voxel.Maps.LatLng.prototype.getLongitude=function(){return this.latlng.lng},Voxel.Maps.LatLng.prototype.toGeocoderFormat=function(){return[this.getLatitude(),this.getLongitude()].join(",")},Voxel.Maps.LatLng.prototype.getSourceObject=function(){return this.latlng},Voxel.Maps.Map.prototype.init=function({el:e,zoom:t,center:o,minZoom:s,maxZoom:i,draggable:n}){this.eventMap={zoom_changed:"zoomstart",bounds_changed:"moveend",idle:"idle",zoom:"zoom"},e?.__vx_map__?.map instanceof L.Map&&e.__vx_map__.map.remove(),this.map=L.map(e,{zoom:t,minZoom:2<=s?s:2,maxZoom:i<=19?i:19,dragging:!1!==n,scrollWheelZoom:!0,zoomControl:!0});t=Voxel_Config.openstreetmap?.tile_url||"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",s=Voxel_Config.openstreetmap?.tile_subdomains||"abc";L.tileLayer(t,{subdomains:s,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(this.map),this.map.zoomControl.setPosition("topright");let r;i=()=>{clearTimeout(r),r=setTimeout(()=>{this.map.fire("idle")},200)};this.map.on("moveend",i),this.map.on("zoomend",i),this.setCenter(o),this._setupVisibilityObserver(e),e.__vx_map__=this,e.classList.add("ts-map-loaded")},Voxel.Maps.Map.prototype.setZoom=function(e){this.map.setZoom(e)},Voxel.Maps.Map.prototype.getZoom=function(){return this.map.getZoom()},Voxel.Maps.Map.prototype.getMinZoom=function(){return this.map.getMinZoom()},Voxel.Maps.Map.prototype.getMaxZoom=function(){return this.map.getMaxZoom()},Voxel.Maps.Map.prototype.setCenter=function(e){this.map.setView(e.getSourceObject(),this.map.getZoom(),{animate:!1})},Voxel.Maps.Map.prototype.getCenter=function(){var e=this.map.getCenter();return new Voxel.Maps.LatLng(e.lat,e.lng)},Voxel.Maps.Map.prototype.getBounds=function(){var e=this.map.getBounds(),t=e.getNorthEast(),e=e.getSouthWest();return new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(e.lat,e.lng),new Voxel.Maps.LatLng(t.lat,t.lng))},Voxel.Maps.Map.prototype.fitBounds=function(e){e.empty()||(this.map.invalidateSize(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.map.fitBounds(e.getSourceObject(),{padding:[15,15],animate:!1})})}))},Voxel.Maps.Map.prototype.panTo=function(e){this.map.panTo(e.getSourceObject())},Voxel.Maps.Map.prototype.getClickPosition=function(e){return new Voxel.Maps.LatLng(e.latlng.lat,e.latlng.lng)},Voxel.Maps.Map.prototype.addListener=function(e,t){e=this.mapEvent(e);return this.map.on(e,t),{event:e,cb:t}},Voxel.Maps.Map.prototype.addListenerOnce=function(e,t){e=this.mapEvent(e);return this.map.once(e,t),{event:e,cb:t}},Voxel.Maps.Map.prototype.removeListener=function(e){this.map.off(e.event,e.cb)},Voxel.Maps.Map.prototype.trigger=function(e){this.map.fire(this.mapEvent(e))},Voxel.Maps.Map.prototype.getSourceObject=function(){return this.map},Voxel.Maps.Map.prototype._setupVisibilityObserver=function(t){null!==t.offsetParent&&"none"!==window.getComputedStyle(t).display&&"hidden"!==window.getComputedStyle(t).visibility||(t.style.opacity="0",t.style.transition="opacity .1s ease-in-out");var e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&0<e.intersectionRatio&&setTimeout(()=>{this.map&&(this.map.invalidateSize(),t.style.opacity="1")},100)})},{threshold:.01});e.observe(t),this._visibilityObserver=e},Voxel.Maps.Marker.prototype.init=function({map:e,position:t,onClick:o,data:s}){this.data=s,this.node=this.getTemplate().get(0),this.onClick=o,this.icon=L.divIcon({html:this.node,className:"vx-leaflet-marker",iconSize:[0,0],iconAnchor:[0,0]}),this.marker=L.marker([0,0],{icon:this.icon,interactive:!0}),this._updateIconSize=()=>{var e,t,o,s;this.node&&this.marker&&(t=(e=this.node).querySelector(".map-marker")||e.firstElementChild||e,e.offsetHeight,o=(s=t.getBoundingClientRect()).width||e.offsetWidth||t.offsetWidth||0,s=s.height||e.offsetHeight||t.offsetHeight||0,0<o)&&0<s&&(this.icon.options.iconSize=[o,s],this.icon.options.iconAnchor=[o/2,s/2],this.marker.setIcon(this.icon))},this._resizeHandler=null,e&&this._attachResizeListener(e),this.node.addEventListener("click",e=>{o&&o(e,this)}),e&&this.setMap(e),t&&(this.setPosition(t),this.node.style.opacity=0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.node.style.opacity=1})}))},Voxel.Maps.Marker.prototype.getPosition=function(){return this.position},Voxel.Maps.Marker.prototype.setPosition=function(e){(this.position=e)&&this.marker.setLatLng(e.getSourceObject())},Voxel.Maps.Marker.prototype.getMap=function(){return this.map},Voxel.Maps.Marker.prototype.setMap=function(e){this.map&&this._resizeHandler&&(this.map.getSourceObject().off("resize",this._resizeHandler),this._resizeHandler=null),this.map=e,this.marker.addTo(e.getSourceObject()),this._updateIconSize&&e.getSourceObject().whenReady(()=>{requestAnimationFrame(()=>{this._updateIconSize()})}),this._attachResizeListener(e)},Voxel.Maps.Marker.prototype.remove=function(){if(this.map&&this._resizeHandler){try{var e=this.map.getSourceObject();e&&e.off("resize",this._resizeHandler)}catch(e){}this._resizeHandler=null}if(this.marker)try{this.marker._map&&this.marker.remove()}catch(e){}return this},Voxel.Maps.Marker.prototype.addClass=function(e){return this.node?.classList.add(e)},Voxel.Maps.Marker.prototype.removeClass=function(e){return this.node?.classList.remove(e)},Voxel.Maps.Marker.prototype.getSourceObject=function(){return this.marker},Voxel.Maps.Marker.prototype._attachResizeListener=function(e){e&&!this._resizeHandler&&(e=e.getSourceObject(),this._resizeHandler=()=>{requestAnimationFrame(()=>{this._updateIconSize&&this._updateIconSize()})},e.on("resize",this._resizeHandler))},Voxel.Maps.Popup.prototype.init=function({map:e,position:t,content:o}){this.popup=L.popup({closeButton:!1,maxWidth:"none",className:"ts-leaflet-popup ts-marker",offset:[0,0],autoPan:!0}),this.map=e,t&&this.setPosition(t),o&&this.setContent(o),e&&this.setMap(e)},Voxel.Maps.Popup.prototype.setContent=function(e){this.popup.setContent(e)},Voxel.Maps.Popup.prototype.setPosition=function(e){this.popup.setLatLng(e.getSourceObject())},Voxel.Maps.Popup.prototype.setMap=function(e){this.map=e},Voxel.Maps.Popup.prototype.remove=function(){this.popup.remove()},Voxel.Maps.Popup.prototype.show=function(){this.popup.openOn(this.map.getSourceObject())},Voxel.Maps.Popup.prototype.hide=function(){this.popup.remove()},Voxel.Maps.Circle.prototype.init=function({map:e=null,center:t=null,radius:o=null}){this.map=e,this.locationNode=jQuery('<div class="hidden"><div class="map-circle-center"></div></div>').get(0),this.locationIcon=L.divIcon({html:this.locationNode,className:"vx-leaflet-circle-center",iconSize:null,iconAnchor:[0,0]}),this.locationMarker=L.marker(t.getSourceObject(),{icon:this.locationIcon}),this.locationMarker.addTo(e.getSourceObject()),this.node=jQuery('<div class="hidden"><div class="map-circle"></div></div>').get(0),this.circleIcon=L.divIcon({html:this.node,className:"vx-leaflet-circle",iconSize:[1e4,1e4],iconAnchor:[5e3,5e3]}),this.marker=L.marker(t.getSourceObject(),{icon:this.circleIcon,interactive:!1}),this.marker.addTo(e.getSourceObject()),this.center=t,this.radius=o,this._draw();t=()=>this._draw(),o=e.getSourceObject();o.on("zoomend",t),o.on("moveend",t),o.on("zoomstart",()=>{requestAnimationFrame(()=>this._draw())})},Voxel.Maps.Circle.prototype.hide=function(){this.node.classList.add("hidden"),this.locationNode.classList.add("hidden")},Voxel.Maps.Circle.prototype.show=function(){this.node.classList.remove("hidden"),this.locationNode.classList.remove("hidden")},Voxel.Maps.Circle.prototype.setCenter=function(e){this.center=e,this.marker.setLatLng(e.getSourceObject()),this.locationMarker.setLatLng(e.getSourceObject()),this._draw()},Voxel.Maps.Circle.prototype.setRadius=function(e){this.radius=e,this._draw()},Voxel.Maps.Circle.prototype.getBounds=function(){return new Voxel.Maps.Bounds(new Voxel.Maps.LatLng(this.bounds.getSouth(),this.bounds.getWest()),new Voxel.Maps.LatLng(this.bounds.getNorth(),this.bounds.getEast()))},Voxel.Maps.Circle.prototype._updateBounds=function(){var e=this.center.getSourceObject(),t=e.lat,e=e.lng,o=this.radius/111320,s=this.radius/(111320*Math.cos(t*Math.PI/180)),i=(e,t,o)=>Math.max(t,Math.min(e,o));this.bounds=L.latLngBounds([i(t-o,-90,90),i(e-s,-180,180)],[i(t+o,-90,90),i(e+s,-180,180)])},Voxel.Maps.Circle.prototype._draw=function(){var e=this.map.getSourceObject(),t=this.center.getSourceObject(),o=e.latLngToContainerPoint(t),e=e.latLngToContainerPoint(L.latLng(t.lat+this.radius/111320,t.lng)),t=Math.abs(e.y-o.y),e=this.node.querySelector(".map-circle");e&&(o=2*t,e.style.left=5e3-t+"px",e.style.top=5e3-t+"px",e.style.width=o+"px",e.style.height=o+"px"),this._updateBounds()};(function(e){e.exports=(()=>{let p=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class i{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");var[t,o]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");t=o>>4;if(1!=t)throw new Error(`Got v${t} data when expected v1.`);var s,t=p[15&o];if(t)return[o]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1),new i(s,o,t,e);throw new Error("Unrecognized array type.")}constructor(e,t=64,o=Float64Array,s){if(isNaN(e)||e<=0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;var i=p.indexOf(this.ArrayType),n=2*e*this.ArrayType.BYTES_PER_ELEMENT,r=e*this.IndexArrayType.BYTES_PER_ELEMENT,a=(8-r%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+r+a,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+n+r+a),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+r+a,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){var o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=t,o}finish(){var e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return function e(t,o,s,i,n,r){if(n-i<=s)return;let a=i+n>>1;h(t,o,a,i,n,r);e(t,o,s,i,a-1,1-r);e(t,o,s,1+a,n,1-r)}(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,s,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:n,coords:r,nodeSize:e}=this,a=[0,n.length-1,0],p=[];a.length;){var l=a.pop()||0,u=a.pop()||0,c=a.pop()||0;if(u-c<=e)for(let e=c;e<=u;e++){var d=r[2*e],h=r[2*e+1];t<=d&&d<=s&&o<=h&&h<=i&&p.push(n[e])}else{var g=c+u>>1,m=r[2*g],f=r[2*g+1];t<=m&&m<=s&&o<=f&&f<=i&&p.push(n[g]),(0===l?t<=m:o<=f)&&(a.push(c),a.push(g-1),a.push(1-l)),(0===l?m<=s:f<=i)&&(a.push(1+g),a.push(u),a.push(1-l))}}return p}within(t,o,e){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");for(var{ids:s,coords:i,nodeSize:n}=this,r=[0,s.length-1,0],a=[],p=e*e;r.length;){var l=r.pop()||0,u=r.pop()||0,c=r.pop()||0;if(u-c<=n)for(let e=c;e<=u;e++)m(i[2*e],i[2*e+1],t,o)<=p&&a.push(s[e]);else{var d=c+u>>1,h=i[2*d],g=i[2*d+1];m(h,g,t,o)<=p&&a.push(s[d]),(0===l?t-e<=h:o-e<=g)&&(r.push(c),r.push(d-1),r.push(1-l)),(0===l?h<=t+e:g<=o+e)&&(r.push(1+d),r.push(u),r.push(1-l))}}return a}}function h(o,s,i,n,r,a){for(;n<r;){600<r-n&&(p=r-n+1,l=i-n+1,c=Math.log(p),u=.5*Math.exp(2*c/3),c=.5*Math.sqrt(c*u*(p-u)/p)*(l-p/2<0?-1:1),h(o,s,i,Math.max(n,Math.floor(i-l*u/p+c)),Math.min(r,Math.floor(i+(p-l)*u/p+c)),a));var p,l,u,c,d=s[2*i+a];let e=n,t=r;for(g(o,s,n,i),d<s[2*r+a]&&g(o,s,n,r);e<t;){for(g(o,s,e,t),e++,t--;s[2*e+a]<d;)e++;for(;s[2*t+a]>d;)t--}s[2*n+a]===d?g(o,s,n,t):g(o,s,++t,r),t<=i&&(n=t+1),i<=t&&(r=t-1)}}function g(e,t,o,s){n(e,o,s),n(t,2*o,2*s),n(t,2*o+1,2*s+1)}function n(e,t,o){var s=e[t];e[t]=e[o],e[o]=s}function m(e,t,o,s){e-=o,o=t-s;return e*e+o*o}let t={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},u=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),f=3,b=5,r=6;class e{constructor(e){this.options=Object.assign(Object.create(t),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){var{log:o,minZoom:s,maxZoom:i}=this.options,e=(o&&console.time("total time"),`prepare ${t.length} points`),n=(o&&console.time(e),this.points=t,[]);for(let e=0;e<t.length;e++){var r,a=t[e];a.geometry&&([a,r]=a.geometry.coordinates,a=u(M(a)),r=u(x(r)),n.push(a,r,1/0,e,-1,1),this.options.reduce)&&n.push(0)}let p=this.trees[i+1]=this._createTree(n);o&&console.timeEnd(e);for(let e=i;e>=s;e--){var l=+Date.now();p=this.trees[e]=this._createTree(this._cluster(p,e)),o&&console.log("z%d: %d clusters in %dms",e,p.numItems,+Date.now()-l)}return o&&console.timeEnd("total time"),this}getClusters(e,t){let o=((e[0]+180)%360+360)%360-180;var s=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;var n=Math.max(-90,Math.min(90,e[3]));if(360<=e[2]-e[0])o=-180,i=180;else if(o>i)return e=this.getClusters([o,s,180,n],t),a=this.getClusters([-180,s,i,n],t),e.concat(a);var r,e=this.trees[this._limitZoom(t)],a=e.range(M(o),x(n),M(i),x(s)),p=e.data,l=[];for(r of a){var u=this.stride*r;l.push(1<p[u+b]?c(p,u,this.clusterProps):this.points[p[u+f]])}return l}getChildren(e){var t=this._getOriginId(e),o=this._getOriginZoom(e),s="No cluster with the specified id.",i=this.trees[o];if(!i)throw new Error(s);var n=i.data;if(t*this.stride>=n.length)throw new Error(s);var r,o=this.options.radius/(this.options.extent*Math.pow(2,o-1)),a=n[t*this.stride],t=n[t*this.stride+1],p=[];for(r of i.within(a,t,o)){var l=r*this.stride;n[4+l]===e&&p.push(1<n[l+b]?c(n,l,this.clusterProps):this.points[n[l+f]])}if(0===p.length)throw new Error(s);return p}getLeaves(e,t,o){var s=[];return this._appendLeaves(s,e,t=t||10,o=o||0,0),s}getTile(e,t,o){var s=this.trees[this._limitZoom(e)],e=Math.pow(2,e),{extent:i,radius:n}=this.options,n=n/i,i=(o-n)/e,r=(o+1+n)/e,a={features:[]};return this._addTileFeatures(s.range((t-n)/e,i,(t+1+n)/e,r),s.data,t,o,e,a),0===t&&this._addTileFeatures(s.range(1-n/e,i,1,r),s.data,e,o,e,a),t===e-1&&this._addTileFeatures(s.range(0,i,n/e,r),s.data,-1,o,e,a),a.features.length?a:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){var o=this.getChildren(e);if(t++,1!==o.length)break;e=o[0].properties.cluster_id}return t}_appendLeaves(e,t,o,s,i){var n;for(n of this.getChildren(t)){var r=n.properties;if(r&&r.cluster?i+r.point_count<=s?i+=r.point_count:i=this._appendLeaves(e,r.cluster_id,o,s,i):i<s?i++:e.push(n),e.length===o)break}return i}_createTree(t){var o=new i(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)o.add(t[e],t[e+1]);return o.finish(),o.data=t,o}_addTileFeatures(e,i,n,r,a,p){for(var l of e){var u,l=l*this.stride,c=1<i[l+b];let e,t,o;o=c?(e=y(i,l,this.clusterProps),t=i[l],i[1+l]):(d=this.points[i[l+f]],[d,u]=(e=d.properties,d.geometry.coordinates),t=M(d),x(u));var d={type:1,geometry:[[Math.round(this.options.extent*(t*a-n)),Math.round(this.options.extent*(o*a-r))]],tags:e};let s;void 0!==(s=c||this.options.generateId?i[l+f]:this.points[i[l+f]].id)&&(d.id=s),p.features.push(d)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,r){var{radius:t,extent:o,reduce:a,minPoints:s}=this.options,p=t/(o*Math.pow(2,r)),l=e.data,u=[],c=this.stride;for(let n=0;n<l.length;n+=c)if(!(l[n+2]<=r)){l[n+2]=r;var d,h=l[n],g=l[n+1],m=e.within(l[n],l[n+1],p),f=l[n+b];let i=f;for(d of m){var y=d*c;l[2+y]>r&&(i+=l[y+b])}if(i>f&&i>=s){let e=h*f,t=g*f,o,s=-1;var M,x=((n/c|0)<<5)+(r+1)+this.points.length;for(M of m){var v,V=M*c;l[2+V]<=r||(l[2+V]=r,v=l[V+b],e+=l[V]*v,t+=l[1+V]*v,l[4+V]=x,a&&(o||(o=this._map(l,n,!0),s=this.clusterProps.length,this.clusterProps.push(o)),a(o,this._map(l,V))))}l[n+4]=x,u.push(e/i,t/i,1/0,x,-1,i),a&&u.push(s)}else{for(let e=0;e<c;e++)u.push(l[n+e]);if(1<i)for(var _ of m){var w=_*c;if(!(l[2+w]<=r)){l[2+w]=r;for(let e=0;e<c;e++)u.push(l[w+e])}}}}return u}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,o){var s;return 1<e[t+b]?(s=this.clusterProps[e[t+r]],o?Object.assign({},s):s):(s=this.points[e[t+f]].properties,e=this.options.map(s),o&&e===s?Object.assign({},e):e)}}function c(e,t,o){return{type:"Feature",id:e[t+f],properties:y(e,t,o),geometry:{type:"Point",coordinates:[360*(e[t]-.5),(e=>(e=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(e))/Math.PI-90))(e[t+1])]}}}function y(e,t,o){var s=e[t+b],i=1e4<=s?Math.round(s/1e3)+"k":1e3<=s?Math.round(s/100)/10+"k":s,n=e[t+r],o=-1===n?{}:Object.assign({},o[n]);return Object.assign(o,{cluster:!0,cluster_id:e[t+f],point_count:s,point_count_abbreviated:i})}function M(e){return e/360+.5}function x(e){e=Math.sin(e*Math.PI/180),e=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return e<0?0:1<e?1:e}return e})()})(e={exports:{}});var e,t=e.exports;Voxel.Maps.Clusterer.prototype.init=function({map:e}){this.map=e,this.markers=[],this.clusters={},this.cluster=new t({radius:35,maxZoom:30}),this.map.addListener("zoomend",()=>this.render())},Voxel.Maps.Clusterer.prototype._getGeoJSON=function(){return this.markers.map(function(e,t){return{type:"Feature",geometry:{type:"Point",coordinates:[e.getPosition().getLongitude(),e.getPosition().getLatitude()]},properties:{sID:t+1,scID:0,marker:e}}})},Voxel.Maps.Clusterer.prototype.getSourceObject=function(){return this.cluster},Voxel.Maps.Clusterer.prototype.clearMarkers=function(){this.markers.map(e=>e.remove()),this.markers=[]},Voxel.Maps.Clusterer.prototype.addMarkers=function(e){this.markers.push(...e)},Voxel.Maps.Clusterer.prototype.render=function(){var e=this._getGeoJSON();e.length?(this.cluster.load(e),this.markers.map(e=>e.remove()),e=this.cluster.getClusters([-180,-90,180,90],Math.floor(this.map.getSourceObject().getZoom())),this._removeFeatures(),this._displayFeatures(e)):this._removeFeatures()},Voxel.Maps.Clusterer.prototype._displayFeatures=function(e){e.forEach(i=>{var e,t;i.properties.cluster?(e=`<div><div class="ts-marker-cluster">${i.properties.point_count_abbreviated}</div></div>`,e=jQuery(e).get(0),t=L.divIcon({html:e,className:"vx-leaflet-cluster",iconSize:null,iconAnchor:[0,0]}),(t=L.marker([i.geometry.coordinates[1],i.geometry.coordinates[0]],{icon:t})).addTo(this.map.getSourceObject()),this.clusters[i.properties.cluster_id]=t,e.addEventListener("click",e=>{e.preventDefault();var e=this.map.getZoom(),t=this.map.getMaxZoom(),o=this.cluster.getClusterExpansionZoom(i.properties.cluster_id),o=Math.min(o,t),s=Math.round(e)>=t;o<=e||s?(e=this.cluster.getLeaves(i.properties.cluster_id,-1).map(e=>e.properties.marker),"function"==typeof this._onNonExpandableClusterClick&&this._onNonExpandableClusterClick(e)):(o===t?this.map.getSourceObject().setView([i.geometry.coordinates[1],i.geometry.coordinates[0]],o):this.map.getSourceObject().flyTo([i.geometry.coordinates[1],i.geometry.coordinates[0]],o),"function"==typeof this._onClusterClick&&this._onClusterClick())})):i.properties.marker.setMap(this.map)})},Voxel.Maps.Clusterer.prototype._removeFeatures=function(){Object.values(this.clusters).map(e=>e.remove()),this.clusters={}},Voxel.Maps.Clusterer.prototype.onClusterClick=function(e){this._onClusterClick=e},Voxel.Maps.Clusterer.prototype.onNonExpandableClusterClick=function(e){this._onNonExpandableClusterClick=e},jQuery(e=>{let t=!1,o=!1;let s="google_maps"===Voxel_Config.openstreetmap?.geocoding_provider,i=()=>{s&&!t||o&&(Voxel.Maps.Loaded=!0,document.dispatchEvent(new Event("maps:loaded")),jQuery(document).on("voxel:markup-update",()=>{requestAnimationFrame(()=>jQuery(document).trigger("maps:loaded"))}))};s?(Voxel.Maps.GoogleMaps=function(){t=!0,i()},(n=document.getElementById("google-maps-js"))&&(n.src=n.dataset.src),"undefined"!=typeof google&&google.maps&&google.maps.importLibrary&&(t=!0)):Voxel.Maps.GoogleMaps=function(){};var n=document.getElementById("leaflet-js");n?(n.src=n.dataset.src,n.addEventListener("load",()=>{o=!0,i()},{once:!0})):"undefined"!=typeof L&&(o=!0,i())}),jQuery(document).on("maps:loaded",()=>{jQuery(".ts-map.ts-map-autoload").each((e,o)=>{if(!o.__map_loaded__){o.__map_loaded__=!0;var s=jQuery(o).data("config"),o={el:o,zoom:3};s&&(s.zoom&&(o.zoom=s.zoom),s.minZoom&&(o.minZoom=s.minZoom),s.maxZoom&&(o.maxZoom=s.maxZoom),s.center)&&(o.center=new Voxel.Maps.LatLng(s.center.lat,s.center.lng));let t=new Voxel.Maps.Map(o);s.markers&&s.markers.forEach(e=>{new Voxel.Maps.Marker({map:t,position:new Voxel.Maps.LatLng(e.lat,e.lng),template:e.uriencoded?decodeURIComponent(e.template):e.template})})}})})});
