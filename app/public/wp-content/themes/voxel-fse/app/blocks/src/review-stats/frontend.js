(function(U,S){"use strict";var x,L,R,k;x={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},L=["(","?"],R={")":["("],":":["?","?:"]},k=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;function B(e){for(var t=[],r=[],n,i,o,s;n=e.match(k);){for(i=n[0],o=e.substr(0,n.index).trim(),o&&t.push(o);s=r.pop();){if(R[i]){if(R[i][0]===s){i=R[i][1]||i;break}}else if(L.indexOf(s)>=0||x[s]<x[i]){r.push(s);break}t.push(s)}R[i]||r.push(i),e=e.substr(n.index+i.length)}return e=e.trim(),e&&t.push(e),t.concat(r.reverse())}var V={"!":function(e){return!e},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"==":function(e,t){return e===t},"!=":function(e,t){return e!==t},"&&":function(e,t){return e&&t},"||":function(e,t){return e||t},"?:":function(e,t,r){if(e)throw t;return r}};function q(e,t){var r=[],n,i,o,s,l,f;for(n=0;n<e.length;n++){if(l=e[n],s=V[l],s){for(i=s.length,o=Array(i);i--;)o[i]=r.pop();try{f=s.apply(null,o)}catch(a){return a}}else t.hasOwnProperty(l)?f=t[l]:f=+l;r.push(f)}return r[0]}function J(e){var t=B(e);return function(r){return q(t,r)}}function K(e){var t=J(e);return function(r){return+t({n:r})}}var w={contextDelimiter:"",onMissingKey:null};function Z(e){var t,r,n;for(t=e.split(";"),r=0;r<t.length;r++)if(n=t[r].trim(),n.indexOf("plural=")===0)return n.substr(7)}function T(e,t){var r;this.data=e,this.pluralForms={},this.options={};for(r in w)this.options[r]=t!==void 0&&r in t?t[r]:w[r]}T.prototype.getPluralForm=function(e,t){var r=this.pluralForms[e],n,i,o;return r||(n=this.data[e][""],o=n["Plural-Forms"]||n["plural-forms"]||n.plural_forms,typeof o!="function"&&(i=Z(n["Plural-Forms"]||n["plural-forms"]||n.plural_forms),o=K(i)),r=this.pluralForms[e]=o),r(t)},T.prototype.dcnpgettext=function(e,t,r,n,i){var o,s,l;return i===void 0?o=0:o=this.getPluralForm(e,i),s=r,t&&(s=t+this.options.contextDelimiter+r),l=this.data[e][s],l&&l[o]?l[o]:(this.options.onMissingKey&&this.options.onMissingKey(r,e),o===0?r:n)};var z={"":{plural_forms(e){return e===1?0:1}}},W=/^i18n\.(n?gettext|has_translation)(_|$)/,X=(e,t,r)=>{const n=new T({}),i=new Set,o=()=>{i.forEach(c=>c())},s=c=>(i.add(c),()=>i.delete(c)),l=(c="default")=>n.data[c],f=(c,u="default")=>{n.data[u]={...n.data[u],...c},n.data[u][""]={...z[""],...n.data[u]?.[""]},delete n.pluralForms[u]},a=(c,u)=>{f(c,u),o()},p=(c,u="default")=>{n.data[u]={...n.data[u],...c,"":{...z[""],...n.data[u]?.[""],...c?.[""]}},delete n.pluralForms[u],o()},d=(c,u)=>{n.data={},n.pluralForms={},a(c,u)},h=(c="default",u,_,b,g)=>(n.data[c]||f(void 0,c),n.dcnpgettext(c,u,_,b,g)),m=c=>c||"default",Se=(c,u)=>{let _=h(u,void 0,c);return r?(_=r.applyFilters("i18n.gettext",_,c,u),r.applyFilters("i18n.gettext_"+m(u),_,c,u)):_},$=(c,u,_)=>{let b=h(_,u,c);return r?(b=r.applyFilters("i18n.gettext_with_context",b,c,u,_),r.applyFilters("i18n.gettext_with_context_"+m(_),b,c,u,_)):b},Ee=(c,u,_,b)=>{let g=h(b,void 0,c,u,_);return r?(g=r.applyFilters("i18n.ngettext",g,c,u,_,b),r.applyFilters("i18n.ngettext_"+m(b),g,c,u,_,b)):g},Ae=(c,u,_,b,g)=>{let H=h(g,b,c,u,_);return r?(H=r.applyFilters("i18n.ngettext_with_context",H,c,u,_,b,g),r.applyFilters("i18n.ngettext_with_context_"+m(g),H,c,u,_,b,g)):H},Fe=()=>$("ltr","text direction")==="rtl",He=(c,u,_)=>{const b=u?u+""+c:c;let g=!!n.data?.[_??"default"]?.[b];return r&&(g=r.applyFilters("i18n.has_translation",g,c,u,_),g=r.applyFilters("i18n.has_translation_"+m(_),g,c,u,_)),g};if(r){const c=u=>{W.test(u)&&o()};r.addAction("hookAdded","core/i18n",c),r.addAction("hookRemoved","core/i18n",c)}return{getLocaleData:l,setLocaleData:a,addLocaleData:p,resetLocaleData:d,subscribe:s,__:Se,_x:$,_n:Ee,_nx:Ae,isRTL:Fe,hasTranslation:He}};function Q(e){return typeof e!="string"||e===""?(console.error("The namespace must be a non-empty string."),!1):/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)?!0:(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)}var I=Q;function Y(e){return typeof e!="string"||e===""?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)?!0:(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)}var C=Y;function ee(e,t){return function(n,i,o,s=10){const l=e[t];if(!C(n)||!I(i))return;if(typeof o!="function"){console.error("The hook callback must be a function.");return}if(typeof s!="number"){console.error("If specified, the hook priority must be a number.");return}const f={callback:o,priority:s,namespace:i};if(l[n]){const a=l[n].handlers;let p;for(p=a.length;p>0&&!(s>=a[p-1].priority);p--);p===a.length?a[p]=f:a.splice(p,0,f),l.__current.forEach(d=>{d.name===n&&d.currentIndex>=p&&d.currentIndex++})}else l[n]={handlers:[f],runs:0};n!=="hookAdded"&&e.doAction("hookAdded",n,i,o,s)}}var D=ee;function te(e,t,r=!1){return function(i,o){const s=e[t];if(!C(i)||!r&&!I(o))return;if(!s[i])return 0;let l=0;if(r)l=s[i].handlers.length,s[i]={runs:s[i].runs,handlers:[]};else{const f=s[i].handlers;for(let a=f.length-1;a>=0;a--)f[a].namespace===o&&(f.splice(a,1),l++,s.__current.forEach(p=>{p.name===i&&p.currentIndex>=a&&p.currentIndex--}))}return i!=="hookRemoved"&&e.doAction("hookRemoved",i,o),l}}var E=te;function re(e,t){return function(n,i){const o=e[t];return typeof i<"u"?n in o&&o[n].handlers.some(s=>s.namespace===i):n in o}}var G=re;function ne(e,t,r,n){return function(o,...s){const l=e[t];l[o]||(l[o]={handlers:[],runs:0}),l[o].runs++;const f=l[o].handlers;if(!f||!f.length)return r?s[0]:void 0;const a={name:o,currentIndex:0};async function p(){try{l.__current.add(a);let h=r?s[0]:void 0;for(;a.currentIndex<f.length;)h=await f[a.currentIndex].callback.apply(null,s),r&&(s[0]=h),a.currentIndex++;return r?h:void 0}finally{l.__current.delete(a)}}function d(){try{l.__current.add(a);let h=r?s[0]:void 0;for(;a.currentIndex<f.length;)h=f[a.currentIndex].callback.apply(null,s),r&&(s[0]=h),a.currentIndex++;return r?h:void 0}finally{l.__current.delete(a)}}return(n?p:d)()}}var A=ne;function ie(e,t){return function(){const n=e[t];return Array.from(n.__current).at(-1)?.name??null}}var N=ie;function oe(e,t){return function(n){const i=e[t];return typeof n>"u"?i.__current.size>0:Array.from(i.__current).some(o=>o.name===n)}}var M=oe;function se(e,t){return function(n){const i=e[t];if(C(n))return i[n]&&i[n].runs?i[n].runs:0}}var O=se,ae=class{actions;filters;addAction;addFilter;removeAction;removeFilter;hasAction;hasFilter;removeAllActions;removeAllFilters;doAction;doActionAsync;applyFilters;applyFiltersAsync;currentAction;currentFilter;doingAction;doingFilter;didAction;didFilter;constructor(){this.actions=Object.create(null),this.actions.__current=new Set,this.filters=Object.create(null),this.filters.__current=new Set,this.addAction=D(this,"actions"),this.addFilter=D(this,"filters"),this.removeAction=E(this,"actions"),this.removeFilter=E(this,"filters"),this.hasAction=G(this,"actions"),this.hasFilter=G(this,"filters"),this.removeAllActions=E(this,"actions",!0),this.removeAllFilters=E(this,"filters",!0),this.doAction=A(this,"actions",!1,!1),this.doActionAsync=A(this,"actions",!1,!0),this.applyFilters=A(this,"filters",!0,!1),this.applyFiltersAsync=A(this,"filters",!0,!0),this.currentAction=N(this,"actions"),this.currentFilter=N(this,"filters"),this.doingAction=M(this,"actions"),this.doingFilter=M(this,"filters"),this.didAction=O(this,"actions"),this.didFilter=O(this,"filters")}};function ce(){return new ae}var le=ce,P=le(),{addAction:xe,addFilter:Te,removeAction:Ce,removeFilter:Le,hasAction:ke,hasFilter:we,removeAllActions:ze,removeAllFilters:Ie,doAction:De,doActionAsync:Ge,applyFilters:Ne,applyFiltersAsync:Me,currentAction:Oe,currentFilter:Pe,doingAction:je,doingFilter:$e,didAction:Ue,didFilter:Be,actions:Ve,filters:qe}=P,y=X(void 0,void 0,P);y.getLocaleData.bind(y),y.setLocaleData.bind(y),y.resetLocaleData.bind(y),y.subscribe.bind(y);var v=y.__.bind(y);y._x.bind(y),y._n.bind(y),y._nx.bind(y),y.isRTL.bind(y),y.hasTranslation.bind(y);const j=[{key:"excellent",label:v("Excellent","voxel-fse"),score:2},{key:"very_good",label:v("Very good","voxel-fse"),score:1},{key:"good",label:v("Good","voxel-fse"),score:0},{key:"fair",label:v("Fair","voxel-fse"),score:-1},{key:"poor",label:v("Poor","voxel-fse"),score:-2}];function ue(e){const t={};return e.columns&&(t.gridTemplateColumns=`repeat(${e.columns}, 1fr)`),e.itemGap!==void 0&&(t.gap=`${e.itemGap}px`),t}function de({attributes:e,statsData:t,isLoading:r,error:n,context:i,postId:o}){const s=ue(e),l={statMode:e.statMode,columns:e.columns,itemGap:e.itemGap,iconSize:e.iconSize,iconSpacing:e.iconSpacing,labelTypography:e.labelTypography,labelColor:e.labelColor,scoreTypography:e.scoreTypography,scoreColor:e.scoreColor,chartBgColor:e.chartBgColor,chartHeight:e.chartHeight,chartRadius:e.chartRadius};if(r)return React.createElement("div",{className:"ts-review-bars vxfse-loading",style:s},React.createElement("div",{className:"vxfse-loading-state"},React.createElement("span",{className:"ts-loader"}),React.createElement("span",null,v("Loading review stats...","voxel-fse"))));if(n)return React.createElement("div",{className:"ts-review-bars vxfse-error",style:s},React.createElement("div",{className:"vxfse-error-state"},React.createElement("span",null,v("Error loading review stats","voxel-fse"))));if(!t)return e.statMode==="by_category"?React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("div",{className:"ts-review-bars",style:s})):React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("div",{className:"ts-review-bars",style:s},j.map(a=>React.createElement("div",{key:a.key,className:`ts-percentage-bar ${a.key}`},React.createElement("div",{className:"ts-bar-data"},React.createElement("p",null,a.label,React.createElement("span",null,"0%"))),React.createElement("div",{className:"ts-bar-chart"},React.createElement("div",{style:{width:"0%"}}))))));if(e.statMode==="by_category")return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("div",{className:"ts-review-bars",style:s},t.byCategory.map(a=>{const p=Math.round((a.score+3)*10)/10,d=p/5*100;return React.createElement("div",{key:a.key,className:"ts-percentage-bar",style:a.color?{"--ts-accent-1":a.color}:void 0},React.createElement("div",{className:"ts-bar-data"},a.icon&&React.createElement("span",{className:"ts-category-icon",dangerouslySetInnerHTML:{__html:a.icon}}),React.createElement("p",null,a.label,React.createElement("span",null,p.toFixed(1)," / 5"))),React.createElement("div",{className:"ts-bar-chart"},React.createElement("div",{style:{width:`${d}%`}})))})));const f=[...t.ratingLevels||j].reverse();return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("div",{className:"ts-review-bars",style:s},f.map(a=>{const p=t.overall[a.key]||0;return React.createElement("div",{key:a.key,className:`ts-percentage-bar ${a.key}`,style:a.color?{"--ts-accent-1":a.color}:void 0},React.createElement("div",{className:"ts-bar-data"},React.createElement("p",null,a.label,React.createElement("span",null,Math.round(p),"%"))),React.createElement("div",{className:"ts-bar-chart"},React.createElement("div",{style:{width:`${p}%`}})))})))}function fe(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const t=e.getAttribute("href");if(t)return t.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function pe(){const e=fe();try{return new URL(e).pathname.replace(/\/$/,"")}catch{return""}}function he(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const t=document.querySelector('link[rel="https://api.w.org/"]');if(t){const r=t.getAttribute("href");if(r)return r}}const e=pe();return typeof window<"u"?window.location.origin+e+"/wp-json/":"/wp-json/"}function me(e){const t=(d,h)=>typeof d=="string"?d:typeof d=="number"?String(d):h,r=(d,h)=>{if(typeof d=="number")return d;if(typeof d=="string"){const m=parseFloat(d);if(!isNaN(m))return m}return h},n=(d,h)=>{if(typeof d=="object"&&d!==null){const m=d;return{desktop:m.desktop!==void 0?r(m.desktop,h):h,tablet:m.tablet!==void 0?r(m.tablet,h):void 0,mobile:m.mobile!==void 0?r(m.mobile,h):void 0}}return typeof d=="number"?{desktop:d}:{desktop:h}},i=(d,h)=>{if(typeof d=="object"&&d!==null){const m=d;return{desktop:m.desktop!==void 0?t(m.desktop,h):h,tablet:m.tablet!==void 0?t(m.tablet,h):void 0,mobile:m.mobile!==void 0?t(m.mobile,h):void 0}}return typeof d=="string"?{desktop:d}:{desktop:h}},o=d=>{if(!d)return;const h=parseFloat(d);return isNaN(h)?void 0:h},s=n(e.columns??e.ts_rs_column_no,1),l=i(e.itemGap??e.item_gap??e.ts_rs_col_gap,""),f=i(e.iconSize??e.icon_size??e.ts_review_icon_size,""),a=i(e.chartHeight??e.chart_height??e.ts_chart_height,""),p=i(e.chartRadius??e.chart_radius??e.ts_chart_rad,"");return{statMode:t(e.statMode??e.stat_mode,"overall"),columns:s.desktop,columns_tablet:s.tablet,columns_mobile:s.mobile,itemGap:typeof e.itemGap=="number"?e.itemGap:o(l.desktop)??0,itemGap_tablet:typeof e.itemGap_tablet=="number"?e.itemGap_tablet:o(l.tablet),itemGap_mobile:typeof e.itemGap_mobile=="number"?e.itemGap_mobile:o(l.mobile),iconSize:typeof e.iconSize=="number"?e.iconSize:o(f.desktop)??0,iconSize_tablet:typeof e.iconSize_tablet=="number"?e.iconSize_tablet:o(f.tablet),iconSize_mobile:typeof e.iconSize_mobile=="number"?e.iconSize_mobile:o(f.mobile),iconSpacing:e.iconSpacing!==void 0?r(e.iconSpacing,void 0):e.icon_spacing!==void 0?r(e.icon_spacing,void 0):e.ts_review_icon_spacing!==void 0?r(e.ts_review_icon_spacing,void 0):void 0,labelTypography:e.labelTypography??e.label_typography??e.ts_review_typo??{},labelColor:t(e.labelColor??e.label_color??e.ts_review_typo_color,""),scoreTypography:e.scoreTypography??e.score_typography??e.ts_review_score??{},scoreColor:t(e.scoreColor??e.score_color??e.ts_review_score_color,""),chartBgColor:t(e.chartBgColor??e.chart_bg_color??e.ts_review_chart_bg,""),chartHeight:typeof e.chartHeight=="number"?e.chartHeight:o(a.desktop)??0,chartHeight_tablet:typeof e.chartHeight_tablet=="number"?e.chartHeight_tablet:o(a.tablet),chartHeight_mobile:typeof e.chartHeight_mobile=="number"?e.chartHeight_mobile:o(a.mobile),chartRadius:typeof e.chartRadius=="number"?e.chartRadius:o(p.desktop)??0,chartRadius_tablet:typeof e.chartRadius_tablet=="number"?e.chartRadius_tablet:o(p.tablet),chartRadius_mobile:typeof e.chartRadius_mobile=="number"?e.chartRadius_mobile:o(p.mobile)}}function _e(){return he()}function ye(){const e=window.voxelCurrentPost;if(e?.id)return e.id;const t=document.body.className.split(" ");for(const i of t)if(i.startsWith("postid-")||i.startsWith("page-id-")){const o=parseInt(i.replace("postid-","").replace("page-id-",""),10);if(!isNaN(o))return o}const r=window.wp;if(r?.data?.select){const i=r.data.select("core/editor")?.getCurrentPostId?.();if(i)return i}const n=document.querySelector('article[id^="post-"]');if(n){const i=parseInt(n.id.replace("post-",""),10);if(!isNaN(i))return i}return null}function be(e){const t=e.querySelector("script.vxconfig");if(t?.textContent)try{const r=JSON.parse(t.textContent);return me(r)}catch(r){console.error("Failed to parse vxconfig:",r)}return null}function ge(e,t){return{blockId:t,statMode:e.statMode||"overall",columns:e.columns||1,columns_tablet:e.columns_tablet,columns_mobile:e.columns_mobile,itemGap:e.itemGap||0,itemGap_tablet:e.itemGap_tablet,itemGap_mobile:e.itemGap_mobile,iconSize:e.iconSize||0,iconSize_tablet:e.iconSize_tablet,iconSize_mobile:e.iconSize_mobile,iconSpacing:e.iconSpacing,labelTypography:e.labelTypography||{},labelColor:e.labelColor||"",scoreTypography:e.scoreTypography||{},scoreColor:e.scoreColor||"",chartBgColor:e.chartBgColor||"",chartHeight:e.chartHeight||0,chartHeight_tablet:e.chartHeight_tablet,chartHeight_mobile:e.chartHeight_mobile,chartRadius:e.chartRadius||0,chartRadius_tablet:e.chartRadius_tablet,chartRadius_mobile:e.chartRadius_mobile,hideDesktop:!1,hideTablet:!1,hideMobile:!1,customClasses:""}}async function ve(e){const r=`${_e()}voxel-fse/v1/review-stats?post_id=${e}`,n=await fetch(r);if(!n.ok){const i=await n.json().catch(()=>({}));throw new Error(i.message||`HTTP error ${n.status}`)}return n.json()}function Re({attributes:e,postId:t}){const[r,n]=S.useState(null),[i,o]=S.useState(!0),[s,l]=S.useState(null);return S.useEffect(()=>{let f=!1;async function a(){o(!0),l(null);try{const p=await ve(t);f||n(p)}catch(p){f||l(p instanceof Error?p.message:"Failed to load review stats")}finally{f||o(!1)}}return a(),()=>{f=!0}},[t]),React.createElement(de,{attributes:e,statsData:r,isLoading:i,error:s,context:"frontend",postId:t})}function F(){document.querySelectorAll(".vxfse-review-stats").forEach(t=>{if(t.dataset.hydrated==="true")return;const r=be(t);if(!r)return;const n=ye();if(!n)return;const i=t.dataset.blockId||"",o=ge(r,i);t.dataset.hydrated="true",t.innerHTML="",U.createRoot(t).render(React.createElement(Re,{attributes:o,postId:n}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",F):F(),window.addEventListener("turbo:load",F),window.addEventListener("pjax:complete",F)})(ReactDOM,React);
