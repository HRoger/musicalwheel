!function(e,t,o){"use strict";const a={loadMore:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg>',noResults:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg>',leftArrow:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 12H5m0 0l7 7m-7-7l7-7" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg>',rightArrow:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 12h14m0 0l-7-7m7 7l-7 7" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg>',leftChevron:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15 19l-7-7 7-7" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg>',rightChevron:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 5l7 7-7 7" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg>',reset:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 4v5h.582M19.938 13A8.001 8.001 0 005.217 9.144M4.582 9H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-14.721-3.856M14.42 15H19" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/></svg>'};function n(e,t){return e&&e.value?"svg"===e.library?e.value:`<i class="${e.value}"></i>`:t}function l({attributes:e,config:l,context:s}){const r=t.useRef(null),i=t.useRef(null),[c,d]=t.useState({loading:!0,page:1,results:"",totalCount:0,displayCount:"0",hasPrev:!1,hasNext:!1,hasResults:!1}),[u,m]=t.useState({}),[p,g]=t.useState(e.postType||""),h="carousel"===e.layoutMode?"ts-feed-nowrap":"ts-feed-grid-default",f=c.loading?`vx-${e.loadingStyle}`:"",b=`post-feed-grid ${h} ${f} vx-opacity ${"search-form"===e.source?"sf-post-feed vx-event-scroll":""}`.trim(),v="carousel"===e.layoutMode?{display:"flex",flexWrap:"nowrap",gap:`${e.itemGap||25}px`,overflowX:"auto",scrollSnapType:"x mandatory",WebkitOverflowScrolling:"touch",padding:e.scrollPadding?`0 ${e.scrollPadding}px`:void 0,scrollPadding:e.scrollPadding?`${e.scrollPadding}px`:void 0}:{display:"grid",gridTemplateColumns:`repeat(${e.columns||3}, minmax(0, 1fr))`,gap:`${e.itemGap||25}px`};"carousel"===e.layoutMode&&e.carouselItemWidth&&(e.carouselItemWidth,e.carouselItemWidthUnit,e.carouselItemWidth,e.carouselItemWidthUnit);const _=t.useCallback(async(t=1,o=!1,a,n)=>{d(e=>({...e,loading:!0}));try{const l=n||p||e.postType||"";if("editor"===s&&"search-form"===e.source&&!l)return void d(e=>({...e,loading:!1,hasResults:!1}));const r=new URLSearchParams({type:l,pg:String(t),limit:String(e.postsPerPage)});e.displayDetails&&r.set("__get_total_count","yes"),"manual"===e.source&&e.manualPostIds.length>0&&r.set("post__in",e.manualPostIds.join(","));const i=a||{...e.filters,...u};i&&"object"==typeof i&&Object.entries(i).forEach(([e,t])=>{"postType"!==e&&null!=t&&""!==t&&r.set(e,String(t))});let c=window.Voxel_Config?.home_url;if(!c){const e=window.wpApiSettings?.root;if(e)c=e.replace(/\/wp-json\/?$/,"");else{const e=window.location.pathname,t=e.indexOf("/wp-admin"),o=t>0?e.substring(0,t):"";c=window.location.origin+o}}r.set("action","search_posts");const m=`${c}/?vx=1&${r.toString()}`,g=await fetch(m,{method:"GET",credentials:"same-origin",headers:{Accept:"text/html"}});if(!g.ok)throw new Error(`HTTP error: ${g.status} ${g.statusText}`);const h=await g.text(),f=new DOMParser,b=f.parseFromString(`<div>${h}</div>`,"text/html").querySelector("script.info"),v="true"===b?.getAttribute("data-has-prev"),_="true"===b?.getAttribute("data-has-next"),y="true"===b?.getAttribute("data-has-results"),w=parseInt(b?.getAttribute("data-total-count")||"0",10),I=b?.getAttribute("data-display-count")||"0",R=h.replace(/<script class="info"[^>]*><\/script>/g,"");d(e=>({...e,loading:!1,page:t,results:o?e.results+R:R,totalCount:w,displayCount:I,hasPrev:v,hasNext:_,hasResults:y}))}catch(l){console.error("[PostFeedComponent] Failed to fetch posts:",l),l instanceof TypeError&&(console.error("[PostFeedComponent] TypeError details - likely CORS or network issue"),console.error("[PostFeedComponent] Current location:",window.location.href),console.error("[PostFeedComponent] Target URL was:",`${window.location.origin}${window.location.pathname.includes("/wp-admin")?window.location.pathname.split("/wp-admin")[0]:""}/?vx=1`)),d(e=>({...e,loading:!1,hasResults:!1}))}},[e,s,u,p]);t.useEffect(()=>{if("frontend"!==s||"search-form"!==e.source)return;const t=t=>{const o=t;if(o.detail?.targetId!==e.blockId)return;const{postType:a,filters:n}=o.detail;m(n),a&&g(a),_(1,!1,n,a)};return window.addEventListener("voxel-fse:filter-update",t),()=>window.removeEventListener("voxel-fse:filter-update",t)},[s,e.source,e.blockId,_]),t.useEffect(()=>{if("search-form"!==e.source)_(1);else if("editor"===s&&e.postType)_(1);else if("frontend"===s&&"search-form"===e.source){const t=new URL(window.location.href),o=t.searchParams.get("post_type"),a={};if(t.searchParams.forEach((e,t)=>{if(t.startsWith("filter_")){const o=t.replace("filter_","");try{a[o]=JSON.parse(e)}catch{a[o]=e}}}),o)g(o),m(a),_(1,!1,a,o);else{const t=new CustomEvent("voxel-fse:post-feed-ready",{detail:{blockId:e.blockId,searchFormId:e.searchFormId},bubbles:!0});window.dispatchEvent(t)}}},[s,e.source,e.postType,e.blockId,e.searchFormId,_]);const y=t.useCallback(()=>{!c.loading&&c.hasNext&&_(c.page+1,!0)},[c.loading,c.hasNext,c.page,_]),w=t.useCallback(()=>{i.current&&i.current.scrollIntoView({behavior:"smooth",block:"start"})},[]),I=t.useCallback(()=>{!c.loading&&c.hasPrev&&(_(c.page-1),setTimeout(w,100))},[c.loading,c.hasPrev,c.page,_,w]),R=t.useCallback(()=>{!c.loading&&c.hasNext&&(_(c.page+1),setTimeout(w,100))},[c.loading,c.hasNext,c.page,_,w]),x=t.useCallback(()=>{if(r.current){const e=.8*r.current.clientWidth;r.current.scrollBy({left:-e,behavior:"smooth"})}},[]),P=t.useCallback(()=>{if(r.current){const e=.8*r.current.clientWidth;r.current.scrollBy({left:e,behavior:"smooth"})}},[]),C={blockId:e.blockId,source:e.source,searchFormId:e.searchFormId,postType:e.postType,manualPostIds:e.manualPostIds,filters:e.filters,pagination:e.pagination,postsPerPage:e.postsPerPage,displayDetails:e.displayDetails,noResultsLabel:e.noResultsLabel,layoutMode:e.layoutMode,columns:e.columns,columns_tablet:e.columns_tablet,columns_mobile:e.columns_mobile,itemGap:e.itemGap,itemGap_tablet:e.itemGap_tablet,itemGap_mobile:e.itemGap_mobile,carouselItemWidth:e.carouselItemWidth,carouselItemWidth_tablet:e.carouselItemWidth_tablet,carouselItemWidth_mobile:e.carouselItemWidth_mobile,carouselItemWidthUnit:e.carouselItemWidthUnit,carouselAutoSlide:e.carouselAutoSlide,scrollPadding:e.scrollPadding,scrollPadding_tablet:e.scrollPadding_tablet,scrollPadding_mobile:e.scrollPadding_mobile,itemPadding:e.itemPadding,itemPadding_tablet:e.itemPadding_tablet,itemPadding_mobile:e.itemPadding_mobile,loadingStyle:e.loadingStyle,loadingOpacity:e.loadingOpacity,icons:{loadMore:e.loadMoreIcon,noResults:e.noResultsIcon,rightArrow:e.rightArrowIcon,leftArrow:e.leftArrowIcon,rightChevron:e.rightChevronIcon,leftChevron:e.leftChevronIcon,reset:e.resetIcon}};if("editor"===s){const t=c.loading||"search-form"===e.source&&!e.postType&&!c.results,l="carousel"===e.layoutMode&&e.carouselItemWidth?`\n\t\t\t\t.ts-post-feed .post-feed-grid > .ts-preview,\n\t\t\t\t.ts-post-feed .post-feed-grid > div,\n\t\t\t\t.ts-post-feed .post-feed-grid > .placeholder-card {\n\t\t\t\t\tflex: 0 0 ${e.carouselItemWidth}${e.carouselItemWidthUnit||"px"};\n\t\t\t\t\tmin-width: ${e.carouselItemWidth}${e.carouselItemWidthUnit||"px"};\n\t\t\t\t\tscroll-snap-align: start;\n\t\t\t\t}\n\t\t\t`:"";return React.createElement("div",{ref:i,className:`ts-post-feed ${f}`},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(C)}}),l&&React.createElement("style",{dangerouslySetInnerHTML:{__html:l}}),e.displayDetails&&React.createElement("div",{className:"post-feed-header flexify"},React.createElement("span",{className:"result-count "+(c.hasResults&&c.totalCount,"")},c.hasResults?c.displayCount:o.__("Showing results","voxel-fse"))),React.createElement("div",{className:`${b} ${"carousel"===e.layoutMode?"min-scroll min-scroll-h":""}`,style:v},t?Array.from({length:Math.min(e.postsPerPage,6)}).map((e,t)=>React.createElement("div",{key:t,className:"ts-preview-card placeholder-card"},React.createElement("div",{className:"ts-card-image placeholder-image"}),React.createElement("div",{className:"ts-card-content"},React.createElement("div",{className:"placeholder-title"}),React.createElement("div",{className:"placeholder-text"})))):c.results?React.createElement("div",{dangerouslySetInnerHTML:{__html:c.results}}):React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-no-posts-icon",dangerouslySetInnerHTML:{__html:n(e.noResultsIcon,a.noResults)}}),React.createElement("p",null,e.noResultsLabel))),"none"!==e.pagination&&React.createElement("div",{className:"feed-pagination flexify"},"prev_next"===e.pagination&&React.createElement(React.Fragment,null,React.createElement("button",{className:"ts-btn ts-btn-1 ts-load-prev "+(c.hasPrev?"":"disabled"),onClick:I,disabled:!c.hasPrev||c.loading},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.leftArrowIcon,a.leftArrow)}}),React.createElement("span",null,o.__("Previous","voxel-fse"))),React.createElement("button",{className:"ts-btn ts-btn-1 ts-load-next "+(c.hasNext?"":"disabled"),onClick:R,disabled:!c.hasNext||c.loading},React.createElement("span",null,o.__("Next","voxel-fse")),React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.rightArrowIcon,a.rightArrow)}}))),"load_more"===e.pagination&&c.hasNext&&React.createElement("button",{className:"ts-btn ts-btn-1 ts-btn-large ts-load-more",onClick:y,disabled:!c.hasNext||c.loading},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.loadMoreIcon,a.loadMore)}}),React.createElement("span",null,o.__("Load more","voxel-fse")))),"carousel"===e.layoutMode&&React.createElement("div",{className:"post-feed-nav"},React.createElement("button",{className:"ts-icon-btn ts-prev-page",disabled:!0},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.leftChevronIcon,a.leftChevron)}})),React.createElement("button",{className:"ts-icon-btn ts-next-page",disabled:!0},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.rightChevronIcon,a.rightChevron)}}))))}const E="carousel"===e.layoutMode&&e.carouselItemWidth?`\n\t\t\t[data-block-id="${e.blockId}"] .post-feed-grid > .ts-preview,\n\t\t\t[data-block-id="${e.blockId}"] .post-feed-grid > div {\n\t\t\t\tflex: 0 0 ${e.carouselItemWidth}${e.carouselItemWidthUnit||"px"};\n\t\t\t\tmin-width: ${e.carouselItemWidth}${e.carouselItemWidthUnit||"px"};\n\t\t\t\tscroll-snap-align: start;\n\t\t\t}\n\t\t\t${e.itemPadding?`\n\t\t\t[data-block-id="${e.blockId}"] .post-feed-grid > .ts-preview,\n\t\t\t[data-block-id="${e.blockId}"] .post-feed-grid > div {\n\t\t\t\tpadding: ${e.itemPadding}px;\n\t\t\t}\n\t\t\t`:""}\n\t\t`:"";return React.createElement("div",{ref:i,className:"ts-post-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(C)}}),E&&React.createElement("style",{dangerouslySetInnerHTML:{__html:E}}),e.displayDetails&&React.createElement("div",{className:"post-feed-header"},React.createElement("span",{className:"result-count "+(c.hasResults&&0!==c.totalCount?"":"hidden")},c.displayCount)),React.createElement("div",{ref:r,className:`${b} ${"carousel"===e.layoutMode?"min-scroll min-scroll-h":""}`,style:v,"data-auto-slide":e.carouselAutoSlide?"3000":"0",dangerouslySetInnerHTML:{__html:c.results}}),React.createElement("div",{className:"ts-no-posts "+(c.hasResults||c.loading?"hidden":"")},React.createElement("span",{className:"ts-no-posts-icon",dangerouslySetInnerHTML:{__html:n(e.noResultsIcon,a.noResults)}}),React.createElement("p",null,e.noResultsLabel),"search-form"===e.source&&React.createElement("button",{className:"ts-btn ts-btn-1 ts-feed-reset"},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.resetIcon,a.reset)}}),React.createElement("span",null,o.__("Reset all","voxel-fse")))),"none"!==e.pagination&&React.createElement("div",{className:"feed-pagination flexify "+(c.hasPrev||c.hasNext?"":"hidden")},"prev_next"===e.pagination&&React.createElement(React.Fragment,null,React.createElement("button",{className:"ts-btn ts-btn-1 ts-load-prev "+(c.hasPrev?"":"disabled"),onClick:I,disabled:!c.hasPrev||c.loading},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.leftArrowIcon,a.leftArrow)}}),React.createElement("span",null,o.__("Previous","voxel-fse"))),React.createElement("button",{className:"ts-btn ts-btn-1 ts-load-next "+(c.hasNext?"":"disabled"),onClick:R,disabled:!c.hasNext||c.loading},React.createElement("span",null,o.__("Next","voxel-fse")),React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.rightArrowIcon,a.rightArrow)}}))),"load_more"===e.pagination&&React.createElement("button",{className:"ts-btn ts-btn-1 ts-btn-large ts-load-more "+(c.hasNext?"":"hidden"),onClick:y,disabled:!c.hasNext||c.loading},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.loadMoreIcon,a.loadMore)}}),React.createElement("span",null,o.__("Load more","voxel-fse")))),"carousel"===e.layoutMode&&React.createElement("div",{className:"post-feed-nav "+(c.hasResults?"":"hidden")},React.createElement("button",{className:"ts-icon-btn ts-prev-page",onClick:x},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.leftChevronIcon,a.leftChevron)}})),React.createElement("button",{className:"ts-icon-btn ts-next-page",onClick:P},React.createElement("span",{dangerouslySetInnerHTML:{__html:n(e.rightChevronIcon,a.rightChevron)}}))))}function s(e){const t=e.querySelector("script.vxconfig");if(!t?.textContent)return console.error("[post-feed] No vxconfig found"),null;try{return JSON.parse(t.textContent)}catch(o){return console.error("[post-feed] Failed to parse vxconfig:",o),null}}function r(e){const t={},o=e.filters??e.filter??{};"object"!=typeof o||Array.isArray(o)||Object.entries(o).forEach(([e,o])=>{t[e]=o});const a={loadMore:e.icons?.loadMore??e.icons?.load_more??{},noResults:e.icons?.noResults??e.icons?.no_results??{},rightArrow:e.icons?.rightArrow??e.icons?.right_arrow??{},leftArrow:e.icons?.leftArrow??e.icons?.left_arrow??{},rightChevron:e.icons?.rightChevron??e.icons?.right_chevron??{},leftChevron:e.icons?.leftChevron??e.icons?.left_chevron??{},reset:e.icons?.reset??{}};return{blockId:e.blockId??e.block_id??"",source:e.source??"custom-query",searchFormId:e.searchFormId??e.search_form_id??"",postType:e.postType??e.post_type??"",manualPostIds:Array.isArray(e.manualPostIds)?e.manualPostIds:Array.isArray(e.manual_post_ids)?e.manual_post_ids:[],filters:t,pagination:e.pagination??"none",postsPerPage:e.postsPerPage??e.posts_per_page??12,displayDetails:e.displayDetails??e.display_details??!1,noResultsLabel:e.noResultsLabel??e.no_results_label??"No results found",layoutMode:e.layoutMode??e.layout_mode??"grid",columns:e.columns??3,columns_tablet:e.columns_tablet??e.columnsTablet??2,columns_mobile:e.columns_mobile??e.columnsMobile??1,itemGap:e.itemGap??e.item_gap??25,itemGap_tablet:e.itemGap_tablet??e.itemGapTablet??20,itemGap_mobile:e.itemGap_mobile??e.itemGapMobile??15,carouselItemWidth:e.carouselItemWidth??e.carousel_item_width??300,carouselItemWidth_tablet:e.carouselItemWidth_tablet??e.carouselItemWidthTablet??250,carouselItemWidth_mobile:e.carouselItemWidth_mobile??e.carouselItemWidthMobile??200,carouselItemWidthUnit:e.carouselItemWidthUnit??e.carousel_item_width_unit??"px",carouselAutoSlide:e.carouselAutoSlide??e.carousel_auto_slide??!1,scrollPadding:e.scrollPadding??e.scroll_padding??0,scrollPadding_tablet:e.scrollPadding_tablet??e.scrollPaddingTablet??0,scrollPadding_mobile:e.scrollPadding_mobile??e.scrollPaddingMobile??0,itemPadding:e.itemPadding??e.item_padding??0,itemPadding_tablet:e.itemPadding_tablet??e.itemPaddingTablet??0,itemPadding_mobile:e.itemPadding_mobile??e.itemPaddingMobile??0,loadingStyle:e.loadingStyle??e.loading_style??"opacity",loadingOpacity:e.loadingOpacity??e.loading_opacity??.5,icons:a}}function i(e){return{blockId:e.blockId,source:e.source,searchFormId:e.searchFormId,postType:e.postType,manualPostIds:e.manualPostIds,filters:e.filters,pagination:e.pagination,postsPerPage:e.postsPerPage,displayDetails:e.displayDetails,noResultsLabel:e.noResultsLabel,layoutMode:e.layoutMode,columns:e.columns,columns_tablet:e.columns_tablet,columns_mobile:e.columns_mobile,itemGap:e.itemGap,itemGap_tablet:e.itemGap_tablet,itemGap_mobile:e.itemGap_mobile,carouselItemWidth:e.carouselItemWidth,carouselItemWidth_tablet:e.carouselItemWidth_tablet,carouselItemWidth_mobile:e.carouselItemWidth_mobile,carouselItemWidthUnit:e.carouselItemWidthUnit,carouselAutoSlide:e.carouselAutoSlide,scrollPadding:e.scrollPadding,scrollPadding_tablet:e.scrollPadding_tablet,scrollPadding_mobile:e.scrollPadding_mobile,itemPadding:e.itemPadding,itemPadding_tablet:e.itemPadding_tablet,itemPadding_mobile:e.itemPadding_mobile,loadingStyle:e.loadingStyle,loadingOpacity:e.loadingOpacity,loadMoreIcon:e.icons?.loadMore||{},noResultsIcon:e.icons?.noResults||{},rightArrowIcon:e.icons?.rightArrow||{},leftArrowIcon:e.icons?.leftArrow||{},rightChevronIcon:e.icons?.rightChevron||{},leftChevronIcon:e.icons?.leftChevron||{},resetIcon:e.icons?.reset||{},counterTypography:{},counterTextColor:"",orderByTypography:{},orderByTextColor:"",orderByTextColorHover:"",noResultsHideScreen:!1,noResultsIconColor:"",noResultsTypography:{},noResultsTextColor:"",noResultsLinkColor:"",paginationTypography:{},paginationPadding:{},paginationWidth:100,paginationWidthUnit:"%",paginationJustify:"center",paginationBorderType:"",paginationTextColor:"",paginationBackgroundColor:"",paginationIconColor:"",paginationTextColorHover:"",paginationBackgroundColorHover:"",paginationBorderColorHover:"",paginationIconColorHover:"",carouselNavIconColor:"",carouselNavBackground:"",carouselNavBorderType:"",carouselNavIconColorHover:"",carouselNavBackgroundHover:"",carouselNavBorderColorHover:"",hideDesktop:!1,hideTablet:!1,hideMobile:!1,customClasses:"",customCSS:""}}async function c(){const t=document.querySelectorAll(".voxel-fse-post-feed-frontend:not([data-react-mounted])");for(const a of t){a.setAttribute("data-react-mounted","true");const t=s(a);if(t)try{const o=i(r(t));e.createRoot(a).render(React.createElement(l,{attributes:o,config:null,context:"frontend"})),requestAnimationFrame(()=>{"function"==typeof window.render_post_feeds&&window.render_post_feeds(),window.jQuery&&window.jQuery(document).trigger("voxel:markup-update")})}catch(o){console.error("[post-feed] Initialization failed:",o)}}}function d(){window.addEventListener("voxel-search-submit",e=>{const t=e;if(!t.detail)return void console.warn("[post-feed] Received voxel-search-submit with no detail");const{targetId:o,postType:a,filters:n}=t.detail;window.dispatchEvent(new CustomEvent("voxel-fse:filter-update",{detail:{targetId:o,postType:a,filters:n}}))})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{c(),d()}):(c(),d()),window.addEventListener("turbo:load",c),document.addEventListener("voxel:markup-update",c),window.VoxelFSEPostFeed={init:c}}(ReactDOM,React,wp.i18n);
