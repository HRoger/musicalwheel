(function(m,a){"use strict";function h({text:e,icon:t="î —",className:o="",style:n={}}){return a.createElement("div",{className:`voxel-empty-placeholder ${o}`,style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:e?"8px":"0",background:"rgb(213 216 220 / 80%)",borderRadius:"0",color:"#666",fontSize:"13px",height:"45px",...n}},a.createElement("span",{className:"placeholder-icon",style:{fontFamily:"eicons",fontSize:"24px",opacity:.3,lineHeight:1,fontStyle:"normal"}},t),e&&a.createElement("span",{className:"placeholder-text",style:{opacity:.6}},e))}function x(e){const t={};if(e.priceColor&&(t["--vx-price-color"]=e.priceColor),e.strikethroughTextColor&&(t["--vx-strike-text-color"]=e.strikethroughTextColor),e.strikethroughLineColor&&(t["--vx-strike-line-color"]=e.strikethroughLineColor),e.strikethroughWidth){const o=e.strikethroughWidthUnit||"px";t["--vx-strike-width"]=`${e.strikethroughWidth}${o}`}return e.outOfStockColor&&(t["--vx-nostock-color"]=e.outOfStockColor),e.typography&&(e.typography.fontSize&&(t["--vx-price-font-size"]=e.typography.fontSize),e.typography.fontWeight&&(t["--vx-price-font-weight"]=e.typography.fontWeight),e.typography.fontFamily&&(t["--vx-price-font-family"]=e.typography.fontFamily),e.typography.lineHeight&&(t["--vx-price-line-height"]=e.typography.lineHeight),e.typography.letterSpacing&&(t["--vx-price-letter-spacing"]=e.typography.letterSpacing),e.typography.textTransform&&(t["--vx-price-text-transform"]=e.typography.textTransform)),t}function k(e,t){return{priceColor:e.priceColor,strikethroughTextColor:e.strikethroughTextColor,strikethroughLineColor:e.strikethroughLineColor,strikethroughWidth:e.strikethroughWidth,strikethroughWidthUnit:e.strikethroughWidthUnit,outOfStockColor:e.outOfStockColor,typography:e.typography,postId:t}}function v({attributes:e,priceData:t,isLoading:o,error:n,context:i,postId:p}){const c=a.useMemo(()=>x(e),[e]),l=a.useMemo(()=>k(e,p),[e,p]),f=[`vxfse-product-price-${e.blockId||"product-price"}`,e.hideDesktop?"vxfse-hide-desktop":"",e.hideTablet?"vxfse-hide-tablet":"",e.hideMobile?"vxfse-hide-mobile":"",e.customClasses||""].filter(Boolean).join(" ");return o?React.createElement("div",{className:`vxfse-product-price ${f}`.trim(),style:c},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement(h,null)):n?React.createElement("div",{className:`vxfse-product-price ${f}`.trim(),style:c},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement(h,null)):t?t.isAvailable?t.hasDiscount?React.createElement("div",{className:`vxfse-product-price ${f}`.trim(),style:c},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("span",{className:"vx-price"},t.formattedDiscountPrice,t.suffix),React.createElement("span",{className:"vx-price"},React.createElement("s",null,t.formattedRegularPrice,t.suffix))):React.createElement("div",{className:`vxfse-product-price ${f}`.trim(),style:c},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("span",{className:"vx-price"},t.formattedRegularPrice,t.suffix)):t.errorMessage==="No product configured"?i==="frontend"?React.createElement("div",{className:`vxfse-product-price ${f}`.trim(),style:c},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}})):React.createElement("div",{className:`vxfse-product-price ${f}`.trim(),style:c},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement(h,null)):React.createElement("div",{className:`vxfse-product-price ${f}`.trim(),style:c},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("span",{className:"vx-price no-stock"},t.errorMessage||"Unavailable")):React.createElement("div",{className:`vxfse-product-price ${f}`.trim(),style:c},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement(h,null))}function S(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const t=e.getAttribute("href");if(t)return t.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function C(){const e=S();try{return new URL(e).pathname.replace(/\/$/,"")}catch{return""}}function _(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const t=document.querySelector('link[rel="https://api.w.org/"]');if(t){const o=t.getAttribute("href");if(o)return o}}const e=C();return typeof window<"u"?window.location.origin+e+"/wp-json/":"/wp-json/"}function N(e){const t=(s,r)=>typeof s=="string"?s:typeof s=="number"?String(s):r,o=(s,r)=>{if(typeof s=="number"&&!isNaN(s))return s;if(typeof s=="string"){const y=parseFloat(s);if(!isNaN(y))return y}return r},n=s=>{if(!s||typeof s!="object")return;const r=s;return{fontFamily:typeof r.fontFamily=="string"?r.fontFamily:void 0,fontSize:typeof r.fontSize=="string"?r.fontSize:void 0,fontSize_tablet:typeof r.fontSize_tablet=="string"?r.fontSize_tablet:void 0,fontSize_mobile:typeof r.fontSize_mobile=="string"?r.fontSize_mobile:void 0,fontWeight:typeof r.fontWeight=="string"?r.fontWeight:void 0,lineHeight:typeof r.lineHeight=="string"?r.lineHeight:void 0,letterSpacing:typeof r.letterSpacing=="string"?r.letterSpacing:void 0,textTransform:["none","uppercase","lowercase","capitalize"].includes(r.textTransform)?r.textTransform:void 0}},i=t(e.priceColor??e.price_color??e.ts_price_col,""),p=t(e.strikethroughTextColor??e.strikethrough_text_color??e.ts_strike_col_text,""),c=t(e.strikethroughLineColor??e.strikethrough_line_color??e.ts_strike_col,""),l=o(e.strikethroughWidth??e.strikethrough_width??e.ts_strike_width,0),d=t(e.strikethroughWidthUnit??e.strikethrough_width_unit,"px"),f=t(e.outOfStockColor??e.out_of_stock_color??e.ts_price_nostock,""),u=n(e.typography??e.price_typo),W=o(e.postId??e.post_id,0)||void 0,I=t(e.postType??e.post_type,"")||void 0;return{priceColor:i||void 0,strikethroughTextColor:p||void 0,strikethroughLineColor:c||void 0,strikethroughWidth:l||void 0,strikethroughWidthUnit:d||void 0,outOfStockColor:f||void 0,typography:u,postId:W,postType:I}}function E(){return _()}function w(){const e=window.voxelCurrentPost;if(e?.id)return e.id;const t=document.body.className.split(" ");for(const i of t)if(i.startsWith("postid-")){const p=parseInt(i.replace("postid-",""),10);if(!isNaN(p))return p}const o=window.wp;if(o?.data?.select){const i=o.data.select("core/editor")?.getCurrentPostId?.();if(i)return i}const n=document.querySelector('article[id^="post-"]');if(n){const i=parseInt(n.id.replace("post-",""),10);if(!isNaN(i))return i}return null}function T(e){const t=e.querySelector("script.vxconfig");if(t?.textContent)try{const o=JSON.parse(t.textContent);return N(o)}catch(o){console.error("Failed to parse vxconfig:",o)}return null}function R(e,t){return{blockId:t,priceColor:e.priceColor,strikethroughTextColor:e.strikethroughTextColor,strikethroughLineColor:e.strikethroughLineColor,strikethroughWidth:e.strikethroughWidth,strikethroughWidthUnit:e.strikethroughWidthUnit,outOfStockColor:e.outOfStockColor,typography:e.typography}}async function L(e){const o=`${E()}voxel-fse/v1/product-price?post_id=${e}`,n=await fetch(o);if(!n.ok){const i=await n.json().catch(()=>({}));throw new Error(i.message||`HTTP error ${n.status}`)}return n.json()}function P({attributes:e,postId:t}){const[o,n]=a.useState(null),[i,p]=a.useState(!0),[c,l]=a.useState(null);return a.useEffect(()=>{let d=!1;async function f(){p(!0),l(null);try{const u=await L(t);d||n(u)}catch(u){d||l(u instanceof Error?u.message:"Failed to load price")}finally{d||p(!1)}}return f(),()=>{d=!0}},[t]),React.createElement(v,{attributes:e,priceData:o,isLoading:i,error:c,context:"frontend",postId:t})}function g(){document.querySelectorAll(".vxfse-product-price").forEach(t=>{if(t.dataset.hydrated==="true")return;const o=T(t);if(!o){console.warn("Product price block missing vxconfig:",t);return}const n=o.postId||w();if(!n){console.warn("Could not determine post ID for product price block");return}const i=t.dataset.blockId||"",p=R(o,i);t.dataset.hydrated="true",t.innerHTML="",m.createRoot(t).render(React.createElement(P,{attributes:p,postId:n}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g(),window.addEventListener("turbo:load",g),window.addEventListener("pjax:complete",g)})(ReactDOM,React);
