var VoxelFSEMap=(function(x){"use strict";let z=!1;function w(){if(z)return!0;if(!window.Voxel?.mixins?.base)return!1;const o=window.Voxel.mixins.base;return o.mounted&&!o._originalMounted?(o._originalMounted=o.mounted,o.mounted=function(){try{const e=this.$root?.$options?.el||this.$el;if(e){const n=e.closest?.(".elementor-element");if(n)this.widget_id=n.dataset?.id||"";else{const i=e.closest?.("[data-block-id]");this.widget_id=i&&i.dataset?.blockId||""}const t=e.closest?.(".elementor");if(t)this.post_id=t.dataset?.elementorId||"";else{const i=document.body.className.match(/postid-(\d+)/);this.post_id=i?i[1]:""}}o._originalMounted&&o._originalMounted!==o.mounted&&o._originalMounted.call(this)}catch(e){console.warn("[VoxelShim] Error in patched mounted():",e),this.widget_id="",this.post_id=""}},z=!0,console.log("[VoxelShim] Successfully patched Voxel.mixins.base.mounted"),!0):!1}function S(){if(w())return;let o=0;const e=50,t=setInterval(()=>{if(o++,w()){clearInterval(t);return}o>=e&&(clearInterval(t),console.warn("[VoxelShim] Voxel.mixins.base not found after 5 seconds"))},100);typeof document<"u"&&document.addEventListener("voxel:ready",()=>{w(),clearInterval(t)},{once:!0})}typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S,{once:!0}):S());function T(){if(typeof window>"u")return"desktop";const o=window.innerWidth;return o<768?"mobile":o<1024?"tablet":"desktop"}function l(o,e){if(!o)return e;const n=T();return n==="mobile"?o.mobile!==void 0?o.mobile:o.tablet!==void 0?o.tablet:o.desktop!==void 0?o.desktop:e:n==="tablet"&&o.tablet!==void 0?o.tablet:o.desktop!==void 0?o.desktop:e}function C(o){if(!o?.enable)return"none";const{horizontal:e=0,vertical:n=0,blur:t=0,spread:i=0,color:s="rgba(0,0,0,0.1)",position:r}=o;return`${r==="inset"?"inset ":""}${e}px ${n}px ${t}px ${i}px ${s}`}function P(o){if(!o)return{};const e={};return o.fontFamily&&(e["font-family"]=o.fontFamily),o.fontSize&&(e["font-size"]=`${o.fontSize}${o.fontSizeUnit||"px"}`),o.fontWeight&&(e["font-weight"]=o.fontWeight),o.fontStyle&&(e["font-style"]=o.fontStyle),o.textTransform&&(e["text-transform"]=o.textTransform),o.textDecoration&&(e["text-decoration"]=o.textDecoration),o.lineHeight&&(e["line-height"]=`${o.lineHeight}${o.lineHeightUnit||""}`),o.letterSpacing&&(e["letter-spacing"]=`${o.letterSpacing}${o.letterSpacingUnit||"px"}`),e}function L(o,e){o.style.width="100%";const n=e.styles;if(!n)return;const t=l(n.height,400),i=n.heightUnit||"px",s=l(n.enableCalcHeight,!1),r=l(n.calcHeight,"");s&&r?o.style.setProperty("--vx-map-height",r):o.style.setProperty("--vx-map-height",`${t}${i}`);const g=l(n.borderRadius,0);if(o.style.setProperty("--vx-map-radius",`${g}px`),n.cluster){const a=l(n.cluster.size,40);o.style.setProperty("--vx-cluster-size",`${a}px`);const h=l(n.cluster.bgColor,"");h&&o.style.setProperty("--vx-cluster-bg",h);const f=l(n.cluster.radius,50);o.style.setProperty("--vx-cluster-radius",`${f}%`);const v=l(n.cluster.textColor,"");if(v&&o.style.setProperty("--vx-cluster-text-color",v),o.style.setProperty("--vx-cluster-shadow",C(n.cluster.shadow)),n.cluster.typography){const u=P(n.cluster.typography);u["font-family"]&&o.style.setProperty("--vx-cluster-font-family",u["font-family"]),u["font-size"]&&o.style.setProperty("--vx-cluster-font-size",u["font-size"]),u["font-weight"]&&o.style.setProperty("--vx-cluster-font-weight",u["font-weight"]),u["font-style"]&&o.style.setProperty("--vx-cluster-font-style",u["font-style"]),u["line-height"]&&o.style.setProperty("--vx-cluster-line-height",u["line-height"]),u["letter-spacing"]&&o.style.setProperty("--vx-cluster-letter-spacing",u["letter-spacing"]),u["text-transform"]&&o.style.setProperty("--vx-cluster-text-transform",u["text-transform"]),u["text-decoration"]&&o.style.setProperty("--vx-cluster-text-decoration",u["text-decoration"])}}if(n.iconMarker){const a=l(n.iconMarker.size,42);o.style.setProperty("--vx-icon-marker-size",`${a}px`);const h=l(n.iconMarker.iconSize,24);o.style.setProperty("--vx-icon-marker-icon-size",`${h}px`);const f=l(n.iconMarker.radius,50);o.style.setProperty("--vx-icon-marker-radius",`${f}%`),o.style.setProperty("--vx-icon-marker-shadow",C(n.iconMarker.shadow));const v=l(n.iconMarker.staticBg,"");v&&o.style.setProperty("--vx-icon-marker-bg",v);const u=l(n.iconMarker.staticBgActive,"");u&&o.style.setProperty("--vx-icon-marker-bg-active",u);const c=l(n.iconMarker.staticIconColor,"");c&&o.style.setProperty("--vx-icon-marker-icon-color",c);const d=l(n.iconMarker.staticIconColorActive,"");d&&o.style.setProperty("--vx-icon-marker-icon-color-active",d)}if(n.textMarker){const a=l(n.textMarker.bgColor,"");a&&o.style.setProperty("--vx-text-marker-bg",a);const h=l(n.textMarker.bgColorActive,"");h&&o.style.setProperty("--vx-text-marker-bg-active",h);const f=l(n.textMarker.textColor,"");f&&o.style.setProperty("--vx-text-marker-text-color",f);const v=l(n.textMarker.textColorActive,"");v&&o.style.setProperty("--vx-text-marker-text-color-active",v);const u=l(n.textMarker.radius,4);if(o.style.setProperty("--vx-text-marker-radius",`${u}px`),o.style.setProperty("--vx-text-marker-shadow",C(n.textMarker.shadow)),n.textMarker.typography){const d=P(n.textMarker.typography);d["font-family"]&&o.style.setProperty("--vx-text-marker-font-family",d["font-family"]),d["font-size"]&&o.style.setProperty("--vx-text-marker-font-size",d["font-size"]),d["font-weight"]&&o.style.setProperty("--vx-text-marker-font-weight",d["font-weight"]),d["font-style"]&&o.style.setProperty("--vx-text-marker-font-style",d["font-style"]),d["line-height"]&&o.style.setProperty("--vx-text-marker-line-height",d["line-height"]),d["letter-spacing"]&&o.style.setProperty("--vx-text-marker-letter-spacing",d["letter-spacing"]),d["text-transform"]&&o.style.setProperty("--vx-text-marker-text-transform",d["text-transform"]),d["text-decoration"]&&o.style.setProperty("--vx-text-marker-text-decoration",d["text-decoration"])}const c=l(n.textMarker.padding,{});if(c){const d=c;d.top&&o.style.setProperty("--vx-text-marker-padding-top",d.top),d.right&&o.style.setProperty("--vx-text-marker-padding-right",d.right),d.bottom&&o.style.setProperty("--vx-text-marker-padding-bottom",d.bottom),d.left&&o.style.setProperty("--vx-text-marker-padding-left",d.left)}}if(n.imageMarker){const a=l(n.imageMarker.size,42);o.style.setProperty("--vx-image-marker-size",`${a}px`);const h=l(n.imageMarker.radius,50);o.style.setProperty("--vx-image-marker-radius",`${h}%`),o.style.setProperty("--vx-image-marker-shadow",C(n.imageMarker.shadow))}if(n.popup){const a=l(n.popup.cardWidth,320);o.style.setProperty("--vx-popup-card-width",`${a}px`),n.popup.loaderColor1&&o.style.setProperty("--vx-popup-loader-color1",n.popup.loaderColor1),n.popup.loaderColor2&&o.style.setProperty("--vx-popup-loader-color2",n.popup.loaderColor2)}if(n.searchBtn){const a=l(n.searchBtn.textColor,"");a&&o.style.setProperty("--vx-search-btn-text-color",a);const h=l(n.searchBtn.bgColor,"");h&&o.style.setProperty("--vx-search-btn-bg",h);const f=l(n.searchBtn.iconColor,"");f&&o.style.setProperty("--vx-search-btn-icon-color",f);const v=l(n.searchBtn.iconColorActive,"");v&&o.style.setProperty("--vx-search-btn-icon-color-active",v);const u=l(n.searchBtn.radius,4);if(o.style.setProperty("--vx-search-btn-radius",`${u}px`),n.searchBtn.typography){const c=P(n.searchBtn.typography);c["font-family"]&&o.style.setProperty("--vx-search-btn-font-family",c["font-family"]),c["font-size"]&&o.style.setProperty("--vx-search-btn-font-size",c["font-size"]),c["font-weight"]&&o.style.setProperty("--vx-search-btn-font-weight",c["font-weight"]),c["font-style"]&&o.style.setProperty("--vx-search-btn-font-style",c["font-style"]),c["line-height"]&&o.style.setProperty("--vx-search-btn-line-height",c["line-height"]),c["letter-spacing"]&&o.style.setProperty("--vx-search-btn-letter-spacing",c["letter-spacing"]),c["text-transform"]&&o.style.setProperty("--vx-search-btn-text-transform",c["text-transform"]),c["text-decoration"]&&o.style.setProperty("--vx-search-btn-text-decoration",c["text-decoration"])}if(n.searchBtn.checkmarkIcon){const c=n.searchBtn.checkmarkIcon;o.dataset.checkmarkIcon=JSON.stringify(c)}}if(n.navBtn){n.navBtn.iconColor&&o.style.setProperty("--vx-nav-btn-icon-color",n.navBtn.iconColor),n.navBtn.iconColorHover&&o.style.setProperty("--vx-nav-btn-icon-color-hover",n.navBtn.iconColorHover);const a=l(n.navBtn.iconSize,20);o.style.setProperty("--vx-nav-btn-icon-size",`${a}px`),n.navBtn.bgColor&&o.style.setProperty("--vx-nav-btn-bg",n.navBtn.bgColor),n.navBtn.bgColorHover&&o.style.setProperty("--vx-nav-btn-bg-hover",n.navBtn.bgColorHover);const h=l(n.navBtn.radius,4);o.style.setProperty("--vx-nav-btn-radius",`${h}px`);const f=l(n.navBtn.size,36);if(o.style.setProperty("--vx-nav-btn-size",`${f}px`),o.style.setProperty("--vx-nav-btn-shadow",C(n.navBtn.shadow)),n.navBtn.borderType&&n.navBtn.borderType!=="none"){o.style.setProperty("--vx-nav-btn-border-style",n.navBtn.borderType);const v=l(n.navBtn.borderWidth,0);o.style.setProperty("--vx-nav-btn-border-width",`${v}px`),n.navBtn.borderColor&&o.style.setProperty("--vx-nav-btn-border-color",n.navBtn.borderColor),n.navBtn.borderColorHover&&o.style.setProperty("--vx-nav-btn-border-color-hover",n.navBtn.borderColorHover)}}}function A(o){const e=o.center||{},n={lat:Number(o.lat||e.lat||e.latitude||51.492),lng:Number(o.lng||e.lng||e.longitude||-.13)},t=o.styles||{},i=(r,g)=>r?{desktop:r.desktop!==void 0?r.desktop:g,tablet:r.tablet!==void 0?r.tablet:r.desktop!==void 0?r.desktop:g,mobile:r.mobile!==void 0?r.mobile:r.tablet!==void 0?r.tablet:r.desktop!==void 0?r.desktop:g}:{desktop:g,tablet:g,mobile:g},s=r=>r?{enable:!!r.enable,horizontal:Number(r.horizontal||r.h||0),vertical:Number(r.vertical||r.v||0),blur:Number(r.blur||0),spread:Number(r.spread||0),color:String(r.color||"rgba(0,0,0,0.1)"),position:r.position||(r.inset?"inset":"outline")}:{enable:!1};return{source:o.source||"search-form",center:n,zoom:Number(o.zoom||o.initialZoom||11),minZoom:Number(o.minZoom||o.min_zoom||2),maxZoom:Number(o.maxZoom||o.max_zoom||18),dragSearch:o.dragSearch!==void 0?!!o.dragSearch:o.drag_search!==void 0?!!o.drag_search:!0,dragSearchMode:o.dragSearchMode||o.drag_search_mode||"manual",dragSearchDefault:o.dragSearchDefault||o.drag_search_default||"unchecked",searchFormId:String(o.searchFormId||o.search_form_id||""),styles:{height:i(t.height||t.mapHeight,400),heightUnit:String(t.heightUnit||t.height_unit||"px"),enableCalcHeight:i(t.enableCalcHeight||t.enable_calc_height,!1),calcHeight:i(t.calcHeight||t.calc_height,""),borderRadius:i(t.borderRadius||t.border_radius,0),cluster:t.cluster?{size:i(t.cluster.size,40),bgColor:i(t.cluster.bgColor||t.cluster.bg_color,""),radius:i(t.cluster.radius,50),textColor:i(t.cluster.textColor||t.cluster.text_color,""),shadow:s(t.cluster.shadow),typography:t.cluster.typography||{}}:{size:{desktop:40},bgColor:{desktop:""},radius:{desktop:50},textColor:{desktop:""},shadow:{enable:!1},typography:{}},iconMarker:t.iconMarker||t.icon_marker?{size:i((t.iconMarker||t.icon_marker).size,42),iconSize:i((t.iconMarker||t.icon_marker).iconSize||(t.iconMarker||t.icon_marker).icon_size,24),radius:i((t.iconMarker||t.icon_marker).radius,50),shadow:s((t.iconMarker||t.icon_marker).shadow),staticBg:i((t.iconMarker||t.icon_marker).staticBg||(t.iconMarker||t.icon_marker).static_bg,""),staticBgActive:i((t.iconMarker||t.icon_marker).staticBgActive||(t.iconMarker||t.icon_marker).static_bg_active,""),staticIconColor:i((t.iconMarker||t.icon_marker).staticIconColor||(t.iconMarker||t.icon_marker).static_icon_color,""),staticIconColorActive:i((t.iconMarker||t.icon_marker).staticIconColorActive||(t.iconMarker||t.icon_marker).static_icon_color_active,"")}:{size:{desktop:42},iconSize:{desktop:24},radius:{desktop:50},shadow:{enable:!1},staticBg:{desktop:""},staticBgActive:{desktop:""},staticIconColor:{desktop:""},staticIconColorActive:{desktop:""}},textMarker:t.textMarker||t.text_marker?{bgColor:i((t.textMarker||t.text_marker).bgColor||(t.textMarker||t.text_marker).bg_color,""),bgColorActive:i((t.textMarker||t.text_marker).bgColorActive||(t.textMarker||t.text_marker).bg_color_active,""),textColor:i((t.textMarker||t.text_marker).textColor||(t.textMarker||t.text_marker).text_color,""),textColorActive:i((t.textMarker||t.text_marker).textColorActive||(t.textMarker||t.text_marker).text_color_active,""),radius:i((t.textMarker||t.text_marker).radius,4),shadow:s((t.textMarker||t.text_marker).shadow),typography:(t.textMarker||t.text_marker).typography||{},padding:i((t.textMarker||t.text_marker).padding,{})}:{bgColor:{desktop:""},bgColorActive:{desktop:""},textColor:{desktop:""},textColorActive:{desktop:""},radius:{desktop:4},shadow:{enable:!1},typography:{},padding:{desktop:{}}},imageMarker:t.imageMarker||t.image_marker?{size:i((t.imageMarker||t.image_marker).size,42),radius:i((t.imageMarker||t.image_marker).radius,50),shadow:s((t.imageMarker||t.image_marker).shadow)}:{size:{desktop:42},radius:{desktop:50},shadow:{enable:!1}},popup:t.popup?{cardWidth:i(t.popup.cardWidth||t.popup.card_width,320),loaderColor1:String(t.popup.loaderColor1||t.popup.loader_color_1||""),loaderColor2:String(t.popup.loaderColor2||t.popup.loader_color_2||"")}:{cardWidth:{desktop:320},loaderColor1:"",loaderColor2:""},searchBtn:t.searchBtn||t.search_btn?{textColor:i((t.searchBtn||t.search_btn).textColor||(t.searchBtn||t.search_btn).text_color,""),bgColor:i((t.searchBtn||t.search_btn).bgColor||(t.searchBtn||t.search_btn).bg_color,""),iconColor:i((t.searchBtn||t.search_btn).iconColor||(t.searchBtn||t.search_btn).icon_color,""),iconColorActive:i((t.searchBtn||t.search_btn).iconColorActive||(t.searchBtn||t.search_btn).icon_color_active,""),radius:i((t.searchBtn||t.search_btn).radius||(t.searchBtn||t.search_btn).radius,4),typography:(t.searchBtn||t.search_btn).typography||{},checkmarkIcon:(t.searchBtn||t.search_btn).checkmarkIcon||{}}:{textColor:{desktop:""},bgColor:{desktop:""},iconColor:{desktop:""},iconColorActive:{desktop:""},radius:{desktop:4},typography:{},checkmarkIcon:{}},navBtn:t.navBtn||t.nav_btn?{iconColor:String((t.navBtn||t.nav_btn).iconColor||(t.navBtn||t.nav_btn).icon_color||""),iconColorHover:String((t.navBtn||t.nav_btn).iconColorHover||(t.navBtn||t.nav_btn).icon_color_hover||""),iconSize:i((t.navBtn||t.nav_btn).iconSize||(t.navBtn||t.nav_btn).icon_size,20),bgColor:String((t.navBtn||t.nav_btn).bgColor||(t.navBtn||t.nav_btn).bg_color||""),bgColorHover:String((t.navBtn||t.nav_btn).bgColorHover||(t.navBtn||t.nav_btn).bg_color_hover||""),radius:i((t.navBtn||t.nav_btn).radius,4),size:i((t.navBtn||t.nav_btn).size,36),shadow:s((t.navBtn||t.nav_btn).shadow),borderType:String((t.navBtn||t.nav_btn).borderType||(t.navBtn||t.nav_btn).border_type||"none"),borderWidth:i((t.navBtn||t.nav_btn).borderWidth||(t.navBtn||t.nav_btn).border_width,0),borderColor:String((t.navBtn||t.nav_btn).borderColor||(t.navBtn||t.nav_btn).border_color||""),borderColorHover:String((t.navBtn||t.nav_btn).borderColorHover||(t.navBtn||t.nav_btn).border_color_hover||"")}:{iconSize:{desktop:20},radius:{desktop:4},size:{desktop:36},shadow:{enable:!1},borderType:"none",borderWidth:{desktop:0}}}}}const p=()=>window;function D(){return!!p().Voxel?.Maps}function k(){return new Promise((o,e)=>{const n=p().Voxel?.Maps;if(n){n.await(()=>o(n));return}const t=()=>{const i=p().Voxel?.Maps;i&&i.await(()=>o(i))};document.addEventListener("maps:loaded",t,{once:!0}),setTimeout(()=>{document.removeEventListener("maps:loaded",t);const i=p().Voxel?.Maps;i?i.await(()=>o(i)):e(new Error("Voxel.Maps not available after timeout"))},15e3)})}function E(){return{lat:p().Voxel_Config?.maps?.default_lat??40.7128,lng:p().Voxel_Config?.maps?.default_lng??-74.006}}class m{constructor(e,n){this._native=null,this._lat=e,this._lng=n;const t=p().Voxel?.Maps;t&&(this._native=new t.LatLng(e,n))}getLatitude(){return this._native?.getLatitude()??this._lat}getLongitude(){return this._native?.getLongitude()??this._lng}getSourceObject(){return this._native?.getSourceObject()??null}toGeocoderFormat(){return this._native?.toGeocoderFormat()??null}getNative(){return this._native}static fromNative(e){const n=new m(e.getLatitude(),e.getLongitude());return n._native=e,n}}class _{constructor(e,n){this._native=null,this._sw=e??null,this._ne=n??null;const t=p().Voxel?.Maps;t&&(this._native=new t.Bounds(e?.getNative()??void 0,n?.getNative()??void 0))}extend(e){this._native&&e.getNative()&&this._native.extend(e.getNative())}empty(){return this._native?.empty()??!0}getSourceObject(){return this._native?.getSourceObject()??null}getSouthWest(){return this._native?m.fromNative(this._native.getSouthWest()):this._sw}getNorthEast(){return this._native?m.fromNative(this._native.getNorthEast()):this._ne}getNative(){return this._native}static fromNative(e){const n=m.fromNative(e.getSouthWest()),t=m.fromNative(e.getNorthEast()),i=new _(n,t);return i._native=e,i}}class F{constructor(e){this._native=null,this._listeners=new Map,this._el=e.el,this._options=e}async init(){const e=await k(),n=this._options.center?new e.LatLng(this._options.center.getLatitude(),this._options.center.getLongitude()):new e.LatLng(E().lat,E().lng);this._native=new e.Map({el:this._el,zoom:this._options.zoom??10,center:n,minZoom:this._options.minZoom??2,maxZoom:this._options.maxZoom??20,draggable:this._options.draggable??!0})}setZoom(e){this._native?.setZoom(e)}getZoom(){return this._native?.getZoom()??this._options.zoom??10}getMinZoom(){return this._native?.getMinZoom()??this._options.minZoom??2}getMaxZoom(){return this._native?.getMaxZoom()??this._options.maxZoom??20}setCenter(e){this._native&&e.getNative()&&this._native.setCenter(e.getNative())}getCenter(){return this._native?m.fromNative(this._native.getCenter()):this._options.center??null}getBounds(){return this._native?_.fromNative(this._native.getBounds()):null}fitBounds(e){this._native&&e.getNative()&&this._native.fitBounds(e.getNative())}panTo(e){this._native&&e.getNative()&&this._native.panTo(e.getNative())}getClickPosition(e){return this._native?m.fromNative(this._native.getClickPosition(e)):null}addListener(e,n){if(this._native){const t=this._native.addListener(e,n);this._listeners.has(e)||this._listeners.set(e,[]),this._listeners.get(e).push(t)}}addListenerOnce(e,n){this._native&&this._native.addListenerOnce(e,n)}removeListeners(e){const n=this._listeners.get(e);n&&this._native&&(n.forEach(t=>this._native.removeListener(t)),this._listeners.delete(e))}trigger(e){this._native?.trigger(e)}getSourceObject(){return this._native?.getSourceObject()??null}getNative(){return this._native}getElement(){return this._el}}class R{constructor(e){this._native=null,this._map=null,this._options=e}init(e){const n=p().Voxel?.Maps;if(!n||!e.getNative())return;this._map=e;const t=this._options.position?new n.LatLng(this._options.position.getLatitude(),this._options.position.getLongitude()):void 0;this._native=new n.Marker({map:e.getNative(),position:t,template:this._options.template,onClick:this._options.onClick?(i,s)=>this._options.onClick(i,this):void 0,data:this._options.data})}getPosition(){return this._native?m.fromNative(this._native.getPosition()):this._options.position??null}setPosition(e){this._native&&e.getNative()&&this._native.setPosition(e.getNative())}getMap(){return this._map}setMap(e){this._native&&e.getNative()&&(this._native.setMap(e.getNative()),this._map=e)}remove(){return this._native?.remove(),this._map=null,this}addClass(e){this._native?.addClass(e)}removeClass(e){this._native?.removeClass(e)}getData(){return this._options.data}getNative(){return this._native}}class U{constructor(e){this._native=null,this._map=null,this._options=e}init(e){const n=p().Voxel?.Maps;if(!n||!e.getNative())return;this._map=e;const t=this._options.position?new n.LatLng(this._options.position.getLatitude(),this._options.position.getLongitude()):void 0;this._native=new n.Popup({map:e.getNative(),position:t,content:this._options.content})}setContent(e){this._native?.setContent(e)}setPosition(e){this._native&&e.getNative()&&this._native.setPosition(e.getNative())}show(){this._native?.show()}hide(){this._native?.hide()}getMap(){return this._map}getNative(){return this._native}}class W{constructor(e){this._native=null,this._map=null,this._options=e}init(e){const n=p().Voxel?.Maps;if(!n||!e.getNative())return;this._map=e;const t=this._options.center?new n.LatLng(this._options.center.getLatitude(),this._options.center.getLongitude()):void 0;this._native=new n.Circle({map:e.getNative(),center:t,radius:this._options.radius,visible:this._options.visible,className:this._options.className??"map-circle"})}hide(){this._native?.hide()}show(){this._native?.show()}setCenter(e){this._native&&e.getNative()&&this._native.setCenter(e.getNative())}setRadius(e){this._native?.setRadius(e)}getBounds(){return this._native?_.fromNative(this._native.getBounds()):null}getMap(){return this._map}getNative(){return this._native}}const b=class b{constructor(){this._native=null;const e=p().Voxel?.Maps;e&&(this._native=e.getGeocoder())}static getInstance(){return b._instance||(b._instance=new b),b._instance}geocode(e,n,t){if(!this._native){const r=typeof n=="function"?n:t;r&&r(!1);return}let i;if(e instanceof m){const r=e.getSourceObject();if(!r){const g=typeof n=="function"?n:t;g&&g(!1);return}i=r}else i=e;const s=r=>g=>{g===!1?r(!1):Array.isArray(g)?r(g.map(a=>({address:a.address,latlng:m.fromNative(a.latlng),viewport:_.fromNative(a.viewport)}))):r({address:g.address,latlng:m.fromNative(g.latlng),viewport:_.fromNative(g.viewport)})};if(typeof n=="function"){const r=n;this._native.geocode(i,s(r))}else t&&this._native.geocode(i,n,s(t))}getUserLocation(e){if(!this._native){e.positionFail?.();return}this._native.getUserLocation({fetchAddress:e.fetchAddress,receivedPosition:e.receivedPosition?n=>e.receivedPosition(m.fromNative(n)):void 0,receivedAddress:e.receivedAddress?n=>e.receivedAddress({address:n.address,latlng:m.fromNative(n.latlng),viewport:_.fromNative(n.viewport)}):void 0,positionFail:e.positionFail,addressFail:e.addressFail})}getNative(){return this._native}};b._instance=null;let N=b;class j{constructor(){this._native=null,this._map=null,this._markers=[]}async init(e){const n=await k();e.getNative()&&(this._map=e,this._native=new n.Clusterer({map:e.getNative()}),this._native&&(this._native._onClusterClick=()=>{this._onClusterClick?.()},this._native._onNonExpandableClusterClick=t=>{if(this._onNonExpandableClusterClick){const i=this._markers.filter(s=>t.some(r=>r===s.getNative()));this._onNonExpandableClusterClick(i)}}))}addMarkers(e){if(this._markers.push(...e),this._native){const n=e.map(t=>t.getNative()).filter(t=>t!==null);this._native.addMarkers(n)}}clearMarkers(){this._markers.forEach(e=>e.remove()),this._markers=[],this._native&&(this._native.markers=[])}render(){this._native?.render()}set onClusterClick(e){this._onClusterClick=e,this._native&&(this._native._onClusterClick=e)}set onNonExpandableClusterClick(e){this._onNonExpandableClusterClick=e}getMarkers(){return this._markers}getMap(){return this._map}getNative(){return this._native}}function q(o){N.getInstance().getUserLocation(o)}function I(o,e){if(e.length===0)return;if(e.length===1){const t=e[0].getPosition();t&&(o.panTo(t),o.setZoom(15));return}const n=new _;e.forEach(t=>{const i=t.getPosition();i&&n.extend(i)}),n.empty()||o.fitBounds(n)}function O(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const o=document.querySelector('link[rel="https://api.w.org/"]');if(o){const e=o.getAttribute("href");if(e)return e.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function G(){const o=O();try{return new URL(o).pathname.replace(/\/$/,"")}catch{return""}}function J(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const n=e.getAttribute("href");if(n)return n}}const o=G();return typeof window<"u"?window.location.origin+o+"/wp-json/":"/wp-json/"}S();function Q(){return J()}function V(o){const e=o.querySelector("script.vxconfig");if(e&&e.textContent)try{return JSON.parse(e.textContent)}catch(n){console.error("[Map Block] Failed to parse vxconfig:",n)}return null}function K(o,e){if(!o)return e;const n=typeof window<"u"?window.innerWidth:1200;let t="desktop";return n<768?t="mobile":n<1024&&(t="tablet"),t==="mobile"?o.mobile!==void 0?o.mobile:o.tablet!==void 0?o.tablet:o.desktop!==void 0?o.desktop:e:t==="tablet"&&o.tablet!==void 0?o.tablet:o.desktop!==void 0?o.desktop:e}function X(o,e){if(!e.dragSearch||e.source!=="search-form")return null;const n=document.createElement("div");if(n.className="ts-map-drag",e.dragSearchMode==="automatic"){const t=e.dragSearchDefault==="checked";n.innerHTML=`
			<a href="#" class="ts-map-btn ts-drag-toggle ${t?"active":""}">
				<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="ts-checkmark-icon">
					<path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
				</svg>
				Search as I move the map
			</a>
		`}else n.innerHTML=`
			<a href="#" class="ts-search-area hidden ts-map-btn">
				<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="ts-search-icon">
					<path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
				</svg>
				Search this area
			</a>
		`;return o.insertBefore(n,o.firstChild),n}function Y(o){const e=document.createElement("a");return e.href="#",e.rel="nofollow",e.role="button",e.className="vx-geolocate-me",e.setAttribute("aria-label","Share your location"),e.innerHTML=`
		<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
			<path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/>
		</svg>
	`,e.addEventListener("click",n=>{n.preventDefault(),e.classList.add("loading"),q({fetchAddress:!0,receivedPosition:t=>{console.log("[Map Block] Got user position:",t.getLatitude(),t.getLongitude()),e.classList.remove("loading");const i=y.get(o.querySelector(".ts-map"));i&&(i.map.panTo(t),i.map.setZoom(15),i.circle&&(i.circle.setCenter(t),i.circle.show()))},receivedAddress:t=>{console.log("[Map Block] Got user address:",t.address),o.dispatchEvent(new CustomEvent("geolocation:address",{detail:{address:t.address,latlng:{lat:t.latlng.getLatitude(),lng:t.latlng.getLongitude()}},bubbles:!0}))},positionFail:()=>{console.warn("[Map Block] Failed to get user position"),e.classList.remove("loading")},addressFail:()=>{console.warn("[Map Block] Failed to get user address")}})}),o.appendChild(e),e}function $(o,e,n){const t=document.createElement("div");return t.className=e.source==="current-post"?"ts-map ts-map-autoload":"ts-map",t.setAttribute("data-config",JSON.stringify(n)),o.appendChild(t),t}async function tt(o,e){const n=dt();if(!n){console.warn("[Map Block] No post ID found for current-post mode");return}const i=`${Q()}voxel-fse/v1/map/post-location?post_id=${n}`;try{const s=await fetch(i);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const r=await s.json(),g={center:{lat:r.latitude,lng:r.longitude},zoom:e.zoom,minZoom:e.minZoom,maxZoom:e.maxZoom,markers:[{lat:r.latitude,lng:r.longitude,template:encodeURIComponent(r.marker),uriencoded:!0}]};o.innerHTML="",$(o,e,g).dispatchEvent(new CustomEvent("voxel:map-ready",{bubbles:!0}))}catch(s){console.error("[Map Block] Failed to fetch post location:",s)}}function et(o,e){o.innerHTML="";const n={center:e.center,zoom:e.zoom,minZoom:e.minZoom,maxZoom:e.maxZoom},t=X(o,e),i=$(o,e,n);Y(o),ot(i,n,o,e);const s=e.searchFormId;s&&window.addEventListener("voxel-search-submit",(r=>{r.detail.targetId===s&&it(o,i,r.detail)})),t&&lt(t,i)}const y=new Map;async function ot(o,e,n,t){try{await k()}catch(i){console.warn("[Map Block] Voxel.Maps not available:",i);return}try{const s=n.style.getPropertyValue("--vx-map-height")||"400px";o.style.height=s;const r=new m(e.center.lat,e.center.lng),g={el:o,center:r,zoom:e.zoom,minZoom:e.minZoom,maxZoom:e.maxZoom,draggable:!0},a=new F(g);await a.init();let h=null;t.source==="search-form"&&(h=new j,await h.init(a),h.onClusterClick=()=>{console.log("[Map Block] Cluster clicked, zooming in")},h.onNonExpandableClusterClick=c=>{console.log("[Map Block] Non-expandable cluster clicked:",c.length,"markers")});const f=new U({});f.init(a);const v=new W({center:r,radius:5e3,className:"map-circle"});v.init(a),v.hide();const u={map:a,clusterer:h,markers:[],popup:f,circle:v,config:t};if(y.set(o,u),o._voxelMap=a.getNative(),o._vxMapInstance=u,a.addListener("zoom_changed",()=>{h&&h.render()}),a.addListener("idle",()=>{n.querySelector(".ts-drag-toggle.active")&&t.dragSearchMode==="automatic"&&nt(n,a,t)}),a.addListener("bounds_changed",()=>{const c=n.querySelector(".ts-search-area");c&&t.dragSearchMode==="manual"&&c.classList.remove("hidden")}),a.addListener("click",()=>{f.hide()}),e.markers&&e.markers.length>0){const c=await Z(a,e.markers,f,h);u.markers=c,c.length>1&&h?h.render():c.length>0&&I(a,c)}console.log("[Map Block] Map initialized successfully with all features")}catch(i){console.error("[Map Block] Failed to initialize map:",i)}}async function Z(o,e,n,t){if(!e)return[];const i=[];for(const s of e){const r=s.uriencoded?decodeURIComponent(s.template):s.template,g={position:new m(s.lat,s.lng),template:r,onClick:(h,f)=>{const v=f.getPosition();v&&(n.setPosition(v),n.setContent(r),n.show())},data:{lat:s.lat,lng:s.lng}},a=new R(g);a.init(o),i.push(a)}return t&&i.length>0&&t.addMarkers(i),i}function nt(o,e,n){const t=e.getBounds();if(!t)return;const i=t.getSouthWest(),s=t.getNorthEast();if(!i||!s)return;const r={bounds:{sw:{lat:i.getLatitude(),lng:i.getLongitude()},ne:{lat:s.getLatitude(),lng:s.getLongitude()}},center:{lat:e.getCenter()?.getLatitude(),lng:e.getCenter()?.getLongitude()},zoom:e.getZoom()};o.dispatchEvent(new CustomEvent("map:bounds-changed",{detail:r,bubbles:!0}))}async function it(o,e,n,t){console.log("[Map Block] Search submitted:",n);const i=y.get(e);if(!i){console.warn("[Map Block] No map instance found");return}i.clusterer?i.clusterer.clearMarkers():i.markers.forEach(r=>r.remove()),i.markers=[],i.popup?.hide();const s=o.closest(".ts-map-widget");s&&s.dispatchEvent(new CustomEvent("search:updated",{detail:n,bubbles:!0}))}async function rt(o,e){const n=o.querySelector(".ts-map");if(!n)return;const t=y.get(n);if(!t)return;t.clusterer?t.clusterer.clearMarkers():t.markers.forEach(r=>r.remove()),t.markers=[];const i=e.map(r=>({lat:r.lat,lng:r.lng,template:r.template,uriencoded:!1})),s=await Z(t.map,i,t.popup,t.clusterer);t.markers=s,t.clusterer&&s.length>0?t.clusterer.render():s.length>0&&I(t.map,s)}function st(o,e,n){const t=o.querySelector(".ts-map");if(!t)return;const i=y.get(t);i?.circle&&(i.circle.setCenter(new m(e.lat,e.lng)),i.circle.setRadius(n),i.circle.show())}function at(o){const e=o.querySelector(".ts-map");if(!e)return;y.get(e)?.circle?.hide()}function ct(o){const e=o.querySelector(".ts-map");if(e)return y.get(e)}function lt(o,e,n){const t=o.querySelector(".ts-drag-toggle"),i=o.querySelector(".ts-search-area");t&&t.addEventListener("click",s=>{s.preventDefault(),t.classList.toggle("active")}),i&&i.addEventListener("click",s=>{s.preventDefault();const r=e.closest(".ts-map-widget");r&&r.dispatchEvent(new CustomEvent("search:area",{bubbles:!0}))})}function dt(){const o=document.body.className.split(" ");for(const n of o){const t=n.match(/^postid-(\d+)$/);if(t)return parseInt(t[1],10)}const e=document.querySelector("[data-post-id]");if(e){const n=e.getAttribute("data-post-id");if(n)return parseInt(n,10)}if(typeof window<"u"){const n=window.wp_post_id;if(n)return n}return null}function M(){document.querySelectorAll(".voxel-fse-map").forEach(e=>{if(e.getAttribute("data-hydrated")==="true")return;const n=V(e);if(!n){console.warn("[Map Block] No vxconfig found for container:",e);return}const t=A(n);e.setAttribute("data-hydrated","true"),L(e,t),t.source==="current-post"?tt(e,t):et(e,t),requestAnimationFrame(()=>{window.jQuery&&window.jQuery(document).trigger("voxel:markup-update")})})}function B(o){D()?k().then(o).catch(()=>{console.warn("[Map Block] Voxel.Maps not available, initializing anyway"),o()}):(document.addEventListener("maps:loaded",()=>{k().then(o).catch(o)},{once:!0}),setTimeout(()=>{k().then(o).catch(o)},1e4))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{B(M)}):B(M),window.addEventListener("turbo:load",()=>{B(M)}),window.addEventListener("pjax:complete",()=>{B(M)});let H;return window.addEventListener("resize",()=>{clearTimeout(H),H=setTimeout(()=>{document.querySelectorAll('.voxel-fse-map[data-hydrated="true"]').forEach(e=>{if(e.getAttribute("data-hydrated")!=="true")return;const t=V(e);if(t){const i=A(t);L(e,i)}})},250)}),x.getMapInstance=ct,x.getResponsiveValueClient=K,x.hideRadiusCircle=at,x.showRadiusCircle=st,x.updateMapMarkers=rt,Object.defineProperty(x,Symbol.toStringTag,{value:"Module"}),x})({});
