(function(Q,A){"use strict";var I,V,L,$;I={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},V=["(","?"],L={")":["("],":":["?","?:"]},$=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;function G(e){for(var t=[],r=[],n,i,c,u;n=e.match($);){for(i=n[0],c=e.substr(0,n.index).trim(),c&&t.push(c);u=r.pop();){if(L[i]){if(L[i][0]===u){i=L[i][1]||i;break}}else if(V.indexOf(u)>=0||I[u]<I[i]){r.push(u);break}t.push(u)}L[i]||r.push(i),e=e.substr(n.index+i.length)}return e=e.trim(),e&&t.push(e),t.concat(r.reverse())}var Y={"!":function(e){return!e},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"==":function(e,t){return e===t},"!=":function(e,t){return e!==t},"&&":function(e,t){return e&&t},"||":function(e,t){return e||t},"?:":function(e,t,r){if(e)throw t;return r}};function ee(e,t){var r=[],n,i,c,u,p,v;for(n=0;n<e.length;n++){if(p=e[n],u=Y[p],u){for(i=u.length,c=Array(i);i--;)c[i]=r.pop();try{v=u.apply(null,c)}catch(h){return h}}else t.hasOwnProperty(p)?v=t[p]:v=+p;r.push(v)}return r[0]}function te(e){var t=G(e);return function(r){return ee(t,r)}}function re(e){var t=te(e);return function(r){return+t({n:r})}}var k={contextDelimiter:"",onMissingKey:null};function ne(e){var t,r,n;for(t=e.split(";"),r=0;r<t.length;r++)if(n=t[r].trim(),n.indexOf("plural=")===0)return n.substr(7)}function M(e,t){var r;this.data=e,this.pluralForms={},this.options={};for(r in k)this.options[r]=t!==void 0&&r in t?t[r]:k[r]}M.prototype.getPluralForm=function(e,t){var r=this.pluralForms[e],n,i,c;return r||(n=this.data[e][""],c=n["Plural-Forms"]||n["plural-forms"]||n.plural_forms,typeof c!="function"&&(i=ne(n["Plural-Forms"]||n["plural-forms"]||n.plural_forms),c=re(i)),r=this.pluralForms[e]=c),r(t)},M.prototype.dcnpgettext=function(e,t,r,n,i){var c,u,p;return i===void 0?c=0:c=this.getPluralForm(e,i),u=r,t&&(u=t+this.options.contextDelimiter+r),p=this.data[e][u],p&&p[c]?p[c]:(this.options.onMissingKey&&this.options.onMissingKey(r,e),c===0?r:n)};var N={"":{plural_forms(e){return e===1?0:1}}},ae=/^i18n\.(n?gettext|has_translation)(_|$)/,se=(e,t,r)=>{const n=new M({}),i=new Set,c=()=>{i.forEach(a=>a())},u=a=>(i.add(a),()=>i.delete(a)),p=(a="default")=>n.data[a],v=(a,o="default")=>{n.data[o]={...n.data[o],...a},n.data[o][""]={...N[""],...n.data[o]?.[""]},delete n.pluralForms[o]},h=(a,o)=>{v(a,o),c()},_=(a,o="default")=>{n.data[o]={...n.data[o],...a,"":{...N[""],...n.data[o]?.[""],...a?.[""]}},delete n.pluralForms[o],c()},s=(a,o)=>{n.data={},n.pluralForms={},h(a,o)},l=(a="default",o,f,R,m)=>(n.data[a]||v(void 0,a),n.dcnpgettext(a,o,f,R,m)),y=a=>a||"default",b=(a,o)=>{let f=l(o,void 0,a);return r?(f=r.applyFilters("i18n.gettext",f,a,o),r.applyFilters("i18n.gettext_"+y(o),f,a,o)):f},C=(a,o,f)=>{let R=l(f,o,a);return r?(R=r.applyFilters("i18n.gettext_with_context",R,a,o,f),r.applyFilters("i18n.gettext_with_context_"+y(f),R,a,o,f)):R},F=(a,o,f,R)=>{let m=l(R,void 0,a,o,f);return r?(m=r.applyFilters("i18n.ngettext",m,a,o,f,R),r.applyFilters("i18n.ngettext_"+y(R),m,a,o,f,R)):m},w=(a,o,f,R,m)=>{let x=l(m,R,a,o,f);return r?(x=r.applyFilters("i18n.ngettext_with_context",x,a,o,f,R,m),r.applyFilters("i18n.ngettext_with_context_"+y(m),x,a,o,f,R,m)):x},z=()=>C("ltr","text direction")==="rtl",d=(a,o,f)=>{const R=o?o+""+a:a;let m=!!n.data?.[f??"default"]?.[R];return r&&(m=r.applyFilters("i18n.has_translation",m,a,o,f),m=r.applyFilters("i18n.has_translation_"+y(f),m,a,o,f)),m};if(r){const a=o=>{ae.test(o)&&c()};r.addAction("hookAdded","core/i18n",a),r.addAction("hookRemoved","core/i18n",a)}return{getLocaleData:p,setLocaleData:h,addLocaleData:_,resetLocaleData:s,subscribe:u,__:b,_x:C,_n:F,_nx:w,isRTL:z,hasTranslation:d}};function ie(e){return typeof e!="string"||e===""?(console.error("The namespace must be a non-empty string."),!1):/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)?!0:(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)}var q=ie;function oe(e){return typeof e!="string"||e===""?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)?!0:(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)}var O=oe;function ce(e,t){return function(n,i,c,u=10){const p=e[t];if(!O(n)||!q(i))return;if(typeof c!="function"){console.error("The hook callback must be a function.");return}if(typeof u!="number"){console.error("If specified, the hook priority must be a number.");return}const v={callback:c,priority:u,namespace:i};if(p[n]){const h=p[n].handlers;let _;for(_=h.length;_>0&&!(u>=h[_-1].priority);_--);_===h.length?h[_]=v:h.splice(_,0,v),p.__current.forEach(s=>{s.name===n&&s.currentIndex>=_&&s.currentIndex++})}else p[n]={handlers:[v],runs:0};n!=="hookAdded"&&e.doAction("hookAdded",n,i,c,u)}}var U=ce;function le(e,t,r=!1){return function(i,c){const u=e[t];if(!O(i)||!r&&!q(c))return;if(!u[i])return 0;let p=0;if(r)p=u[i].handlers.length,u[i]={runs:u[i].runs,handlers:[]};else{const v=u[i].handlers;for(let h=v.length-1;h>=0;h--)v[h].namespace===c&&(v.splice(h,1),p++,u.__current.forEach(_=>{_.name===i&&_.currentIndex>=h&&_.currentIndex--}))}return i!=="hookRemoved"&&e.doAction("hookRemoved",i,c),p}}var H=le;function ue(e,t){return function(n,i){const c=e[t];return typeof i<"u"?n in c&&c[n].handlers.some(u=>u.namespace===i):n in c}}var Z=ue;function de(e,t,r,n){return function(c,...u){const p=e[t];p[c]||(p[c]={handlers:[],runs:0}),p[c].runs++;const v=p[c].handlers;if(!v||!v.length)return r?u[0]:void 0;const h={name:c,currentIndex:0};async function _(){try{p.__current.add(h);let l=r?u[0]:void 0;for(;h.currentIndex<v.length;)l=await v[h.currentIndex].callback.apply(null,u),r&&(u[0]=l),h.currentIndex++;return r?l:void 0}finally{p.__current.delete(h)}}function s(){try{p.__current.add(h);let l=r?u[0]:void 0;for(;h.currentIndex<v.length;)l=v[h.currentIndex].callback.apply(null,u),r&&(u[0]=l),h.currentIndex++;return r?l:void 0}finally{p.__current.delete(h)}}return(n?_:s)()}}var T=de;function fe(e,t){return function(){const n=e[t];return Array.from(n.__current).at(-1)?.name??null}}var X=fe;function pe(e,t){return function(n){const i=e[t];return typeof n>"u"?i.__current.size>0:Array.from(i.__current).some(c=>c.name===n)}}var B=pe;function he(e,t){return function(n){const i=e[t];if(O(n))return i[n]&&i[n].runs?i[n].runs:0}}var W=he,me=class{actions;filters;addAction;addFilter;removeAction;removeFilter;hasAction;hasFilter;removeAllActions;removeAllFilters;doAction;doActionAsync;applyFilters;applyFiltersAsync;currentAction;currentFilter;doingAction;doingFilter;didAction;didFilter;constructor(){this.actions=Object.create(null),this.actions.__current=new Set,this.filters=Object.create(null),this.filters.__current=new Set,this.addAction=U(this,"actions"),this.addFilter=U(this,"filters"),this.removeAction=H(this,"actions"),this.removeFilter=H(this,"filters"),this.hasAction=Z(this,"actions"),this.hasFilter=Z(this,"filters"),this.removeAllActions=H(this,"actions",!0),this.removeAllFilters=H(this,"filters",!0),this.doAction=T(this,"actions",!1,!1),this.doActionAsync=T(this,"actions",!1,!0),this.applyFilters=T(this,"filters",!0,!1),this.applyFiltersAsync=T(this,"filters",!0,!0),this.currentAction=X(this,"actions"),this.currentFilter=X(this,"filters"),this.doingAction=B(this,"actions"),this.doingFilter=B(this,"filters"),this.didAction=W(this,"actions"),this.didFilter=W(this,"filters")}};function ve(){return new me}var ye=ve,K=ye(),{addAction:ge,addFilter:be,removeAction:Ce,removeFilter:xe,hasAction:Fe,hasFilter:Le,removeAllActions:Se,removeAllFilters:He,doAction:Te,doActionAsync:De,applyFilters:Ie,applyFiltersAsync:Me,currentAction:Oe,currentFilter:je,doingAction:ze,doingFilter:Pe,didAction:Ve,didFilter:$e,actions:ke,filters:Ne}=K,E=se(void 0,void 0,K);E.getLocaleData.bind(E),E.setLocaleData.bind(E),E.resetLocaleData.bind(E),E.subscribe.bind(E);var g=E.__.bind(E);E._x.bind(E),E._n.bind(E),E._nx.bind(E),E.isRTL.bind(E),E.hasTranslation.bind(E);const D={"24h":g("24 hours","voxel-fse"),"7d":g("7 days","voxel-fse"),"30d":g("30 days","voxel-fse"),"12m":g("12 months","voxel-fse")},J=()=>React.createElement("svg",{width:"80",height:"80",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",transform:"rotate(0 0 0)"},React.createElement("path",{d:"M11.833 3.75C10.5904 3.75 9.58301 4.75736 9.58301 6V18.9991C9.58301 20.2417 10.5904 21.2491 11.833 21.2491H12.1663C13.409 21.2491 14.4163 20.2417 14.4163 18.9991V6C14.4163 4.75736 13.409 3.75 12.1663 3.75H11.833Z",fill:"#343C54"}),React.createElement("path",{d:"M5.5 12.5625C4.25736 12.5625 3.25 13.5699 3.25 14.8125V19C3.25 20.2426 4.25736 21.25 5.5 21.25H5.83333C7.07597 21.25 8.08333 20.2426 8.08333 19V14.8125C8.08333 13.5699 7.07598 12.5625 5.83333 12.5625H5.5Z",fill:"#343C54"}),React.createElement("path",{d:"M18.166 8.66016C16.9234 8.66016 15.916 9.66752 15.916 10.9102V19.0001C15.916 20.2427 16.9234 21.2501 18.166 21.2501H18.4993C19.742 21.2501 20.7493 20.2427 20.7493 19.0001V10.9102C20.7493 9.66752 19.742 8.66016 18.4993 8.66016H18.166Z",fill:"#343C54"})),j=e=>e?e.library&&e.value&&!e.value.includes(".")?React.createElement("i",{className:e.value,"aria-hidden":"true"}):e.value&&e.value.includes("<svg")?React.createElement("span",{dangerouslySetInnerHTML:{__html:e.value},"aria-hidden":"true"}):e.url?React.createElement("img",{src:e.url,alt:"","aria-hidden":"true",style:{width:"48px",height:"48px"}}):React.createElement(J,null):React.createElement(J,null);function _e({attributes:e,context:t,vxconfig:r}){const[n,i]=A.useState(e.activeChart||"7d"),[c,u]=A.useState({"24h":{loaded:!1},"7d":{loaded:!1},"30d":{loaded:!1},"12m":{loaded:!1}}),[p,v]=A.useState(!1),[h,_]=A.useState(null),s=A.useRef(null),l=A.useRef(null),y=A.useRef({isDown:!1,startX:0,scrollLeft:0});A.useCallback(()=>typeof window<"u"&&window.wpApiSettings?.root?window.wpApiSettings.root:"/wp-json/",[]);const b=A.useCallback(async d=>{if(t!=="editor"&&r){v(!0);try{const a=new URLSearchParams({source:r.source,timeframe:d,view_type:r.viewType,_wpnonce:r.nonce});r.source==="post"&&r.postId&&a.append("post_id",String(r.postId));const f=`${window.Voxel_Config?.ajax_url||"/wp-admin/admin-ajax.php?"}&action=tracking.get_chart_data&${a.toString()}`,m=await(await fetch(f)).json();if(m.success&&m.data)u(x=>({...x,[d]:{loaded:!0,steps:m.data.steps,items:m.data.items,meta:m.data.meta}}));else{const x=m.message||window.Voxel_Config?.l10n?.ajaxError||"An error occurred";window.Voxel?.alert&&window.Voxel.alert(x,"error"),u(P=>({...P,[d]:{loaded:!0,error:!0}}))}}catch{const a=window.Voxel_Config?.l10n?.ajaxError||"An error occurred";window.Voxel?.alert&&window.Voxel.alert(a,"error"),u(o=>({...o,[d]:{loaded:!0,error:!0}}))}finally{v(!1)}}},[t,r]);A.useEffect(()=>{const d=c[n];d&&!d.loaded&&t==="frontend"&&b(n)},[n,c,t,b]),A.useEffect(()=>{const d=s.current;if(!d)return;const a=()=>{y.current.isDown=!1},o=()=>{y.current.isDown=!1},f=m=>{y.current.isDown=!0,y.current.startX=m.pageX-d.offsetLeft,y.current.scrollLeft=d.scrollLeft},R=m=>{if(!y.current.isDown)return;m.preventDefault();const P=m.pageX-d.offsetLeft-y.current.startX;d.scrollLeft=y.current.scrollLeft-P};return d.addEventListener("mouseup",a),d.addEventListener("mouseleave",o),d.addEventListener("mousedown",f),d.addEventListener("mousemove",R),requestAnimationFrame(()=>{d.scrollLeft=d.scrollWidth}),()=>{d.removeEventListener("mouseup",a),d.removeEventListener("mouseleave",o),d.removeEventListener("mousedown",f),d.removeEventListener("mousemove",R)}},[n]);const C=A.useCallback((d,a)=>{_(a);const o=l.current;if(!o)return;const f=d.currentTarget.getBoundingClientRect();o.style.top=`${f.top}px`,window.innerWidth-f.right>=o.offsetWidth+10?o.style.left=`${f.left+f.width+10}px`:o.style.left=`${f.left-o.offsetWidth-10}px`},[]),F=A.useCallback(()=>{_(null)},[]),w=c[n],z=()=>t!=="frontend"||!r?null:React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(r)}});return t==="editor"?React.createElement("div",{className:"ts-visits-chart voxel-fse-editor-preview"},React.createElement("ul",{className:"ts-generic-tabs simplify-ul flexify bar-chart-tabs"},Object.keys(D).map(d=>React.createElement("li",{key:d,className:n===d?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:a=>{a.preventDefault(),i(d)}},D[d])))),React.createElement("div",{className:`ts-chart chart-${n}`},React.createElement("div",{className:"chart-contain"},React.createElement("div",{className:"ts-no-posts"},j(e.chartIcon),React.createElement("p",null,g("Loading data","voxel-fse")))))):React.createElement(React.Fragment,null,z(),React.createElement("ul",{className:"ts-generic-tabs simplify-ul flexify bar-chart-tabs"},Object.keys(D).map(d=>React.createElement("li",{key:d,className:n===d?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:a=>{a.preventDefault(),i(d)}},D[d])))),w&&React.createElement("div",{className:`ts-chart chart-${n}${p?" vx-pending":""}`},!w.loaded&&React.createElement("div",{className:"chart-contain"},React.createElement("div",{className:"ts-no-posts"},j(e.chartIcon),React.createElement("p",null,g("Loading data","voxel-fse")))),w.loaded&&React.createElement(React.Fragment,null,w.meta?.has_activity&&w.items&&React.createElement("div",{className:"chart-contain"},React.createElement("div",{className:"chart-content"},React.createElement("div",{className:"bar-item-con bar-values"},w.steps?.map((d,a)=>React.createElement("span",{key:a},d)))),React.createElement("div",{className:"chart-content min-scroll min-scroll-h",ref:s},w.items.map((d,a)=>React.createElement("div",{key:a,className:"bar-item-con"},React.createElement("div",{className:"bi-hold"},React.createElement("div",{className:"bar-item bar-animate",style:{height:`${d.percent}%`},onMouseOver:o=>C(o,d),onMouseLeave:F})),React.createElement("span",null,d.label)))),React.createElement("ul",{ref:l,className:`flexify simplify-ul bar-item-data${h?" active":""}`},React.createElement("li",null,React.createElement("small",null,g("Views","voxel-fse")),h?.count||""),React.createElement("li",null,React.createElement("small",null,g("Unique views","voxel-fse")),h?.unique_count||""))),!w.meta?.has_activity&&React.createElement("div",{className:"ts-no-posts"},j(e.chartIcon),React.createElement("p",null,g("No activity","voxel-fse"))))))}function Re(e){const t=(s,l)=>typeof s=="string"?s:typeof s=="number"?String(s):l,r=(s,l)=>{if(typeof s=="number")return s;if(typeof s=="string"){const y=parseFloat(s);return isNaN(y)?l:y}return l},n=(s,l)=>typeof s=="boolean"?s:s==="yes"||s==="1"||s===1||s==="true"?!0:s==="no"||s==="0"||s===0||s==="false"?!1:l,i=s=>typeof s=="string"&&["post","user","site"].includes(s)?s:"post",c=s=>typeof s=="string"&&["24h","7d","30d","12m"].includes(s)?s:"7d",u=s=>typeof s=="string"&&["views","unique_views"].includes(s)?s:"views",p=s=>{const l=s&&typeof s=="object"?s:{};return{label:t(l.label,""),percent:r(l.percent,0)??0,count:t(l.count,"0"),unique_count:t(l.unique_count??l.uniqueCount,"0")}},v=s=>{const l=s&&typeof s=="object"?s:{};return{label:t(l.label,""),has_activity:n(l.has_activity??l.hasActivity,!1)}},h=s=>{const l=s&&typeof s=="object"?s:{};let y;Array.isArray(l.items)&&(y=l.items.map(p));let b;return Array.isArray(l.steps)&&(b=l.steps.map(C=>t(C,""))),{loaded:n(l.loaded,!1),error:l.error!==void 0?n(l.error,!1):void 0,steps:b,items:y,meta:l.meta?v(l.meta):void 0}},_=s=>{const l=s&&typeof s=="object"?s:{},y={loaded:!1},b=["24h","7d","30d","12m"],C={};for(const F of b)C[F]=l[F]?h(l[F]):{...y};return C};return{source:i(e.source??e.ts_source??e.statsSource),activeChart:c(e.activeChart??e.active_chart??e.ts_active_chart),viewType:u(e.viewType??e.view_type??e.ts_view_type),nonce:t(e.nonce,""),postId:r(e.postId??e.post_id,void 0),charts:_(e.charts)}}function Ee(e){const t=e.querySelector("script.vxconfig");if(!t||!t.textContent)return console.error("Visit Chart: vxconfig not found"),null;try{const r=JSON.parse(t.textContent);return Re(r)}catch(r){return console.error("Visit Chart: Failed to parse vxconfig",r),null}}function Ae(e){return{blockId:"",source:e.source||"post",activeChart:e.activeChart||"7d",viewType:e.viewType||"views",chartIcon:{library:"",value:""},chevronRight:{library:"",value:""},chevronLeft:{library:"",value:""}}}function we({config:e,attributes:t}){return e.nonce?React.createElement(_e,{attributes:t,context:"frontend",vxconfig:e}):null}function S(){document.querySelectorAll(".voxel-fse-visit-chart-frontend").forEach(t=>{if(t.dataset.reactMounted==="true")return;const r=Ee(t);if(!r){console.error("Visit Chart: Could not parse configuration");return}const n=Ae(r);t.dataset.reactMounted="true",Q.createRoot(t).render(React.createElement(we,{config:r,attributes:n}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S(),window.addEventListener("turbo:load",S),window.addEventListener("pjax:complete",S),typeof jQuery<"u"&&jQuery(document).on("voxel:markup-update",S)})(ReactDOM,React);
