(function(le,y){"use strict";var M,J,D,K;M={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},J=["(","?"],D={")":["("],":":["?","?:"]},K=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;function ie(t){for(var e=[],n=[],r,i,l,s;r=t.match(K);){for(i=r[0],l=t.substr(0,r.index).trim(),l&&e.push(l);s=n.pop();){if(D[i]){if(D[i][0]===s){i=D[i][1]||i;break}}else if(J.indexOf(s)>=0||M[s]<M[i]){n.push(s);break}e.push(s)}D[i]||n.push(i),t=t.substr(r.index+i.length)}return t=t.trim(),t&&e.push(t),e.concat(n.reverse())}var ce={"!":function(t){return!t},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"+":function(t,e){return t+e},"-":function(t,e){return t-e},"<":function(t,e){return t<e},"<=":function(t,e){return t<=e},">":function(t,e){return t>e},">=":function(t,e){return t>=e},"==":function(t,e){return t===e},"!=":function(t,e){return t!==e},"&&":function(t,e){return t&&e},"||":function(t,e){return t||e},"?:":function(t,e,n){if(t)throw e;return n}};function oe(t,e){var n=[],r,i,l,s,m,h;for(r=0;r<t.length;r++){if(m=t[r],s=ce[m],s){for(i=s.length,l=Array(i);i--;)l[i]=n.pop();try{h=s.apply(null,l)}catch(f){return f}}else e.hasOwnProperty(m)?h=e[m]:h=+m;n.push(h)}return n[0]}function ue(t){var e=ie(t);return function(n){return oe(e,n)}}function de(t){var e=ue(t);return function(n){return+e({n})}}var Y={contextDelimiter:"",onMissingKey:null};function pe(t){var e,n,r;for(e=t.split(";"),n=0;n<e.length;n++)if(r=e[n].trim(),r.indexOf("plural=")===0)return r.substr(7)}function $(t,e){var n;this.data=t,this.pluralForms={},this.options={};for(n in Y)this.options[n]=e!==void 0&&n in e?e[n]:Y[n]}$.prototype.getPluralForm=function(t,e){var n=this.pluralForms[t],r,i,l;return n||(r=this.data[t][""],l=r["Plural-Forms"]||r["plural-forms"]||r.plural_forms,typeof l!="function"&&(i=pe(r["Plural-Forms"]||r["plural-forms"]||r.plural_forms),l=de(i)),n=this.pluralForms[t]=l),n(e)},$.prototype.dcnpgettext=function(t,e,n,r,i){var l,s,m;return i===void 0?l=0:l=this.getPluralForm(t,i),s=n,e&&(s=e+this.options.contextDelimiter+n),m=this.data[t][s],m&&m[l]?m[l]:(this.options.onMissingKey&&this.options.onMissingKey(n,t),l===0?n:r)};var X={"":{plural_forms(t){return t===1?0:1}}},me=/^i18n\.(n?gettext|has_translation)(_|$)/,fe=(t,e,n)=>{const r=new $({}),i=new Set,l=()=>{i.forEach(o=>o())},s=o=>(i.add(o),()=>i.delete(o)),m=(o="default")=>r.data[o],h=(o,p="default")=>{r.data[p]={...r.data[p],...o},r.data[p][""]={...X[""],...r.data[p]?.[""]},delete r.pluralForms[p]},f=(o,p)=>{h(o,p),l()},v=(o,p="default")=>{r.data[p]={...r.data[p],...o,"":{...X[""],...r.data[p]?.[""],...o?.[""]}},delete r.pluralForms[p],l()},S=(o,p)=>{r.data={},r.pluralForms={},f(o,p)},b=(o="default",p,g,_,E)=>(r.data[o]||h(void 0,o),r.dcnpgettext(o,p,g,_,E)),N=o=>o||"default",H=(o,p)=>{let g=b(p,void 0,o);return n?(g=n.applyFilters("i18n.gettext",g,o,p),n.applyFilters("i18n.gettext_"+N(p),g,o,p)):g},C=(o,p,g)=>{let _=b(g,p,o);return n?(_=n.applyFilters("i18n.gettext_with_context",_,o,p,g),n.applyFilters("i18n.gettext_with_context_"+N(g),_,o,p,g)):_},F=(o,p,g,_)=>{let E=b(_,void 0,o,p,g);return n?(E=n.applyFilters("i18n.ngettext",E,o,p,g,_),n.applyFilters("i18n.ngettext_"+N(_),E,o,p,g,_)):E},I=(o,p,g,_,E)=>{let w=b(E,_,o,p,g);return n?(w=n.applyFilters("i18n.ngettext_with_context",w,o,p,g,_,E),n.applyFilters("i18n.ngettext_with_context_"+N(E),w,o,p,g,_,E)):w},T=()=>C("ltr","text direction")==="rtl",U=(o,p,g)=>{const _=p?p+""+o:o;let E=!!r.data?.[g??"default"]?.[_];return n&&(E=n.applyFilters("i18n.has_translation",E,o,p,g),E=n.applyFilters("i18n.has_translation_"+N(g),E,o,p,g)),E};if(n){const o=p=>{me.test(p)&&l()};n.addAction("hookAdded","core/i18n",o),n.addAction("hookRemoved","core/i18n",o)}return{getLocaleData:m,setLocaleData:f,addLocaleData:v,resetLocaleData:S,subscribe:s,__:H,_x:C,_n:F,_nx:I,isRTL:T,hasTranslation:U}};function ve(t){return typeof t!="string"||t===""?(console.error("The namespace must be a non-empty string."),!1):/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(t)?!0:(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)}var z=ve;function he(t){return typeof t!="string"||t===""?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(t)?(console.error("The hook name cannot begin with `__`."),!1):/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(t)?!0:(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)}var B=he;function ge(t,e){return function(r,i,l,s=10){const m=t[e];if(!B(r)||!z(i))return;if(typeof l!="function"){console.error("The hook callback must be a function.");return}if(typeof s!="number"){console.error("If specified, the hook priority must be a number.");return}const h={callback:l,priority:s,namespace:i};if(m[r]){const f=m[r].handlers;let v;for(v=f.length;v>0&&!(s>=f[v-1].priority);v--);v===f.length?f[v]=h:f.splice(v,0,h),m.__current.forEach(S=>{S.name===r&&S.currentIndex>=v&&S.currentIndex++})}else m[r]={handlers:[h],runs:0};r!=="hookAdded"&&t.doAction("hookAdded",r,i,l,s)}}var Q=ge;function ye(t,e,n=!1){return function(i,l){const s=t[e];if(!B(i)||!n&&!z(l))return;if(!s[i])return 0;let m=0;if(n)m=s[i].handlers.length,s[i]={runs:s[i].runs,handlers:[]};else{const h=s[i].handlers;for(let f=h.length-1;f>=0;f--)h[f].namespace===l&&(h.splice(f,1),m++,s.__current.forEach(v=>{v.name===i&&v.currentIndex>=f&&v.currentIndex--}))}return i!=="hookRemoved"&&t.doAction("hookRemoved",i,l),m}}var j=ye;function Re(t,e){return function(r,i){const l=t[e];return typeof i<"u"?r in l&&l[r].handlers.some(s=>s.namespace===i):r in l}}var V=Re;function _e(t,e,n,r){return function(l,...s){const m=t[e];m[l]||(m[l]={handlers:[],runs:0}),m[l].runs++;const h=m[l].handlers;if(!h||!h.length)return n?s[0]:void 0;const f={name:l,currentIndex:0};async function v(){try{m.__current.add(f);let b=n?s[0]:void 0;for(;f.currentIndex<h.length;)b=await h[f.currentIndex].callback.apply(null,s),n&&(s[0]=b),f.currentIndex++;return n?b:void 0}finally{m.__current.delete(f)}}function S(){try{m.__current.add(f);let b=n?s[0]:void 0;for(;f.currentIndex<h.length;)b=h[f.currentIndex].callback.apply(null,s),n&&(s[0]=b),f.currentIndex++;return n?b:void 0}finally{m.__current.delete(f)}}return(r?v:S)()}}var Z=_e;function Ee(t,e){return function(){const r=t[e];return Array.from(r.__current).at(-1)?.name??null}}var ee=Ee;function be(t,e){return function(r){const i=t[e];return typeof r>"u"?i.__current.size>0:Array.from(i.__current).some(l=>l.name===r)}}var te=be;function xe(t,e){return function(r){const i=t[e];if(B(r))return i[r]&&i[r].runs?i[r].runs:0}}var ne=xe,we=class{actions;filters;addAction;addFilter;removeAction;removeFilter;hasAction;hasFilter;removeAllActions;removeAllFilters;doAction;doActionAsync;applyFilters;applyFiltersAsync;currentAction;currentFilter;doingAction;doingFilter;didAction;didFilter;constructor(){this.actions=Object.create(null),this.actions.__current=new Set,this.filters=Object.create(null),this.filters.__current=new Set,this.addAction=Q(this,"actions"),this.addFilter=Q(this,"filters"),this.removeAction=j(this,"actions"),this.removeFilter=j(this,"filters"),this.hasAction=V(this,"actions"),this.hasFilter=V(this,"filters"),this.removeAllActions=j(this,"actions",!0),this.removeAllFilters=j(this,"filters",!0),this.doAction=Z(this,"actions",!1,!1),this.doActionAsync=Z(this,"actions",!1,!0),this.applyFilters=Z(this,"filters",!0,!1),this.applyFiltersAsync=Z(this,"filters",!0,!0),this.currentAction=ee(this,"actions"),this.currentFilter=ee(this,"filters"),this.doingAction=te(this,"actions"),this.doingFilter=te(this,"filters"),this.didAction=ne(this,"actions"),this.didFilter=ne(this,"filters")}};function Se(){return new we}var Ae=Se,ae=Ae(),{addAction:Ge,addFilter:Je,removeAction:Ke,removeFilter:Ye,hasAction:Xe,hasFilter:ze,removeAllActions:Qe,removeAllFilters:Ve,doAction:et,doActionAsync:tt,applyFilters:nt,applyFiltersAsync:at,currentAction:rt,currentFilter:st,doingAction:lt,doingFilter:it,didAction:ct,didFilter:ot,actions:ut,filters:dt}=ae,R=fe(void 0,void 0,ae);R.getLocaleData.bind(R),R.setLocaleData.bind(R),R.resetLocaleData.bind(R),R.subscribe.bind(R);var d=R.__.bind(R);R._x.bind(R),R._n.bind(R),R._nx.bind(R),R.isRTL.bind(R),R.hasTranslation.bind(R);function re(){return Math.random().toString(36).substring(2,10)}function se(){return{enabled:!1,minimum:{value:null,unit:"day"},maximum:{value:null,unit:"day"}}}function ke({config:t,zones:e,rates:n,onZonesChange:r,onRatesChange:i,onGoBack:l,onSave:s,saving:m,context:h}){const[f,v]=y.useState(null),[S,b]=y.useState(null),[N,H]=y.useState({}),C=t.shipping_countries||{},F=t.shipping_countries_by_continent||{};t.shipping_classes;const I=t.primary_currency||"USD",T=y.useCallback(()=>{const a={key:re(),label:"",regions:[]};r([...e,a]),v(a)},[e,r]),U=y.useCallback(a=>{const c=[...e];c.splice(a,1),r(c),f===e[a]&&v(null)},[e,r,f]),o=y.useCallback((a,c)=>{const u=[...e];u[a]={...u[a],...c},r(u)},[e,r]),p=y.useCallback((a,c)=>{if(!c)return;const u=e.findIndex(x=>x.key===a.key);if(u!==-1)if(c.startsWith("continent:")){const x=c.substring(10),k=F[x]||{},G=Object.keys(k).filter(P=>!a.regions.some(We=>We.country===P)).map(P=>({country:P,states:[]}));o(u,{regions:[...a.regions,...G]})}else a.regions.some(x=>x.country===c)||o(u,{regions:[...a.regions,{country:c,states:[]}]})},[e,F,o]),g=y.useCallback((a,c)=>{const u=e.findIndex(k=>k.key===a.key);if(u===-1)return;const x=[...a.regions];x.splice(c,1),o(u,{regions:x})},[e,o]),_=y.useCallback(()=>{const a={key:re(),label:"",zone_keys:[],type:"free_shipping",free_shipping:{requirements:"none",minimum_order_amount:null,delivery_estimate:se()},fixed_rate:{calculation_method:"per_item",amount_per_unit:null,shipping_classes:[],delivery_estimate:se()}};i([...n,a]),b(a)},[n,i]),E=y.useCallback(a=>{const c=n.findIndex(x=>x.key===a.key);if(c===-1)return;const u=[...n];u.splice(c,1),i(u),S===a&&b(null)},[n,i,S]),w=y.useCallback((a,c)=>{const u=n.findIndex(k=>k.key===a.key);if(u===-1)return;const x=[...n];x[u]={...x[u],...c},i(x)},[n,i]),O=y.useCallback(a=>e.filter(c=>a.zone_keys.includes(c.key)),[e]),W=y.useCallback((a,c)=>a.zone_keys.includes(c),[]),Me=y.useCallback((a,c)=>{!c||W(a,c)||w(a,{zone_keys:[...a.zone_keys,c]})},[W,w]),$e=y.useCallback((a,c)=>{w(a,{zone_keys:a.zone_keys.filter(u=>u!==c)})},[w]),Be=y.useCallback(a=>C[a]?.name||a,[C]),A=(a,c)=>{const u=a||c;return u.startsWith("svg:")?React.createElement("img",{src:u.substring(4),alt:"",className:"ts-icon"}):React.createElement("i",{className:u})};return React.createElement("div",{className:"ts-vendor-shipping-zones",style:{marginTop:"20px"}},React.createElement("div",{className:"ac-body"},React.createElement("div",{className:"ts-form"},React.createElement("div",{className:"create-form-step form-field-grid"},React.createElement("div",{className:"ts-form-group ui-heading-field field-key-ui-heading"},React.createElement("label",null,d("Configure Shipping","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,d("Shipping zones","voxel-fse")),e.length>0&&React.createElement("div",{className:"ts-repeater-container"},e.map((a,c)=>React.createElement("div",{key:a.key,className:`ts-field-repeater ${f!==a?"collapsed":""}`},React.createElement("div",{className:"ts-repeater-head ts-repeater-head--zone",onClick:()=>v(f===a?null:a)},A(t.icons?.zone,"las la-flag"),React.createElement("label",null,a.label||d("Untitled zone","voxel-fse")),React.createElement("div",{className:"ts-repeater-controller"},React.createElement("a",{href:"#",onClick:u=>{u.stopPropagation(),u.preventDefault(),U(c)},className:"ts-icon-btn ts-smaller no-drag"},A(t.icons?.trash,"las la-trash")),React.createElement("a",{href:"#",className:"ts-icon-btn ts-smaller no-drag",onClick:u=>u.preventDefault()},A(t.icons?.down,"las la-angle-down")))),f===a&&React.createElement("div",{className:"medium form-field-grid"},React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Label","voxel-fse")),React.createElement("input",{type:"text",className:"ts-filter",maxLength:32,value:a.label,onChange:u=>o(c,{label:u.target.value})})),React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Countries","voxel-fse"),React.createElement("span",{style:{marginLeft:"auto"}},React.createElement("a",{href:"#",onClick:u=>{u.preventDefault()}},d("Select all","voxel-fse"))," / ",React.createElement("a",{href:"#",onClick:u=>{u.preventDefault(),o(c,{regions:[]})}},d("Unselect all","voxel-fse")))),React.createElement("div",{className:"ts-filter"},React.createElement("select",{onChange:u=>{p(a,u.target.value),u.target.value=""},value:""},React.createElement("option",{value:""},d("Add country","voxel-fse")),Object.entries(F).map(([u,x])=>React.createElement("optgroup",{key:u,label:u},Object.entries(x).map(([k,G])=>React.createElement("option",{key:k,value:k,disabled:a.regions.some(P=>P.country===k)},G))))),React.createElement("div",{className:"ts-down-icon"}))),React.createElement("div",{className:"ts-form-group vx-1-1"},a.regions.length>0?React.createElement("div",{className:"ts-repeater-container"},a.regions.map((u,x)=>React.createElement("div",{key:u.country,className:"ts-field-repeater collapsed"},React.createElement("div",{className:"ts-repeater-head"},React.createElement("label",null,Be(u.country)),React.createElement("div",{className:"ts-repeater-controller"},React.createElement("a",{href:"#",onClick:k=>{k.stopPropagation(),k.preventDefault(),g(a,x)},className:"ts-icon-btn ts-smaller"},A(t.icons?.trash,"las la-trash"))))))):React.createElement("label",{style:{paddingBottom:0}},d("You have not added any countries yet.","voxel-fse"))))))),React.createElement("a",{href:"#",className:"ts-repeater-add ts-btn ts-btn-4 form-btn",onClick:a=>{a.preventDefault(),T()}},A(t.icons?.add,"las la-plus"),d("Add shipping zone","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,d("Shipping rates","voxel-fse")),n.length>0&&React.createElement("div",{className:"ts-repeater-container"},n.map(a=>React.createElement("div",{key:a.key,className:`ts-field-repeater ${S!==a?"collapsed":""}`},React.createElement("div",{className:"ts-repeater-head ts-repeater-head--rate",onClick:()=>b(S===a?null:a)},A(t.icons?.zone,"las la-box"),React.createElement("label",null,a.label||d("Untitled rate","voxel-fse")),O(a).length>0&&React.createElement("em",null,O(a).length," zone",O(a).length!==1?"s":""),React.createElement("div",{className:"ts-repeater-controller"},React.createElement("a",{href:"#",onClick:c=>{c.stopPropagation(),c.preventDefault(),E(a)},className:"ts-icon-btn ts-smaller no-drag"},A(t.icons?.trash,"las la-trash")),React.createElement("a",{href:"#",className:"ts-icon-btn ts-smaller no-drag",onClick:c=>c.preventDefault()},A(t.icons?.down,"las la-angle-down")))),S===a&&React.createElement("div",{className:"medium form-field-grid"},React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Label","voxel-fse")),React.createElement("input",{type:"text",className:"ts-filter",maxLength:32,value:a.label,onChange:c=>w(a,{label:c.target.value})})),React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Zones","voxel-fse"),React.createElement("span",{style:{marginLeft:"auto"}},React.createElement("a",{href:"#",onClick:c=>{c.preventDefault(),w(a,{zone_keys:e.map(u=>u.key)})}},d("Select all","voxel-fse"))," / ",React.createElement("a",{href:"#",onClick:c=>{c.preventDefault(),w(a,{zone_keys:[]})}},d("Unselect all","voxel-fse")))),React.createElement("div",{className:"ts-filter"},React.createElement("select",{onChange:c=>{Me(a,c.target.value),c.target.value=""},value:""},React.createElement("option",{value:""},d("Add zone","voxel-fse")),e.map(c=>React.createElement("option",{key:c.key,value:c.key,disabled:W(a,c.key)},c.label||d("Untitled zone","voxel-fse")))),React.createElement("div",{className:"ts-down-icon"}))),React.createElement("div",{className:"ts-form-group vx-1-1"},O(a).length>0?React.createElement("div",{className:"flexify simplify-ul attribute-select"},O(a).map(c=>React.createElement("a",{key:c.key,href:"#",onClick:u=>u.preventDefault()},c.label||d("Untitled zone","voxel-fse"),React.createElement("span",{onClick:u=>{u.preventDefault(),u.stopPropagation(),$e(a,c.key)}},A(t.icons?.trash,"las la-trash"))))):React.createElement("label",{style:{paddingBottom:0}},d("No zones selected. Select zones where this rate applies.","voxel-fse"))),React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Type","voxel-fse")),React.createElement("div",{className:"ts-filter"},React.createElement("select",{value:a.type,onChange:c=>w(a,{type:c.target.value})},React.createElement("option",{value:"free_shipping"},d("Free shipping","voxel-fse")),React.createElement("option",{value:"fixed_rate"},d("Flat rate","voxel-fse"))),React.createElement("div",{className:"ts-down-icon"}))),a.type==="free_shipping"&&React.createElement(React.Fragment,null,React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Free shipping requires","voxel-fse")),React.createElement("div",{className:"ts-filter"},React.createElement("select",{value:a.free_shipping.requirements,onChange:c=>w(a,{free_shipping:{...a.free_shipping,requirements:c.target.value}})},React.createElement("option",{value:"none"},d("No requirement","voxel-fse")),React.createElement("option",{value:"minimum_order_amount"},d("Minimum order amount","voxel-fse"))),React.createElement("div",{className:"ts-down-icon"}))),a.free_shipping.requirements==="minimum_order_amount"&&React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Min. order amount","voxel-fse")),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"number",step:"any",className:"ts-filter",value:a.free_shipping.minimum_order_amount||"",onChange:c=>w(a,{free_shipping:{...a.free_shipping,minimum_order_amount:c.target.value?parseFloat(c.target.value):null}})}),React.createElement("span",{className:"input-suffix"},I)))),a.type==="fixed_rate"&&React.createElement(React.Fragment,null,React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Calculation method","voxel-fse")),React.createElement("div",{className:"ts-filter"},React.createElement("select",{value:a.fixed_rate.calculation_method,onChange:c=>w(a,{fixed_rate:{...a.fixed_rate,calculation_method:c.target.value}})},React.createElement("option",{value:"per_item"},d("Per item: Charge per item/quantity (default)","voxel-fse")),React.createElement("option",{value:"per_order"},d("Per order: Fixed cost regardless of quantity or number of items","voxel-fse")),React.createElement("option",{value:"per_class"},d("Per class: Use the highest shipping class cost","voxel-fse"))),React.createElement("div",{className:"ts-down-icon"}))),React.createElement("div",{className:"ts-form-group vx-1-1"},React.createElement("label",null,d("Price per unit","voxel-fse")),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"number",step:"any",className:"ts-filter",value:a.fixed_rate.amount_per_unit||"",onChange:c=>w(a,{fixed_rate:{...a.fixed_rate,amount_per_unit:c.target.value?parseFloat(c.target.value):null}})}),React.createElement("span",{className:"input-suffix"},I)))))))),React.createElement("a",{href:"#",className:"ts-repeater-add ts-btn ts-btn-4 form-btn",onClick:a=>{a.preventDefault(),_()}},A(t.icons?.add,"las la-plus"),d("Add shipping rate","voxel-fse"))),React.createElement("div",{className:"ts-form-group vx-1-2"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:a=>{a.preventDefault(),l()}},A(t.icons?.chevronLeft,"las la-angle-left"),d("Go back","voxel-fse"))),React.createElement("div",{className:"ts-form-group vx-1-2"},React.createElement("a",{href:"#",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-disabled":""}`,onClick:a=>{a.preventDefault(),m||s()}},A(t.icons?.save,"las la-save"),d("Save changes","voxel-fse")))))))}function L(t,e){if(!t&&!e)return null;const n=t||e||"";if(n.startsWith("svg:")){const r=n.substring(4);return React.createElement("img",{src:r,alt:"",className:"ts-icon"})}return React.createElement("i",{className:n})}function Ne(){return"/wp-content/themes/voxel/assets/images/Connect-social-card.png"}function Fe({attributes:t,config:e,context:n,onSaveShipping:r}){const[i,l]=y.useState("main"),[s,m]=y.useState(!1),[h,f]=y.useState(e.shipping_zones||[]),[v,S]=y.useState(e.shipping_rates||[]),b=t.genImage?.url||e.icons?.setup||Ne(),N=y.useCallback(async()=>{if(!(s||!r)){m(!0);try{await r(h,v)}finally{m(!1)}}},[s,r,h,v]),H=e.is_admin,C=e.admin_onboarding_enabled,F=e.account,I=()=>H&&!C?d("Stripe vendor onboarding is not necessary for admin accounts.","voxel-fse"):F.charges_enabled?d("Your account is ready to accept payments.","voxel-fse"):F.details_submitted?d("Your account is pending verification.","voxel-fse"):d("Setup your Stripe vendor account in order to accept payments.","voxel-fse"),T={genImage:t.genImage||{id:0,url:""},icons:e.icons};return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(T)}}),i==="main"&&React.createElement("div",{className:"ts-panel"},React.createElement("img",{src:b,alt:"",style:{width:"100%",height:"auto",borderRadius:"8px 8px 0 0"}}),React.createElement("div",{className:"ac-body"},H&&!C?React.createElement("p",null,I()):React.createElement(React.Fragment,null,React.createElement("p",null,I()),F.exists?F.details_submitted?React.createElement(React.Fragment,null,React.createElement("div",{className:"ac-bottom"},React.createElement("ul",{className:"simplify-ul current-plan-btn"},React.createElement("li",null,React.createElement("a",{href:e.dashboard_link,target:"_blank",rel:"noopener noreferrer",className:"ts-btn ts-btn-1 ts-btn-large"},L(e.icons?.stripe,"lab la-stripe"),d("Stripe Express Dashboard","voxel-fse"))))),React.createElement("div",{className:"ac-bottom"},React.createElement("ul",{className:"simplify-ul current-plan-btn"},React.createElement("li",null,React.createElement("a",{href:e.onboard_link,className:"ts-btn ts-btn-1 ts-btn-large"},L(e.icons?.update,"las la-pen"),d("Update information","voxel-fse"))),e.shipping_enabled&&React.createElement("li",null,React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:U=>{U.preventDefault(),l("shipping")}},L(e.icons?.shipping,"las la-shipping-fast"),d("Configure shipping","voxel-fse")))))):React.createElement("div",{className:"ac-bottom"},React.createElement("ul",{className:"simplify-ul current-plan-btn"},React.createElement("li",null,React.createElement("a",{href:e.onboard_link,className:"ts-btn ts-btn-1 ts-btn-large"},L(e.icons?.submit,"las la-info-circle"),d("Complete onboarding","voxel-fse"))))):React.createElement("div",{className:"ac-bottom"},React.createElement("ul",{className:"simplify-ul current-plan-btn"},React.createElement("li",null,React.createElement("a",{href:e.onboard_link,className:"ts-btn ts-btn-1 ts-btn-large"},L(e.icons?.setup,"las la-plus"),d("Start setup","voxel-fse")))))))),i==="shipping"&&e.shipping_enabled&&React.createElement(ke,{config:e,zones:h,rates:v,onZonesChange:f,onRatesChange:S,onGoBack:()=>l("main"),onSave:N,saving:s,context:n}))}function Ce(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const t=document.querySelector('link[rel="https://api.w.org/"]');if(t){const e=t.getAttribute("href");if(e)return e.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function Ie(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const t=document.querySelector('link[rel="https://api.w.org/"]');if(t){const e=t.getAttribute("href");if(e)return e}}if(typeof window<"u"&&window.location?.origin){const t=window.location.pathname.split("/").filter(Boolean),e=["wp-admin","wp-content","wp-includes","wp-json"];return t.length>0&&!e.includes(t[0])?window.location.origin+"/"+t[0]+"/wp-json/":window.location.origin+"/wp-json/"}return"/wp-json/"}function De(){return Ie()}function Le(){return typeof window<"u"&&window.voxelStripeAccount?.ajaxUrl?window.voxelStripeAccount.ajaxUrl:Ce()}function He(){return typeof window<"u"&&window.wpApiSettings?.nonce?window.wpApiSettings.nonce:""}function Te(){return typeof window<"u"&&window.voxelStripeAccount?.nonce?window.voxelStripeAccount.nonce:""}function Ue(t){const e=(l,s)=>typeof l=="string"?l:typeof l=="number"?String(l):s,n=(l,s)=>{if(typeof l=="number")return l;if(typeof l=="string"){const m=parseInt(l,10);if(!isNaN(m))return m}return s},r=l=>{if(l&&typeof l=="object"){const s=l;return{id:n(s.id,0),url:e(s.url,"")}}return{id:0,url:""}},i=l=>{if(!l||typeof l!="object")return{};const s=l;return{setup:e(s.setup??s.ts_setup_ico,""),submit:e(s.submit??s.ts_submit_ico,""),update:e(s.update??s.ts_update_ico,""),stripe:e(s.stripe??s.ts_stripe_ico,""),shipping:e(s.shipping??s.ts_shipping_ico,""),chevronLeft:e(s.chevronLeft??s.ts_chevron_left,""),save:e(s.save??s.save_icon,""),handle:e(s.handle??s.handle_icon,""),zone:e(s.zone??s.ts_zone_ico,""),trash:e(s.trash??s.trash_icon,""),down:e(s.down??s.down_icon,""),search:e(s.search??s.ts_search_icon,""),add:e(s.add??s.ts_add_icon,"")}};return{genImage:r(t.genImage??t.gen_image),genImageDynamicTag:e(t.genImageDynamicTag??t.gen_image_dynamic_tag,""),icons:i(t.icons)}}function Oe(t){const e=t.querySelector("script.vxconfig");if(e&&e.textContent)try{const n=JSON.parse(e.textContent);return Ue(n)}catch(n){console.error("[Stripe Account] Failed to parse vxconfig:",n)}return null}function Pe(t){const e=n=>n?n.startsWith("svg:")?{library:"svg",url:n.substring(4)}:{library:"icon",value:n}:null;return{genImage:t.genImage||{id:0,url:""},genImageDynamicTag:t.genImageDynamicTag||"",previewAsUser:null,tsSetupIco:e(t.icons?.setup),tsSubmitIco:e(t.icons?.submit),tsUpdateIco:e(t.icons?.update),tsStripeIco:e(t.icons?.stripe),tsShippingIco:e(t.icons?.shipping),tsChevronLeft:e(t.icons?.chevronLeft),saveIcon:e(t.icons?.save),handleIcon:e(t.icons?.handle),tsZoneIco:e(t.icons?.zone),trashIcon:e(t.icons?.trash),downIcon:e(t.icons?.down),tsSearchIcon:e(t.icons?.search),tsAddIcon:e(t.icons?.add)}}async function je(){const e=`${De()}voxel-fse/v1/stripe-account/config`;try{const n=await fetch(e,{headers:{"Content-Type":"application/json","X-WP-Nonce":He()},credentials:"same-origin"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const r=await n.json();return r.success&&r.data?r.data:null}catch(n){return console.error("[Stripe Account] Failed to fetch config:",n),null}}async function Ze(t,e){const n=Le(),r=Te(),i=new FormData;i.append("action","stripe_connect.account.save_shipping"),i.append("_wpnonce",r),i.append("shipping_zones",JSON.stringify(t)),i.append("shipping_rates",JSON.stringify(e));try{const l=await fetch(n,{method:"POST",body:i,credentials:"same-origin"});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const s=await l.json();return{success:s.success??!1,message:s.message||""}}catch(l){return console.error("[Stripe Account] Failed to save shipping:",l),{success:!1,message:l instanceof Error?l.message:"Failed to save shipping configuration"}}}function qe({attributes:t}){const[e,n]=y.useState(null),[r,i]=y.useState(!0),[l,s]=y.useState(null);y.useEffect(()=>{let h=!1;async function f(){i(!0),s(null);try{const v=await je();h||(v?n(v):s("Failed to load Stripe account configuration"))}catch(v){h||s(v instanceof Error?v.message:"Failed to load")}finally{h||i(!1)}}return f(),()=>{h=!0}},[]);const m=async(h,f)=>{const v=await Ze(h,f);if(!v.success)throw alert(v.message||"Failed to save shipping configuration"),new Error(v.message);alert(v.message||"Shipping configuration saved successfully")};return r?React.createElement("div",{className:"ts-panel"},React.createElement("div",{className:"ac-body",style:{textAlign:"center",padding:"40px"}},React.createElement("p",null,"Loading Stripe account..."))):l?React.createElement("div",{className:"ts-panel"},React.createElement("div",{className:"ac-body",style:{textAlign:"center",padding:"40px",color:"#d32f2f"}},React.createElement("p",null,"Error: ",l))):e?React.createElement(Fe,{attributes:t,config:e,context:"frontend",onSaveShipping:m}):React.createElement("div",{className:"ts-panel"},React.createElement("div",{className:"ac-body",style:{textAlign:"center",padding:"40px"}},React.createElement("p",null,"Stripe Connect is not configured.")))}function q(){document.querySelectorAll(".voxel-fse-stripe-account-frontend:not([data-react-mounted])").forEach(e=>{e.setAttribute("data-react-mounted","true");const n=Oe(e);if(!n){console.error("[Stripe Account] Failed to find vxconfig");return}const r=Pe(n);e.innerHTML="",le.createRoot(e).render(React.createElement(qe,{attributes:r}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",q):q(),window.addEventListener("turbo:load",q),window.addEventListener("pjax:complete",q)})(ReactDOM,React);
