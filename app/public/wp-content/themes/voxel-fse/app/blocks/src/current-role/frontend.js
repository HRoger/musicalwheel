(function(B,E){"use strict";var S,L,w,T;S={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},L=["(","?"],w={")":["("],":":["?","?:"]},T=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;function J(e){for(var t=[],n=[],r,i,l,o;r=e.match(T);){for(i=r[0],l=e.substr(0,r.index).trim(),l&&t.push(l);o=n.pop();){if(w[i]){if(w[i][0]===o){i=w[i][1]||i;break}}else if(L.indexOf(o)>=0||S[o]<S[i]){n.push(o);break}t.push(o)}w[i]||n.push(i),e=e.substr(r.index+i.length)}return e=e.trim(),e&&t.push(e),t.concat(n.reverse())}var q={"!":function(e){return!e},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"==":function(e,t){return e===t},"!=":function(e,t){return e!==t},"&&":function(e,t){return e&&t},"||":function(e,t){return e||t},"?:":function(e,t,n){if(e)throw t;return n}};function K(e,t){var n=[],r,i,l,o,s,f;for(r=0;r<e.length;r++){if(s=e[r],o=q[s],o){for(i=o.length,l=Array(i);i--;)l[i]=n.pop();try{f=o.apply(null,l)}catch(u){return u}}else t.hasOwnProperty(s)?f=t[s]:f=+s;n.push(f)}return n[0]}function Z(e){var t=J(e);return function(n){return K(t,n)}}function G(e){var t=Z(e);return function(n){return+t({n})}}var D={contextDelimiter:"",onMissingKey:null};function V(e){var t,n,r;for(t=e.split(";"),n=0;n<t.length;n++)if(r=t[n].trim(),r.indexOf("plural=")===0)return r.substr(7)}function I(e,t){var n;this.data=e,this.pluralForms={},this.options={};for(n in D)this.options[n]=t!==void 0&&n in t?t[n]:D[n]}I.prototype.getPluralForm=function(e,t){var n=this.pluralForms[e],r,i,l;return n||(r=this.data[e][""],l=r["Plural-Forms"]||r["plural-forms"]||r.plural_forms,typeof l!="function"&&(i=V(r["Plural-Forms"]||r["plural-forms"]||r.plural_forms),l=G(i)),n=this.pluralForms[e]=l),n(t)},I.prototype.dcnpgettext=function(e,t,n,r,i){var l,o,s;return i===void 0?l=0:l=this.getPluralForm(e,i),o=n,t&&(o=t+this.options.contextDelimiter+n),s=this.data[e][o],s&&s[l]?s[l]:(this.options.onMissingKey&&this.options.onMissingKey(n,e),l===0?n:r)};var O={"":{plural_forms(e){return e===1?0:1}}},W=/^i18n\.(n?gettext|has_translation)(_|$)/,X=(e,t,n)=>{const r=new I({}),i=new Set,l=()=>{i.forEach(a=>a())},o=a=>(i.add(a),()=>i.delete(a)),s=(a="default")=>r.data[a],f=(a,c="default")=>{r.data[c]={...r.data[c],...a},r.data[c][""]={...O[""],...r.data[c]?.[""]},delete r.pluralForms[c]},u=(a,c)=>{f(a,c),l()},h=(a,c="default")=>{r.data[c]={...r.data[c],...a,"":{...O[""],...r.data[c]?.[""],...a?.[""]}},delete r.pluralForms[c],l()},g=(a,c)=>{r.data={},r.pluralForms={},u(a,c)},y=(a="default",c,d,v,m)=>(r.data[a]||f(void 0,a),r.dcnpgettext(a,c,d,v,m)),_=a=>a||"default",we=(a,c)=>{let d=y(c,void 0,a);return n?(d=n.applyFilters("i18n.gettext",d,a,c),n.applyFilters("i18n.gettext_"+_(c),d,a,c)):d},$=(a,c,d)=>{let v=y(d,c,a);return n?(v=n.applyFilters("i18n.gettext_with_context",v,a,c,d),n.applyFilters("i18n.gettext_with_context_"+_(d),v,a,c,d)):v},Ee=(a,c,d,v)=>{let m=y(v,void 0,a,c,d);return n?(m=n.applyFilters("i18n.ngettext",m,a,c,d,v),n.applyFilters("i18n.ngettext_"+_(v),m,a,c,d,v)):m},Ae=(a,c,d,v,m)=>{let F=y(m,v,a,c,d);return n?(F=n.applyFilters("i18n.ngettext_with_context",F,a,c,d,v,m),n.applyFilters("i18n.ngettext_with_context_"+_(m),F,a,c,d,v,m)):F},xe=()=>$("ltr","text direction")==="rtl",be=(a,c,d)=>{const v=c?c+""+a:a;let m=!!r.data?.[d??"default"]?.[v];return n&&(m=n.applyFilters("i18n.has_translation",m,a,c,d),m=n.applyFilters("i18n.has_translation_"+_(d),m,a,c,d)),m};if(n){const a=c=>{W.test(c)&&l()};n.addAction("hookAdded","core/i18n",a),n.addAction("hookRemoved","core/i18n",a)}return{getLocaleData:s,setLocaleData:u,addLocaleData:h,resetLocaleData:g,subscribe:o,__:we,_x:$,_n:Ee,_nx:Ae,isRTL:xe,hasTranslation:be}};function Y(e){return typeof e!="string"||e===""?(console.error("The namespace must be a non-empty string."),!1):/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)?!0:(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)}var C=Y;function Q(e){return typeof e!="string"||e===""?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)?!0:(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)}var H=Q;function ee(e,t){return function(r,i,l,o=10){const s=e[t];if(!H(r)||!C(i))return;if(typeof l!="function"){console.error("The hook callback must be a function.");return}if(typeof o!="number"){console.error("If specified, the hook priority must be a number.");return}const f={callback:l,priority:o,namespace:i};if(s[r]){const u=s[r].handlers;let h;for(h=u.length;h>0&&!(o>=u[h-1].priority);h--);h===u.length?u[h]=f:u.splice(h,0,f),s.__current.forEach(g=>{g.name===r&&g.currentIndex>=h&&g.currentIndex++})}else s[r]={handlers:[f],runs:0};r!=="hookAdded"&&e.doAction("hookAdded",r,i,l,o)}}var U=ee;function te(e,t,n=!1){return function(i,l){const o=e[t];if(!H(i)||!n&&!C(l))return;if(!o[i])return 0;let s=0;if(n)s=o[i].handlers.length,o[i]={runs:o[i].runs,handlers:[]};else{const f=o[i].handlers;for(let u=f.length-1;u>=0;u--)f[u].namespace===l&&(f.splice(u,1),s++,o.__current.forEach(h=>{h.name===i&&h.currentIndex>=u&&h.currentIndex--}))}return i!=="hookRemoved"&&e.doAction("hookRemoved",i,l),s}}var A=te;function ne(e,t){return function(r,i){const l=e[t];return typeof i<"u"?r in l&&l[r].handlers.some(o=>o.namespace===i):r in l}}var k=ne;function re(e,t,n,r){return function(l,...o){const s=e[t];s[l]||(s[l]={handlers:[],runs:0}),s[l].runs++;const f=s[l].handlers;if(!f||!f.length)return n?o[0]:void 0;const u={name:l,currentIndex:0};async function h(){try{s.__current.add(u);let y=n?o[0]:void 0;for(;u.currentIndex<f.length;)y=await f[u.currentIndex].callback.apply(null,o),n&&(o[0]=y),u.currentIndex++;return n?y:void 0}finally{s.__current.delete(u)}}function g(){try{s.__current.add(u);let y=n?o[0]:void 0;for(;u.currentIndex<f.length;)y=f[u.currentIndex].callback.apply(null,o),n&&(o[0]=y),u.currentIndex++;return n?y:void 0}finally{s.__current.delete(u)}}return(r?h:g)()}}var x=re;function ie(e,t){return function(){const r=e[t];return Array.from(r.__current).at(-1)?.name??null}}var P=ie;function le(e,t){return function(r){const i=e[t];return typeof r>"u"?i.__current.size>0:Array.from(i.__current).some(l=>l.name===r)}}var j=le;function oe(e,t){return function(r){const i=e[t];if(H(r))return i[r]&&i[r].runs?i[r].runs:0}}var M=oe,ae=class{actions;filters;addAction;addFilter;removeAction;removeFilter;hasAction;hasFilter;removeAllActions;removeAllFilters;doAction;doActionAsync;applyFilters;applyFiltersAsync;currentAction;currentFilter;doingAction;doingFilter;didAction;didFilter;constructor(){this.actions=Object.create(null),this.actions.__current=new Set,this.filters=Object.create(null),this.filters.__current=new Set,this.addAction=U(this,"actions"),this.addFilter=U(this,"filters"),this.removeAction=A(this,"actions"),this.removeFilter=A(this,"filters"),this.hasAction=k(this,"actions"),this.hasFilter=k(this,"filters"),this.removeAllActions=A(this,"actions",!0),this.removeAllFilters=A(this,"filters",!0),this.doAction=x(this,"actions",!1,!1),this.doActionAsync=x(this,"actions",!1,!0),this.applyFilters=x(this,"filters",!0,!1),this.applyFiltersAsync=x(this,"filters",!0,!0),this.currentAction=P(this,"actions"),this.currentFilter=P(this,"filters"),this.doingAction=j(this,"actions"),this.doingFilter=j(this,"filters"),this.didAction=M(this,"actions"),this.didFilter=M(this,"filters")}};function ce(){return new ae}var se=ce,z=se(),{addAction:Fe,addFilter:Se,removeAction:Ie,removeFilter:He,hasAction:Le,hasFilter:Te,removeAllActions:De,removeAllFilters:Oe,doAction:Ce,doActionAsync:Ue,applyFilters:ke,applyFiltersAsync:Pe,currentAction:je,currentFilter:Me,doingAction:ze,doingFilter:Ne,didAction:$e,didFilter:Be,actions:Je,filters:qe}=z,p=X(void 0,void 0,z);p.getLocaleData.bind(p),p.setLocaleData.bind(p),p.resetLocaleData.bind(p),p.subscribe.bind(p);var R=p.__.bind(p);p._x.bind(p),p._n.bind(p),p._nx.bind(p),p.isRTL.bind(p),p.hasTranslation.bind(p);function N(e){return!e||!e.value?null:e.library==="svg"?React.createElement("img",{src:e.value,alt:"",className:"voxel-icon-svg"}):e.library==="icon"?React.createElement("i",{className:e.value,"aria-hidden":"true"}):null}function ue(){return React.createElement("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"}))}function fe(){return React.createElement("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},React.createElement("path",{d:"M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"}))}function de({attributes:e,roleData:t,isLoading:n,error:r,context:i}){const l={roleIcon:e.roleIcon??{library:"",value:""},switchIcon:e.switchIcon??{library:"",value:""}},o=N(e.roleIcon)??React.createElement(ue,null),s=N(e.switchIcon)??React.createElement(fe,null);if(n)return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("div",{className:"ts-panel active-plan role-panel"},React.createElement("div",{className:"ac-head"},o,React.createElement("b",null,R("User role","voxel-fse"))),React.createElement("div",{className:"ac-body"},React.createElement("p",null,R("Loading...","voxel-fse")))));if(r)return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("div",{className:"ts-panel active-plan role-panel"},React.createElement("div",{className:"ac-head"},o,React.createElement("b",null,R("User role","voxel-fse"))),React.createElement("div",{className:"ac-body"},React.createElement("p",null,r))));if(!t?.isLoggedIn)return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("div",{className:"ts-panel active-plan role-panel"},React.createElement("div",{className:"ac-head"},o,React.createElement("b",null,R("User role","voxel-fse"))),React.createElement("div",{className:"ac-body"},React.createElement("p",null,R("Please log in to view your role.","voxel-fse")))));const u=t.currentRoles&&t.currentRoles.length>0?t.rolesLabel:R("You do not have a role assigned currently.","voxel-fse"),h=()=>!t.canSwitch||!t.switchableRoles||t.switchableRoles.length===0?null:React.createElement("div",{className:"ac-bottom"},React.createElement("ul",{className:"simplify-ul current-plan-btn"},t.switchableRoles.map(g=>React.createElement("li",{key:g.key},React.createElement("a",{...i==="frontend"?{"vx-action":""}:{},className:"ts-btn ts-btn-1",href:g.switchUrl,onClick:i==="editor"?y=>y.preventDefault():void 0},s,R("Switch to ","voxel-fse"),g.label)))));return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(l)}}),React.createElement("div",{className:"ts-panel active-plan role-panel"},React.createElement("div",{className:"ac-head"},o,React.createElement("b",null,R("User role","voxel-fse"))),React.createElement("div",{className:"ac-body"},React.createElement("p",null,u),h())))}function he(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const t=e.getAttribute("href");if(t)return t.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function pe(){const e=he();try{return new URL(e).pathname.replace(/\/$/,"")}catch{return""}}function ve(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const t=document.querySelector('link[rel="https://api.w.org/"]');if(t){const n=t.getAttribute("href");if(n)return n}}const e=pe();return typeof window<"u"?window.location.origin+e+"/wp-json/":"/wp-json/"}function me(e){const t=(i,l)=>typeof i=="string"?i:typeof i=="number"?String(i):l,n=(i,l)=>{if(i&&typeof i=="object"){const o=i;return{library:t(o.library,l.library),value:t(o.value,l.value)}}return l},r={library:"",value:""};return{roleIcon:n(e.roleIcon??e.role_icon??e.ts_role_ico,r),switchIcon:n(e.switchIcon??e.switch_icon??e.ts_switch_ico,r)}}function ye(){return ve()}function ge(e){const t=e.querySelector("script.vxconfig");if(t&&t.textContent)try{const n=JSON.parse(t.textContent);return me(n)}catch(n){console.error("Failed to parse vxconfig:",n)}return null}async function Re(){const e=ye(),t=await fetch(`${e}voxel-fse/v1/current-role`,{credentials:"same-origin"});if(!t.ok)throw new Error(`Failed to fetch role data: ${t.statusText}`);return await t.json()}function _e({config:e}){const[t,n]=E.useState(null),[r,i]=E.useState(!0),[l,o]=E.useState(null);E.useEffect(()=>{let f=!1;async function u(){i(!0),o(null);try{const h=await Re();f||n(h)}catch(h){f||o(h instanceof Error?h.message:"Failed to load role data")}finally{f||i(!1)}}return u(),()=>{f=!0}},[]);const s={blockId:"",roleIcon:e.roleIcon,switchIcon:e.switchIcon};return React.createElement(de,{attributes:s,roleData:t,isLoading:r,error:l,context:"frontend"})}function b(){document.querySelectorAll(".voxel-fse-current-role").forEach(t=>{if(t.dataset.hydrated==="true")return;const n=ge(t);if(!n){console.error("No vxconfig found for current role block");return}t.dataset.hydrated="true",t.innerHTML="",B.createRoot(t).render(React.createElement(_e,{config:n}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",b):b(),window.addEventListener("turbo:load",b),window.addEventListener("pjax:complete",b)})(ReactDOM,React);
