(function(Ce,u){"use strict";const z={addToCart:{library:"icon",value:"la-shopping-cart"},outOfStock:{library:"icon",value:"la-exclamation-circle"},checkout:{library:"icon",value:"la-arrow-right"},calendar:{library:"icon",value:"la-calendar"},clock:{library:"icon",value:"la-clock"}},qe={blockId:"",showPriceCalculator:"show",showPriceCalculatorTablet:"show",showPriceCalculatorMobile:"show",showSubtotalOnly:!1,hideCardSubheading:!1,cardSelectOnClick:!0,icons:z,fieldSpacing:20,fieldLabelTypography:{},fieldLabelColor:"",primaryButtonTypography:{},primaryButtonBorder:{borderType:"none",borderWidth:{},borderColor:""},primaryButtonBorderRadius:0,primaryButtonBoxShadow:{},primaryButtonTextColor:"",primaryButtonBackground:"",primaryButtonIconSize:24,primaryButtonIconColor:"",primaryButtonIconTextSpacing:8,primaryButtonTextColorHover:"",primaryButtonBackgroundHover:"",primaryButtonBorderColorHover:"",primaryButtonBoxShadowHover:{},primaryButtonIconColorHover:"",priceCalculatorListSpacing:10,priceCalculatorTypography:{},priceCalculatorTextColor:"",priceCalculatorTotalTypography:{},priceCalculatorTotalTextColor:"",loadingColor1:"",loadingColor2:"",outOfStockContentGap:15,outOfStockIconSize:40,outOfStockIconColor:"",outOfStockTypography:{},outOfStockTextColor:"",stepperInputSize:16,stepperButtonIconColor:"",stepperButtonBackground:"",stepperButtonBorder:{borderType:"none",borderWidth:{},borderColor:""},stepperButtonBorderRadius:0,stepperButtonIconColorHover:"",stepperButtonBackgroundHover:"",stepperButtonBorderColorHover:"",cardsGap:10,cardsBackground:"",cardsBorder:{borderType:"none",borderWidth:{},borderColor:""},cardsBorderRadius:0,cardsPrimaryTypography:{},cardsPrimaryColor:"",cardsSecondaryTypography:{},cardsSecondaryColor:"",cardsPriceTypography:{},cardsPriceColor:"",cardsImageBorderRadius:0,cardsImageSize:60,cardsSelectedBackground:"",cardsSelectedBorderColor:"",cardsSelectedBoxShadow:{},cardsSelectedPrimaryTypography:{},buttonsGap:10,buttonsBackground:"",buttonsBorder:{borderType:"none",borderWidth:{},borderColor:""},buttonsBorderRadius:0,buttonsTextTypography:{},buttonsTextColor:"",buttonsSelectedBackground:"",buttonsSelectedBorderColor:"",buttonsSelectedBoxShadow:{},dropdownTypography:{},dropdownBoxShadow:{},dropdownBackground:"",dropdownTextColor:"",dropdownBorder:{type:"default",width:0,color:""},dropdownBorderRadius:0,dropdownIconColor:"",dropdownIconSize:24,dropdownIconTextSpacing:10,dropdownHideChevron:!1,dropdownChevronColor:"",dropdownBackgroundHover:"",dropdownTextColorHover:"",dropdownBorderColorHover:"",dropdownIconColorHover:"",dropdownBoxShadowHover:{},dropdownFilledTypography:{},dropdownFilledBackground:"",dropdownFilledTextColor:"",dropdownFilledIconColor:"",dropdownFilledBorderColor:"",dropdownFilledBorderWidth:0,dropdownFilledBoxShadow:{},radioCheckboxBorderColor:"",radioCheckboxTextTypography:{},radioCheckboxTextColor:"",radioCheckboxSelectedBackground:"",radioCheckboxSelectedTextTypography:{},radioCheckboxSelectedTextColor:"",radioCheckboxSelectedBoxShadow:{},switcherBackgroundInactive:"",switcherBackgroundActive:"",switcherHandleBackground:"",imagesGap:10,imagesBorderRadius:0,imagesSelectedBorderColor:"",colorsGap:10,colorsSize:30,colorsBorderRadius:50,colorsInsetColor:"",inputPlaceholderColor:"",inputPlaceholderTypography:{},inputValueColor:"",inputValueTypography:{},inputBackground:"",inputBorder:{type:"default",width:0,color:""},inputBorderRadius:0,inputBackgroundHover:"",inputBorderColorHover:"",inputPlaceholderColorHover:"",inputTextColorHover:"",inputBackgroundActive:"",inputBorderColorActive:"",inputTextColorActive:""},Pe={start_date:null,end_date:null,date:null,slot:null};function ne({addon:t,value:e,onChange:n,getRepeatConfig:a,getCustomPrice:l,getCustomPriceForDate:d,searchContext:o}){u.useEffect(()=>{t.required&&!e.enabled&&n({enabled:!0}),o?.switcher_addons?.[t.key]===!0&&!e.enabled&&n({enabled:!0})},[t.key,t.required,o,e.enabled,n]);const p=u.useCallback(()=>{t.required&&e.enabled||n({enabled:!e.enabled})},[t.required,e.enabled,n]);u.useCallback(()=>{if(!e.enabled)return null;let g=t.label;const m=a(t),i=l(t);let b=0;if(m!==null){b=0;const f=new Date(m.start+"T00:00:00Z"),r=new Date(m.end+"T00:00:00Z");for(;m.count_mode==="nights"?f<r:f<=r;){const c=d(f);if(c!==null){const y=c.prices.addons?.[t.key],E=y&&"price"in y?y.price:null;b+=E??t.props.price??0}else b+=t.props.price??0;f.setDate(f.getDate()+1)}g+=m.label}else{let f=t.props.price??0;if(i!==null){const r=i.prices.addons?.[t.key],c=r&&"price"in r?r.price:null;c!=null&&(f=c)}b=f}return{label:g,amount:b}},[t,e.enabled,a,l,d]);const s=t.props.price!=null?`+${t.props.price.toLocaleString()}`:"";return React.createElement("div",{className:"ts-form-group ts-addon-switcher"},React.createElement("div",{className:"switch-slider"},React.createElement("label",{className:"container-switch"},React.createElement("input",{type:"checkbox",checked:e.enabled,onChange:p,disabled:t.required&&e.enabled}),React.createElement("span",{className:"switch"})),React.createElement("span",{className:"switch-label"},t.label,s&&React.createElement("span",{className:"addon-price"}," (",s,")"))))}ne.getPricingSummary=function(t,e,n,a,l){if(!e.enabled)return null;let d=t.label;const o=n(t),p=a(t);let s=0;if(o!==null){s=0;const g=new Date(o.start+"T00:00:00Z"),m=new Date(o.end+"T00:00:00Z");for(;o.count_mode==="nights"?g<m:g<=m;){const i=l(g);if(i!==null){const b=i.prices.addons?.[t.key],f=b&&"price"in b?b.price:null;s+=f??t.props.price??0}else s+=t.props.price??0;g.setDate(g.getDate()+1)}d+=o.label}else{let g=t.props.price??0;if(p!==null){const m=p.prices.addons?.[t.key],i=m&&"price"in m?m.price:null;i!=null&&(g=i)}s=g}return{label:d,amount:s}};function ae({addon:t,value:e,onChange:n,getRepeatConfig:a,getCustomPrice:l,getCustomPriceForDate:d,searchContext:o}){const p=t.props.min_units??1,s=t.props.max_units??999;u.useEffect(()=>{if(e.quantity===null){const y=t.required?p:0;n({quantity:y})}const c=o?.numeric_addons?.[t.key];if(c!==void 0){const y=parseInt(String(c),10);typeof y=="number"&&y>=p&&y<=s&&n({quantity:y})}},[t.key,t.required,p,s,o]);const g=u.useCallback(()=>{const c=e.quantity??0;typeof c!="number"||c+1<p?n({quantity:p}):n({quantity:Math.min(c+1,s)})},[e.quantity,p,s,n]),m=u.useCallback(()=>{const c=e.quantity??0;if(typeof c!="number")n({quantity:p});else{const y=c-1;!t.required&&y<p?n({quantity:0}):n({quantity:Math.max(y,p)})}},[t.required,e.quantity,p,n]),i=u.useCallback(()=>{const c=e.quantity;typeof c=="number"&&(c>s?n({quantity:s}):c<p&&(!t.required&&c===0||n({quantity:p})))},[t.required,e.quantity,p,s,n]),b=u.useCallback(c=>{const y=parseInt(c.target.value,10);isNaN(y)||n({quantity:y})},[n]),f=t.props.price!=null?`+${t.props.price.toLocaleString()}`:"",r=e.quantity??0;return React.createElement("div",{className:"ts-form-group ts-addon-numeric"},React.createElement("label",null,t.label,f&&React.createElement("span",{className:"addon-price"}," (",f," each)")),React.createElement("div",{className:"ts-stepper-input"},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:m,disabled:t.required&&r<=p},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("input",{type:"number",value:r,onChange:b,onBlur:i,min:t.required?p:0,max:s,className:"ts-stepper-value"}),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:g,disabled:r>=s},React.createElement("span",{className:"ts-icon"},"+"))),t.props.charge_after?.enabled&&t.props.charge_after.quantity>0&&React.createElement("small",{className:"charge-after-note"},"First ",t.props.charge_after.quantity," free"))}ae.getPricingSummary=function(t,e,n,a,l){const d=e.quantity??0;if(d<1)return null;let o=t.label;d>=1&&(o+=` × ${d}`);let p=d;t.props.charge_after?.enabled&&t.props.charge_after?.quantity>0&&(p=Math.max(0,d-t.props.charge_after.quantity));const s=n(t),g=a(t);let m=0;if(s!==null){m=0;const i=new Date(s.start+"T00:00:00Z"),b=new Date(s.end+"T00:00:00Z");for(;s.count_mode==="nights"?i<b:i<=b;){const f=l(i);if(f!==null){const r=f.prices.addons?.[t.key],c=r&&"price"in r?r.price:null;m+=c??t.props.price??0}else m+=t.props.price??0;i.setDate(i.getDate()+1)}m*=p,o+=s.label}else{let i=t.props.price??0;if(g!==null){const b=g.prices.addons?.[t.key],f=b&&"price"in b?b.price:null;f!=null&&(i=f)}m=i*p}return{label:o,amount:m}};function se({addon:t,value:e,onChange:n}){const[a,l]=u.useState(!1),d=u.useRef(null),o=t.props.choices??{},p=Object.keys(o);u.useEffect(()=>{t.required&&e.selected===null&&p.length>0&&n({selected:p[0]})},[t.required,e.selected,p,n]);const s=u.useCallback(b=>{n({selected:b}),l(!1)},[n]),g=u.useCallback(()=>{t.required||n({selected:null})},[t.required,n]),m=e.selected?o[e.selected]??null:null,i=b=>b.price!=null&&b.price>0?`+${b.price.toLocaleString()}`:"";return React.createElement("div",{className:"ts-form-group ts-addon-select"},React.createElement("label",null,t.label),React.createElement("div",{ref:d,className:`ts-filter ts-popup-target${m?" ts-filled":""}`,onClick:()=>l(!a),role:"button",tabIndex:0,onKeyDown:b=>b.key==="Enter"&&l(!a)},React.createElement("span",{className:"ts-filter-text"},m?m.label:"Select..."),React.createElement("div",{className:"ts-down-icon"})),a&&React.createElement("div",{className:"ts-popup-list"},React.createElement("ul",{className:"simplify-ul ts-form-options"},!t.required&&e.selected&&React.createElement("li",{className:"ts-option ts-option-clear",onClick:g,role:"option"},React.createElement("span",null,"Clear selection")),p.map(b=>{const f=o[b],r=e.selected===b,c=i(f);return React.createElement("li",{key:b,className:`ts-option${r?" ts-selected":""}`,onClick:()=>s(b),role:"option","aria-selected":r},React.createElement("span",{className:"option-label"},f.label),c&&React.createElement("span",{className:"option-price"},c))}))))}se.getPricingSummary=function(t,e,n,a,l){const d=e.selected;if(d===null)return null;const p=(t.props.choices??{})[d];if(!p)return null;let s=p.label;const g=n(t),m=a(t);let i=0;if(g!==null){i=0;const b=new Date(g.start+"T00:00:00Z"),f=new Date(g.end+"T00:00:00Z");for(;g.count_mode==="nights"?b<f:b<=f;){const r=l(b);if(r!==null){const c=r.prices.addons?.[t.key],E=(c&&typeof c=="object"&&!("price"in c)?c[d]:null)?.price??null;i+=E??p.price}else i+=p.price;b.setDate(b.getDate()+1)}s+=g.label}else{let b=p.price;if(m!==null){const f=m.prices.addons?.[t.key],c=(f&&typeof f=="object"&&!("price"in f)?f[d]:null)?.price??null;c!=null&&(b=c)}i=b}return{label:s,amount:i}};function re({addon:t,value:e,onChange:n}){const[a,l]=u.useState(!1),d=u.useRef(null),o=t.props.choices??{},p=Object.keys(o),s=e.selected??[],g=u.useCallback(r=>{const c=[...s],y=c.indexOf(r);y!==-1?c.splice(y,1):c.push(r),n({selected:c})},[s,n]),m=u.useCallback(()=>{n({selected:[]})},[n]),i=r=>s.includes(r),b=r=>r.price!=null&&r.price>0?`+${r.price.toLocaleString()}`:"",f=()=>s.length===0?"Select...":s.length===1?o[s[0]]?.label??"Selected":`${s.length} selected`;return React.createElement("div",{className:"ts-form-group ts-addon-multiselect"},React.createElement("label",null,t.label),React.createElement("div",{ref:d,className:`ts-filter ts-popup-target${s.length>0?" ts-filled":""}`,onClick:()=>l(!a),role:"button",tabIndex:0,onKeyDown:r=>r.key==="Enter"&&l(!a)},React.createElement("span",{className:"ts-filter-text"},f()),React.createElement("div",{className:"ts-down-icon"})),a&&React.createElement("div",{className:"ts-popup-list"},React.createElement("ul",{className:"simplify-ul ts-form-options ts-checkboxes"},s.length>0&&!t.required&&React.createElement("li",{className:"ts-option ts-option-clear",onClick:m,role:"option"},React.createElement("span",null,"Clear all")),p.map(r=>{const c=o[r],y=i(r),E=b(c);return React.createElement("li",{key:r,className:`ts-option ts-checkbox-option${y?" ts-selected":""}`,onClick:()=>g(r),role:"option","aria-selected":y},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:y,onChange:()=>{},tabIndex:-1}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",{className:"option-label"},c.label),E&&React.createElement("span",{className:"option-price"},E))}))))}re.getPricingSummary=function(t,e,n,a,l){const d=[],o=n(t),p=a(t),s=t.props.choices??{};return(e.selected??[]).forEach(m=>{const i=m;if(i===null)return;const b=s[i];if(!b)return;let f=b.label,r=0;if(o!==null){r=0;const c=new Date(o.start+"T00:00:00Z"),y=new Date(o.end+"T00:00:00Z");for(;o.count_mode==="nights"?c<y:c<=y;){const E=l(c);if(E!==null){const k=E.prices.addons?.[t.key],_=(k&&typeof k=="object"&&!("price"in k)?k[i]:null)?.price??null;r+=_??b.price}else r+=b.price;c.setDate(c.getDate()+1)}f+=o.label}else{let c=b.price;if(p!==null){const y=p.prices.addons?.[t.key],k=(y&&typeof y=="object"&&!("price"in y)?y[i]:null)?.price??null;k!=null&&(c=k)}r=c}d.push({label:f,amount:r})}),d};function ce({addon:t,value:e,onChange:n}){const a=t.props.choices??{},l=Object.values(a);u.useEffect(()=>{if(t.required&&e.selected.item===null&&l.length>0){const i=l[0];n({selected:{item:i.value,quantity:i.quantity?.enabled?i.quantity.min:1}})}},[t.required,e.selected.item,l,n]);const d=()=>!t._has_external_handler||e.selected.item!==null,o=i=>!t._has_external_handler||e.selected.item===i.value,p=u.useCallback(i=>{i&&e.selected.item!==i.value?n({selected:{item:i.value,quantity:i.quantity?.enabled?i.quantity.min:1}}):t.required||n({selected:{item:null,quantity:1}})},[t.required,e.selected.item,n]);u.useCallback(i=>{const b=e.selected.quantity;typeof b=="number"&&i.quantity?.enabled&&(b>i.quantity.max?n({selected:{item:e.selected.item,quantity:i.quantity.max}}):b<i.quantity.min&&n({selected:{item:e.selected.item,quantity:i.quantity.min}}))},[e.selected,n]);const s=u.useCallback(i=>{if(!i.quantity?.enabled)return;const b=e.selected.quantity;if(typeof b!="number")n({selected:{item:e.selected.item,quantity:i.quantity.min}});else{const f=b+1;f<i.quantity.min?n({selected:{item:e.selected.item,quantity:i.quantity.min}}):n({selected:{item:e.selected.item,quantity:Math.min(f,i.quantity.max)}})}},[e.selected,n]),g=u.useCallback(i=>{if(!i.quantity?.enabled)return;const b=e.selected.quantity;n(typeof b!="number"?{selected:{item:e.selected.item,quantity:i.quantity.min}}:{selected:{item:e.selected.item,quantity:Math.max(b-1,i.quantity.min)}})},[e.selected,n]),m=i=>i.price!=null&&i.price>0?`+${i.price.toLocaleString()}`:"";return d()?React.createElement("div",{className:"ts-form-group ts-addon-custom-select"},React.createElement("label",null,t.label),React.createElement("div",{className:"ts-custom-select-cards"},l.map(i=>{if(!o(i))return null;const b=e.selected.item===i.value,f=m(i),r=i.quantity?.enabled&&b;return React.createElement("div",{key:i.value,className:`ts-card-choice${b?" ts-selected":""}`,onClick:()=>p(i),role:"option","aria-selected":b},i.image&&React.createElement("div",{className:"ts-card-image"},React.createElement("img",{src:i.image,alt:i.label})),React.createElement("div",{className:"ts-card-content"},React.createElement("span",{className:"ts-card-label"},i.label),f&&React.createElement("span",{className:"ts-card-price"},f)),r&&React.createElement("div",{className:"ts-stepper-input",onClick:c=>c.stopPropagation()},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:()=>g(i),disabled:e.selected.quantity<=(i.quantity?.min??1)},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("span",{className:"ts-stepper-value"},e.selected.quantity),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:()=>s(i),disabled:e.selected.quantity>=(i.quantity?.max??999)},React.createElement("span",{className:"ts-icon"},"+"))))}))):null}ce.getPricingSummary=function(t,e,n,a,l){const{item:d,quantity:o}=e.selected;if(d===null)return null;const s=(t.props.choices??{})[d];if(!s)return null;let g=s.label;s.quantity?.enabled&&o>=1&&(g+=` × ${o}`);const m=n(t),i=a(t);let b=0;if(m!==null){const f=new Date(m.start+"T00:00:00Z"),r=new Date(m.end+"T00:00:00Z");for(;m.count_mode==="nights"?f<r:f<=r;){const c=l(f);if(c!==null){const y=c.prices.addons?.[t.key],k=(y&&typeof y=="object"&&!("price"in y)?y[d]:null)?.price??null;b+=k??s.price}else b+=s.price;f.setDate(f.getDate()+1)}s.quantity?.enabled&&(b*=o),g+=m.label}else{let f=s.price;if(i!==null){const r=i.prices.addons?.[t.key],y=(r&&typeof r=="object"&&!("price"in r)?r[d]:null)?.price??null;y!=null&&(f=y)}b=f,s.quantity?.enabled&&(b*=o)}return{label:g,amount:b}};function le({addon:t,value:e,onChange:n}){const a=t.props.choices??{},l=Object.values(a),d=e.selected??[],o=()=>!t._has_external_handler||d.length>0,p=r=>!t._has_external_handler||g(r),s=r=>d.findIndex(c=>c.item===r.value),g=r=>s(r)!==-1,m=u.useCallback(r=>{const c=s(r),y=[...d];c!==-1?y.splice(c,1):y.push({item:r.value,quantity:r.quantity?.min??1}),n({selected:y})},[d,n]);u.useCallback(r=>{const c=s(r);if(c===-1||!r.quantity?.enabled)return;const y=d[c].quantity;if(typeof y=="number"){const E=[...d];y>r.quantity.max?(E[c]={...E[c],quantity:r.quantity.max},n({selected:E})):y<r.quantity.min&&(E[c]={...E[c],quantity:r.quantity.min},n({selected:E}))}},[d,n]);const i=u.useCallback(r=>{const c=s(r);if(c===-1||!r.quantity?.enabled)return;const y=[...d],E=y[c].quantity;if(typeof E!="number")y[c]={...y[c],quantity:r.quantity.min};else{const k=E+1;k<r.quantity.min?y[c]={...y[c],quantity:r.quantity.min}:y[c]={...y[c],quantity:Math.min(k,r.quantity.max)}}n({selected:y})},[d,n]),b=u.useCallback(r=>{const c=s(r);if(c===-1||!r.quantity?.enabled)return;const y=[...d],E=y[c].quantity;typeof E!="number"?y[c]={...y[c],quantity:r.quantity.min}:y[c]={...y[c],quantity:Math.max(E-1,r.quantity.min)},n({selected:y})},[d,n]),f=r=>r.price!=null&&r.price>0?`+${r.price.toLocaleString()}`:"";return o()?React.createElement("div",{className:"ts-form-group ts-addon-custom-multiselect"},React.createElement("label",null,t.label),React.createElement("div",{className:"ts-custom-select-cards ts-multi"},l.map(r=>{if(!p(r))return null;const c=s(r),y=c!==-1,E=f(r),k=r.quantity?.enabled&&y,h=y?d[c].quantity:1;return React.createElement("div",{key:r.value,className:`ts-card-choice${y?" ts-selected":""}`,onClick:()=>m(r),role:"option","aria-selected":y},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:y,onChange:()=>{},tabIndex:-1}),React.createElement("span",{className:"checkmark"}))),r.image&&React.createElement("div",{className:"ts-card-image"},React.createElement("img",{src:r.image,alt:r.label})),React.createElement("div",{className:"ts-card-content"},React.createElement("span",{className:"ts-card-label"},r.label),E&&React.createElement("span",{className:"ts-card-price"},E)),k&&React.createElement("div",{className:"ts-stepper-input",onClick:_=>_.stopPropagation()},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:()=>b(r),disabled:h<=(r.quantity?.min??1)},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("span",{className:"ts-stepper-value"},h),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:()=>i(r),disabled:h>=(r.quantity?.max??999)},React.createElement("span",{className:"ts-icon"},"+"))))}))):null}le.getPricingSummary=function(t,e,n,a,l){const d=[],o=n(t),p=a(t),s=t.props.choices??{};return(e.selected??[]).forEach(m=>{const{item:i,quantity:b}=m;if(i===null)return;const f=s[i];if(!f)return;let r=f.label;f.quantity?.enabled&&b>=1&&(r+=` × ${b}`);let c=0;if(o!==null){let y=0;const E=new Date(o.start+"T00:00:00Z"),k=new Date(o.end+"T00:00:00Z");for(;o.count_mode==="nights"?E<k:E<=k;){const h=l(E);if(h!==null){const _=h.prices.addons?.[t.key],N=(_&&typeof _=="object"&&!("price"in _)?_[i]:null)?.price??null;y+=N??f.price}else y+=f.price;E.setDate(E.getDate()+1)}f.quantity?.enabled&&(y*=b),c=y,r+=o.label}else{let y=f.price;if(p!==null){const E=p.prices.addons?.[t.key],h=(E&&typeof E=="object"&&!("price"in E)?E[i]:null)?.price??null;h!=null&&(y=h)}c=y,f.quantity?.enabled&&(c*=b)}d.push({label:r,amount:c})}),d};function Te(t){return t?Array.isArray(t)?t:Object.entries(t).map(([e,n])=>({...n,key:n.key||e})):[]}const Ie=u.forwardRef(function({config:e,values:n,onValueChange:a,bookingValue:l,bookingRangeLength:d,searchContext:o},p){const s=e.props?.fields?.["form-addons"],g=u.useMemo(()=>Te(s?.props.addons),[s]),m=s?.props.l10n??{},i=e.settings?.product_mode??"regular",b=e.props?.custom_prices,f=u.useCallback(k=>{if(!b?.enabled||!b.list?.length)return null;const h=k.toISOString().split("T")[0],_=k.getUTCDay();for(const w of b.list)for(const N of w.conditions){if(N.type==="date"&&N.date===h)return w;if(N.type==="date_range"&&N.range){const C=new Date(N.range.from+"T00:00:00Z"),q=new Date(N.range.to+"T00:00:00Z");if(k>=C&&k<=q)return w}if(N.type==="day_of_week"&&N.days){const C=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];if(N.days.includes(C[_]))return w}}return null},[b]),r=u.useCallback(k=>{const h=e.props?.fields?.["form-booking"];if(i==="booking")return h&&["single_day","timeslots"].includes(h.props?.mode??"")&&l?.date?f(new Date(l.date+"T00:00:00Z")):null;if(i==="regular"){const _=e.props?.today?.date;if(_)return f(new Date(_+"T00:00:00Z"))}return null},[i,l,e.props,f]),c=u.useCallback(k=>{const h=e.props?.fields?.["form-booking"];if(!h||h.props?.mode!=="date_range"||!k.repeat||!l?.start_date||!l?.end_date)return null;const _=d??0;if(_<1)return null;const w=h.props?.count_mode??"nights";let N="";return _>1&&(w==="nights"?N=` (${(m.amount_nights??"@count nights").replace("@count",String(_))})`:N=` (${(m.amount_days??"@count days").replace("@count",String(_))})`),{length:_,label:N,start:l.start_date,end:l.end_date,count_mode:w}},[e.props,l,d,m]),y=u.useCallback(()=>{const k=[];return g.forEach(h=>{const _=n[h.key];if(!_)return;let w=null;switch(h.type){case"switcher":w=ne.getPricingSummary(h,_,c,r,f);break;case"numeric":w=ae.getPricingSummary(h,_,c,r,f);break;case"select":w=se.getPricingSummary(h,_,c,r,f);break;case"multiselect":w=re.getPricingSummary(h,_,c,r,f);break;case"custom-select":w=ce.getPricingSummary(h,_,c,r,f);break;case"custom-multiselect":w=le.getPricingSummary(h,_,c,r,f);break}w!==null&&(Array.isArray(w)?k.push(...w):k.push(w))}),k},[g,n,c,r,f]);u.useImperativeHandle(p,()=>({getPricingSummary:y}),[y]);const E=k=>{const h=n[k.key],_=N=>{a(k.key,N)},w={addon:k,getRepeatConfig:c,getCustomPrice:r,getCustomPriceForDate:f};switch(k.type){case"switcher":return React.createElement(ne,{key:k.key,...w,value:h??{enabled:!1},onChange:_,searchContext:o});case"numeric":return React.createElement(ae,{key:k.key,...w,value:h??{quantity:null},onChange:_,searchContext:o});case"select":return React.createElement(se,{key:k.key,...w,value:h??{selected:null},onChange:_});case"multiselect":return React.createElement(re,{key:k.key,...w,value:h??{selected:[]},onChange:_});case"custom-select":return React.createElement(ce,{key:k.key,...w,value:h??{selected:{item:null,quantity:1}},onChange:_});case"custom-multiselect":return React.createElement(le,{key:k.key,...w,value:h??{selected:[]},onChange:_});default:return null}};return g.length===0?null:React.createElement("div",{className:"ts-form-group ts-field-addons"},g.map(E))});function Be({maxQuantity:t,value:e,onChange:n,label:a="Quantity"}){const l=u.useCallback(()=>{if(typeof e!="number")n(1);else{const g=e+1;n(g<1?1:Math.min(g,t))}},[e,t,n]),d=u.useCallback(()=>{n(typeof e!="number"?1:Math.max(e-1,1))},[e,n]),o=u.useCallback(()=>{typeof e=="number"&&(e>t?n(t):e<1&&n(1))},[e,t,n]),p=u.useCallback(g=>{const m=parseInt(g.target.value,10);isNaN(m)||n(m)},[n]),s=e??1;return React.createElement("div",{className:"ts-form-group ts-field-quantity"},React.createElement("label",null,a),React.createElement("div",{className:"ts-stepper-input"},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:d,disabled:s<=1},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("input",{type:"number",value:s,onChange:p,onBlur:o,min:1,max:t,className:"ts-stepper-value"}),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:l,disabled:s>=t},React.createElement("span",{className:"ts-icon"},"+"))))}function Oe({attribute:t,allAttributes:e,variations:n,selections:a,stockEnabled:l,onSelect:d}){const[o,p]=u.useState(!1),s=Object.values(t.props.choices),g=u.useCallback(()=>Object.values(n).filter(k=>{for(const h of e){if(h.key===t.key)break;if(a[h.key]!==k.attributes[h.key])return!1}return!0}),[n,e,t.key,a]);u.useMemo(()=>{const k=g();return s.filter(h=>k.find(_=>_.attributes[t.key]===h.value))},[s,g,t.key]);const m=u.useCallback(k=>{const _=g().filter(N=>N.attributes[t.key]===k.value);return _.length?l?_.find(N=>N._status==="active")?"active":"out_of_stock":"active":"inactive"},[g,t.key,l]),i=u.useCallback(k=>a[t.key]===k.value,[a,t.key]),b=u.useCallback(k=>{m(k)!=="inactive"&&(d(t.key,k.value),p(!1))},[t.key,d,m]),f=u.useMemo(()=>{const k=a[t.key];return s.find(_=>_.value===k)?.label??"Select"},[a,t.key,s]),r=()=>React.createElement("div",{className:"ts-form-group ts-variation-attribute ts-variation-dropdown"},React.createElement("label",null,t.label),React.createElement("div",{className:`ts-filter ts-popup-target${a[t.key]?" ts-filled":""}`,onClick:()=>p(!o),role:"button",tabIndex:0,onKeyDown:k=>k.key==="Enter"&&p(!o)},React.createElement("span",{className:"ts-filter-text"},f),React.createElement("div",{className:"ts-down-icon"})),o&&React.createElement("div",{className:"ts-popup-list"},React.createElement("ul",{className:"simplify-ul ts-form-options"},s.map(k=>{const h=m(k),_=i(k);return React.createElement("li",{key:k.value,className:`ts-option${_?" ts-selected":""}${h==="inactive"?" ts-inactive":""}${h==="out_of_stock"?" ts-out-of-stock":""}`,onClick:()=>b(k),role:"option","aria-selected":_,"aria-disabled":h==="inactive"},React.createElement("span",{className:"option-label"},k.label),h==="out_of_stock"&&React.createElement("span",{className:"option-status"},"Out of stock"))})))),c=()=>React.createElement("div",{className:"ts-form-group ts-variation-attribute ts-variation-buttons"},React.createElement("label",null,t.label),React.createElement("div",{className:"ts-variation-options ts-buttons-list"},s.map(k=>{const h=m(k),_=i(k);return React.createElement("button",{key:k.value,type:"button",className:`ts-btn ts-btn-4${_?" ts-selected":""}${h==="inactive"?" ts-inactive":""}${h==="out_of_stock"?" ts-out-of-stock":""}`,onClick:()=>b(k),disabled:h==="inactive"},k.label)}))),y=()=>React.createElement("div",{className:"ts-form-group ts-variation-attribute ts-variation-images"},React.createElement("label",null,t.label),React.createElement("div",{className:"ts-variation-options ts-images-list"},s.map(k=>{const h=m(k),_=i(k);return React.createElement("div",{key:k.value,className:`ts-variation-image${_?" ts-selected":""}${h==="inactive"?" ts-inactive":""}${h==="out_of_stock"?" ts-out-of-stock":""}`,onClick:()=>b(k),role:"button",tabIndex:h==="inactive"?-1:0,title:k.label},k.image?React.createElement("img",{src:k.image,alt:k.label}):React.createElement("span",{className:"ts-image-placeholder"},k.label.charAt(0)))}))),E=()=>React.createElement("div",{className:"ts-form-group ts-variation-attribute ts-variation-colors"},React.createElement("label",null,t.label),React.createElement("div",{className:"ts-variation-options ts-colors-list"},s.map(k=>{const h=m(k),_=i(k);return React.createElement("div",{key:k.value,className:`ts-variation-color${_?" ts-selected":""}${h==="inactive"?" ts-inactive":""}${h==="out_of_stock"?" ts-out-of-stock":""}`,onClick:()=>b(k),role:"button",tabIndex:h==="inactive"?-1:0,title:k.label,style:{backgroundColor:k.color||"#ccc"}},_&&React.createElement("span",{className:"ts-color-check"},"✓"))})));switch(t.display_type){case"buttons":return c();case"images":return y();case"colors":return E();default:return r()}}function oe({field:t,value:e,onChange:n}){const[a,l]=u.useState(()=>({...t.props.selections})),d=u.useMemo(()=>Object.values(t.props.attributes),[t.props.attributes]),o=t.props.variations,p=t.props.stock?.enabled??!1,s=u.useMemo(()=>e.variation_id?o[e.variation_id]??null:null,[e.variation_id,o]),g=u.useCallback(()=>{if(s)if(p&&s.config.stock.enabled&&!s.config.stock.sold_individually){const h=s.config.stock.quantity;e.quantity>h?n({...e,quantity:h}):e.quantity<1&&n({...e,quantity:1})}else e.quantity!==1&&n({...e,quantity:1})},[s,p,e,n]),m=u.useCallback(()=>{let h=null;const _=Object.values(o).filter(w=>w._status==="active");for(const w of Object.keys(a)){const N=_.filter(C=>{for(const q of Object.keys(a))if(C.attributes[q]!==a[q])return!1;return!0});if(N.length){h=N[0];break}}if(!h&&_.length){h=_[0];const w={};Object.keys(a).forEach(N=>{w[N]=h.attributes[N]}),l(w)}if(h&&(e.variation_id!==h.id&&n({...e,variation_id:h.id}),h.image)){const w=document.getElementById("ts-media-"+h.image.id);w?.parentElement&&(w.parentElement.scrollLeft=w.offsetLeft)}},[o,a,e,n]),i=u.useCallback(()=>{for(const h of Object.values(o))if(h._status==="active"){const _={};Object.keys(a).forEach(w=>{_[w]=h.attributes[w]}),l(_),n({...e,variation_id:h.id});break}},[o,a,e,n]),b=u.useCallback((h,_)=>{l(w=>({...w,[h]:_}))},[]);u.useEffect(()=>{m()},[a]),u.useEffect(()=>{s&&g()},[s]),u.useEffect(()=>{e.variation_id||i()},[]);const f=u.useCallback(()=>{if(!s)return;const h=s.config.stock.quantity;if(typeof e.quantity!="number")n({...e,quantity:1});else{const _=e.quantity+1;n({...e,quantity:_<1?1:Math.min(_,h)})}},[s,e,n]),r=u.useCallback(()=>{typeof e.quantity!="number"?n({...e,quantity:1}):n({...e,quantity:Math.max(e.quantity-1,1)})},[e,n]),c=u.useCallback(h=>{const _=parseInt(h.target.value,10);isNaN(_)||n({...e,quantity:_})},[e,n]),y=u.useCallback(()=>{if(!s)return;const h=s.config.stock.quantity;typeof e.quantity=="number"&&(e.quantity>h?n({...e,quantity:h}):e.quantity<1&&n({...e,quantity:1}))},[s,e,n]),E=s&&p&&s.config.stock.enabled&&!s.config.stock.sold_individually,k=s?.config.stock.quantity??1;return d.length===0?null:React.createElement("div",{className:"ts-field-variations"},d.map(h=>React.createElement(Oe,{key:h.key,attribute:h,allAttributes:d,variations:o,selections:a,stockEnabled:p,onSelect:b})),E&&React.createElement("div",{className:"ts-form-group ts-variation-quantity"},React.createElement("label",null,"Quantity"),React.createElement("div",{className:"ts-stepper-input"},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:r,disabled:e.quantity<=1},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("input",{type:"number",value:e.quantity,onChange:c,onBlur:y,min:1,max:k,className:"ts-stepper-value"}),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:f,disabled:e.quantity>=k},React.createElement("span",{className:"ts-icon"},"+")))))}oe.getPricingSummary=function(t,e){if(!e.variation_id)return null;const n=t.props.variations[e.variation_id];if(!n)return null;const a=n.config.base_price;let l=a.discount_amount!=null?a.discount_amount:a.amount,d=null;(t.props.stock?.enabled??!1)&&n.config.stock.enabled&&!n.config.stock.sold_individually&&(d=e.quantity,l*=e.quantity);const p=[];return Object.keys(n.attributes).forEach(s=>{const g=n.attributes[s],m=t.props.attributes[s];if(m){const i=m.props.choices["choice_"+g];i&&p.push(i.label)}}),{label:p.join(" / "),amount:l,quantity:d}};function X(t){const e=u.useRef(null),n=u.useRef(null),a=u.useRef(t);a.current=t,u.useEffect(()=>{if(!e.current||typeof window.Pikaday>"u")return;const f={field:e.current,bound:a.current.bound??!0,format:a.current.format??"YYYY-MM-DD",minDate:a.current.minDate,maxDate:a.current.maxDate,defaultDate:a.current.defaultDate,setDefaultDate:!!a.current.defaultDate,disableDayFn:a.current.disableDayFn,numberOfMonths:a.current.numberOfMonths??1,showDaysInNextAndPreviousMonths:!0,enableSelectionDaysInNextAndPreviousMonths:!1,firstDay:1,onSelect:r=>{a.current.onSelect?.(r)},onDraw:r=>{a.current.onDraw?.(r)},dayRenderHook:a.current.dayRenderHook};return a.current.container&&(f.container=a.current.container,f.bound=!1),n.current=new window.Pikaday(f),()=>{n.current?.destroy(),n.current=null}},[]),u.useEffect(()=>{n.current&&t.minDate&&n.current.setMinDate(t.minDate)},[t.minDate]),u.useEffect(()=>{n.current&&t.maxDate&&n.current.setMaxDate(t.maxDate)},[t.maxDate]);const l=u.useCallback(f=>{n.current?.setDate(f,!0)},[]),d=u.useCallback(()=>n.current?.getDate()??null,[]),o=u.useCallback(()=>{n.current?.show()},[]),p=u.useCallback(()=>{n.current?.hide()},[]),s=u.useCallback(f=>{n.current?.gotoDate(f)},[]),g=u.useCallback(()=>{n.current?.draw(!0)},[]),m=u.useCallback(f=>{n.current?.setStartRange(f)},[]),i=u.useCallback(f=>{n.current?.setEndRange(f)},[]),b=u.useCallback(()=>n.current?.el??null,[]);return{inputRef:e,pickerRef:n,setDate:l,getDate:d,setStartRange:m,setEndRange:i,show:o,hide:p,gotoDate:s,redraw:g,getPickerElement:b}}function L(t){const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${a}`}function D(t){return new Date(t+"T00:00:00")}function ke(t){return["sun","mon","tue","wed","thu","fri","sat"][t.getDay()]}function Me(t,e){const n=L(t);return e.includes(n)}function Ae(t,e){const n=ke(t);return e.includes(n)}function Le(t,e){const n=D(e.date);return t<n}function Ve(t,e,n){if(!n||n.amount<=0)return!1;const a=D(e.date);if(n.unit==="hours"){const[l,d]=e.time.split(":").map(Number);a.setHours(l,d,0,0);const o=n.amount*60*60*1e3;return t.getTime()-a.getTime()<o}else{const l=new Date(a);return l.setDate(l.getDate()+n.amount),t<l}}function Fe(t,e,n){const a=D(e.date),l=new Date(a);return l.setDate(l.getDate()+n),t>l}function je(t,e){const{excluded_days:n=[],excluded_weekdays:a=[],availability:l,today:d}=e.props;return!(Me(t,n)||Ae(t,a)||d&&(Le(t,d)||Ve(t,d,l?.buffer)||l?.max_days&&Fe(t,d,l.max_days)))}function Qe(t,e){const{timeslots:n,quantity_per_slot:a=1,booked_slot_counts:l={}}=e.props;if(!n?.groups)return[];const d=ke(t),o=L(t),p=[];for(const s of n.groups)if(s.days.includes(d))for(const g of s.slots){const m=`${g.from}-${g.to}`,i=`${o} ${m}`,b=l[i]||0,f=Math.max(0,a-b);p.push({...g,key:m,label:`${g.from} - ${g.to}`,available:f,booked:b,isAvailable:f>0})}return p}function H(t,e,n){const a=D(t),d=D(e).getTime()-a.getTime(),o=Math.ceil(d/(1e3*60*60*24));return n==="nights"?o:o+1}function He(t,e,n){const{count_mode:a="nights",date_range:l,l10n:d}=n.props,o=H(t,e,a);if(!l)return{valid:!0,length:o};const{min_length:p=1,max_length:s=365}=l;if(o<p||o>s){const g=a==="nights"?d?.nights_range_error??"Min @minlength, max @maxlength nights":d?.days_range_error??"Min @minlength, max @maxlength days";return{valid:!1,length:o,error:g.replace("@minlength",String(p)).replace("@maxlength",String(s))}}return{valid:!0,length:o}}function ie(t,e,n){return e==="nights"?t===1?n?.one_night??"1 night":(n?.multiple_nights??"@count nights").replace("@count",String(t)):t===1?n?.one_day??"1 day":(n?.multiple_days??"@count days").replace("@count",String(t))}function ue(t){const{today:e,availability:n}=t.props;if(!e)return new Date;const a=D(e.date);if(n?.buffer)if(n.buffer.unit==="days")a.setDate(a.getDate()+n.buffer.amount);else{const[l]=e.time.split(":").map(Number);l+n.buffer.amount>=24&&a.setDate(a.getDate()+1)}return a}function de(t){const{today:e,availability:n}=t.props;if(!e){const l=new Date;return l.setFullYear(l.getFullYear()+1),l}const a=D(e.date);return a.setDate(a.getDate()+(n?.max_days??365)),a}function me(t){return e=>!je(e,t)}function x(t){return typeof window<"u"&&window.Voxel?.helpers?.currencyFormat?window.Voxel.helpers.currencyFormat(t):new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)}function Ue(t){if(typeof window<"u"&&window.Voxel?.helpers?.dateFormatYmd)return window.Voxel.helpers.dateFormatYmd(t);const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${a}`}function Ee(t,e){const n=e.props?.custom_prices;if(!n?.enabled||!n.list?.length)return null;const a=Ue(t);return n.list.find(d=>{for(const o of d.conditions)if(o.type==="date"){if(o.date===a)return!0}else if(o.type==="date_range"){if(o.range){const p=new Date(o.range.from+"T00:00:00Z"),s=new Date(o.range.to+"T00:00:00Z"),g=new Date(a+"T00:00:00Z");if(p<=g&&g<=s)return!0}}else if(o.type==="day_of_week"){const p=new Date(a+"T00:00:00Z"),g=["sun","mon","tue","wed","thu","fri","sat"][p.getDay()];if(o.days?.includes(g))return!0}return!1})??null}function pe(t,e){const n=e.props?.minimum_price??0;if(!e.props?.custom_prices?.enabled||t===null)return n;const a=Ee(t,e);return a===null?n:a.minimum_price??n}function Ze(t){const e=t.props?.base_price;if(!e?.enabled)return null;let n=e.discount_amount??e.amount;if(t.settings?.product_mode==="regular"){const a=t.props?.today?.date;if(a){const l=Ee(new Date(a+"T00:00:00Z"),t);l?.prices?.base_price&&(n=l.prices.base_price.discount_amount??l.prices.base_price.amount)}}return{label:"Price",amount:n}}function Ye(t,e){return t.props?.fields?.["form-quantity"]&&e>1?e:1}function fe(t){return t.reduce((e,n)=>e+(n.amount??0),0)}function ze(t){const{config:e,quantity:n,bookingValue:a,getAddonsPricingSummary:l,getVariationsPricingSummary:d}=t,o=u.useCallback(()=>{if(!e)return{visible_items:[],total:0,formatted_total:x(0)};const m=[],i=Ze(e),b=l?.()??null,f=Ye(e,n);i!==null&&m.push({key:"base_price",...i,hidden:b===null||b.length===0}),b!==null&&b.forEach((E,k)=>{m.push({key:`addon_${k}`,...E})}),f>1&&m.push({key:"quantity",label:e.l10n?.quantity??"Quantity",amount:0,value:f});let r=fe(m);r*=f;const c={key:"total",label:"Total",price:r,formatted_price:x(r)},y=m.filter(E=>!E.hidden).map(E=>({key:E.key,label:E.label,price:E.amount,formatted_price:E.value!==void 0?`× ${E.value}`:x(E.amount)}));return y.push(c),{visible_items:y,total:r,formatted_total:x(r)}},[e,n,l]),p=u.useCallback(()=>{if(!e)return{visible_items:[],total:0,formatted_total:x(0)};const m=[],i=d?.()??null;i!==null&&(m.push({key:"variation",label:i.label,amount:i.amount}),i.quantity&&i.quantity>1&&m.push({key:"quantity",label:e.l10n?.quantity??"Quantity",amount:0,value:i.quantity}));const b=fe(m),f={key:"total",label:"Total",price:b,formatted_price:x(b)},r=m.filter(c=>!c.hidden).map(c=>({key:c.key,label:c.label,price:c.amount,formatted_price:c.value!==void 0?`× ${c.value}`:x(c.amount)}));return r.push(f),{visible_items:r,total:b,formatted_total:x(b)}},[e,d]),s=u.useCallback(()=>{if(!e)return{visible_items:[],total:0,formatted_total:x(0)};const m=[],i=e.props?.fields?.["form-booking"],b=i?W.getPricingSummary(i,a,e):null,f=l?.()??null;b!==null&&(m.push({key:"booking",label:b.label,amount:b.amount,hidden:b.amount===0}),f!==null&&f.forEach((E,k)=>{m.push({key:`addon_${k}`,...E})}));const r=fe(m),c={key:"total",label:"Total",price:r,formatted_price:x(r)},y=m.filter(E=>!E.hidden).map(E=>({key:E.key,label:E.label,price:E.amount,formatted_price:x(E.amount)}));return(r>0||y.length>0)&&y.push(c),{visible_items:y,total:r,formatted_total:x(r)}},[e,a,l]);return{summary:u.useMemo(()=>{if(!e)return{visible_items:[],total:0,formatted_total:x(0)};switch(e.settings?.product_mode??"regular"){case"regular":return o();case"variable":return p();case"booking":return s();default:return{visible_items:[],total:0,formatted_total:x(0)}}},[e,o,p,s]),formatPrice:x}}const he=1440*60*1e3;function We(t){if(t)return(e,n)=>{if(e.isDisabled)return;const a=new Date(e.year,e.month,e.day),l=pe(a,t);if(l>0){const d=`<div class="pika-tooltip">${x(l)}</div>`;n.beforeCloseTd+=d}}}function _e({field:t,value:e,onChange:n,initialAvailability:a,config:l}){const[d,o]=u.useState("start"),[p,s]=u.useState(null),[g,m]=u.useState(!1),[i,b]=u.useState(null),f=u.useRef(null),r=u.useRef(null),{count_mode:c="nights",l10n:y}=t.props;u.useEffect(()=>{g||a?.start&&(e.start_date||e.end_date||(m(!0),n({...e,start_date:a.start,end_date:a.end||a.start})))},[a,g,e,n]);const E=u.useMemo(()=>ue(t),[t]),k=u.useMemo(()=>de(t),[t]),h=u.useMemo(()=>me(t),[t]),_=u.useMemo(()=>!e.start_date||!e.end_date?null:He(e.start_date,e.end_date,t),[e.start_date,e.end_date,t]);u.useEffect(()=>{_&&!_.valid?s(_.error??null):s(null)},[_]);const w=u.useCallback(R=>{const v=L(R);e.end_date&&v>=e.end_date?n({...e,start_date:v,end_date:null}):n({...e,start_date:v}),o("end")},[e,n]),N=u.useCallback(R=>{const v=L(R);e.start_date&&v<=e.start_date?n({...e,start_date:v,end_date:e.start_date}):n({...e,end_date:v}),o("start")},[e,n]),C=u.useCallback((R,v)=>{if(!e.start_date||e.end_date||!v)return;const V=R.target,M=V.tagName==="TD"?V:V.closest("td");if(!M||M.classList.contains("is-empty")||M.classList.contains("is-disabled"))return;const F=M.querySelector(".pika-button");if(!F||F.disabled)return;M.classList.add("is-endrange");const P=parseInt(F.getAttribute("data-pika-year")??"0",10),j=parseInt(F.getAttribute("data-pika-month")??"0",10),Y=parseInt(F.getAttribute("data-pika-day")??"0",10),ee=new Date(P,j,Y);b(new Date(ee.getTime()));const te=D(e.start_date);let Q=new Date(ee.getTime()-he);for(;Q>te;){const ge=[`.pika-button[data-pika-year="${Q.getFullYear()}"]`,`[data-pika-month="${Q.getMonth()}"]`,`[data-pika-day="${Q.getDate()}"]`].join(""),xe=v.querySelector(ge);xe?.parentElement&&xe.parentElement.classList.add("is-inrange"),Q.setTime(Q.getTime()-he)}M.addEventListener("mouseleave",()=>{Array.from(v.querySelectorAll("td.is-inrange:not(.is-disabled)")).forEach(ge=>ge.classList.remove("is-inrange")),M.classList.remove("is-endrange"),b(null)},{once:!0})},[e.start_date,e.end_date]),q=u.useMemo(()=>We(l??null),[l]),I=u.useCallback(R=>{R.el.addEventListener("mouseover",v=>C(v,R.el))},[C]),S=u.useCallback(R=>{R.el.addEventListener("mouseover",v=>C(v,R.el))},[C]),T=X({onSelect:w,onDraw:I,minDate:E,maxDate:k,defaultDate:e.start_date?D(e.start_date):void 0,disableDayFn:h,dayRenderHook:q,container:f.current,bound:!1,startRange:e.start_date?D(e.start_date):null,endRange:e.end_date?D(e.end_date):null}),B=u.useMemo(()=>{if(!e.start_date)return E;const R=D(e.start_date);return R.setDate(R.getDate()+1),R>E?R:E},[e.start_date,E]),O=X({onSelect:N,onDraw:S,minDate:B,maxDate:k,defaultDate:e.end_date?D(e.end_date):void 0,disableDayFn:h,dayRenderHook:q,container:r.current,bound:!1,startRange:e.start_date?D(e.start_date):null,endRange:e.end_date?D(e.end_date):null});u.useEffect(()=>{if(e.start_date){const R=D(e.start_date);T.setDate(e.start_date),T.setStartRange(R),O.setStartRange(R)}else T.setStartRange(null),O.setStartRange(null)},[e.start_date]),u.useEffect(()=>{if(e.end_date){const R=D(e.end_date);O.setDate(e.end_date),T.setEndRange(R),O.setEndRange(R)}else T.setEndRange(null),O.setEndRange(null)},[e.end_date]),u.useEffect(()=>{b(null)},[e.start_date]);const J=y?.select_start_and_end_date??"Select start date",A=y?.select_end_date??"Select end date",Z=c==="nights"?y?.select_nights??"Select nights":y?.select_days??"Select days",K=u.useMemo(()=>{if(!e.start_date)return Z;if(e.end_date){const R=H(e.start_date,e.end_date,c),v=ie(R,c,y);return`${e.start_date} - ${e.end_date} (${v})`}if(i){const R=L(i),v=H(e.start_date,R,c),V=ie(v,c,y);return`${e.start_date} - ${R} (${V})`}return`${e.start_date} - ${y?.select_end_date??"..."}`},[e.start_date,e.end_date,i,c,y,Z]);return React.createElement("div",{className:"ts-form-group ts-booking-field ts-booking-date-range"},React.createElement("label",null,c==="nights"?"Dates":"Days"),React.createElement("div",{className:`ts-filter ts-popup-target${e.start_date?" ts-filled":""}`},React.createElement("span",{className:"ts-filter-text"},K),React.createElement("div",{className:"ts-down-icon"})),React.createElement("div",{className:"ts-booking-calendars"},React.createElement("div",{className:"ts-booking-calendar ts-booking-start"},React.createElement("div",{className:"ts-calendar-label"},J),React.createElement("div",{ref:f,className:`ts-calendar-container${d==="start"?" ts-active":""}`},React.createElement("input",{ref:T.inputRef,type:"hidden",readOnly:!0}))),React.createElement("div",{className:"ts-booking-calendar ts-booking-end"},React.createElement("div",{className:"ts-calendar-label"},A),React.createElement("div",{ref:r,className:`ts-calendar-container${d==="end"?" ts-active":""}`},React.createElement("input",{ref:O.inputRef,type:"hidden",readOnly:!0})))),p&&React.createElement("div",{className:"ts-field-error"},React.createElement("span",null,p)))}_e.getSelectedRangeLength=function(t,e){return!t.start_date||!t.end_date?0:H(t.start_date,t.end_date,e.props.count_mode??"nights")};function Ge(t,e){if(!t||!e)return;t.querySelectorAll(".pika-button").forEach(a=>{const l=a,d=l.dataset,o=parseInt(d.pikaYear??"0",10),p=parseInt(d.pikaMonth??"0",10),s=parseInt(d.pikaDay??"0",10);if(o&&s){const g=new Date(o,p,s),m=pe(g,e);m>0&&l.setAttribute("title",x(m))}})}function Je({field:t,value:e,onChange:n,initialAvailability:a,config:l}){const d=u.useRef(null),[o,p]=u.useState(!1),{l10n:s}=t.props;u.useEffect(()=>{o||a?.start&&(e.date||(p(!0),n({...e,date:a.start})))},[a,o,e,n]);const g=u.useMemo(()=>ue(t),[t]),m=u.useMemo(()=>de(t),[t]),i=u.useMemo(()=>me(t),[t]),b=u.useCallback(E=>{n({...e,date:L(E)})},[e,n]),f=u.useCallback(()=>{Ge(d.current,l??null)},[l]),r=X({onSelect:b,onDraw:f,minDate:g,maxDate:m,defaultDate:e.date?D(e.date):void 0,disableDayFn:i,container:d.current,bound:!1});u.useEffect(()=>{e.date&&r.setDate(e.date)},[e.date]);const c=s?.select_date??"Select date",y=e.date??c;return React.createElement("div",{className:"ts-form-group ts-booking-field ts-booking-single-day"},React.createElement("label",null,"Date"),React.createElement("div",{className:`ts-filter ts-popup-target${e.date?" ts-filled":""}`},React.createElement("span",{className:"ts-filter-text"},y),React.createElement("div",{className:"ts-down-icon"})),React.createElement("div",{className:"ts-booking-calendars"},React.createElement("div",{className:"ts-booking-calendar"},React.createElement("div",{ref:d,className:"ts-calendar-container ts-active"},React.createElement("input",{ref:r.inputRef,type:"hidden",readOnly:!0})))))}function Ke(t,e){if(!t||!e)return;t.querySelectorAll(".pika-button").forEach(a=>{const l=a,d=l.dataset,o=parseInt(d.pikaYear??"0",10),p=parseInt(d.pikaMonth??"0",10),s=parseInt(d.pikaDay??"0",10);if(o&&s){const g=new Date(o,p,s),m=pe(g,e);m>0&&l.setAttribute("title",x(m))}})}function Xe({field:t,value:e,onChange:n,initialAvailability:a,config:l}){const d=u.useRef(null),[o,p]=u.useState(!1),[s,g]=u.useState(!1),{l10n:m,quantity_per_slot:i=1}=t.props;u.useEffect(()=>{s||a?.start&&(e.date||(g(!0),n({...e,date:a.start})))},[a,s,e,n]);const b=u.useMemo(()=>ue(t),[t]),f=u.useMemo(()=>de(t),[t]),r=u.useMemo(()=>me(t),[t]),c=u.useMemo(()=>{if(!e.date)return[];const S=D(e.date);return Qe(S,t)},[e.date,t]),y=u.useCallback(S=>{const T=L(S);n({...e,date:T,slot:null}),p(!0)},[e,n]),E=u.useCallback(S=>{S.isAvailable&&(n({...e,slot:S.key}),p(!1))},[e,n]),k=u.useCallback(()=>{Ke(d.current,l??null)},[l]),h=X({onSelect:y,onDraw:k,minDate:b,maxDate:f,defaultDate:e.date?D(e.date):void 0,disableDayFn:r,container:d.current,bound:!1});u.useEffect(()=>{e.date&&h.setDate(e.date)},[e.date]);const _=m?.select_date??"Select date",w=m?.select_timeslot??"Select time",N=m?.no_slots_available??"No time slots available",C=m?.amount_available??"@count available",q=e.date??_,I=u.useMemo(()=>e.slot?c.find(T=>T.key===e.slot)?.label??e.slot:w,[e.slot,c,w]);return React.createElement("div",{className:"ts-form-group ts-booking-field ts-booking-timeslots"},React.createElement("div",{className:"ts-booking-date-section"},React.createElement("label",null,"Date"),React.createElement("div",{className:`ts-filter ts-popup-target${e.date?" ts-filled":""}`},React.createElement("span",{className:"ts-filter-text"},q),React.createElement("div",{className:"ts-down-icon"})),React.createElement("div",{className:"ts-booking-calendars"},React.createElement("div",{className:"ts-booking-calendar"},React.createElement("div",{ref:d,className:"ts-calendar-container ts-active"},React.createElement("input",{ref:h.inputRef,type:"hidden",readOnly:!0}))))),e.date&&React.createElement("div",{className:"ts-booking-slots-section"},React.createElement("label",null,"Time"),React.createElement("div",{className:`ts-filter ts-popup-target${e.slot?" ts-filled":""}`,onClick:()=>p(!o),role:"button",tabIndex:0,onKeyDown:S=>S.key==="Enter"&&p(!o)},React.createElement("span",{className:"ts-filter-text"},I),React.createElement("div",{className:"ts-down-icon"})),o&&React.createElement("div",{className:"ts-popup-list ts-timeslot-list"},c.length===0?React.createElement("div",{className:"ts-no-slots"},React.createElement("span",null,N)):React.createElement("ul",{className:"simplify-ul ts-form-options"},c.map(S=>React.createElement("li",{key:S.key,className:`ts-option${e.slot===S.key?" ts-selected":""}${S.isAvailable?"":" ts-unavailable"}`,onClick:()=>E(S),role:"option","aria-selected":e.slot===S.key,"aria-disabled":!S.isAvailable},React.createElement("span",{className:"ts-slot-time"},S.label),i>1&&React.createElement("span",{className:"ts-slot-availability"},S.isAvailable?C.replace("@count",String(S.available)):"Fully booked")))))))}function W({field:t,value:e,onChange:n,config:a,initialAvailability:l}){switch(t.props.mode){case"date_range":return React.createElement(_e,{field:t,value:e,onChange:n,initialAvailability:l,config:a});case"single_day":return React.createElement(Je,{field:t,value:e,onChange:n,initialAvailability:l,config:a});case"timeslots":return React.createElement(Xe,{field:t,value:e,onChange:n,initialAvailability:l,config:a});default:return null}}W.getPricingSummary=function(t,e,n){const{mode:a,count_mode:l="nights",l10n:d}=t.props,o=n?.props?.base_price;if(!o?.enabled)return null;const p=o.discount_amount??o.amount;let s=p,g=d?.booking_price??"Booking";if(a==="date_range"){if(!e.start_date||!e.end_date)return null;const m=H(e.start_date,e.end_date,l);if(m<1)return null;s=p*m,g=ie(m,l,d)}else if(a==="single_day"){if(!e.date)return null}else if(a==="timeslots"&&(!e.date||!e.slot))return null;return{label:g,amount:s,hidden:s===0}},W.isComplete=function(t,e){const{mode:n}=t.props;switch(n){case"date_range":return!!e.start_date&&!!e.end_date;case"single_day":return!!e.date;case"timeslots":return!!e.date&&!!e.slot;default:return!1}},W.getSelectedRangeLength=function(t,e){return t.props.mode!=="date_range"?1:!e.start_date||!e.end_date?0:H(e.start_date,e.end_date,t.props.count_mode??"nights")};function we(t){return t?.value?t.library==="line-awesome"||t.value.startsWith("la-")?React.createElement("i",{className:`las ${t.value}`}):React.createElement("i",{className:`las ${t.value}`}):null}function $e({dataInput:t,value:e,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"text",className:"ts-filter",value:e||"",onChange:a=>n(a.target.value),placeholder:t.props.placeholder,minLength:t.props.minlength,maxLength:t.props.maxlength})))}function et({dataInput:t,value:e,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"input-container"},React.createElement("textarea",{className:"ts-filter min-scroll",value:e||"",onChange:a=>n(a.target.value),placeholder:t.props.placeholder,minLength:t.props.minlength,maxLength:t.props.maxlength})))}function tt({dataInput:t,value:e,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"email",className:"ts-filter",value:e||"",onChange:a=>n(a.target.value),placeholder:t.props.placeholder})))}function nt({dataInput:t,value:e,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"tel",className:"ts-filter",value:e||"",onChange:a=>n(a.target.value),placeholder:t.props.placeholder})))}function at({dataInput:t,value:e,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"url",className:"ts-filter",value:e||"",onChange:a=>n(a.target.value),placeholder:t.props.placeholder})))}function st({dataInput:t,value:e,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"date",className:"ts-filter",value:e||"",onChange:a=>n(a.target.value),placeholder:t.props.placeholder,style:{display:"block"}})))}function rt({dataInput:t,value:e,onChange:n}){return React.createElement("div",{className:"ts-form-group switcher-label"},React.createElement("label",null,React.createElement("div",{className:"switch-slider"},React.createElement("div",{className:"onoffswitch"},React.createElement("input",{type:"checkbox",className:"onoffswitch-checkbox",checked:e||!1,onChange:a=>n(a.target.checked)}),React.createElement("label",{className:"onoffswitch-label",onClick:a=>{a.preventDefault(),n(!e)}}))),t.label))}function ct({dataInput:t,value:e,onChange:n,icons:a}){const{min:l=0,max:d=999999,display_mode:o="default"}=t.props,p=u.useCallback(i=>i===null?null:i<l?l:i>d?d:i,[l,d]),s=u.useCallback(()=>{const b=p((typeof e=="number"?e:l)+1);n(b)},[e,l,p,n]),g=u.useCallback(()=>{const b=p((typeof e=="number"?e:l)-1);n(b)},[e,l,p,n]),m=u.useCallback(i=>{const b=i.target.value===""?null:parseInt(i.target.value,10);n(p(b))},[p,n]);return o==="stepper"?React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"ts-stepper-input flexify"},React.createElement("button",{className:`ts-stepper-left ts-icon-btn${(e??0)<=l?" vx-disabled":""}`,onClick:i=>{i.preventDefault(),g()},type:"button"},we(a?.minusIcon)||React.createElement("i",{className:"las la-minus"})),React.createElement("input",{type:"number",className:"ts-input-box",value:e??"",onChange:m,placeholder:t.props.placeholder}),React.createElement("button",{className:`ts-stepper-right ts-icon-btn${(e??0)>=d?" vx-disabled":""}`,onClick:i=>{i.preventDefault(),s()},type:"button"},we(a?.plusIcon)||React.createElement("i",{className:"las la-plus"})))):React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"number",className:"ts-filter",value:e??"",onChange:m,placeholder:t.props.placeholder,min:l,max:d})))}function lt({dataInput:t,value:e,onChange:n}){const{display_mode:a="default",choices:l={},placeholder:d,l10n:o}=t.props,p=u.useMemo(()=>Object.values(l),[l]),s=u.useCallback(m=>e===m.value,[e]),g=u.useCallback(m=>{e===m.value?n(null):n(m.value)},[e,n]);return a==="buttons"?React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("ul",{className:"simplify-ul addon-buttons flexify"},p.map(m=>React.createElement("li",{key:m.value,className:`flexify${s(m)?" adb-selected":""}`,onClick:i=>{i.preventDefault(),g(m)}},m.label)))):a==="radio"?React.createElement("div",{className:"ts-form-group inline-terms-wrapper ts-inline-filter"},React.createElement("label",null,t.label),React.createElement("ul",{className:"simplify-ul ts-addition-list flexify"},p.map(m=>React.createElement("li",{key:m.value,className:`flexify${s(m)?" ts-checked":""}`},React.createElement("div",{className:"addition-body",onClick:i=>{i.preventDefault(),g(m)}},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",value:m.value,checked:s(m),className:"onoffswitch-checkbox",disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"})),React.createElement("span",null,m.label)))))):React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("div",{className:"ts-filter"},React.createElement("select",{value:e??"",onChange:m=>n(m.target.value||null)},React.createElement("option",{value:""},d||o?.default_placeholder||"Select..."),p.map(m=>React.createElement("option",{key:m.value,value:m.value},m.label))),React.createElement("div",{className:"ts-down-icon"})))}function ot({dataInput:t,value:e,onChange:n}){const{display_mode:a="default",choices:l={}}=t.props,d=u.useMemo(()=>Object.values(l),[l]),o=u.useCallback(s=>(e||[]).includes(s.value),[e]),p=u.useCallback(s=>{const g=e||[];g.includes(s.value)?n(g.filter(m=>m!==s.value)):n([...g,s.value])},[e,n]);return a==="buttons"?React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,t.label),React.createElement("ul",{className:"simplify-ul addon-buttons flexify"},d.map(s=>React.createElement("li",{key:s.value,className:`flexify${o(s)?" adb-selected":""}`,onClick:g=>{g.preventDefault(),p(s)}},s.label)))):React.createElement("div",{className:"ts-form-group ts-custom-additions"},React.createElement("label",null,t.label),React.createElement("ul",{className:"simplify-ul ts-addition-list flexify"},d.map(s=>React.createElement("li",{key:s.value,className:`flexify${o(s)?" ts-checked":""}`},React.createElement("div",{className:"addition-body",onClick:g=>{g.preventDefault(),p(s)}},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:o(s),className:"onoffswitch-checkbox",disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"})),React.createElement("span",null,s.label))))))}function it({field:t,values:e,onValueChange:n,icons:a}){const l=u.useMemo(()=>Object.values(t.props.data_inputs||{}),[t.props.data_inputs]);return l.length?React.createElement(React.Fragment,null,l.map(d=>{const o=d.key,p=e[o];switch(d.type){case"text":return React.createElement($e,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"textarea":return React.createElement(et,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"email":return React.createElement(tt,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"phone":return React.createElement(nt,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"url":return React.createElement(at,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"date":return React.createElement(st,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"switcher":return React.createElement(rt,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"number":return React.createElement(ct,{key:o,dataInput:d,value:p,onChange:s=>n(o,s),icons:a});case"select":return React.createElement(lt,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"multiselect":return React.createElement(ot,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});default:return null}})):null}const Ne="voxel:guest_cart",ut="voxel:direct_cart";function ye(t,e){return`${window.Voxel_Config?.ajax_url??"/?vx=1"}&action=${t}&_wpnonce=${e}`}function dt(){return window.Voxel_Config?.is_logged_in??!1}function mt(){return typeof localStorage>"u"?null:localStorage.getItem(Ne)}function pt(t){typeof localStorage>"u"||localStorage.setItem(Ne,JSON.stringify(t))}function ft(t,e){typeof localStorage>"u"||localStorage.setItem(ut,JSON.stringify({[t]:e}))}function G(t,e="info",n,a){window.Voxel?.alert?window.Voxel.alert(t,e,n,a):console.log(`[${e.toUpperCase()}]`,t)}function yt(t){const e=[];typeof document<"u"&&document.querySelector(".ts-popup-cart > a")&&e.push({label:t.view_cart??"View Cart",link:"#",onClick:n=>{n.preventDefault(),window.Voxel?.openCart&&window.Voxel.openCart(),n.target.closest(".ts-notice")?.querySelector(".close-alert")?.click()}}),G(t.added_to_cart??"Added to cart","success",e,4e3)}function bt(t){window.jQuery&&window.jQuery(document).trigger("voxel:added_cart_item",t)}function Se(t,e,n,a,l,d={}){const o=t.settings?.product_mode??"regular",p={post_id:0};return Object.keys(e).length>0&&(p.addons=e),o==="regular"?p.stock={quantity:n}:o==="variable"?p.variations=a:o==="booking"&&(p.booking=l),Object.keys(d).length>0&&(p.data_inputs=d),p}async function be(t,e){if(window.jQuery?.post)return new Promise(a=>{window.jQuery.post(t,e).always(l=>{a(l)})});const n=new FormData;Object.entries(e).forEach(([a,l])=>{n.append(a,l)});try{return await(await fetch(t,{method:"POST",body:n})).json()}catch{return{success:!1,message:window.Voxel_Config?.l10n?.ajaxError??"Request failed"}}}function gt(t){const{config:e,addonValues:n,quantity:a,variationsValue:l,bookingValue:d,dataInputValues:o}=t,[p,s]=u.useState(!1),[g,m]=u.useState(null),i=u.useCallback(async()=>{if(!e)return m("Product configuration not available"),!1;s(!0),m(null);try{const f=e.settings?.cart_nonce??e.nonce,r=Se(e,n,a,l,d,o),c={...e.value??{},...r};let y;if(dt()){const E=ye("products.add_to_cart",f);y=await be(E,{item:JSON.stringify(c)})}else{const E=ye("products.add_to_guest_cart",f);y=await be(E,{item:JSON.stringify(c),guest_cart:mt()??""}),y.success&&y.guest_cart&&pt(y.guest_cart)}if(y.success)return bt(y.item),yt({added_to_cart:e.l10n?.added_to_cart,view_cart:e.l10n?.view_cart}),!0;{const E=y.message??"Failed to add to cart";return m(E),G(E,"error"),!1}}catch(f){const r=f instanceof Error?f.message:"Failed to add to cart";return m(r),G(r,"error"),!1}finally{s(!1)}},[e,n,a,l,d,o]),b=u.useCallback(async()=>{if(!e)return m("Product configuration not available"),!1;s(!0),m(null);try{const f=e.settings?.cart_nonce??e.nonce,r=Se(e,n,a,l,d,o),c={...e.value??{},...r},y=ye("products.get_direct_cart",f),E=await be(y,{item:JSON.stringify(c)});if(E.success&&E.item&&E.checkout_link)return ft(E.item.key,E.item.value),window.location.href=E.checkout_link,!0;{const k=E.message??"Failed to proceed to checkout";return m(k),G(k,"error"),!1}}catch(f){const r=f instanceof Error?f.message:"Failed to proceed to checkout";return m(r),G(r,"error"),!1}finally{s(!1)}},[e,n,a,l,d,o]);return{isProcessing:p,addToCart:i,directCheckout:b,error:g}}const Re={active:!1,element:null,choice:null,addonKey:null};function kt(t){const{config:e,addonValues:n,onAddonValueChange:a}=t,[l,d]=u.useState(Re),o=u.useRef([]),p=u.useCallback(i=>{try{return JSON.parse(atob(i))}catch{return null}},[]),s=u.useCallback((i,b,f,r)=>{const c=i.parentElement;c&&(b?(i.classList.add("active"),r?c.dataset.tooltip=r:delete c.dataset.tooltip):(i.classList.remove("active"),f?c.dataset.tooltip=f:delete c.dataset.tooltip))},[]),g=u.useCallback(()=>{d(Re)},[]),m=u.useCallback(i=>{if(!l.active||!l.addonKey||!l.choice)return;const b=l.addonKey,f=l.choice.value,r=n[b];if(!r)return;const c=e?.props?.fields?.["form-addons"]?.props?.addons?.[b];if(c){if(c.type==="custom-multiselect"){const y=r.selected||[],E=y.findIndex(k=>k.item===f);if(E!==-1){const k=[...y];k[E]={...k[E],quantity:i},a(b,{...r,selected:k})}}else if(c.type==="custom-select"){const y=r.selected;y.item===f&&a(b,{...r,selected:{...y,quantity:i}})}g()}},[l,n,e,a,g]);return u.useEffect(()=>{if(!e)return;o.current.forEach(f=>f()),o.current=[];const i=e.props?.fields?.["form-addons"]?.props?.addons;return i?(document.querySelectorAll(".ts-use-addition").forEach(f=>{const r=f.dataset.id;if(!r)return;const c=p(r);if(!c)return;const y=i[c.addon],E=y?.props?.choices?.[c.choice];if(!y||!E)return;const k=f.parentElement,h=k?.dataset.tooltipDefault||null,_=k?.dataset.tooltipActive||null;if(y._has_external_handler=!0,y.type==="custom-multiselect"){const w=q=>{q.preventDefault();const I=n[c.addon],S=I?.selected||[],T=S.findIndex(B=>B.item===c.choice);if(T===-1){const B=[...S,{item:c.choice,quantity:E.props?.quantity?.min??1}];a(c.addon,{...I,selected:B}),E.props?.quantity?.enabled&&d({active:!0,element:f,choice:E,addonKey:c.addon})}else{const B=S.filter((O,J)=>J!==T);a(c.addon,{...I,selected:B})}};f.addEventListener("click",w),o.current.push(()=>f.removeEventListener("click",w));const C=n[c.addon]?.selected?.some(q=>q.item===c.choice)??!1;s(f,C,h,_)}else if(y.type==="custom-select"){const w=q=>{q.preventDefault();const I=n[c.addon];I?.selected?.item!==c.choice?(a(c.addon,{...I,selected:{item:c.choice,quantity:E.props?.quantity?.min??1}}),E.props?.quantity?.enabled&&d({active:!0,element:f,choice:E,addonKey:c.addon})):a(c.addon,{...I,selected:{item:null,quantity:1}})};f.addEventListener("click",w),o.current.push(()=>f.removeEventListener("click",w));const C=n[c.addon]?.selected?.item===c.choice;s(f,C,h,_)}}),()=>{o.current.forEach(f=>f()),o.current=[]}):void 0},[e,p,s]),u.useEffect(()=>{if(!e)return;const i=e.props?.fields?.["form-addons"]?.props?.addons;if(!i)return;document.querySelectorAll(".ts-use-addition").forEach(f=>{const r=f.dataset.id;if(!r)return;const c=p(r);if(!c)return;const y=i[c.addon];if(!y)return;const E=f.parentElement,k=E?.dataset.tooltipDefault||null,h=E?.dataset.tooltipActive||null;if(y.type==="custom-multiselect"){const w=n[c.addon]?.selected?.some(N=>N.item===c.choice)??!1;s(f,w,k,h)}else if(y.type==="custom-select"){const w=n[c.addon]?.selected?.item===c.choice;s(f,w,k,h)}})},[e,n,p,s]),{externalChoice:l,closeExternalChoice:g,updateExternalChoiceQuantity:m}}function ve(t){return t?.value?t.library==="line-awesome"||t.value.startsWith("la-")?React.createElement("i",{className:`las ${t.value}`}):React.createElement("i",{className:`las ${t.value}`}):null}function Et({active:t,element:e,choice:n,onClose:a,onConfirm:l,icons:d}){const o=u.useRef(null),[p,s]=u.useState(1),g=n?.props?.quantity?.min??1,m=n?.props?.quantity?.max??999;u.useEffect(()=>{t&&s(g)},[t,g]),u.useEffect(()=>{if(!t||!e||!o.current)return;const r=o.current,c=e.getBoundingClientRect(),y=r.getBoundingClientRect();let E=c.bottom+window.scrollY+8,k=c.left+window.scrollX+c.width/2-y.width/2;const h=window.innerWidth,_=window.innerHeight;k<8&&(k=8),k+y.width>h-8&&(k=h-y.width-8),c.bottom+y.height+16>_&&(E=c.top+window.scrollY-y.height-8),r.style.top=`${E}px`,r.style.left=`${k}px`},[t,e]),u.useEffect(()=>{if(!t)return;const r=y=>{o.current&&!o.current.contains(y.target)&&a()},c=setTimeout(()=>{document.addEventListener("click",r)},100);return()=>{clearTimeout(c),document.removeEventListener("click",r)}},[t,a]),u.useEffect(()=>{if(!t)return;const r=c=>{c.key==="Escape"&&a()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[t,a]);const i=u.useCallback(()=>{s(r=>Math.min(r+1,m))},[m]),b=u.useCallback(()=>{s(r=>Math.max(r-1,g))},[g]),f=u.useCallback(()=>{l(p)},[p,l]);return!t||!n?null:React.createElement("div",{ref:o,className:"ts-popup ts-external-choice-popup",style:{position:"absolute",zIndex:9999}},React.createElement("div",{className:"ts-popup-content"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,n.label," - Quantity"),React.createElement("div",{className:"ts-stepper-input flexify"},React.createElement("button",{className:`ts-stepper-left ts-icon-btn${p<=g?" vx-disabled":""}`,onClick:r=>{r.preventDefault(),r.stopPropagation(),b()},type:"button",disabled:p<=g},ve(d?.minusIcon)||React.createElement("i",{className:"las la-minus"})),React.createElement("input",{type:"number",className:"ts-input-box",value:p,onChange:r=>{const c=parseInt(r.target.value,10);isNaN(c)||s(Math.max(g,Math.min(c,m)))},min:g,max:m}),React.createElement("button",{className:`ts-stepper-right ts-icon-btn${p>=m?" vx-disabled":""}`,onClick:r=>{r.preventDefault(),r.stopPropagation(),i()},type:"button",disabled:p>=m},ve(d?.plusIcon)||React.createElement("i",{className:"las la-plus"})))),React.createElement("div",{className:"ts-form-group ts-popup-actions flexify"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1",onClick:r=>{r.preventDefault(),a()}},"Cancel"),React.createElement("a",{href:"#",className:"ts-btn ts-btn-2",onClick:r=>{r.preventDefault(),f()}},"Confirm"))))}function ht({text:t,icon:e="",className:n="",style:a={}}){return u.createElement("div",{className:`voxel-empty-placeholder ${n}`,style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:t?"8px":"0",background:"rgb(213 216 220 / 80%)",borderRadius:"0",color:"#666",fontSize:"13px",height:"45px",...a}},u.createElement("span",{className:"placeholder-icon",style:{fontFamily:"eicons",fontSize:"24px",opacity:.3,lineHeight:1,fontStyle:"normal"}},e),t&&u.createElement("span",{className:"placeholder-text",style:{opacity:.6}},t))}function $(t,e){return t?.value?t.library==="line-awesome"||t.value.startsWith("la-")?React.createElement("i",{className:`las ${t.value} `}):t.library==="fa-solid"||t.library==="fa-regular"?React.createElement("i",{className:`${t.library==="fa-solid"?"fas":"far"} fa-${t.value} `}):React.createElement("i",{className:`las ${t.value} `}):null}function _t(){return React.createElement("div",{className:"ts-product-main vx-loading-screen"},React.createElement(ht,null))}function wt({message:t,icon:e}){return React.createElement("div",{className:"ts-product-main"},React.createElement("div",{className:"ts-form-group ts-no-posts"},$(e),React.createElement("p",null,t)))}function Nt({attributes:t}){const e=t.icons||z;return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify({blockId:t.blockId,settings:{showPriceCalculator:t.showPriceCalculator,showSubtotalOnly:t.showSubtotalOnly,hideCardSubheading:t.hideCardSubheading,cardSelectOnClick:t.cardSelectOnClick},icons:{...z,...t.icons}})}}),React.createElement("div",{className:"ts-product-main"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,"Product Options"),React.createElement("div",{className:"ts-filter ts-popup-target"},React.createElement("span",{className:"ts-filter-text"},"Select an option"),React.createElement("div",{className:"ts-down-icon"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,"Add-ons"),React.createElement("ul",{className:"addon-cards simplify-ul flexify"},React.createElement("li",null,React.createElement("div",{className:"adc-title"},"Sample Add-on"),React.createElement("div",{className:"adc-subtitle"},"Description"),React.createElement("span",{className:"vx-addon-price"},"+$10.00")),React.createElement("li",{className:"adc-selected"},React.createElement("div",{className:"adc-title"},"Selected Add-on"),React.createElement("div",{className:"adc-subtitle"},"Description"),React.createElement("span",{className:"vx-addon-price"},"+$15.00")))),React.createElement("div",{className:"ts-form-group product-actions"},React.createElement("a",{href:"#",className:"ts-btn form-btn ts-btn-2"},$(e.addToCart),React.createElement("span",null,"Add to cart"))),t.showPriceCalculator==="show"&&React.createElement("div",{className:"ts-form-group tcc-container"},React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify"},React.createElement("li",null,React.createElement("p",{className:"ts-item-name"},"Base price"),React.createElement("p",{className:"ts-item-price"},"$50.00")),React.createElement("li",null,React.createElement("p",{className:"ts-item-name"},"Add-on: Selected"),React.createElement("p",{className:"ts-item-price"},"$15.00")),React.createElement("li",{className:"ts-total"},React.createElement("p",{className:"ts-item-name"},"Total"),React.createElement("p",{className:"ts-item-price"},"$65.00"))))))}function St({summary:t,showSubtotalOnly:e}){if(!t.visible_items.length)return null;const n=e?t.visible_items.filter(a=>a.key==="total"):t.visible_items;return React.createElement("div",{className:"ts-form-group tcc-container"},React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify"},n.map(a=>React.createElement("li",{key:a.key,className:a.key==="total"?"ts-total":""},React.createElement("p",{className:"ts-item-name"},a.label),React.createElement("p",{className:"ts-item-price"},a.formatted_price)))))}function Rt({attributes:t,context:e,config:n,productConfig:a}){const[l,d]=u.useState({}),[o,p]=u.useState(1),[s,g]=u.useState({variation_id:null,quantity:1}),[m,i]=u.useState(Pe),[b,f]=u.useState({}),[r,c]=u.useState(e==="frontend"),{isProcessing:y,addToCart:E,directCheckout:k}=gt({config:a??null,addonValues:l,quantity:o,variationsValue:s,bookingValue:m,dataInputValues:b}),h=u.useRef(null),_=a?.props?.fields?.["form-quantity"],w=_?.props?.quantity??999,N=u.useMemo(()=>{const P=a?.props?.fields?.["form-booking"];if(!P||P.props?.mode!=="date_range"||!m.start_date||!m.end_date)return 0;const j=new Date(m.start_date+"T00:00:00Z"),ee=new Date(m.end_date+"T00:00:00Z").getTime()-j.getTime(),te=Math.ceil(ee/(1e3*60*60*24));return(P.props?.count_mode??"nights")==="nights"?te:te+1},[a,m.start_date,m.end_date]),C=u.useCallback(()=>h.current?.getPricingSummary()??null,[]),q=u.useCallback(()=>{const P=a?.props?.fields?.["form-variations"];return P?oe.getPricingSummary(P,s):null},[a,s]),{summary:I}=ze({config:a??null,quantity:o,bookingValue:m,getAddonsPricingSummary:C,getVariationsPricingSummary:q}),S=u.useCallback((P,j)=>{d(Y=>({...Y,[P]:j}))},[]),T=u.useCallback((P,j)=>{f(Y=>({...Y,[P]:j}))},[]),{externalChoice:B,closeExternalChoice:O,updateExternalChoiceQuantity:J}=kt({config:a??null,addonValues:l,onAddonValueChange:S}),A=n?.icons||t.icons||z,Z=n?.settings||{showPriceCalculator:t.showPriceCalculator,showSubtotalOnly:t.showSubtotalOnly,hideCardSubheading:t.hideCardSubheading,cardSelectOnClick:t.cardSelectOnClick};if(e==="editor")return React.createElement(Nt,{attributes:t});if(r&&!a)return React.createElement(_t,null);if(!a||!a.is_purchasable)return React.createElement(wt,{message:a?.out_of_stock_message||"This product is not available",icon:A.outOfStock});const K=a?.settings?.product_mode??"regular",R=!!a?.props?.fields?.["form-addons"],v=!!_,V=!!a?.props?.fields?.["form-variations"],M=!!a?.props?.fields?.["form-booking"],F=!!a?.props?.fields?.["form-data-inputs"];return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify({blockId:t.blockId||n?.blockId,settings:Z,icons:A})}}),React.createElement("div",{className:"ts-product-main"},R&&a&&React.createElement(Ie,{ref:h,config:a,values:l,onValueChange:S,bookingValue:m,bookingRangeLength:N,searchContext:a.settings?.search_context}),V&&K==="variable"&&a?.props?.fields?.["form-variations"]&&React.createElement(oe,{field:a.props.fields["form-variations"],value:s,onChange:g}),M&&K==="booking"&&a?.props?.fields?.["form-booking"]&&React.createElement(W,{field:a.props.fields["form-booking"],value:m,onChange:i,config:a,initialAvailability:a.settings?.search_context?.availability}),v&&K==="regular"&&React.createElement(Be,{maxQuantity:w,value:o,onChange:p,label:a?.l10n?.quantity??"Quantity"}),F&&a?.props?.fields?.["form-data-inputs"]&&React.createElement(it,{field:a.props.fields["form-data-inputs"],values:b,onValueChange:T,icons:A}),React.createElement("div",{className:"ts-form-group product-actions"},a.cart.enabled?React.createElement("a",{href:"#",className:`ts-btn form-btn ts-btn-2 ${y?"ts-loading-btn":""}`,onClick:P=>{P.preventDefault(),y||E()}},y?React.createElement("span",{className:"ts-loader"}):React.createElement(React.Fragment,null,$(A.addToCart),React.createElement("span",null,"Add to cart"))):React.createElement("a",{href:"#",className:`ts-btn form-btn ts-btn-2 ${y?"ts-loading-btn":""}`,onClick:P=>{P.preventDefault(),y||k()}},y?React.createElement("span",{className:"ts-loader"}):React.createElement(React.Fragment,null,$(A.checkout),React.createElement("span",null,"Continue")))),Z.showPriceCalculator==="show"&&React.createElement(St,{summary:I,showSubtotalOnly:Z.showSubtotalOnly})),React.createElement(Et,{active:B.active,element:B.element,choice:B.choice,onClose:O,onConfirm:J,icons:A}))}function vt(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const t=document.querySelector('link[rel="https://api.w.org/"]');if(t){const e=t.getAttribute("href");if(e)return e.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function Dt(){const t=vt();try{return new URL(t).pathname.replace(/\/$/,"")}catch{return""}}function xt(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const n=e.getAttribute("href");if(n)return n}}const t=Dt();return typeof window<"u"?window.location.origin+t+"/wp-json/":"/wp-json/"}function De(t){return typeof t!="string"||!t.match(/^\d{4}-\d{2}-\d{2}$/)?!1:isFinite(new Date(t).getTime())}function Ct(t){const e={availability:{start:"",end:""},numeric_addons:{},switcher_addons:{}};if(!t)return e;try{const a=new URL(document.referrer).searchParams;if(t.availability){const l=a.get(t.availability);if(typeof l=="string"){const d=l.split("..");De(d[0])&&(e.availability={start:d[0],end:De(d[1])?d[1]:d[0]})}}t.numeric_addons&&Object.keys(t.numeric_addons).forEach(l=>{const d=t.numeric_addons[l],o=a.get(d);if(typeof o=="string"){const p=parseInt(o,10);isNaN(p)||(e.numeric_addons[l]=p)}}),t.switcher_addons&&Object.keys(t.switcher_addons).forEach(l=>{const d=t.switcher_addons[l];a.get(d)==="1"&&(e.switcher_addons[l]=!0)})}catch(n){console.debug("Search context parsing failed:",n)}return e}function qt(t,e){return{availability:{start:t?.availability?.start||e.availability?.start||"",end:t?.availability?.end||e.availability?.end||""},numeric_addons:{...e.numeric_addons,...t?.numeric_addons},switcher_addons:{...e.switcher_addons,...t?.switcher_addons}}}function Pt(){return xt()}function Tt(){const t=window;if(t.voxel?.current_post?.id)return t.voxel.current_post.id;if(t.wp?.data?.select){const a=t.wp.data.select("core/editor")?.getCurrentPostId?.();if(a)return a}const n=document.body.className.match(/postid-(\d+)/);return n?parseInt(n[1],10):null}function It(t){const e=(g,m)=>typeof g=="boolean"?g:g==="true"||g==="1"||g===1?!0:g==="false"||g==="0"||g===0?!1:m,n=(g,m)=>typeof g=="string"?g:m,a=t.settings??{},l=t.icons??{},d=a.searchContextConfig??a.search_context_config??null,o=a.searchContext??a.search_context??{},p=Ct(d),s=qt(o,p);return{blockId:n(t.blockId??t.block_id,""),settings:{showPriceCalculator:n(a.showPriceCalculator??a.show_price_calculator,"show"),showSubtotalOnly:e(a.showSubtotalOnly??a.show_subtotal_only,!1),hideCardSubheading:e(a.hideCardSubheading??a.hide_card_subheading,!1),cardSelectOnClick:e(a.cardSelectOnClick??a.card_select_on_click,!0),productMode:n(a.productMode??a.product_mode,"regular"),cartNonce:n(a.cartNonce??a.cart_nonce,""),searchContext:s,searchContextConfig:d},icons:{calendarIcon:l.calendarIcon??l.calendar_icon??null,minusIcon:l.minusIcon??l.minus_icon??null,plusIcon:l.plusIcon??l.plus_icon??null,cartIcon:l.cartIcon??l.cart_icon??null,checkIcon:l.checkIcon??l.check_icon??null,downIcon:l.downIcon??l.down_icon??null},props:t.props??{},value:t.value??{},l10n:t.l10n??{}}}function Bt(t){const e=t.querySelector("script.vxconfig");if(e&&e.textContent)try{const n=JSON.parse(e.textContent);return It(n)}catch(n){console.error("Failed to parse vxconfig:",n)}return null}async function Ot(t){const n=`${Pt()}voxel-fse/v1/product-form/config?post_id=${t}`;try{const a=await fetch(n,{credentials:"same-origin",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to fetch product config:",a),null}}function Mt(t){return{...qe,blockId:t.blockId||"",showPriceCalculator:t.settings?.showPriceCalculator||"show",showSubtotalOnly:t.settings?.showSubtotalOnly||!1,hideCardSubheading:t.settings?.hideCardSubheading||!1,cardSelectOnClick:t.settings?.cardSelectOnClick??!0,icons:{...z,...t.icons}}}function At({config:t,postId:e}){const[n,a]=u.useState(null),[l,d]=u.useState(!0),[o,p]=u.useState(null),s=Mt(t);return u.useEffect(()=>{let g=!1;async function m(){if(!e){p("No post ID found"),d(!1);return}d(!0),p(null);try{const i=await Ot(e);g||a(i)}catch(i){g||p(i instanceof Error?i.message:"Failed to load product")}finally{g||d(!1)}}return m(),()=>{g=!0}},[e]),l?React.createElement("div",{className:"ts-product-main vx-loading-screen"},React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-loader"}))):o?React.createElement("div",{className:"ts-product-main"},React.createElement("div",{className:"ts-form-group ts-no-posts"},React.createElement("i",{className:"las la-exclamation-circle"}),React.createElement("p",null,o))):React.createElement(Rt,{attributes:s,context:"frontend",config:t,productConfig:n})}function U(){const t=document.querySelectorAll(".voxel-fse-product-form, .ts-product-form"),e=Tt();t.forEach(n=>{if(n.dataset.hydrated==="true"||!n.classList.contains("voxel-fse-product-form"))return;const a=Bt(n);if(!a){console.error("No vxconfig found for product form block");return}n.dataset.hydrated="true";const l=n.querySelector(".vx-loading-screen");l&&l.remove(),Ce.createRoot(n).render(React.createElement(At,{config:a,postId:e}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",U):U(),window.addEventListener("turbo:load",U),window.addEventListener("pjax:complete",U),document.addEventListener("voxel:markup-update",U);const Lt=window;Lt.render_product_form=U})(ReactDOM,React);
