(function(he,m){"use strict";const A={addToCart:{library:"icon",value:"la-shopping-cart"},outOfStock:{library:"icon",value:"la-exclamation-circle"},checkout:{library:"icon",value:"la-arrow-right"},calendar:{library:"icon",value:"la-calendar"},clock:{library:"icon",value:"la-clock"}},_e={blockId:"",showPriceCalculator:"show",showPriceCalculatorTablet:"show",showPriceCalculatorMobile:"show",showSubtotalOnly:!1,hideCardSubheading:!1,cardSelectOnClick:!0,icons:A,fieldSpacing:20,fieldLabelTypography:{},fieldLabelColor:"",primaryButtonTypography:{},primaryButtonBorder:{borderType:"none",borderWidth:{},borderColor:""},primaryButtonBorderRadius:0,primaryButtonBoxShadow:{},primaryButtonTextColor:"",primaryButtonBackground:"",primaryButtonIconSize:24,primaryButtonIconColor:"",primaryButtonIconTextSpacing:8,primaryButtonTextColorHover:"",primaryButtonBackgroundHover:"",primaryButtonBorderColorHover:"",primaryButtonBoxShadowHover:{},primaryButtonIconColorHover:"",priceCalculatorListSpacing:10,priceCalculatorTypography:{},priceCalculatorTextColor:"",priceCalculatorTotalTypography:{},priceCalculatorTotalTextColor:"",loadingColor1:"",loadingColor2:"",outOfStockContentGap:15,outOfStockIconSize:40,outOfStockIconColor:"",outOfStockTypography:{},outOfStockTextColor:"",stepperInputSize:16,stepperButtonIconColor:"",stepperButtonBackground:"",stepperButtonBorder:{borderType:"none",borderWidth:{},borderColor:""},stepperButtonBorderRadius:0,stepperButtonIconColorHover:"",stepperButtonBackgroundHover:"",stepperButtonBorderColorHover:"",cardsGap:10,cardsBackground:"",cardsBorder:{borderType:"none",borderWidth:{},borderColor:""},cardsBorderRadius:0,cardsPrimaryTypography:{},cardsPrimaryColor:"",cardsSecondaryTypography:{},cardsSecondaryColor:"",cardsPriceTypography:{},cardsPriceColor:"",cardsImageBorderRadius:0,cardsImageSize:60,cardsSelectedBackground:"",cardsSelectedBorderColor:"",cardsSelectedBoxShadow:{},cardsSelectedPrimaryTypography:{},buttonsGap:10,buttonsBackground:"",buttonsBorder:{borderType:"none",borderWidth:{},borderColor:""},buttonsBorderRadius:0,buttonsTextTypography:{},buttonsTextColor:"",buttonsSelectedBackground:"",buttonsSelectedBorderColor:"",buttonsSelectedBoxShadow:{},dropdownTypography:{},dropdownBoxShadow:{},dropdownBackground:"",dropdownTextColor:"",dropdownBorder:{type:"default",width:0,color:""},dropdownBorderRadius:0,dropdownIconColor:"",dropdownIconSize:24,dropdownIconTextSpacing:10,dropdownHideChevron:!1,dropdownChevronColor:"",dropdownBackgroundHover:"",dropdownTextColorHover:"",dropdownBorderColorHover:"",dropdownIconColorHover:"",dropdownBoxShadowHover:{},dropdownFilledTypography:{},dropdownFilledBackground:"",dropdownFilledTextColor:"",dropdownFilledIconColor:"",dropdownFilledBorderColor:"",dropdownFilledBorderWidth:0,dropdownFilledBoxShadow:{},radioCheckboxBorderColor:"",radioCheckboxTextTypography:{},radioCheckboxTextColor:"",radioCheckboxSelectedBackground:"",radioCheckboxSelectedTextTypography:{},radioCheckboxSelectedTextColor:"",radioCheckboxSelectedBoxShadow:{},switcherBackgroundInactive:"",switcherBackgroundActive:"",switcherHandleBackground:"",imagesGap:10,imagesBorderRadius:0,imagesSelectedBorderColor:"",colorsGap:10,colorsSize:30,colorsBorderRadius:50,colorsInsetColor:"",inputPlaceholderColor:"",inputPlaceholderTypography:{},inputValueColor:"",inputValueTypography:{},inputBackground:"",inputBorder:{type:"default",width:0,color:""},inputBorderRadius:0,inputBackgroundHover:"",inputBorderColorHover:"",inputPlaceholderColorHover:"",inputTextColorHover:"",inputBackgroundActive:"",inputBorderColorActive:"",inputTextColorActive:""},we={start_date:null,end_date:null,date:null,slot:null};function z({addon:e,value:t,onChange:n,getRepeatConfig:a,getCustomPrice:l,getCustomPriceForDate:d,searchContext:o}){m.useEffect(()=>{e.required&&!t.enabled&&n({enabled:!0}),o?.switcher_addons?.[e.key]===!0&&!t.enabled&&n({enabled:!0})},[e.key,e.required,o,t.enabled,n]);const p=m.useCallback(()=>{e.required&&t.enabled||n({enabled:!t.enabled})},[e.required,t.enabled,n]);m.useCallback(()=>{if(!t.enabled)return null;let g=e.label;const i=a(e),u=l(e);let b=0;if(i!==null){b=0;const f=new Date(i.start+"T00:00:00Z"),r=new Date(i.end+"T00:00:00Z");for(;i.count_mode==="nights"?f<r:f<=r;){const c=d(f);if(c!==null){const y=c.prices.addons?.[e.key],E=y&&"price"in y?y.price:null;b+=E??e.props.price??0}else b+=e.props.price??0;f.setDate(f.getDate()+1)}g+=i.label}else{let f=e.props.price??0;if(u!==null){const r=u.prices.addons?.[e.key],c=r&&"price"in r?r.price:null;c!=null&&(f=c)}b=f}return{label:g,amount:b}},[e,t.enabled,a,l,d]);const s=e.props.price!=null?`+${e.props.price.toLocaleString()}`:"";return React.createElement("div",{className:"ts-form-group ts-addon-switcher"},React.createElement("div",{className:"switch-slider"},React.createElement("label",{className:"container-switch"},React.createElement("input",{type:"checkbox",checked:t.enabled,onChange:p,disabled:e.required&&t.enabled}),React.createElement("span",{className:"switch"})),React.createElement("span",{className:"switch-label"},e.label,s&&React.createElement("span",{className:"addon-price"}," (",s,")"))))}z.getPricingSummary=function(e,t,n,a,l){if(!t.enabled)return null;let d=e.label;const o=n(e),p=a(e);let s=0;if(o!==null){s=0;const g=new Date(o.start+"T00:00:00Z"),i=new Date(o.end+"T00:00:00Z");for(;o.count_mode==="nights"?g<i:g<=i;){const u=l(g);if(u!==null){const b=u.prices.addons?.[e.key],f=b&&"price"in b?b.price:null;s+=f??e.props.price??0}else s+=e.props.price??0;g.setDate(g.getDate()+1)}d+=o.label}else{let g=e.props.price??0;if(p!==null){const i=p.prices.addons?.[e.key],u=i&&"price"in i?i.price:null;u!=null&&(g=u)}s=g}return{label:d,amount:s}};function Y({addon:e,value:t,onChange:n,getRepeatConfig:a,getCustomPrice:l,getCustomPriceForDate:d,searchContext:o}){const p=e.props.min_units??1,s=e.props.max_units??999;m.useEffect(()=>{if(t.quantity===null){const y=e.required?p:0;n({quantity:y})}const c=o?.numeric_addons?.[e.key];if(c!==void 0){const y=parseInt(String(c),10);typeof y=="number"&&y>=p&&y<=s&&n({quantity:y})}},[e.key,e.required,p,s,o]);const g=m.useCallback(()=>{const c=t.quantity??0;typeof c!="number"||c+1<p?n({quantity:p}):n({quantity:Math.min(c+1,s)})},[t.quantity,p,s,n]),i=m.useCallback(()=>{const c=t.quantity??0;if(typeof c!="number")n({quantity:p});else{const y=c-1;!e.required&&y<p?n({quantity:0}):n({quantity:Math.max(y,p)})}},[e.required,t.quantity,p,n]),u=m.useCallback(()=>{const c=t.quantity;typeof c=="number"&&(c>s?n({quantity:s}):c<p&&(!e.required&&c===0||n({quantity:p})))},[e.required,t.quantity,p,s,n]),b=m.useCallback(c=>{const y=parseInt(c.target.value,10);isNaN(y)||n({quantity:y})},[n]),f=e.props.price!=null?`+${e.props.price.toLocaleString()}`:"",r=t.quantity??0;return React.createElement("div",{className:"ts-form-group ts-addon-numeric"},React.createElement("label",null,e.label,f&&React.createElement("span",{className:"addon-price"}," (",f," each)")),React.createElement("div",{className:"ts-stepper-input"},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:i,disabled:e.required&&r<=p},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("input",{type:"number",value:r,onChange:b,onBlur:u,min:e.required?p:0,max:s,className:"ts-stepper-value"}),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:g,disabled:r>=s},React.createElement("span",{className:"ts-icon"},"+"))),e.props.charge_after?.enabled&&e.props.charge_after.quantity>0&&React.createElement("small",{className:"charge-after-note"},"First ",e.props.charge_after.quantity," free"))}Y.getPricingSummary=function(e,t,n,a,l){const d=t.quantity??0;if(d<1)return null;let o=e.label;d>=1&&(o+=` × ${d}`);let p=d;e.props.charge_after?.enabled&&e.props.charge_after?.quantity>0&&(p=Math.max(0,d-e.props.charge_after.quantity));const s=n(e),g=a(e);let i=0;if(s!==null){i=0;const u=new Date(s.start+"T00:00:00Z"),b=new Date(s.end+"T00:00:00Z");for(;s.count_mode==="nights"?u<b:u<=b;){const f=l(u);if(f!==null){const r=f.prices.addons?.[e.key],c=r&&"price"in r?r.price:null;i+=c??e.props.price??0}else i+=e.props.price??0;u.setDate(u.getDate()+1)}i*=p,o+=s.label}else{let u=e.props.price??0;if(g!==null){const b=g.prices.addons?.[e.key],f=b&&"price"in b?b.price:null;f!=null&&(u=f)}i=u*p}return{label:o,amount:i}};function W({addon:e,value:t,onChange:n}){const[a,l]=m.useState(!1),d=m.useRef(null),o=e.props.choices??{},p=Object.keys(o);m.useEffect(()=>{e.required&&t.selected===null&&p.length>0&&n({selected:p[0]})},[e.required,t.selected,p,n]);const s=m.useCallback(b=>{n({selected:b}),l(!1)},[n]),g=m.useCallback(()=>{e.required||n({selected:null})},[e.required,n]),i=t.selected?o[t.selected]??null:null,u=b=>b.price!=null&&b.price>0?`+${b.price.toLocaleString()}`:"";return React.createElement("div",{className:"ts-form-group ts-addon-select"},React.createElement("label",null,e.label),React.createElement("div",{ref:d,className:`ts-filter ts-popup-target${i?" ts-filled":""}`,onClick:()=>l(!a),role:"button",tabIndex:0,onKeyDown:b=>b.key==="Enter"&&l(!a)},React.createElement("span",{className:"ts-filter-text"},i?i.label:"Select..."),React.createElement("div",{className:"ts-down-icon"})),a&&React.createElement("div",{className:"ts-popup-list"},React.createElement("ul",{className:"simplify-ul ts-form-options"},!e.required&&t.selected&&React.createElement("li",{className:"ts-option ts-option-clear",onClick:g,role:"option"},React.createElement("span",null,"Clear selection")),p.map(b=>{const f=o[b],r=t.selected===b,c=u(f);return React.createElement("li",{key:b,className:`ts-option${r?" ts-selected":""}`,onClick:()=>s(b),role:"option","aria-selected":r},React.createElement("span",{className:"option-label"},f.label),c&&React.createElement("span",{className:"option-price"},c))}))))}W.getPricingSummary=function(e,t,n,a,l){const d=t.selected;if(d===null)return null;const p=(e.props.choices??{})[d];if(!p)return null;let s=p.label;const g=n(e),i=a(e);let u=0;if(g!==null){u=0;const b=new Date(g.start+"T00:00:00Z"),f=new Date(g.end+"T00:00:00Z");for(;g.count_mode==="nights"?b<f:b<=f;){const r=l(b);if(r!==null){const c=r.prices.addons?.[e.key],E=(c&&typeof c=="object"&&!("price"in c)?c[d]:null)?.price??null;u+=E??p.price}else u+=p.price;b.setDate(b.getDate()+1)}s+=g.label}else{let b=p.price;if(i!==null){const f=i.prices.addons?.[e.key],c=(f&&typeof f=="object"&&!("price"in f)?f[d]:null)?.price??null;c!=null&&(b=c)}u=b}return{label:s,amount:u}};function G({addon:e,value:t,onChange:n}){const[a,l]=m.useState(!1),d=m.useRef(null),o=e.props.choices??{},p=Object.keys(o),s=t.selected??[],g=m.useCallback(r=>{const c=[...s],y=c.indexOf(r);y!==-1?c.splice(y,1):c.push(r),n({selected:c})},[s,n]),i=m.useCallback(()=>{n({selected:[]})},[n]),u=r=>s.includes(r),b=r=>r.price!=null&&r.price>0?`+${r.price.toLocaleString()}`:"",f=()=>s.length===0?"Select...":s.length===1?o[s[0]]?.label??"Selected":`${s.length} selected`;return React.createElement("div",{className:"ts-form-group ts-addon-multiselect"},React.createElement("label",null,e.label),React.createElement("div",{ref:d,className:`ts-filter ts-popup-target${s.length>0?" ts-filled":""}`,onClick:()=>l(!a),role:"button",tabIndex:0,onKeyDown:r=>r.key==="Enter"&&l(!a)},React.createElement("span",{className:"ts-filter-text"},f()),React.createElement("div",{className:"ts-down-icon"})),a&&React.createElement("div",{className:"ts-popup-list"},React.createElement("ul",{className:"simplify-ul ts-form-options ts-checkboxes"},s.length>0&&!e.required&&React.createElement("li",{className:"ts-option ts-option-clear",onClick:i,role:"option"},React.createElement("span",null,"Clear all")),p.map(r=>{const c=o[r],y=u(r),E=b(c);return React.createElement("li",{key:r,className:`ts-option ts-checkbox-option${y?" ts-selected":""}`,onClick:()=>g(r),role:"option","aria-selected":y},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:y,onChange:()=>{},tabIndex:-1}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",{className:"option-label"},c.label),E&&React.createElement("span",{className:"option-price"},E))}))))}G.getPricingSummary=function(e,t,n,a,l){const d=[],o=n(e),p=a(e),s=e.props.choices??{};return(t.selected??[]).forEach(i=>{const u=i;if(u===null)return;const b=s[u];if(!b)return;let f=b.label,r=0;if(o!==null){r=0;const c=new Date(o.start+"T00:00:00Z"),y=new Date(o.end+"T00:00:00Z");for(;o.count_mode==="nights"?c<y:c<=y;){const E=l(c);if(E!==null){const k=E.prices.addons?.[e.key],_=(k&&typeof k=="object"&&!("price"in k)?k[u]:null)?.price??null;r+=_??b.price}else r+=b.price;c.setDate(c.getDate()+1)}f+=o.label}else{let c=b.price;if(p!==null){const y=p.prices.addons?.[e.key],k=(y&&typeof y=="object"&&!("price"in y)?y[u]:null)?.price??null;k!=null&&(c=k)}r=c}d.push({label:f,amount:r})}),d};function J({addon:e,value:t,onChange:n}){const a=e.props.choices??{},l=Object.values(a);m.useEffect(()=>{if(e.required&&t.selected.item===null&&l.length>0){const u=l[0];n({selected:{item:u.value,quantity:u.quantity?.enabled?u.quantity.min:1}})}},[e.required,t.selected.item,l,n]);const d=()=>!e._has_external_handler||t.selected.item!==null,o=u=>!e._has_external_handler||t.selected.item===u.value,p=m.useCallback(u=>{u&&t.selected.item!==u.value?n({selected:{item:u.value,quantity:u.quantity?.enabled?u.quantity.min:1}}):e.required||n({selected:{item:null,quantity:1}})},[e.required,t.selected.item,n]);m.useCallback(u=>{const b=t.selected.quantity;typeof b=="number"&&u.quantity?.enabled&&(b>u.quantity.max?n({selected:{item:t.selected.item,quantity:u.quantity.max}}):b<u.quantity.min&&n({selected:{item:t.selected.item,quantity:u.quantity.min}}))},[t.selected,n]);const s=m.useCallback(u=>{if(!u.quantity?.enabled)return;const b=t.selected.quantity;if(typeof b!="number")n({selected:{item:t.selected.item,quantity:u.quantity.min}});else{const f=b+1;f<u.quantity.min?n({selected:{item:t.selected.item,quantity:u.quantity.min}}):n({selected:{item:t.selected.item,quantity:Math.min(f,u.quantity.max)}})}},[t.selected,n]),g=m.useCallback(u=>{if(!u.quantity?.enabled)return;const b=t.selected.quantity;n(typeof b!="number"?{selected:{item:t.selected.item,quantity:u.quantity.min}}:{selected:{item:t.selected.item,quantity:Math.max(b-1,u.quantity.min)}})},[t.selected,n]),i=u=>u.price!=null&&u.price>0?`+${u.price.toLocaleString()}`:"";return d()?React.createElement("div",{className:"ts-form-group ts-addon-custom-select"},React.createElement("label",null,e.label),React.createElement("div",{className:"ts-custom-select-cards"},l.map(u=>{if(!o(u))return null;const b=t.selected.item===u.value,f=i(u),r=u.quantity?.enabled&&b;return React.createElement("div",{key:u.value,className:`ts-card-choice${b?" ts-selected":""}`,onClick:()=>p(u),role:"option","aria-selected":b},u.image&&React.createElement("div",{className:"ts-card-image"},React.createElement("img",{src:u.image,alt:u.label})),React.createElement("div",{className:"ts-card-content"},React.createElement("span",{className:"ts-card-label"},u.label),f&&React.createElement("span",{className:"ts-card-price"},f)),r&&React.createElement("div",{className:"ts-stepper-input",onClick:c=>c.stopPropagation()},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:()=>g(u),disabled:t.selected.quantity<=(u.quantity?.min??1)},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("span",{className:"ts-stepper-value"},t.selected.quantity),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:()=>s(u),disabled:t.selected.quantity>=(u.quantity?.max??999)},React.createElement("span",{className:"ts-icon"},"+"))))}))):null}J.getPricingSummary=function(e,t,n,a,l){const{item:d,quantity:o}=t.selected;if(d===null)return null;const s=(e.props.choices??{})[d];if(!s)return null;let g=s.label;s.quantity?.enabled&&o>=1&&(g+=` × ${o}`);const i=n(e),u=a(e);let b=0;if(i!==null){const f=new Date(i.start+"T00:00:00Z"),r=new Date(i.end+"T00:00:00Z");for(;i.count_mode==="nights"?f<r:f<=r;){const c=l(f);if(c!==null){const y=c.prices.addons?.[e.key],k=(y&&typeof y=="object"&&!("price"in y)?y[d]:null)?.price??null;b+=k??s.price}else b+=s.price;f.setDate(f.getDate()+1)}s.quantity?.enabled&&(b*=o),g+=i.label}else{let f=s.price;if(u!==null){const r=u.prices.addons?.[e.key],y=(r&&typeof r=="object"&&!("price"in r)?r[d]:null)?.price??null;y!=null&&(f=y)}b=f,s.quantity?.enabled&&(b*=o)}return{label:g,amount:b}};function K({addon:e,value:t,onChange:n}){const a=e.props.choices??{},l=Object.values(a),d=t.selected??[],o=()=>!e._has_external_handler||d.length>0,p=r=>!e._has_external_handler||g(r),s=r=>d.findIndex(c=>c.item===r.value),g=r=>s(r)!==-1,i=m.useCallback(r=>{const c=s(r),y=[...d];c!==-1?y.splice(c,1):y.push({item:r.value,quantity:r.quantity?.min??1}),n({selected:y})},[d,n]);m.useCallback(r=>{const c=s(r);if(c===-1||!r.quantity?.enabled)return;const y=d[c].quantity;if(typeof y=="number"){const E=[...d];y>r.quantity.max?(E[c]={...E[c],quantity:r.quantity.max},n({selected:E})):y<r.quantity.min&&(E[c]={...E[c],quantity:r.quantity.min},n({selected:E}))}},[d,n]);const u=m.useCallback(r=>{const c=s(r);if(c===-1||!r.quantity?.enabled)return;const y=[...d],E=y[c].quantity;if(typeof E!="number")y[c]={...y[c],quantity:r.quantity.min};else{const k=E+1;k<r.quantity.min?y[c]={...y[c],quantity:r.quantity.min}:y[c]={...y[c],quantity:Math.min(k,r.quantity.max)}}n({selected:y})},[d,n]),b=m.useCallback(r=>{const c=s(r);if(c===-1||!r.quantity?.enabled)return;const y=[...d],E=y[c].quantity;typeof E!="number"?y[c]={...y[c],quantity:r.quantity.min}:y[c]={...y[c],quantity:Math.max(E-1,r.quantity.min)},n({selected:y})},[d,n]),f=r=>r.price!=null&&r.price>0?`+${r.price.toLocaleString()}`:"";return o()?React.createElement("div",{className:"ts-form-group ts-addon-custom-multiselect"},React.createElement("label",null,e.label),React.createElement("div",{className:"ts-custom-select-cards ts-multi"},l.map(r=>{if(!p(r))return null;const c=s(r),y=c!==-1,E=f(r),k=r.quantity?.enabled&&y,h=y?d[c].quantity:1;return React.createElement("div",{key:r.value,className:`ts-card-choice${y?" ts-selected":""}`,onClick:()=>i(r),role:"option","aria-selected":y},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:y,onChange:()=>{},tabIndex:-1}),React.createElement("span",{className:"checkmark"}))),r.image&&React.createElement("div",{className:"ts-card-image"},React.createElement("img",{src:r.image,alt:r.label})),React.createElement("div",{className:"ts-card-content"},React.createElement("span",{className:"ts-card-label"},r.label),E&&React.createElement("span",{className:"ts-card-price"},E)),k&&React.createElement("div",{className:"ts-stepper-input",onClick:_=>_.stopPropagation()},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:()=>b(r),disabled:h<=(r.quantity?.min??1)},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("span",{className:"ts-stepper-value"},h),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:()=>u(r),disabled:h>=(r.quantity?.max??999)},React.createElement("span",{className:"ts-icon"},"+"))))}))):null}K.getPricingSummary=function(e,t,n,a,l){const d=[],o=n(e),p=a(e),s=e.props.choices??{};return(t.selected??[]).forEach(i=>{const{item:u,quantity:b}=i;if(u===null)return;const f=s[u];if(!f)return;let r=f.label;f.quantity?.enabled&&b>=1&&(r+=` × ${b}`);let c=0;if(o!==null){let y=0;const E=new Date(o.start+"T00:00:00Z"),k=new Date(o.end+"T00:00:00Z");for(;o.count_mode==="nights"?E<k:E<=k;){const h=l(E);if(h!==null){const _=h.prices.addons?.[e.key],N=(_&&typeof _=="object"&&!("price"in _)?_[u]:null)?.price??null;y+=N??f.price}else y+=f.price;E.setDate(E.getDate()+1)}f.quantity?.enabled&&(y*=b),c=y,r+=o.label}else{let y=f.price;if(p!==null){const E=p.prices.addons?.[e.key],h=(E&&typeof E=="object"&&!("price"in E)?E[u]:null)?.price??null;h!=null&&(y=h)}c=y,f.quantity?.enabled&&(c*=b)}d.push({label:r,amount:c})}),d};function Ne(e){return e?Array.isArray(e)?e:Object.entries(e).map(([t,n])=>({...n,key:n.key||t})):[]}const Se=m.forwardRef(function({config:t,values:n,onValueChange:a,bookingValue:l,bookingRangeLength:d,searchContext:o},p){const s=t.props?.fields?.["form-addons"],g=m.useMemo(()=>Ne(s?.props.addons),[s]),i=s?.props.l10n??{},u=t.settings?.product_mode??"regular",b=t.props?.custom_prices,f=m.useCallback(k=>{if(!b?.enabled||!b.list?.length)return null;const h=k.toISOString().split("T")[0],_=k.getUTCDay();for(const w of b.list)for(const N of w.conditions){if(N.type==="date"&&N.date===h)return w;if(N.type==="date_range"&&N.range){const v=new Date(N.range.from+"T00:00:00Z"),x=new Date(N.range.to+"T00:00:00Z");if(k>=v&&k<=x)return w}if(N.type==="day_of_week"&&N.days){const v=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];if(N.days.includes(v[_]))return w}}return null},[b]),r=m.useCallback(k=>{const h=t.props?.fields?.["form-booking"];if(u==="booking")return h&&["single_day","timeslots"].includes(h.props?.mode??"")&&l?.date?f(new Date(l.date+"T00:00:00Z")):null;if(u==="regular"){const _=t.props?.today?.date;if(_)return f(new Date(_+"T00:00:00Z"))}return null},[u,l,t.props,f]),c=m.useCallback(k=>{const h=t.props?.fields?.["form-booking"];if(!h||h.props?.mode!=="date_range"||!k.repeat||!l?.start_date||!l?.end_date)return null;const _=d??0;if(_<1)return null;const w=h.props?.count_mode??"nights";let N="";return _>1&&(w==="nights"?N=` (${(i.amount_nights??"@count nights").replace("@count",String(_))})`:N=` (${(i.amount_days??"@count days").replace("@count",String(_))})`),{length:_,label:N,start:l.start_date,end:l.end_date,count_mode:w}},[t.props,l,d,i]),y=m.useCallback(()=>{const k=[];return g.forEach(h=>{const _=n[h.key];if(!_)return;let w=null;switch(h.type){case"switcher":w=z.getPricingSummary(h,_,c,r,f);break;case"numeric":w=Y.getPricingSummary(h,_,c,r,f);break;case"select":w=W.getPricingSummary(h,_,c,r,f);break;case"multiselect":w=G.getPricingSummary(h,_,c,r,f);break;case"custom-select":w=J.getPricingSummary(h,_,c,r,f);break;case"custom-multiselect":w=K.getPricingSummary(h,_,c,r,f);break}w!==null&&(Array.isArray(w)?k.push(...w):k.push(w))}),k},[g,n,c,r,f]);m.useImperativeHandle(p,()=>({getPricingSummary:y}),[y]);const E=k=>{const h=n[k.key],_=N=>{a(k.key,N)},w={addon:k,getRepeatConfig:c,getCustomPrice:r,getCustomPriceForDate:f};switch(k.type){case"switcher":return React.createElement(z,{key:k.key,...w,value:h??{enabled:!1},onChange:_,searchContext:o});case"numeric":return React.createElement(Y,{key:k.key,...w,value:h??{quantity:null},onChange:_,searchContext:o});case"select":return React.createElement(W,{key:k.key,...w,value:h??{selected:null},onChange:_});case"multiselect":return React.createElement(G,{key:k.key,...w,value:h??{selected:[]},onChange:_});case"custom-select":return React.createElement(J,{key:k.key,...w,value:h??{selected:{item:null,quantity:1}},onChange:_});case"custom-multiselect":return React.createElement(K,{key:k.key,...w,value:h??{selected:[]},onChange:_});default:return null}};return g.length===0?null:React.createElement("div",{className:"ts-form-group ts-field-addons"},g.map(E))});function Re({maxQuantity:e,value:t,onChange:n,label:a="Quantity"}){const l=m.useCallback(()=>{if(typeof t!="number")n(1);else{const g=t+1;n(g<1?1:Math.min(g,e))}},[t,e,n]),d=m.useCallback(()=>{n(typeof t!="number"?1:Math.max(t-1,1))},[t,n]),o=m.useCallback(()=>{typeof t=="number"&&(t>e?n(e):t<1&&n(1))},[t,e,n]),p=m.useCallback(g=>{const i=parseInt(g.target.value,10);isNaN(i)||n(i)},[n]),s=t??1;return React.createElement("div",{className:"ts-form-group ts-field-quantity"},React.createElement("label",null,a),React.createElement("div",{className:"ts-stepper-input"},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:d,disabled:s<=1},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("input",{type:"number",value:s,onChange:p,onBlur:o,min:1,max:e,className:"ts-stepper-value"}),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:l,disabled:s>=e},React.createElement("span",{className:"ts-icon"},"+"))))}function ve({attribute:e,allAttributes:t,variations:n,selections:a,stockEnabled:l,onSelect:d}){const[o,p]=m.useState(!1),s=Object.values(e.props.choices),g=m.useCallback(()=>Object.values(n).filter(k=>{for(const h of t){if(h.key===e.key)break;if(a[h.key]!==k.attributes[h.key])return!1}return!0}),[n,t,e.key,a]);m.useMemo(()=>{const k=g();return s.filter(h=>k.find(_=>_.attributes[e.key]===h.value))},[s,g,e.key]);const i=m.useCallback(k=>{const _=g().filter(N=>N.attributes[e.key]===k.value);return _.length?l?_.find(N=>N._status==="active")?"active":"out_of_stock":"active":"inactive"},[g,e.key,l]),u=m.useCallback(k=>a[e.key]===k.value,[a,e.key]),b=m.useCallback(k=>{i(k)!=="inactive"&&(d(e.key,k.value),p(!1))},[e.key,d,i]),f=m.useMemo(()=>{const k=a[e.key];return s.find(_=>_.value===k)?.label??"Select"},[a,e.key,s]),r=()=>React.createElement("div",{className:"ts-form-group ts-variation-attribute ts-variation-dropdown"},React.createElement("label",null,e.label),React.createElement("div",{className:`ts-filter ts-popup-target${a[e.key]?" ts-filled":""}`,onClick:()=>p(!o),role:"button",tabIndex:0,onKeyDown:k=>k.key==="Enter"&&p(!o)},React.createElement("span",{className:"ts-filter-text"},f),React.createElement("div",{className:"ts-down-icon"})),o&&React.createElement("div",{className:"ts-popup-list"},React.createElement("ul",{className:"simplify-ul ts-form-options"},s.map(k=>{const h=i(k),_=u(k);return React.createElement("li",{key:k.value,className:`ts-option${_?" ts-selected":""}${h==="inactive"?" ts-inactive":""}${h==="out_of_stock"?" ts-out-of-stock":""}`,onClick:()=>b(k),role:"option","aria-selected":_,"aria-disabled":h==="inactive"},React.createElement("span",{className:"option-label"},k.label),h==="out_of_stock"&&React.createElement("span",{className:"option-status"},"Out of stock"))})))),c=()=>React.createElement("div",{className:"ts-form-group ts-variation-attribute ts-variation-buttons"},React.createElement("label",null,e.label),React.createElement("div",{className:"ts-variation-options ts-buttons-list"},s.map(k=>{const h=i(k),_=u(k);return React.createElement("button",{key:k.value,type:"button",className:`ts-btn ts-btn-4${_?" ts-selected":""}${h==="inactive"?" ts-inactive":""}${h==="out_of_stock"?" ts-out-of-stock":""}`,onClick:()=>b(k),disabled:h==="inactive"},k.label)}))),y=()=>React.createElement("div",{className:"ts-form-group ts-variation-attribute ts-variation-images"},React.createElement("label",null,e.label),React.createElement("div",{className:"ts-variation-options ts-images-list"},s.map(k=>{const h=i(k),_=u(k);return React.createElement("div",{key:k.value,className:`ts-variation-image${_?" ts-selected":""}${h==="inactive"?" ts-inactive":""}${h==="out_of_stock"?" ts-out-of-stock":""}`,onClick:()=>b(k),role:"button",tabIndex:h==="inactive"?-1:0,title:k.label},k.image?React.createElement("img",{src:k.image,alt:k.label}):React.createElement("span",{className:"ts-image-placeholder"},k.label.charAt(0)))}))),E=()=>React.createElement("div",{className:"ts-form-group ts-variation-attribute ts-variation-colors"},React.createElement("label",null,e.label),React.createElement("div",{className:"ts-variation-options ts-colors-list"},s.map(k=>{const h=i(k),_=u(k);return React.createElement("div",{key:k.value,className:`ts-variation-color${_?" ts-selected":""}${h==="inactive"?" ts-inactive":""}${h==="out_of_stock"?" ts-out-of-stock":""}`,onClick:()=>b(k),role:"button",tabIndex:h==="inactive"?-1:0,title:k.label,style:{backgroundColor:k.color||"#ccc"}},_&&React.createElement("span",{className:"ts-color-check"},"✓"))})));switch(e.display_type){case"buttons":return c();case"images":return y();case"colors":return E();default:return r()}}function X({field:e,value:t,onChange:n}){const[a,l]=m.useState(()=>({...e.props.selections})),d=m.useMemo(()=>Object.values(e.props.attributes),[e.props.attributes]),o=e.props.variations,p=e.props.stock?.enabled??!1,s=m.useMemo(()=>t.variation_id?o[t.variation_id]??null:null,[t.variation_id,o]),g=m.useCallback(()=>{if(s)if(p&&s.config.stock.enabled&&!s.config.stock.sold_individually){const h=s.config.stock.quantity;t.quantity>h?n({...t,quantity:h}):t.quantity<1&&n({...t,quantity:1})}else t.quantity!==1&&n({...t,quantity:1})},[s,p,t,n]),i=m.useCallback(()=>{let h=null;const _=Object.values(o).filter(w=>w._status==="active");for(const w of Object.keys(a)){const N=_.filter(v=>{for(const x of Object.keys(a))if(v.attributes[x]!==a[x])return!1;return!0});if(N.length){h=N[0];break}}if(!h&&_.length){h=_[0];const w={};Object.keys(a).forEach(N=>{w[N]=h.attributes[N]}),l(w)}if(h&&(t.variation_id!==h.id&&n({...t,variation_id:h.id}),h.image)){const w=document.getElementById("ts-media-"+h.image.id);w?.parentElement&&(w.parentElement.scrollLeft=w.offsetLeft)}},[o,a,t,n]),u=m.useCallback(()=>{for(const h of Object.values(o))if(h._status==="active"){const _={};Object.keys(a).forEach(w=>{_[w]=h.attributes[w]}),l(_),n({...t,variation_id:h.id});break}},[o,a,t,n]),b=m.useCallback((h,_)=>{l(w=>({...w,[h]:_}))},[]);m.useEffect(()=>{i()},[a]),m.useEffect(()=>{s&&g()},[s]),m.useEffect(()=>{t.variation_id||u()},[]);const f=m.useCallback(()=>{if(!s)return;const h=s.config.stock.quantity;if(typeof t.quantity!="number")n({...t,quantity:1});else{const _=t.quantity+1;n({...t,quantity:_<1?1:Math.min(_,h)})}},[s,t,n]),r=m.useCallback(()=>{typeof t.quantity!="number"?n({...t,quantity:1}):n({...t,quantity:Math.max(t.quantity-1,1)})},[t,n]),c=m.useCallback(h=>{const _=parseInt(h.target.value,10);isNaN(_)||n({...t,quantity:_})},[t,n]),y=m.useCallback(()=>{if(!s)return;const h=s.config.stock.quantity;typeof t.quantity=="number"&&(t.quantity>h?n({...t,quantity:h}):t.quantity<1&&n({...t,quantity:1}))},[s,t,n]),E=s&&p&&s.config.stock.enabled&&!s.config.stock.sold_individually,k=s?.config.stock.quantity??1;return d.length===0?null:React.createElement("div",{className:"ts-field-variations"},d.map(h=>React.createElement(ve,{key:h.key,attribute:h,allAttributes:d,variations:o,selections:a,stockEnabled:p,onSelect:b})),E&&React.createElement("div",{className:"ts-form-group ts-variation-quantity"},React.createElement("label",null,"Quantity"),React.createElement("div",{className:"ts-stepper-input"},React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-minus",onClick:r,disabled:t.quantity<=1},React.createElement("span",{className:"ts-icon"},"-")),React.createElement("input",{type:"number",value:t.quantity,onChange:c,onBlur:y,min:1,max:k,className:"ts-stepper-value"}),React.createElement("button",{type:"button",className:"ts-stepper-btn ts-stepper-plus",onClick:f,disabled:t.quantity>=k},React.createElement("span",{className:"ts-icon"},"+")))))}X.getPricingSummary=function(e,t){if(!t.variation_id)return null;const n=e.props.variations[t.variation_id];if(!n)return null;const a=n.config.base_price;let l=a.discount_amount!=null?a.discount_amount:a.amount,d=null;(e.props.stock?.enabled??!1)&&n.config.stock.enabled&&!n.config.stock.sold_individually&&(d=t.quantity,l*=t.quantity);const p=[];return Object.keys(n.attributes).forEach(s=>{const g=n.attributes[s],i=e.props.attributes[s];if(i){const u=i.props.choices["choice_"+g];u&&p.push(u.label)}}),{label:p.join(" / "),amount:l,quantity:d}};function Q(e){const t=m.useRef(null),n=m.useRef(null),a=m.useRef(e);a.current=e,m.useEffect(()=>{if(!t.current||typeof window.Pikaday>"u")return;const i={field:t.current,bound:a.current.bound??!0,format:a.current.format??"YYYY-MM-DD",minDate:a.current.minDate,maxDate:a.current.maxDate,defaultDate:a.current.defaultDate,setDefaultDate:!!a.current.defaultDate,disableDayFn:a.current.disableDayFn,numberOfMonths:a.current.numberOfMonths??1,showDaysInNextAndPreviousMonths:!0,enableSelectionDaysInNextAndPreviousMonths:!1,firstDay:1,onSelect:u=>{a.current.onSelect?.(u)},onDraw:u=>{a.current.onDraw?.(u)}};return a.current.container&&(i.container=a.current.container,i.bound=!1),n.current=new window.Pikaday(i),()=>{n.current?.destroy(),n.current=null}},[]),m.useEffect(()=>{n.current&&e.minDate&&n.current.setMinDate(e.minDate)},[e.minDate]),m.useEffect(()=>{n.current&&e.maxDate&&n.current.setMaxDate(e.maxDate)},[e.maxDate]);const l=m.useCallback(i=>{n.current?.setDate(i,!0)},[]),d=m.useCallback(()=>n.current?.getDate()??null,[]),o=m.useCallback(()=>{n.current?.show()},[]),p=m.useCallback(()=>{n.current?.hide()},[]),s=m.useCallback(i=>{n.current?.gotoDate(i)},[]),g=m.useCallback(()=>{n.current?.draw(!0)},[]);return{inputRef:t,pickerRef:n,setDate:l,getDate:d,show:o,hide:p,gotoDate:s,redraw:g}}function O(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${a}`}function T(e){return new Date(e+"T00:00:00")}function oe(e){return["sun","mon","tue","wed","thu","fri","sat"][e.getDay()]}function xe(e,t){const n=O(e);return t.includes(n)}function De(e,t){const n=oe(e);return t.includes(n)}function Ce(e,t){const n=T(t.date);return e<n}function qe(e,t,n){if(!n||n.amount<=0)return!1;const a=T(t.date);if(n.unit==="hours"){const[l,d]=t.time.split(":").map(Number);a.setHours(l,d,0,0);const o=n.amount*60*60*1e3;return e.getTime()-a.getTime()<o}else{const l=new Date(a);return l.setDate(l.getDate()+n.amount),e<l}}function Pe(e,t,n){const a=T(t.date),l=new Date(a);return l.setDate(l.getDate()+n),e>l}function Te(e,t){const{excluded_days:n=[],excluded_weekdays:a=[],availability:l,today:d}=t.props;return!(xe(e,n)||De(e,a)||d&&(Ce(e,d)||qe(e,d,l?.buffer)||l?.max_days&&Pe(e,d,l.max_days)))}function Ie(e,t){const{timeslots:n,quantity_per_slot:a=1,booked_slot_counts:l={}}=t.props;if(!n?.groups)return[];const d=oe(e),o=O(e),p=[];for(const s of n.groups)if(s.days.includes(d))for(const g of s.slots){const i=`${g.from}-${g.to}`,u=`${o} ${i}`,b=l[u]||0,f=Math.max(0,a-b);p.push({...g,key:i,label:`${g.from} - ${g.to}`,available:f,booked:b,isAvailable:f>0})}return p}function V(e,t,n){const a=T(e),d=T(t).getTime()-a.getTime(),o=Math.ceil(d/(1e3*60*60*24));return n==="nights"?o:o+1}function Be(e,t,n){const{count_mode:a="nights",date_range:l,l10n:d}=n.props,o=V(e,t,a);if(!l)return{valid:!0,length:o};const{min_length:p=1,max_length:s=365}=l;if(o<p||o>s){const g=a==="nights"?d?.nights_range_error??"Min @minlength, max @maxlength nights":d?.days_range_error??"Min @minlength, max @maxlength days";return{valid:!1,length:o,error:g.replace("@minlength",String(p)).replace("@maxlength",String(s))}}return{valid:!0,length:o}}function ie(e,t,n){return t==="nights"?e===1?n?.one_night??"1 night":(n?.multiple_nights??"@count nights").replace("@count",String(e)):e===1?n?.one_day??"1 day":(n?.multiple_days??"@count days").replace("@count",String(e))}function $(e){const{today:t,availability:n}=e.props;if(!t)return new Date;const a=T(t.date);if(n?.buffer)if(n.buffer.unit==="days")a.setDate(a.getDate()+n.buffer.amount);else{const[l]=t.time.split(":").map(Number);l+n.buffer.amount>=24&&a.setDate(a.getDate()+1)}return a}function ee(e){const{today:t,availability:n}=e.props;if(!t){const l=new Date;return l.setFullYear(l.getFullYear()+1),l}const a=T(t.date);return a.setDate(a.getDate()+(n?.max_days??365)),a}function te(e){return t=>!Te(t,e)}function R(e){return typeof window<"u"&&window.Voxel?.helpers?.currencyFormat?window.Voxel.helpers.currencyFormat(e):new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function Oe(e){if(typeof window<"u"&&window.Voxel?.helpers?.dateFormatYmd)return window.Voxel.helpers.dateFormatYmd(e);const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${a}`}function ue(e,t){const n=t.props?.custom_prices;if(!n?.enabled||!n.list?.length)return null;const a=Oe(e);return n.list.find(d=>{for(const o of d.conditions)if(o.type==="date"){if(o.date===a)return!0}else if(o.type==="date_range"){if(o.range){const p=new Date(o.range.from+"T00:00:00Z"),s=new Date(o.range.to+"T00:00:00Z"),g=new Date(a+"T00:00:00Z");if(p<=g&&g<=s)return!0}}else if(o.type==="day_of_week"){const p=new Date(a+"T00:00:00Z"),g=["sun","mon","tue","wed","thu","fri","sat"][p.getDay()];if(o.days?.includes(g))return!0}return!1})??null}function ne(e,t){const n=t.props?.minimum_price??0;if(!t.props?.custom_prices?.enabled||e===null)return n;const a=ue(e,t);return a===null?n:a.minimum_price??n}function Me(e){const t=e.props?.base_price;if(!t?.enabled)return null;let n=t.discount_amount??t.amount;if(e.settings?.product_mode==="regular"){const a=e.props?.today?.date;if(a){const l=ue(new Date(a+"T00:00:00Z"),e);l?.prices?.base_price&&(n=l.prices.base_price.discount_amount??l.prices.base_price.amount)}}return{label:"Price",amount:n}}function Ae(e,t){return e.props?.fields?.["form-quantity"]&&t>1?t:1}function ae(e){return e.reduce((t,n)=>t+(n.amount??0),0)}function Ve(e){const{config:t,quantity:n,bookingValue:a,getAddonsPricingSummary:l,getVariationsPricingSummary:d}=e,o=m.useCallback(()=>{if(!t)return{visible_items:[],total:0,formatted_total:R(0)};const i=[],u=Me(t),b=l?.()??null,f=Ae(t,n);u!==null&&i.push({key:"base_price",...u,hidden:b===null||b.length===0}),b!==null&&b.forEach((E,k)=>{i.push({key:`addon_${k}`,...E})}),f>1&&i.push({key:"quantity",label:t.l10n?.quantity??"Quantity",amount:0,value:f});let r=ae(i);r*=f;const c={key:"total",label:"Total",price:r,formatted_price:R(r)},y=i.filter(E=>!E.hidden).map(E=>({key:E.key,label:E.label,price:E.amount,formatted_price:E.value!==void 0?`× ${E.value}`:R(E.amount)}));return y.push(c),{visible_items:y,total:r,formatted_total:R(r)}},[t,n,l]),p=m.useCallback(()=>{if(!t)return{visible_items:[],total:0,formatted_total:R(0)};const i=[],u=d?.()??null;u!==null&&(i.push({key:"variation",label:u.label,amount:u.amount}),u.quantity&&u.quantity>1&&i.push({key:"quantity",label:t.l10n?.quantity??"Quantity",amount:0,value:u.quantity}));const b=ae(i),f={key:"total",label:"Total",price:b,formatted_price:R(b)},r=i.filter(c=>!c.hidden).map(c=>({key:c.key,label:c.label,price:c.amount,formatted_price:c.value!==void 0?`× ${c.value}`:R(c.amount)}));return r.push(f),{visible_items:r,total:b,formatted_total:R(b)}},[t,d]),s=m.useCallback(()=>{if(!t)return{visible_items:[],total:0,formatted_total:R(0)};const i=[],u=t.props?.fields?.["form-booking"],b=u?F.getPricingSummary(u,a,t):null,f=l?.()??null;b!==null&&(i.push({key:"booking",label:b.label,amount:b.amount,hidden:b.amount===0}),f!==null&&f.forEach((E,k)=>{i.push({key:`addon_${k}`,...E})}));const r=ae(i),c={key:"total",label:"Total",price:r,formatted_price:R(r)},y=i.filter(E=>!E.hidden).map(E=>({key:E.key,label:E.label,price:E.amount,formatted_price:R(E.amount)}));return(r>0||y.length>0)&&y.push(c),{visible_items:y,total:r,formatted_total:R(r)}},[t,a,l]);return{summary:m.useMemo(()=>{if(!t)return{visible_items:[],total:0,formatted_total:R(0)};switch(t.settings?.product_mode??"regular"){case"regular":return o();case"variable":return p();case"booking":return s();default:return{visible_items:[],total:0,formatted_total:R(0)}}},[t,o,p,s]),formatPrice:R}}function de(e,t){if(!e||!t)return;e.querySelectorAll(".pika-button").forEach(a=>{const l=a,d=l.dataset,o=parseInt(d.pikaYear??"0",10),p=parseInt(d.pikaMonth??"0",10),s=parseInt(d.pikaDay??"0",10);if(o&&s){const g=new Date(o,p,s),i=ne(g,t);i>0&&l.setAttribute("title",R(i))}})}function me({field:e,value:t,onChange:n,initialAvailability:a,config:l}){const[d,o]=m.useState("start"),[p,s]=m.useState(null),[g,i]=m.useState(!1),u=m.useRef(null),b=m.useRef(null),{count_mode:f="nights",l10n:r}=e.props;m.useEffect(()=>{g||a?.start&&(t.start_date||t.end_date||(i(!0),n({...t,start_date:a.start,end_date:a.end||a.start})))},[a,g,t,n]);const c=m.useMemo(()=>$(e),[e]),y=m.useMemo(()=>ee(e),[e]),E=m.useMemo(()=>te(e),[e]),k=m.useMemo(()=>!t.start_date||!t.end_date?null:Be(t.start_date,t.end_date,e),[t.start_date,t.end_date,e]);m.useEffect(()=>{k&&!k.valid?s(k.error??null):s(null)},[k]);const h=m.useCallback(q=>{const D=O(q);t.end_date&&D>=t.end_date?n({...t,start_date:D,end_date:null}):n({...t,start_date:D}),o("end")},[t,n]),_=m.useCallback(q=>{const D=O(q);t.start_date&&D<=t.start_date?n({...t,start_date:D,end_date:t.start_date}):n({...t,end_date:D}),o("start")},[t,n]),w=m.useCallback(()=>{de(u.current,l??null)},[l]),N=m.useCallback(()=>{de(b.current,l??null)},[l]),v=Q({onSelect:h,onDraw:w,minDate:c,maxDate:y,defaultDate:t.start_date?T(t.start_date):void 0,disableDayFn:E,container:u.current,bound:!1}),x=m.useMemo(()=>{if(!t.start_date)return c;const q=T(t.start_date);return q.setDate(q.getDate()+1),q>c?q:c},[t.start_date,c]),C=Q({onSelect:_,onDraw:N,minDate:x,maxDate:y,defaultDate:t.end_date?T(t.end_date):void 0,disableDayFn:E,container:b.current,bound:!1});m.useEffect(()=>{t.start_date&&v.setDate(t.start_date)},[t.start_date]),m.useEffect(()=>{t.end_date&&C.setDate(t.end_date)},[t.end_date]);const S=r?.select_start_and_end_date??"Select start date",B=r?.select_end_date??"Select end date",I=f==="nights"?r?.select_nights??"Select nights":r?.select_days??"Select days",H=m.useMemo(()=>{if(!t.start_date)return I;if(!t.end_date)return`${t.start_date} - ...`;const q=V(t.start_date,t.end_date,f),D=ie(q,f,r);return`${t.start_date} - ${t.end_date} (${D})`},[t.start_date,t.end_date,f,r,I]);return React.createElement("div",{className:"ts-form-group ts-booking-field ts-booking-date-range"},React.createElement("label",null,f==="nights"?"Dates":"Days"),React.createElement("div",{className:`ts-filter ts-popup-target${t.start_date?" ts-filled":""}`},React.createElement("span",{className:"ts-filter-text"},H),React.createElement("div",{className:"ts-down-icon"})),React.createElement("div",{className:"ts-booking-calendars"},React.createElement("div",{className:"ts-booking-calendar ts-booking-start"},React.createElement("div",{className:"ts-calendar-label"},S),React.createElement("div",{ref:u,className:`ts-calendar-container${d==="start"?" ts-active":""}`},React.createElement("input",{ref:v.inputRef,type:"hidden",readOnly:!0}))),React.createElement("div",{className:"ts-booking-calendar ts-booking-end"},React.createElement("div",{className:"ts-calendar-label"},B),React.createElement("div",{ref:b,className:`ts-calendar-container${d==="end"?" ts-active":""}`},React.createElement("input",{ref:C.inputRef,type:"hidden",readOnly:!0})))),p&&React.createElement("div",{className:"ts-field-error"},React.createElement("span",null,p)))}me.getSelectedRangeLength=function(e,t){return!e.start_date||!e.end_date?0:V(e.start_date,e.end_date,t.props.count_mode??"nights")};function Fe(e,t){if(!e||!t)return;e.querySelectorAll(".pika-button").forEach(a=>{const l=a,d=l.dataset,o=parseInt(d.pikaYear??"0",10),p=parseInt(d.pikaMonth??"0",10),s=parseInt(d.pikaDay??"0",10);if(o&&s){const g=new Date(o,p,s),i=ne(g,t);i>0&&l.setAttribute("title",R(i))}})}function Le({field:e,value:t,onChange:n,initialAvailability:a,config:l}){const d=m.useRef(null),[o,p]=m.useState(!1),{l10n:s}=e.props;m.useEffect(()=>{o||a?.start&&(t.date||(p(!0),n({...t,date:a.start})))},[a,o,t,n]);const g=m.useMemo(()=>$(e),[e]),i=m.useMemo(()=>ee(e),[e]),u=m.useMemo(()=>te(e),[e]),b=m.useCallback(E=>{n({...t,date:O(E)})},[t,n]),f=m.useCallback(()=>{Fe(d.current,l??null)},[l]),r=Q({onSelect:b,onDraw:f,minDate:g,maxDate:i,defaultDate:t.date?T(t.date):void 0,disableDayFn:u,container:d.current,bound:!1});m.useEffect(()=>{t.date&&r.setDate(t.date)},[t.date]);const c=s?.select_date??"Select date",y=t.date??c;return React.createElement("div",{className:"ts-form-group ts-booking-field ts-booking-single-day"},React.createElement("label",null,"Date"),React.createElement("div",{className:`ts-filter ts-popup-target${t.date?" ts-filled":""}`},React.createElement("span",{className:"ts-filter-text"},y),React.createElement("div",{className:"ts-down-icon"})),React.createElement("div",{className:"ts-booking-calendars"},React.createElement("div",{className:"ts-booking-calendar"},React.createElement("div",{ref:d,className:"ts-calendar-container ts-active"},React.createElement("input",{ref:r.inputRef,type:"hidden",readOnly:!0})))))}function je(e,t){if(!e||!t)return;e.querySelectorAll(".pika-button").forEach(a=>{const l=a,d=l.dataset,o=parseInt(d.pikaYear??"0",10),p=parseInt(d.pikaMonth??"0",10),s=parseInt(d.pikaDay??"0",10);if(o&&s){const g=new Date(o,p,s),i=ne(g,t);i>0&&l.setAttribute("title",R(i))}})}function Qe({field:e,value:t,onChange:n,initialAvailability:a,config:l}){const d=m.useRef(null),[o,p]=m.useState(!1),[s,g]=m.useState(!1),{l10n:i,quantity_per_slot:u=1}=e.props;m.useEffect(()=>{s||a?.start&&(t.date||(g(!0),n({...t,date:a.start})))},[a,s,t,n]);const b=m.useMemo(()=>$(e),[e]),f=m.useMemo(()=>ee(e),[e]),r=m.useMemo(()=>te(e),[e]),c=m.useMemo(()=>{if(!t.date)return[];const S=T(t.date);return Ie(S,e)},[t.date,e]),y=m.useCallback(S=>{const B=O(S);n({...t,date:B,slot:null}),p(!0)},[t,n]),E=m.useCallback(S=>{S.isAvailable&&(n({...t,slot:S.key}),p(!1))},[t,n]),k=m.useCallback(()=>{je(d.current,l??null)},[l]),h=Q({onSelect:y,onDraw:k,minDate:b,maxDate:f,defaultDate:t.date?T(t.date):void 0,disableDayFn:r,container:d.current,bound:!1});m.useEffect(()=>{t.date&&h.setDate(t.date)},[t.date]);const _=i?.select_date??"Select date",w=i?.select_timeslot??"Select time",N=i?.no_slots_available??"No time slots available",v=i?.amount_available??"@count available",x=t.date??_,C=m.useMemo(()=>t.slot?c.find(B=>B.key===t.slot)?.label??t.slot:w,[t.slot,c,w]);return React.createElement("div",{className:"ts-form-group ts-booking-field ts-booking-timeslots"},React.createElement("div",{className:"ts-booking-date-section"},React.createElement("label",null,"Date"),React.createElement("div",{className:`ts-filter ts-popup-target${t.date?" ts-filled":""}`},React.createElement("span",{className:"ts-filter-text"},x),React.createElement("div",{className:"ts-down-icon"})),React.createElement("div",{className:"ts-booking-calendars"},React.createElement("div",{className:"ts-booking-calendar"},React.createElement("div",{ref:d,className:"ts-calendar-container ts-active"},React.createElement("input",{ref:h.inputRef,type:"hidden",readOnly:!0}))))),t.date&&React.createElement("div",{className:"ts-booking-slots-section"},React.createElement("label",null,"Time"),React.createElement("div",{className:`ts-filter ts-popup-target${t.slot?" ts-filled":""}`,onClick:()=>p(!o),role:"button",tabIndex:0,onKeyDown:S=>S.key==="Enter"&&p(!o)},React.createElement("span",{className:"ts-filter-text"},C),React.createElement("div",{className:"ts-down-icon"})),o&&React.createElement("div",{className:"ts-popup-list ts-timeslot-list"},c.length===0?React.createElement("div",{className:"ts-no-slots"},React.createElement("span",null,N)):React.createElement("ul",{className:"simplify-ul ts-form-options"},c.map(S=>React.createElement("li",{key:S.key,className:`ts-option${t.slot===S.key?" ts-selected":""}${S.isAvailable?"":" ts-unavailable"}`,onClick:()=>E(S),role:"option","aria-selected":t.slot===S.key,"aria-disabled":!S.isAvailable},React.createElement("span",{className:"ts-slot-time"},S.label),u>1&&React.createElement("span",{className:"ts-slot-availability"},S.isAvailable?v.replace("@count",String(S.available)):"Fully booked")))))))}function F({field:e,value:t,onChange:n,config:a,initialAvailability:l}){switch(e.props.mode){case"date_range":return React.createElement(me,{field:e,value:t,onChange:n,initialAvailability:l,config:a});case"single_day":return React.createElement(Le,{field:e,value:t,onChange:n,initialAvailability:l,config:a});case"timeslots":return React.createElement(Qe,{field:e,value:t,onChange:n,initialAvailability:l,config:a});default:return null}}F.getPricingSummary=function(e,t,n){const{mode:a,count_mode:l="nights",l10n:d}=e.props,o=n?.props?.base_price;if(!o?.enabled)return null;const p=o.discount_amount??o.amount;let s=p,g=d?.booking_price??"Booking";if(a==="date_range"){if(!t.start_date||!t.end_date)return null;const i=V(t.start_date,t.end_date,l);if(i<1)return null;s=p*i,g=ie(i,l,d)}else if(a==="single_day"){if(!t.date)return null}else if(a==="timeslots"&&(!t.date||!t.slot))return null;return{label:g,amount:s,hidden:s===0}},F.isComplete=function(e,t){const{mode:n}=e.props;switch(n){case"date_range":return!!t.start_date&&!!t.end_date;case"single_day":return!!t.date;case"timeslots":return!!t.date&&!!t.slot;default:return!1}},F.getSelectedRangeLength=function(e,t){return e.props.mode!=="date_range"?1:!t.start_date||!t.end_date?0:V(t.start_date,t.end_date,e.props.count_mode??"nights")};function pe(e){return e?.value?e.library==="line-awesome"||e.value.startsWith("la-")?React.createElement("i",{className:`las ${e.value}`}):React.createElement("i",{className:`las ${e.value}`}):null}function Ue({dataInput:e,value:t,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"text",className:"ts-filter",value:t||"",onChange:a=>n(a.target.value),placeholder:e.props.placeholder,minLength:e.props.minlength,maxLength:e.props.maxlength})))}function He({dataInput:e,value:t,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"input-container"},React.createElement("textarea",{className:"ts-filter min-scroll",value:t||"",onChange:a=>n(a.target.value),placeholder:e.props.placeholder,minLength:e.props.minlength,maxLength:e.props.maxlength})))}function Ze({dataInput:e,value:t,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"email",className:"ts-filter",value:t||"",onChange:a=>n(a.target.value),placeholder:e.props.placeholder})))}function ze({dataInput:e,value:t,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"tel",className:"ts-filter",value:t||"",onChange:a=>n(a.target.value),placeholder:e.props.placeholder})))}function Ye({dataInput:e,value:t,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"url",className:"ts-filter",value:t||"",onChange:a=>n(a.target.value),placeholder:e.props.placeholder})))}function We({dataInput:e,value:t,onChange:n}){return React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"date",className:"ts-filter",value:t||"",onChange:a=>n(a.target.value),placeholder:e.props.placeholder,style:{display:"block"}})))}function Ge({dataInput:e,value:t,onChange:n}){return React.createElement("div",{className:"ts-form-group switcher-label"},React.createElement("label",null,React.createElement("div",{className:"switch-slider"},React.createElement("div",{className:"onoffswitch"},React.createElement("input",{type:"checkbox",className:"onoffswitch-checkbox",checked:t||!1,onChange:a=>n(a.target.checked)}),React.createElement("label",{className:"onoffswitch-label",onClick:a=>{a.preventDefault(),n(!t)}}))),e.label))}function Je({dataInput:e,value:t,onChange:n,icons:a}){const{min:l=0,max:d=999999,display_mode:o="default"}=e.props,p=m.useCallback(u=>u===null?null:u<l?l:u>d?d:u,[l,d]),s=m.useCallback(()=>{const b=p((typeof t=="number"?t:l)+1);n(b)},[t,l,p,n]),g=m.useCallback(()=>{const b=p((typeof t=="number"?t:l)-1);n(b)},[t,l,p,n]),i=m.useCallback(u=>{const b=u.target.value===""?null:parseInt(u.target.value,10);n(p(b))},[p,n]);return o==="stepper"?React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"ts-stepper-input flexify"},React.createElement("button",{className:`ts-stepper-left ts-icon-btn${(t??0)<=l?" vx-disabled":""}`,onClick:u=>{u.preventDefault(),g()},type:"button"},pe(a?.minusIcon)||React.createElement("i",{className:"las la-minus"})),React.createElement("input",{type:"number",className:"ts-input-box",value:t??"",onChange:i,placeholder:e.props.placeholder}),React.createElement("button",{className:`ts-stepper-right ts-icon-btn${(t??0)>=d?" vx-disabled":""}`,onClick:u=>{u.preventDefault(),s()},type:"button"},pe(a?.plusIcon)||React.createElement("i",{className:"las la-plus"})))):React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"input-container"},React.createElement("input",{type:"number",className:"ts-filter",value:t??"",onChange:i,placeholder:e.props.placeholder,min:l,max:d})))}function Ke({dataInput:e,value:t,onChange:n}){const{display_mode:a="default",choices:l={},placeholder:d,l10n:o}=e.props,p=m.useMemo(()=>Object.values(l),[l]),s=m.useCallback(i=>t===i.value,[t]),g=m.useCallback(i=>{t===i.value?n(null):n(i.value)},[t,n]);return a==="buttons"?React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("ul",{className:"simplify-ul addon-buttons flexify"},p.map(i=>React.createElement("li",{key:i.value,className:`flexify${s(i)?" adb-selected":""}`,onClick:u=>{u.preventDefault(),g(i)}},i.label)))):a==="radio"?React.createElement("div",{className:"ts-form-group inline-terms-wrapper ts-inline-filter"},React.createElement("label",null,e.label),React.createElement("ul",{className:"simplify-ul ts-addition-list flexify"},p.map(i=>React.createElement("li",{key:i.value,className:`flexify${s(i)?" ts-checked":""}`},React.createElement("div",{className:"addition-body",onClick:u=>{u.preventDefault(),g(i)}},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",value:i.value,checked:s(i),className:"onoffswitch-checkbox",disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"})),React.createElement("span",null,i.label)))))):React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("div",{className:"ts-filter"},React.createElement("select",{value:t??"",onChange:i=>n(i.target.value||null)},React.createElement("option",{value:""},d||o?.default_placeholder||"Select..."),p.map(i=>React.createElement("option",{key:i.value,value:i.value},i.label))),React.createElement("div",{className:"ts-down-icon"})))}function Xe({dataInput:e,value:t,onChange:n}){const{display_mode:a="default",choices:l={}}=e.props,d=m.useMemo(()=>Object.values(l),[l]),o=m.useCallback(s=>(t||[]).includes(s.value),[t]),p=m.useCallback(s=>{const g=t||[];g.includes(s.value)?n(g.filter(i=>i!==s.value)):n([...g,s.value])},[t,n]);return a==="buttons"?React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,e.label),React.createElement("ul",{className:"simplify-ul addon-buttons flexify"},d.map(s=>React.createElement("li",{key:s.value,className:`flexify${o(s)?" adb-selected":""}`,onClick:g=>{g.preventDefault(),p(s)}},s.label)))):React.createElement("div",{className:"ts-form-group ts-custom-additions"},React.createElement("label",null,e.label),React.createElement("ul",{className:"simplify-ul ts-addition-list flexify"},d.map(s=>React.createElement("li",{key:s.value,className:`flexify${o(s)?" ts-checked":""}`},React.createElement("div",{className:"addition-body",onClick:g=>{g.preventDefault(),p(s)}},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:o(s),className:"onoffswitch-checkbox",disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"})),React.createElement("span",null,s.label))))))}function $e({field:e,values:t,onValueChange:n,icons:a}){const l=m.useMemo(()=>Object.values(e.props.data_inputs||{}),[e.props.data_inputs]);return l.length?React.createElement(React.Fragment,null,l.map(d=>{const o=d.key,p=t[o];switch(d.type){case"text":return React.createElement(Ue,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"textarea":return React.createElement(He,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"email":return React.createElement(Ze,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"phone":return React.createElement(ze,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"url":return React.createElement(Ye,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"date":return React.createElement(We,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"switcher":return React.createElement(Ge,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"number":return React.createElement(Je,{key:o,dataInput:d,value:p,onChange:s=>n(o,s),icons:a});case"select":return React.createElement(Ke,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});case"multiselect":return React.createElement(Xe,{key:o,dataInput:d,value:p,onChange:s=>n(o,s)});default:return null}})):null}const fe="voxel:guest_cart",et="voxel:direct_cart";function se(e,t){return`${window.Voxel_Config?.ajax_url??"/?vx=1"}&action=${e}&_wpnonce=${t}`}function tt(){return window.Voxel_Config?.is_logged_in??!1}function nt(){return typeof localStorage>"u"?null:localStorage.getItem(fe)}function at(e){typeof localStorage>"u"||localStorage.setItem(fe,JSON.stringify(e))}function st(e,t){typeof localStorage>"u"||localStorage.setItem(et,JSON.stringify({[e]:t}))}function L(e,t="info",n,a){window.Voxel?.alert?window.Voxel.alert(e,t,n,a):console.log(`[${t.toUpperCase()}]`,e)}function rt(e){const t=[];typeof document<"u"&&document.querySelector(".ts-popup-cart > a")&&t.push({label:e.view_cart??"View Cart",link:"#",onClick:n=>{n.preventDefault(),window.Voxel?.openCart&&window.Voxel.openCart(),n.target.closest(".ts-notice")?.querySelector(".close-alert")?.click()}}),L(e.added_to_cart??"Added to cart","success",t,4e3)}function ct(e){window.jQuery&&window.jQuery(document).trigger("voxel:added_cart_item",e)}function ye(e,t,n,a,l,d={}){const o=e.settings?.product_mode??"regular",p={post_id:0};return Object.keys(t).length>0&&(p.addons=t),o==="regular"?p.stock={quantity:n}:o==="variable"?p.variations=a:o==="booking"&&(p.booking=l),Object.keys(d).length>0&&(p.data_inputs=d),p}async function re(e,t){if(window.jQuery?.post)return new Promise(a=>{window.jQuery.post(e,t).always(l=>{a(l)})});const n=new FormData;Object.entries(t).forEach(([a,l])=>{n.append(a,l)});try{return await(await fetch(e,{method:"POST",body:n})).json()}catch{return{success:!1,message:window.Voxel_Config?.l10n?.ajaxError??"Request failed"}}}function lt(e){const{config:t,addonValues:n,quantity:a,variationsValue:l,bookingValue:d,dataInputValues:o}=e,[p,s]=m.useState(!1),[g,i]=m.useState(null),u=m.useCallback(async()=>{if(!t)return i("Product configuration not available"),!1;s(!0),i(null);try{const f=t.settings?.cart_nonce??t.nonce,r=ye(t,n,a,l,d,o),c={...t.value??{},...r};let y;if(tt()){const E=se("products.add_to_cart",f);y=await re(E,{item:JSON.stringify(c)})}else{const E=se("products.add_to_guest_cart",f);y=await re(E,{item:JSON.stringify(c),guest_cart:nt()??""}),y.success&&y.guest_cart&&at(y.guest_cart)}if(y.success)return ct(y.item),rt({added_to_cart:t.l10n?.added_to_cart,view_cart:t.l10n?.view_cart}),!0;{const E=y.message??"Failed to add to cart";return i(E),L(E,"error"),!1}}catch(f){const r=f instanceof Error?f.message:"Failed to add to cart";return i(r),L(r,"error"),!1}finally{s(!1)}},[t,n,a,l,d,o]),b=m.useCallback(async()=>{if(!t)return i("Product configuration not available"),!1;s(!0),i(null);try{const f=t.settings?.cart_nonce??t.nonce,r=ye(t,n,a,l,d,o),c={...t.value??{},...r},y=se("products.get_direct_cart",f),E=await re(y,{item:JSON.stringify(c)});if(E.success&&E.item&&E.checkout_link)return st(E.item.key,E.item.value),window.location.href=E.checkout_link,!0;{const k=E.message??"Failed to proceed to checkout";return i(k),L(k,"error"),!1}}catch(f){const r=f instanceof Error?f.message:"Failed to proceed to checkout";return i(r),L(r,"error"),!1}finally{s(!1)}},[t,n,a,l,d,o]);return{isProcessing:p,addToCart:u,directCheckout:b,error:g}}const be={active:!1,element:null,choice:null,addonKey:null};function ot(e){const{config:t,addonValues:n,onAddonValueChange:a}=e,[l,d]=m.useState(be),o=m.useRef([]),p=m.useCallback(u=>{try{return JSON.parse(atob(u))}catch{return null}},[]),s=m.useCallback((u,b,f,r)=>{const c=u.parentElement;c&&(b?(u.classList.add("active"),r?c.dataset.tooltip=r:delete c.dataset.tooltip):(u.classList.remove("active"),f?c.dataset.tooltip=f:delete c.dataset.tooltip))},[]),g=m.useCallback(()=>{d(be)},[]),i=m.useCallback(u=>{if(!l.active||!l.addonKey||!l.choice)return;const b=l.addonKey,f=l.choice.value,r=n[b];if(!r)return;const c=t?.props?.fields?.["form-addons"]?.props?.addons?.[b];if(c){if(c.type==="custom-multiselect"){const y=r.selected||[],E=y.findIndex(k=>k.item===f);if(E!==-1){const k=[...y];k[E]={...k[E],quantity:u},a(b,{...r,selected:k})}}else if(c.type==="custom-select"){const y=r.selected;y.item===f&&a(b,{...r,selected:{...y,quantity:u}})}g()}},[l,n,t,a,g]);return m.useEffect(()=>{if(!t)return;o.current.forEach(f=>f()),o.current=[];const u=t.props?.fields?.["form-addons"]?.props?.addons;return u?(document.querySelectorAll(".ts-use-addition").forEach(f=>{const r=f.dataset.id;if(!r)return;const c=p(r);if(!c)return;const y=u[c.addon],E=y?.props?.choices?.[c.choice];if(!y||!E)return;const k=f.parentElement,h=k?.dataset.tooltipDefault||null,_=k?.dataset.tooltipActive||null;if(y._has_external_handler=!0,y.type==="custom-multiselect"){const w=x=>{x.preventDefault();const C=n[c.addon],S=C?.selected||[],B=S.findIndex(I=>I.item===c.choice);if(B===-1){const I=[...S,{item:c.choice,quantity:E.props?.quantity?.min??1}];a(c.addon,{...C,selected:I}),E.props?.quantity?.enabled&&d({active:!0,element:f,choice:E,addonKey:c.addon})}else{const I=S.filter((H,q)=>q!==B);a(c.addon,{...C,selected:I})}};f.addEventListener("click",w),o.current.push(()=>f.removeEventListener("click",w));const v=n[c.addon]?.selected?.some(x=>x.item===c.choice)??!1;s(f,v,h,_)}else if(y.type==="custom-select"){const w=x=>{x.preventDefault();const C=n[c.addon];C?.selected?.item!==c.choice?(a(c.addon,{...C,selected:{item:c.choice,quantity:E.props?.quantity?.min??1}}),E.props?.quantity?.enabled&&d({active:!0,element:f,choice:E,addonKey:c.addon})):a(c.addon,{...C,selected:{item:null,quantity:1}})};f.addEventListener("click",w),o.current.push(()=>f.removeEventListener("click",w));const v=n[c.addon]?.selected?.item===c.choice;s(f,v,h,_)}}),()=>{o.current.forEach(f=>f()),o.current=[]}):void 0},[t,p,s]),m.useEffect(()=>{if(!t)return;const u=t.props?.fields?.["form-addons"]?.props?.addons;if(!u)return;document.querySelectorAll(".ts-use-addition").forEach(f=>{const r=f.dataset.id;if(!r)return;const c=p(r);if(!c)return;const y=u[c.addon];if(!y)return;const E=f.parentElement,k=E?.dataset.tooltipDefault||null,h=E?.dataset.tooltipActive||null;if(y.type==="custom-multiselect"){const w=n[c.addon]?.selected?.some(N=>N.item===c.choice)??!1;s(f,w,k,h)}else if(y.type==="custom-select"){const w=n[c.addon]?.selected?.item===c.choice;s(f,w,k,h)}})},[t,n,p,s]),{externalChoice:l,closeExternalChoice:g,updateExternalChoiceQuantity:i}}function ge(e){return e?.value?e.library==="line-awesome"||e.value.startsWith("la-")?React.createElement("i",{className:`las ${e.value}`}):React.createElement("i",{className:`las ${e.value}`}):null}function it({active:e,element:t,choice:n,onClose:a,onConfirm:l,icons:d}){const o=m.useRef(null),[p,s]=m.useState(1),g=n?.props?.quantity?.min??1,i=n?.props?.quantity?.max??999;m.useEffect(()=>{e&&s(g)},[e,g]),m.useEffect(()=>{if(!e||!t||!o.current)return;const r=o.current,c=t.getBoundingClientRect(),y=r.getBoundingClientRect();let E=c.bottom+window.scrollY+8,k=c.left+window.scrollX+c.width/2-y.width/2;const h=window.innerWidth,_=window.innerHeight;k<8&&(k=8),k+y.width>h-8&&(k=h-y.width-8),c.bottom+y.height+16>_&&(E=c.top+window.scrollY-y.height-8),r.style.top=`${E}px`,r.style.left=`${k}px`},[e,t]),m.useEffect(()=>{if(!e)return;const r=y=>{o.current&&!o.current.contains(y.target)&&a()},c=setTimeout(()=>{document.addEventListener("click",r)},100);return()=>{clearTimeout(c),document.removeEventListener("click",r)}},[e,a]),m.useEffect(()=>{if(!e)return;const r=c=>{c.key==="Escape"&&a()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[e,a]);const u=m.useCallback(()=>{s(r=>Math.min(r+1,i))},[i]),b=m.useCallback(()=>{s(r=>Math.max(r-1,g))},[g]),f=m.useCallback(()=>{l(p)},[p,l]);return!e||!n?null:React.createElement("div",{ref:o,className:"ts-popup ts-external-choice-popup",style:{position:"absolute",zIndex:9999}},React.createElement("div",{className:"ts-popup-content"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,n.label," - Quantity"),React.createElement("div",{className:"ts-stepper-input flexify"},React.createElement("button",{className:`ts-stepper-left ts-icon-btn${p<=g?" vx-disabled":""}`,onClick:r=>{r.preventDefault(),r.stopPropagation(),b()},type:"button",disabled:p<=g},ge(d?.minusIcon)||React.createElement("i",{className:"las la-minus"})),React.createElement("input",{type:"number",className:"ts-input-box",value:p,onChange:r=>{const c=parseInt(r.target.value,10);isNaN(c)||s(Math.max(g,Math.min(c,i)))},min:g,max:i}),React.createElement("button",{className:`ts-stepper-right ts-icon-btn${p>=i?" vx-disabled":""}`,onClick:r=>{r.preventDefault(),r.stopPropagation(),u()},type:"button",disabled:p>=i},ge(d?.plusIcon)||React.createElement("i",{className:"las la-plus"})))),React.createElement("div",{className:"ts-form-group ts-popup-actions flexify"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1",onClick:r=>{r.preventDefault(),a()}},"Cancel"),React.createElement("a",{href:"#",className:"ts-btn ts-btn-2",onClick:r=>{r.preventDefault(),f()}},"Confirm"))))}function ut({text:e,icon:t="",className:n="",style:a={}}){return m.createElement("div",{className:`voxel-empty-placeholder ${n}`,style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:e?"8px":"0",background:"rgb(213 216 220 / 80%)",borderRadius:"0",color:"#666",fontSize:"13px",height:"45px",...a}},m.createElement("span",{className:"placeholder-icon",style:{fontFamily:"eicons",fontSize:"24px",opacity:.3,lineHeight:1,fontStyle:"normal"}},t),e&&m.createElement("span",{className:"placeholder-text",style:{opacity:.6}},e))}function U(e,t){return e?.value?e.library==="line-awesome"||e.value.startsWith("la-")?React.createElement("i",{className:`las ${e.value} `}):e.library==="fa-solid"||e.library==="fa-regular"?React.createElement("i",{className:`${e.library==="fa-solid"?"fas":"far"} fa-${e.value} `}):React.createElement("i",{className:`las ${e.value} `}):null}function dt(){return React.createElement("div",{className:"ts-product-main vx-loading-screen"},React.createElement(ut,null))}function mt({message:e,icon:t}){return React.createElement("div",{className:"ts-product-main"},React.createElement("div",{className:"ts-form-group ts-no-posts"},U(t),React.createElement("p",null,e)))}function pt({attributes:e}){const t=e.icons||A;return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify({blockId:e.blockId,settings:{showPriceCalculator:e.showPriceCalculator,showSubtotalOnly:e.showSubtotalOnly,hideCardSubheading:e.hideCardSubheading,cardSelectOnClick:e.cardSelectOnClick},icons:{...A,...e.icons}})}}),React.createElement("div",{className:"ts-product-main"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,"Product Options"),React.createElement("div",{className:"ts-filter ts-popup-target"},React.createElement("span",{className:"ts-filter-text"},"Select an option"),React.createElement("div",{className:"ts-down-icon"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,"Add-ons"),React.createElement("ul",{className:"addon-cards simplify-ul flexify"},React.createElement("li",null,React.createElement("div",{className:"adc-title"},"Sample Add-on"),React.createElement("div",{className:"adc-subtitle"},"Description"),React.createElement("span",{className:"vx-addon-price"},"+$10.00")),React.createElement("li",{className:"adc-selected"},React.createElement("div",{className:"adc-title"},"Selected Add-on"),React.createElement("div",{className:"adc-subtitle"},"Description"),React.createElement("span",{className:"vx-addon-price"},"+$15.00")))),React.createElement("div",{className:"ts-form-group product-actions"},React.createElement("a",{href:"#",className:"ts-btn form-btn ts-btn-2"},U(t.addToCart),React.createElement("span",null,"Add to cart"))),e.showPriceCalculator==="show"&&React.createElement("div",{className:"ts-form-group tcc-container"},React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify"},React.createElement("li",null,React.createElement("p",{className:"ts-item-name"},"Base price"),React.createElement("p",{className:"ts-item-price"},"$50.00")),React.createElement("li",null,React.createElement("p",{className:"ts-item-name"},"Add-on: Selected"),React.createElement("p",{className:"ts-item-price"},"$15.00")),React.createElement("li",{className:"ts-total"},React.createElement("p",{className:"ts-item-name"},"Total"),React.createElement("p",{className:"ts-item-price"},"$65.00"))))))}function ft({summary:e,showSubtotalOnly:t}){if(!e.visible_items.length)return null;const n=t?e.visible_items.filter(a=>a.key==="total"):e.visible_items;return React.createElement("div",{className:"ts-form-group tcc-container"},React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify"},n.map(a=>React.createElement("li",{key:a.key,className:a.key==="total"?"ts-total":""},React.createElement("p",{className:"ts-item-name"},a.label),React.createElement("p",{className:"ts-item-price"},a.formatted_price)))))}function yt({attributes:e,context:t,config:n,productConfig:a}){const[l,d]=m.useState({}),[o,p]=m.useState(1),[s,g]=m.useState({variation_id:null,quantity:1}),[i,u]=m.useState(we),[b,f]=m.useState({}),[r,c]=m.useState(t==="frontend"),{isProcessing:y,addToCart:E,directCheckout:k}=lt({config:a??null,addonValues:l,quantity:o,variationsValue:s,bookingValue:i,dataInputValues:b}),h=m.useRef(null),_=a?.props?.fields?.["form-quantity"],w=_?.props?.quantity??999,N=m.useMemo(()=>{const P=a?.props?.fields?.["form-booking"];if(!P||P.props?.mode!=="date_range"||!i.start_date||!i.end_date)return 0;const j=new Date(i.start_date+"T00:00:00Z"),Bt=new Date(i.end_date+"T00:00:00Z").getTime()-j.getTime(),Ee=Math.ceil(Bt/(1e3*60*60*24));return(P.props?.count_mode??"nights")==="nights"?Ee:Ee+1},[a,i.start_date,i.end_date]),v=m.useCallback(()=>h.current?.getPricingSummary()??null,[]),x=m.useCallback(()=>{const P=a?.props?.fields?.["form-variations"];return P?X.getPricingSummary(P,s):null},[a,s]),{summary:C}=Ve({config:a??null,quantity:o,bookingValue:i,getAddonsPricingSummary:v,getVariationsPricingSummary:x}),S=m.useCallback((P,j)=>{d(Z=>({...Z,[P]:j}))},[]),B=m.useCallback((P,j)=>{f(Z=>({...Z,[P]:j}))},[]),{externalChoice:I,closeExternalChoice:H,updateExternalChoiceQuantity:q}=ot({config:a??null,addonValues:l,onAddonValueChange:S}),D=n?.icons||e.icons||A,ce=n?.settings||{showPriceCalculator:e.showPriceCalculator,showSubtotalOnly:e.showSubtotalOnly,hideCardSubheading:e.hideCardSubheading,cardSelectOnClick:e.cardSelectOnClick};if(t==="editor")return React.createElement(pt,{attributes:e});if(r&&!a)return React.createElement(dt,null);if(!a||!a.is_purchasable)return React.createElement(mt,{message:a?.out_of_stock_message||"This product is not available",icon:D.outOfStock});const le=a?.settings?.product_mode??"regular",Ct=!!a?.props?.fields?.["form-addons"],qt=!!_,Pt=!!a?.props?.fields?.["form-variations"],Tt=!!a?.props?.fields?.["form-booking"],It=!!a?.props?.fields?.["form-data-inputs"];return React.createElement(React.Fragment,null,React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify({blockId:e.blockId||n?.blockId,settings:ce,icons:D})}}),React.createElement("div",{className:"ts-product-main"},Ct&&a&&React.createElement(Se,{ref:h,config:a,values:l,onValueChange:S,bookingValue:i,bookingRangeLength:N,searchContext:a.settings?.search_context}),Pt&&le==="variable"&&a?.props?.fields?.["form-variations"]&&React.createElement(X,{field:a.props.fields["form-variations"],value:s,onChange:g}),Tt&&le==="booking"&&a?.props?.fields?.["form-booking"]&&React.createElement(F,{field:a.props.fields["form-booking"],value:i,onChange:u,config:a,initialAvailability:a.settings?.search_context?.availability}),qt&&le==="regular"&&React.createElement(Re,{maxQuantity:w,value:o,onChange:p,label:a?.l10n?.quantity??"Quantity"}),It&&a?.props?.fields?.["form-data-inputs"]&&React.createElement($e,{field:a.props.fields["form-data-inputs"],values:b,onValueChange:B,icons:D}),React.createElement("div",{className:"ts-form-group product-actions"},a.cart.enabled?React.createElement("a",{href:"#",className:`ts-btn form-btn ts-btn-2 ${y?"ts-loading-btn":""}`,onClick:P=>{P.preventDefault(),y||E()}},y?React.createElement("span",{className:"ts-loader"}):React.createElement(React.Fragment,null,U(D.addToCart),React.createElement("span",null,"Add to cart"))):React.createElement("a",{href:"#",className:`ts-btn form-btn ts-btn-2 ${y?"ts-loading-btn":""}`,onClick:P=>{P.preventDefault(),y||k()}},y?React.createElement("span",{className:"ts-loader"}):React.createElement(React.Fragment,null,U(D.checkout),React.createElement("span",null,"Continue")))),ce.showPriceCalculator==="show"&&React.createElement(ft,{summary:C,showSubtotalOnly:ce.showSubtotalOnly})),React.createElement(it,{active:I.active,element:I.element,choice:I.choice,onClose:H,onConfirm:q,icons:D}))}function bt(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const t=e.getAttribute("href");if(t)return t.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function gt(){const e=bt();try{return new URL(e).pathname.replace(/\/$/,"")}catch{return""}}function kt(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const t=document.querySelector('link[rel="https://api.w.org/"]');if(t){const n=t.getAttribute("href");if(n)return n}}const e=gt();return typeof window<"u"?window.location.origin+e+"/wp-json/":"/wp-json/"}function ke(e){return typeof e!="string"||!e.match(/^\d{4}-\d{2}-\d{2}$/)?!1:isFinite(new Date(e).getTime())}function Et(e){const t={availability:{start:"",end:""},numeric_addons:{},switcher_addons:{}};if(!e)return t;try{const a=new URL(document.referrer).searchParams;if(e.availability){const l=a.get(e.availability);if(typeof l=="string"){const d=l.split("..");ke(d[0])&&(t.availability={start:d[0],end:ke(d[1])?d[1]:d[0]})}}e.numeric_addons&&Object.keys(e.numeric_addons).forEach(l=>{const d=e.numeric_addons[l],o=a.get(d);if(typeof o=="string"){const p=parseInt(o,10);isNaN(p)||(t.numeric_addons[l]=p)}}),e.switcher_addons&&Object.keys(e.switcher_addons).forEach(l=>{const d=e.switcher_addons[l];a.get(d)==="1"&&(t.switcher_addons[l]=!0)})}catch(n){console.debug("Search context parsing failed:",n)}return t}function ht(e,t){return{availability:{start:e?.availability?.start||t.availability?.start||"",end:e?.availability?.end||t.availability?.end||""},numeric_addons:{...t.numeric_addons,...e?.numeric_addons},switcher_addons:{...t.switcher_addons,...e?.switcher_addons}}}function _t(){return kt()}function wt(){const e=window;if(e.voxel?.current_post?.id)return e.voxel.current_post.id;if(e.wp?.data?.select){const a=e.wp.data.select("core/editor")?.getCurrentPostId?.();if(a)return a}const n=document.body.className.match(/postid-(\d+)/);return n?parseInt(n[1],10):null}function Nt(e){const t=(g,i)=>typeof g=="boolean"?g:g==="true"||g==="1"||g===1?!0:g==="false"||g==="0"||g===0?!1:i,n=(g,i)=>typeof g=="string"?g:i,a=e.settings??{},l=e.icons??{},d=a.searchContextConfig??a.search_context_config??null,o=a.searchContext??a.search_context??{},p=Et(d),s=ht(o,p);return{blockId:n(e.blockId??e.block_id,""),settings:{showPriceCalculator:n(a.showPriceCalculator??a.show_price_calculator,"show"),showSubtotalOnly:t(a.showSubtotalOnly??a.show_subtotal_only,!1),hideCardSubheading:t(a.hideCardSubheading??a.hide_card_subheading,!1),cardSelectOnClick:t(a.cardSelectOnClick??a.card_select_on_click,!0),productMode:n(a.productMode??a.product_mode,"regular"),cartNonce:n(a.cartNonce??a.cart_nonce,""),searchContext:s,searchContextConfig:d},icons:{calendarIcon:l.calendarIcon??l.calendar_icon??null,minusIcon:l.minusIcon??l.minus_icon??null,plusIcon:l.plusIcon??l.plus_icon??null,cartIcon:l.cartIcon??l.cart_icon??null,checkIcon:l.checkIcon??l.check_icon??null,downIcon:l.downIcon??l.down_icon??null},props:e.props??{},value:e.value??{},l10n:e.l10n??{}}}function St(e){const t=e.querySelector("script.vxconfig");if(t&&t.textContent)try{const n=JSON.parse(t.textContent);return Nt(n)}catch(n){console.error("Failed to parse vxconfig:",n)}return null}async function Rt(e){const n=`${_t()}voxel-fse/v1/product-form/config?post_id=${e}`;try{const a=await fetch(n,{credentials:"same-origin",headers:{"Content-Type":"application/json"}});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){return console.error("Failed to fetch product config:",a),null}}function vt(e){return{..._e,blockId:e.blockId||"",showPriceCalculator:e.settings?.showPriceCalculator||"show",showSubtotalOnly:e.settings?.showSubtotalOnly||!1,hideCardSubheading:e.settings?.hideCardSubheading||!1,cardSelectOnClick:e.settings?.cardSelectOnClick??!0,icons:{...A,...e.icons}}}function xt({config:e,postId:t}){const[n,a]=m.useState(null),[l,d]=m.useState(!0),[o,p]=m.useState(null),s=vt(e);return m.useEffect(()=>{let g=!1;async function i(){if(!t){p("No post ID found"),d(!1);return}d(!0),p(null);try{const u=await Rt(t);g||a(u)}catch(u){g||p(u instanceof Error?u.message:"Failed to load product")}finally{g||d(!1)}}return i(),()=>{g=!0}},[t]),l?React.createElement("div",{className:"ts-product-main vx-loading-screen"},React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-loader"}))):o?React.createElement("div",{className:"ts-product-main"},React.createElement("div",{className:"ts-form-group ts-no-posts"},React.createElement("i",{className:"las la-exclamation-circle"}),React.createElement("p",null,o))):React.createElement(yt,{attributes:s,context:"frontend",config:e,productConfig:n})}function M(){const e=document.querySelectorAll(".voxel-fse-product-form, .ts-product-form"),t=wt();e.forEach(n=>{if(n.dataset.hydrated==="true"||!n.classList.contains("voxel-fse-product-form"))return;const a=St(n);if(!a){console.error("No vxconfig found for product form block");return}n.dataset.hydrated="true";const l=n.querySelector(".vx-loading-screen");l&&l.remove(),he.createRoot(n).render(React.createElement(xt,{config:a,postId:t}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",M):M(),window.addEventListener("turbo:load",M),window.addEventListener("pjax:complete",M),document.addEventListener("voxel:markup-update",M);const Dt=window;Dt.render_product_form=M})(ReactDOM,React);
