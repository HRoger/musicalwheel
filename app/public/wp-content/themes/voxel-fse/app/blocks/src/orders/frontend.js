(function(pe,c){"use strict";function fe(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const t=e.getAttribute("href");if(t)return t}}if(typeof window<"u"&&window.location?.origin){const e=window.location.pathname.split("/").filter(Boolean),t=["wp-admin","wp-content","wp-includes","wp-json"];return e.length>0&&!t.includes(e[0])?window.location.origin+"/"+e[0]+"/wp-json/":window.location.origin+"/wp-json/"}return"/wp-json/"}let $=!1;function G(){if($)return!0;if(!window.Voxel?.mixins?.base)return!1;const e=window.Voxel.mixins.base;return e.mounted&&!e._originalMounted?(e._originalMounted=e.mounted,e.mounted=function(){try{const t=this.$root?.$options?.el||this.$el;if(t){const l=t.closest?.(".elementor-element");if(l)this.widget_id=l.dataset?.id||"";else{const d=t.closest?.("[data-block-id]");this.widget_id=d&&d.dataset?.blockId||""}const o=t.closest?.(".elementor");if(o)this.post_id=o.dataset?.elementorId||"";else{const d=document.body.className.match(/postid-(\d+)/);this.post_id=d?d[1]:""}}e._originalMounted&&e._originalMounted!==e.mounted&&e._originalMounted.call(this)}catch(t){console.warn("[VoxelShim] Error in patched mounted():",t),this.widget_id="",this.post_id=""}},$=!0,console.log("[VoxelShim] Successfully patched Voxel.mixins.base.mounted"),!0):!1}function ee(){if(G())return;let e=0;const t=50,o=setInterval(()=>{if(e++,G()){clearInterval(o);return}e>=t&&(clearInterval(o),console.warn("[VoxelShim] Voxel.mixins.base not found after 5 seconds"))},100);typeof document<"u"&&document.addEventListener("voxel:ready",()=>{G(),clearInterval(o)},{once:!0})}typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ee,{once:!0}):ee());function he(e){return!!(e&&e.value)}function Ee(e,t){return he(e)?e:t}function ve(e,t){return!e||!t?.shipping_statuses?"vx-neutral":t.shipping_statuses[e]?.class||"vx-neutral"}function ye(e,t){return!e||!t?.shipping_statuses?e||"":t.shipping_statuses[e]?.label||e}function Re({orders:e,config:t,attributes:l,isLoading:o,onOrderSelect:d,currentPage:i,totalPages:u,onPageChange:N}){if(!e||e.length===0)return React.createElement("div",{className:"ts-no-posts"},ae(l.noResultsIcon),React.createElement("p",null,"No orders found"));const R=i<u,h=i>1||R;return React.createElement(React.Fragment,null,React.createElement("div",{className:"vx-order-ease"},React.createElement("div",{className:`vx-order-list${o?" vx-disabled":""}`},e.map(r=>React.createElement("div",{key:r.id,className:`vx-order-card vx-status-${r.status}`,onClick:_=>{_.preventDefault(),d(r.id)}},React.createElement("div",{className:"vx-order-meta vx-order-title"},r.customer.avatar&&React.createElement("div",{className:"vx-avatar",dangerouslySetInnerHTML:{__html:r.customer.avatar}}),React.createElement("span",{className:"order-badge vx-hide-mobile"},"#",r.id),React.createElement("b",null,r.customer.name," placed an order ",r.created_at)),React.createElement("div",{className:"vx-order-meta"},r.item_count>1&&React.createElement("span",{className:"vx-hide-mobile"},r.item_count," items"),typeof r.total=="number"?React.createElement("span",{className:"vx-hide-mobile"},S(r.total,r.currency)):typeof r.subtotal=="number"?React.createElement("span",{className:"vx-hide-mobile"},S(r.subtotal,r.currency)):null),r.status==="completed"&&r.shipping_status!==null?React.createElement("div",{className:`order-status ${ve(r.shipping_status,t)}`},ye(r.shipping_status,t)):React.createElement("div",{className:`order-status ${z(r.status,t)}`},Z(r.status,t)))))),h&&React.createElement("div",{className:`vx-order-more${o?" vx-inert":""}`},React.createElement("a",{href:"#",className:`ts-load-more ts-btn ts-btn-1${i<2?" vx-disabled":""}`,onClick:r=>{r.preventDefault(),i>1&&N(i-1)}},b(k(l.backIcon,"backIcon")),"Previous"),React.createElement("a",{href:"#",className:`ts-load-more ts-btn ts-btn-1${R?"":" vx-disabled"}`,onClick:r=>{r.preventDefault(),R&&N(i+1)}},"Next",b(k(l.forwardIcon,"forwardIcon")))))}function ge(e,t){return e&&e.value?e.library==="svg"?e.value.startsWith("<svg")||e.value.startsWith("<?xml")?React.createElement("span",{className:"ts-icon-svg",dangerouslySetInnerHTML:{__html:e.value}}):React.createElement("img",{src:e.value,alt:"",className:"ts-icon-svg"}):React.createElement("i",{className:e.value}):null}function be({item:e,order:t,config:l,onCancelPromotion:o,isRunningAction:d,infoIcon:i}){const u=e.details?.promotion_package,N=c.useCallback(async _=>{_.preventDefault();const w=typeof Voxel_Config<"u"?Voxel_Config.l10n.confirmAction:"Are you sure you want to cancel this promotion?";window.confirm(w)&&await o()},[o]);if(!u)return null;const h=u.start_date&&u.end_date?`${u.start_date} - ${u.end_date}`:null,r=()=>{switch(u.status){case"cancelled":return"Promotion canceled";case"expired":return"Promotion has ended";case"active":return u.assigned_to_post?"Promotion is active":"Promotion details";default:return"Promotion details"}};return React.createElement("div",{className:"order-event"},React.createElement("div",{className:"order-event-icon vx-blue"},i?ge(i):React.createElement("i",{className:"las la-info-circle"})),React.createElement("b",null,r()),h&&React.createElement("span",null,h),React.createElement("div",{className:"further-actions"},u.post_link&&React.createElement("a",{href:u.post_link,target:"_blank",rel:"noopener noreferrer",className:"ts-btn ts-btn-1"},"View listing"),u.stats_link&&React.createElement("a",{href:u.stats_link,target:"_blank",rel:"noopener noreferrer",className:"ts-btn ts-btn-1"},"View stats"),u.status==="active"&&u.assigned_to_post&&React.createElement("a",{href:"#",className:`ts-btn ts-btn-1${d?" vx-pending":""}`,onClick:N},"Cancel promotion")))}function Ne({order:e,config:t,attributes:l,isLoading:o,onBack:d,onAction:i,onCancelPromotion:u,onMessage:N}){const[R,h]=c.useState(!1),[r,_]=c.useState({}),[w,p]=c.useState(!1),C=c.useRef(null);c.useEffect(()=>{window.scrollTo(0,0)},[e.id]);const O=t?.data_inputs?.content_length??128,B=c.useCallback(async()=>{h(!0);try{await u(e.id)}finally{h(!1)}},[e.id,u]),P=c.useCallback(async n=>{if(R)return;const v=async()=>{h(!0),await i(n.action),h(!1),p(!1),C.current?.blur()};if(typeof n.confirm=="string")if(typeof Voxel<"u"&&typeof Voxel.prompt=="function"){const s=n.confirm||Voxel_Config?.l10n?.confirmAction||"Are you sure?",g=Voxel_Config?.l10n?.yes||"Yes",f=Voxel_Config?.l10n?.no||"No";Voxel.prompt(s,"warning",[{label:g,onClick:()=>{v()}},{label:f,onClick:()=>{}}],7500)}else window.confirm(n.confirm)&&await v();else await v()},[i,R]),A=c.useCallback(n=>{_(v=>({...v,[n]:!v[n]}))},[]),F=t?.is_vendor||t?.is_admin||!1;return React.createElement("div",{className:"vx-order-ease"},React.createElement("div",{className:`single-order ${R||o?"vx-pending":""}`},React.createElement("div",{className:"vx-order-head"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-go-back",onClick:n=>{n.preventDefault(),d()}},b(k(l.backIcon,"backIcon")),"Go back"),e.actions.dms.enabled&&e.customer.id&&e.actions.dms.vendor_target&&N&&React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 has-tooltip","data-tooltip":F?"Message customer":"Message seller",onClick:n=>{n.preventDefault(),N(e)}},b(k(l.inboxIcon,"inboxIcon"))),e.actions.primary.length>0&&React.createElement(React.Fragment,null,e.actions.primary.map((n,v)=>React.createElement("a",{key:v,href:"#",className:"ts-btn ts-btn-2",onClick:s=>{s.preventDefault(),P(n)}},n.action.endsWith("vendor.approve")&&b(k(l.checkmarkIcon,"checkmarkIcon")),n.label))),e.actions.secondary.length>0&&React.createElement("div",{className:"ts-inline-filter"},React.createElement("a",{ref:C,href:"#",className:"ts-btn ts-btn-1 has-tooltip ts-popup-target","data-tooltip":"More actions",onClick:n=>{n.preventDefault(),p(!w)}},b(k(l.menuIcon,"menuIcon"))),w&&React.createElement("div",{className:"ts-field-popup ts-popup-active"},React.createElement("div",{className:"ts-term-dropdown ts-md-group"},React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list min-scroll"},e.actions.secondary.map((n,v)=>React.createElement("li",{key:v},React.createElement("a",{href:"#",className:"flexify",onClick:s=>{s.preventDefault(),P(n)}},React.createElement("span",null,n.label))))))))),React.createElement("div",{className:"order-timeline"},React.createElement("div",{className:"order-event"},e.customer.avatar&&React.createElement("a",{href:e.customer.link},React.createElement("div",{className:"vx-avatar big-avatar",dangerouslySetInnerHTML:{__html:e.customer.avatar}})),e.status.key==="completed"&&e.shipping.enabled?React.createElement("div",{className:`order-status ${e.shipping.status.class||"vx-neutral"}`},e.shipping.status.label||e.shipping.status.key):React.createElement("div",{className:`order-status ${z(e.status.key,t)}`},Z(e.status.key,t)),React.createElement("h3",null,e.customer.name," placed order #",e.id),React.createElement("span",null,e.created_at)),e.child_orders.length>0&&React.createElement("div",{className:"order-event ts-child-orders"},React.createElement("div",{className:"vx-order-list"},e.child_orders.map(n=>React.createElement("div",{key:n.id,className:`vx-order-card vx-status-${n.status}`},React.createElement("div",{className:"vx-order-meta vx-order-title"},n.vendor.avatar?React.createElement("div",{className:"vx-avatar",dangerouslySetInnerHTML:{__html:n.vendor.avatar}}):React.createElement("div",{className:"vx-avatar"},React.createElement("img",{src:"/wp-content/themes/voxel/assets/images/platform.jpg",alt:""})),React.createElement("b",null,n.item_count<=1?`One item sold by ${n.vendor.name}`:`${n.item_count} items sold by ${n.vendor.name}`)),React.createElement("div",{className:"vx-order-meta"},n.total!==null&&React.createElement("span",{className:"vx-hide-mobile"},S(n.total,n.currency))),n.shipping_status!==null?React.createElement("div",{className:`order-status ${t?.shipping_statuses?.[n.shipping_status]?.class||"vx-neutral"}`},t?.shipping_statuses?.[n.shipping_status]?.label||n.shipping_status):React.createElement("div",{className:`order-status ${z(n.status,t)}`},Z(n.status,t)))))),React.createElement("div",{className:"order-event"},React.createElement("div",{className:"order-event-box"},e.items.length>0&&React.createElement("ul",{className:"ts-cart-list simplify-ul"},e.items.map(n=>React.createElement("li",{key:n.id},React.createElement("div",{className:"cart-image"},React.createElement("img",{width:"150",height:"150",src:n.product.thumbnail_url||"/wp-content/themes/voxel/assets/images/platform.jpg",className:"ts-status-avatar",alt:n.product.label})),React.createElement("div",{className:"cart-item-details"},React.createElement("div",{className:"order-item-title"},React.createElement("a",{href:n.product.link},n.product.label),React.createElement("span",null,S(n.subtotal,n.currency))),React.createElement("span",null,n.product.description),React.createElement("span",{className:"cart-data-inputs",dangerouslySetInnerHTML:{__html:r[n.id]?n.data_inputs_markup:_e(n.data_inputs_markup,O)}}),ke(n.data_inputs_markup,O)&&React.createElement("span",{className:"order-expand-details"},React.createElement("span",{onClick:()=>A(n.id)},r[n.id]?"Collapse ▴":"Expand ▾")),n.details?.promotion_package&&React.createElement(be,{item:n,order:e,config:t,onCancelPromotion:B,isRunningAction:R}))))),React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify"},e.pricing.subtotal!==null&&React.createElement("li",{className:"ts-cost--subtotal"},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,"Subtotal")),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,S(e.pricing.subtotal,e.pricing.currency)))),e.pricing.discount_amount!==null&&React.createElement("li",{className:"ts-cost--discount-amount"},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,"Discount")),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,S(e.pricing.discount_amount,e.pricing.currency)))),e.pricing.tax_amount!==null&&React.createElement("li",{className:"ts-cost--tax-amount"},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,"Tax")),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,S(e.pricing.tax_amount,e.pricing.currency)))),e.pricing.shipping_amount!==null&&React.createElement("li",{className:"ts-cost--shipping-amount"},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,"Shipping")),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,S(e.pricing.shipping_amount,e.pricing.currency)))),e.pricing.total!==null&&React.createElement("li",{className:"ts-total"},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,"Total")),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,S(e.pricing.total,e.pricing.currency)))),e.pricing.total!==null&&e.pricing.subscription_interval!==null&&React.createElement("li",{className:"ts-cost--schedule"},React.createElement("div",{className:"ts-item-name"}),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,"Renews ",e.pricing.subscription_interval)))),e.vendor.fees&&React.createElement("details",{className:"order-accordion"},React.createElement("summary",null,"Vendor fees",b(k(l.downIcon,"downIcon"))),React.createElement("div",{className:"details-body"},React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify ts-customer-details"},e.vendor.fees.breakdown.map((n,v)=>React.createElement("li",{key:v},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,n.label)),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,n.content)))),React.createElement("li",{className:"ts-total"},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,"Total")),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,S(e.vendor.fees.total,e.pricing.currency))))))),e.pricing.sections.map((n,v)=>React.createElement("details",{key:v,className:"order-accordion"},React.createElement("summary",null,n.label,b(k(l.downIcon,"downIcon"))),n.type==="list"&&n.items&&React.createElement("div",{className:"details-body"},React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify ts-customer-details"},n.items.map((s,g)=>React.createElement("li",{key:g,className:s.bold?"ts-total":""},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,s.label)),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,s.content)))))))),e.customer.customer_details&&e.customer.customer_details.length>0&&React.createElement("details",{className:"order-accordion"},React.createElement("summary",null,"Customer details",b(k(l.downIcon,"downIcon"))),React.createElement("div",{className:"details-body"},React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify ts-customer-details"},e.customer.customer_details.map((n,v)=>React.createElement("li",{key:v},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,n.label)),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,n.content))))))),e.customer.shipping_details&&e.customer.shipping_details.length>0&&React.createElement("details",{className:"order-accordion"},React.createElement("summary",null,"Shipping details",b(k(l.downIcon,"downIcon"))),React.createElement("div",{className:"details-body"},React.createElement("ul",{className:"ts-cost-calculator simplify-ul flexify ts-customer-details"},e.customer.shipping_details.map((n,v)=>React.createElement("li",{key:v},React.createElement("div",{className:"ts-item-name"},React.createElement("p",null,n.label)),React.createElement("div",{className:"ts-item-price"},React.createElement("p",null,n.content))))))),e.customer.order_notes&&e.customer.order_notes.length>0&&React.createElement("details",{className:"order-accordion"},React.createElement("summary",null,"Order notes",b(k(l.downIcon,"downIcon"))),React.createElement("div",{className:"details-body"},React.createElement("p",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:e.customer.order_notes}}))),e.vendor.notes_to_customer&&e.vendor.notes_to_customer.length>0&&React.createElement("details",{className:"order-accordion"},React.createElement("summary",null,"Notes to customer",b(k(l.downIcon,"downIcon"))),React.createElement("div",{className:"details-body"},React.createElement("p",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:e.vendor.notes_to_customer}}))))))))}function ke(e,t=128){return e.replace(/<[^>]*>/g,"").length>t}function _e(e,t=128){const l=e.replace(/<[^>]*>/g,"");if(l.length<=t)return e;const d=l.substring(0,t).lastIndexOf(" "),i=d>t*.8?d:t;return l.substring(0,i)+"..."}const we={searchIcon:{library:"icon",value:"las la-search"},noResultsIcon:{library:"svg",value:""},resetSearchIcon:{library:"icon",value:"las la-sync"},backIcon:{library:"icon",value:"las la-angle-left"},forwardIcon:{library:"icon",value:"las la-angle-right"},downIcon:{library:"icon",value:"las la-angle-down"},inboxIcon:{library:"icon",value:"las la-inbox"},checkmarkIcon:{library:"icon",value:"las la-check"},menuIcon:{library:"icon",value:"las la-ellipsis-h"},infoIcon:{library:"icon",value:"las la-info-circle"},filesIcon:{library:"icon",value:"las la-file"},trashIcon:{library:"icon",value:"las la-trash"},calendarIcon:{library:"icon",value:"las la-calendar"}},te='<svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" transform="rotate(0 0 0)"><path d="M3.25 5.5C3.25 4.25736 4.25736 3.25 5.5 3.25H18.5C19.7426 3.25 20.75 4.25736 20.75 5.5V18.5C20.75 19.7426 19.7426 20.75 18.5 20.75H5.5C4.25736 20.75 3.25 19.7426 3.25 18.5V5.5ZM9.75 7C9.75 6.58579 9.41421 6.25 9 6.25C8.58579 6.25 8.25 6.58579 8.25 7V8C8.25 10.0711 9.92893 11.75 12 11.75C14.0711 11.75 15.75 10.0711 15.75 8V7C15.75 6.58579 15.4142 6.25 15 6.25C14.5858 6.25 14.25 6.58579 14.25 7V8C14.25 9.24264 13.2426 10.25 12 10.25C10.7574 10.25 9.75 9.24264 9.75 8V7Z" fill="#343C54"></path></svg>';function k(e,t){return Ee(e,we[t]||{library:"",value:""})}function V(e){return typeof window>"u"?null:new URLSearchParams(window.location.search).get(e)}function H(e,t){if(typeof window>"u")return;const l=new URL(window.location.href);l.searchParams.set(e,String(t)),window.history.replaceState({},"",l.toString())}function x(e){if(typeof window>"u")return;const t=new URL(window.location.href);t.searchParams.delete(e),window.history.replaceState({},"",t.toString())}function J(e,t){c.useEffect(()=>{function l(o){e.current&&!e.current.contains(o.target)&&t()}return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[e,t])}function b(e,t){return!e||!e.value?null:e.library==="svg"?React.createElement("img",{src:e.value,alt:"",className:t}):React.createElement("i",{className:`${e.value} `})}function ae(e){return e&&e.value?b(e)||React.createElement("span",{dangerouslySetInnerHTML:{__html:te}}):React.createElement("span",{dangerouslySetInnerHTML:{__html:te}})}function ne(e,t){let l=e;return Object.keys(t).forEach(o=>{l=l.split(o).join(String(t[o]))}),l}function S(e,t){const l=window;if(l.Voxel?.helpers?.currencyFormat)return l.Voxel.helpers.currencyFormat(e,t);try{return new Intl.NumberFormat(void 0,{style:"currency",currency:t.toUpperCase()}).format(e/100)}catch{return`${t} ${(e/100).toFixed(2)}`}}function z(e,t){return t?.statuses_ui&&t.statuses_ui[e]?.class||"vx-neutral"}function Z(e,t){return t?.statuses&&t.statuses[e]?.label||e}function xe({attributes:e,config:t,orders:l,currentOrder:o,context:d,isLoading:i,error:u,currentPage:N,totalPages:R,onSearch:h,onStatusFilter:r,onShippingStatusFilter:_,onProductTypeFilter:w,onOrderSelect:p,onOrderBack:C,onOrderAction:O,onPageChange:B,onCancelPromotion:P}){const A=c.useRef(!1),F=c.useRef(null),n=c.useRef(null),v=c.useRef(null),[s,g]=c.useState({searchQuery:"",statusFilter:null,shippingStatusFilter:null,productTypeFilter:null,statusDropdownOpen:!1,shippingStatusDropdownOpen:!1,productTypeDropdownOpen:!1,parentOrderId:null});c.useEffect(()=>{const E=`${(window.Voxel_Config?.site_url||window.location.origin).replace(/\/$/,"")}/wp-content/themes/voxel`;[{id:"voxel-commons-css",href:`${E}/assets/dist/commons.css`},{id:"voxel-forms-css",href:`${E}/assets/dist/forms.css`},{id:"voxel-popup-kit-css",href:`${E}/assets/dist/popup-kit.css`},{id:"voxel-orders-css",href:`${E}/assets/dist/orders.css`},{id:"voxel-line-awesome-css",href:`${E}/assets/icons/line-awesome/line-awesome.css`}].forEach(({id:j,href:X})=>{if(!document.getElementById(j)){const T=document.createElement("link");T.id=j,T.rel="stylesheet",T.href=X,document.head.appendChild(T)}})},[]),c.useEffect(()=>{if(A.current||d==="editor")return;A.current=!0;const a=V("status"),m=V("shipping_status"),E=V("product_type"),q=V("search"),j=V("order_id"),X=V("parent_id");if(g(T=>({...T,statusFilter:a&&t?.statuses?.[a]?a:null,shippingStatusFilter:m&&t?.shipping_statuses?.[m]?m:null,productTypeFilter:E||null,searchQuery:q||"",parentOrderId:X?parseInt(X,10):null})),j&&p){const T=parseInt(j,10);!isNaN(T)&&T>0&&p(T)}a&&r&&r(a),m&&_&&_(m),E&&w&&w(E),q&&h&&h(q)},[t,d,h,r,_,w,p]);const f=c.useCallback(a=>{const m=a.target.value;g(E=>({...E,searchQuery:m})),m?H("search",m):x("search"),h&&h(m)},[h]),y=c.useCallback(()=>{s.searchQuery===""&&s.statusFilter===null&&s.shippingStatusFilter===null&&s.productTypeFilter===null||(g(a=>({...a,searchQuery:"",statusFilter:null,shippingStatusFilter:null,productTypeFilter:null})),x("search"),x("status"),x("shipping_status"),x("product_type"),x("pg"),h&&h(""),r&&r(null),_&&_(null),w&&w(null))},[s,h,r,_,w]),I=c.useCallback(a=>{g(m=>({...m,statusFilter:a,statusDropdownOpen:!1})),a&&a!=="all"?H("status",a):x("status"),x("pg"),r&&r(a)},[r]),M=c.useCallback(a=>{g(m=>({...m,shippingStatusFilter:a,shippingStatusDropdownOpen:!1})),a&&a!=="all"?H("shipping_status",a):x("shipping_status"),x("pg"),_&&_(a)},[_]),D=c.useCallback(a=>{g(m=>({...m,productTypeFilter:a,productTypeDropdownOpen:!1})),a&&a!=="all"?H("product_type",a):x("product_type"),x("pg"),w&&w(a)},[w]),W=c.useCallback(()=>{g(a=>({...a,statusDropdownOpen:!a.statusDropdownOpen,shippingStatusDropdownOpen:!1,productTypeDropdownOpen:!1}))},[]),le=c.useCallback(()=>{g(a=>({...a,shippingStatusDropdownOpen:!a.shippingStatusDropdownOpen,statusDropdownOpen:!1,productTypeDropdownOpen:!1}))},[]),ce=c.useCallback(()=>{g(a=>({...a,productTypeDropdownOpen:!a.productTypeDropdownOpen,statusDropdownOpen:!1,shippingStatusDropdownOpen:!1}))},[]),Pe=c.useCallback(()=>{g(a=>a.statusDropdownOpen?{...a,statusDropdownOpen:!1}:a)},[]),Fe=c.useCallback(()=>{g(a=>a.shippingStatusDropdownOpen?{...a,shippingStatusDropdownOpen:!1}:a)},[]),Me=c.useCallback(()=>{g(a=>a.productTypeDropdownOpen?{...a,productTypeDropdownOpen:!1}:a)},[]);J(F,Pe),J(n,Fe),J(v,Me);const Ve=c.useCallback(a=>{if(!t?.messages?.url)return;const m=a.current_user?.id===a.vendor?.id,E=new URL(t.messages.url);m?(E.searchParams.set("chat",`u${a.customer?.id}`),E.searchParams.set("text",ne(t.messages.enquiry_text?.vendor||"Order #@order_id inquiry",{"@order_id":String(a.id)}))):(E.searchParams.set("chat",String(a.actions?.dms?.vendor_target||`u${a.vendor?.id}`)),E.searchParams.set("text",ne(t.messages.enquiry_text?.customer||"Question about order #@order_id",{"@order_id":String(a.id)}))),window.location.href=E.toString()},[t]),He=c.useCallback(a=>{H("order_id",a),p&&p(a)},[p]),Le=c.useCallback(()=>{x("order_id"),x("parent_id"),s.parentOrderId&&p?(p(s.parentOrderId),g(a=>({...a,parentOrderId:null}))):C&&C()},[s.parentOrderId,p,C]),Ae=c.useCallback(a=>{a>1?H("pg",a):x("pg"),B&&B(a)},[B]),re=c.useMemo(()=>s.statusFilter&&t?.statuses&&t.statuses[s.statusFilter]?.label||"Status",[s.statusFilter,t]),oe=c.useMemo(()=>s.shippingStatusFilter&&t?.shipping_statuses&&t.shipping_statuses[s.shippingStatusFilter]?.label||"Shipping",[s.shippingStatusFilter,t]),ie=c.useMemo(()=>s.productTypeFilter&&t?.product_types&&t.product_types.find(m=>m.key===s.productTypeFilter)?.label||"Product type",[s.productTypeFilter,t]);c.useMemo(()=>s.searchQuery!==""||s.statusFilter!==null||s.shippingStatusFilter!==null||s.productTypeFilter!==null,[s.searchQuery,s.statusFilter,s.shippingStatusFilter,s.productTypeFilter]);const ue=c.useMemo(()=>t?.available_statuses&&t.available_statuses.length>0,[t]),de=c.useMemo(()=>t?.available_shipping_statuses&&t.available_shipping_statuses.length>0,[t]),me=c.useMemo(()=>{const a={};return e.titleColor&&(a["--vx-orders-title-color"]=e.titleColor),e.subtitleColor&&(a["--vx-orders-subtitle-color"]=e.subtitleColor),e.cardBackground&&(a["--vx-orders-card-bg"]=e.cardBackground),e.cardBackgroundHover&&(a["--vx-orders-card-bg-hover"]=e.cardBackgroundHover),e.cardBorderRadius&&(a["--vx-orders-card-radius"]=`${e.cardBorderRadius}px`),a},[e]);return d==="editor"?React.createElement("div",{className:"voxel-fse-orders-inner",style:{display:"contents",...me}},!e.headHide&&React.createElement("div",{className:"widget-head"},React.createElement("h1",{style:e.titleColor?{color:e.titleColor}:void 0},e.ordersTitle||"Orders"),React.createElement("p",{style:e.subtitleColor?{color:e.subtitleColor}:void 0},e.ordersSubtitle||"View all orders related to your account")),ue&&React.createElement("div",{className:"vx-order-filters ts-form"},React.createElement("div",{className:"ts-form-group ts-inline-filter order-keyword-search"},React.createElement("div",{className:"ts-input-icon flexify"},b(k(e.searchIcon,"searchIcon")),React.createElement("input",{type:"text",className:"inline-input",placeholder:"Search orders",value:s.searchQuery,onChange:f}))),React.createElement("div",{className:"ts-form-group ts-inline-filter order-status-search",ref:F},React.createElement("div",{className:`ts-filter ts-popup-target${s.statusFilter?" ts-filled":""}`,onClick:W},React.createElement("div",{className:"ts-filter-text"},re),React.createElement("div",{className:"ts-down-icon"})),s.statusDropdownOpen&&t&&React.createElement("div",{className:"ts-field-popup-container"},React.createElement("div",{className:"ts-field-popup"},React.createElement("div",{className:"ts-term-dropdown ts-md-group"},React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list min-scroll"},React.createElement("li",null,React.createElement("a",{href:"#",className:"flexify",onClick:a=>{a.preventDefault(),I(null)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:!s.statusFilter,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,"All statuses"))),t.statuses&&Object.entries(t.statuses).map(([a,m])=>React.createElement("li",{key:a},React.createElement("a",{href:"#",className:"flexify",onClick:E=>{E.preventDefault(),I(a)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:s.statusFilter===a,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,m.label))))))))),de&&React.createElement("div",{className:"ts-form-group ts-inline-filter order-shipping-status-search",ref:n},React.createElement("div",{className:`ts-filter ts-popup-target${s.shippingStatusFilter?" ts-filled":""}`,onClick:le},React.createElement("div",{className:"ts-filter-text"},oe),React.createElement("div",{className:"ts-down-icon"})),s.shippingStatusDropdownOpen&&t&&React.createElement("div",{className:"ts-field-popup-container"},React.createElement("div",{className:"ts-field-popup"},React.createElement("div",{className:"ts-term-dropdown ts-md-group"},React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list min-scroll"},React.createElement("li",null,React.createElement("a",{href:"#",className:"flexify",onClick:a=>{a.preventDefault(),M(null)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:!s.shippingStatusFilter,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,"All shipping statuses"))),Object.entries(t.shipping_statuses).map(([a,m])=>React.createElement("li",{key:a},React.createElement("a",{href:"#",className:"flexify",onClick:E=>{E.preventDefault(),M(a)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:s.shippingStatusFilter===a,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,m.label))))))))),t&&t.product_types&&t.product_types.length>0&&React.createElement("div",{className:"ts-form-group ts-inline-filter order-product-type-search",ref:v},React.createElement("div",{className:`ts-filter ts-popup-target${s.productTypeFilter?" ts-filled":""}`,onClick:ce},React.createElement("div",{className:"ts-filter-text"},ie),React.createElement("div",{className:"ts-down-icon"})),s.productTypeDropdownOpen&&t&&React.createElement("div",{className:"ts-field-popup-container"},React.createElement("div",{className:"ts-field-popup"},React.createElement("div",{className:"ts-term-dropdown ts-md-group"},React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list min-scroll"},React.createElement("li",null,React.createElement("a",{href:"#",className:"flexify",onClick:a=>{a.preventDefault(),D(null)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:!s.productTypeFilter,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,"All product types"))),t.product_types.map(a=>React.createElement("li",{key:a.key},React.createElement("a",{href:"#",className:"flexify",onClick:m=>{m.preventDefault(),D(a.key)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:s.productTypeFilter===a.key,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,a.label))))))))),React.createElement("div",{className:"ts-form-group order-reset-button"},React.createElement("a",{href:"#",className:"ts-filter",onClick:a=>{a.preventDefault(),y()}},b(k(e.resetSearchIcon,"resetSearchIcon"))))),React.createElement("div",{className:"ts-no-posts"},ae(e.noResultsIcon),React.createElement("p",null,"No orders found"))):React.createElement("div",{className:"voxel-fse-orders-inner",style:{display:"contents",...me}},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify({headHide:e.headHide,ordersTitle:e.ordersTitle,ordersSubtitle:e.ordersSubtitle,icons:{searchIcon:e.searchIcon,noResultsIcon:e.noResultsIcon,resetSearchIcon:e.resetSearchIcon,backIcon:e.backIcon,forwardIcon:e.forwardIcon,downIcon:e.downIcon,inboxIcon:e.inboxIcon,checkmarkIcon:e.checkmarkIcon,menuIcon:e.menuIcon,infoIcon:e.infoIcon,filesIcon:e.filesIcon,trashIcon:e.trashIcon,calendarIcon:e.calendarIcon}})}}),o?React.createElement(Ne,{order:o,config:t,attributes:e,isLoading:i,onBack:Le,onAction:(a,m)=>{O&&O(o.id,a,m)},onMessage:Ve,onCancelPromotion:async a=>{P&&await P(a)}}):React.createElement(React.Fragment,null,!e.headHide&&React.createElement("div",{className:"widget-head"},React.createElement("h1",{style:e.titleColor?{color:e.titleColor}:void 0},e.ordersTitle||"Orders"),React.createElement("p",{style:e.subtitleColor?{color:e.subtitleColor}:void 0},e.ordersSubtitle||"View all orders related to your account")),ue&&React.createElement("div",{className:"vx-order-filters ts-form"},React.createElement("div",{className:"ts-form-group ts-inline-filter order-keyword-search"},React.createElement("div",{className:"ts-input-icon flexify"},b(k(e.searchIcon,"searchIcon")),React.createElement("input",{type:"text",className:"inline-input",placeholder:"Search orders",value:s.searchQuery,onChange:f}))),React.createElement("div",{className:"ts-form-group ts-inline-filter order-status-search",ref:F},React.createElement("div",{className:`ts-filter ts-popup-target${s.statusFilter?" ts-filled":""}`,onClick:W},React.createElement("div",{className:"ts-filter-text"},re),React.createElement("div",{className:"ts-down-icon"})),s.statusDropdownOpen&&t&&React.createElement("div",{className:"ts-field-popup-container"},React.createElement("div",{className:"ts-field-popup"},React.createElement("div",{className:"ts-term-dropdown ts-md-group"},React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list min-scroll"},React.createElement("li",null,React.createElement("a",{href:"#",className:"flexify",onClick:a=>{a.preventDefault(),I(null)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:!s.statusFilter,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,"All statuses"))),Object.entries(t.statuses).map(([a,m])=>React.createElement("li",{key:a},React.createElement("a",{href:"#",className:"flexify",onClick:E=>{E.preventDefault(),I(a)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:s.statusFilter===a,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,m.label))))))))),de&&React.createElement("div",{className:"ts-form-group ts-inline-filter order-shipping-status-search",ref:n},React.createElement("div",{className:`ts-filter ts-popup-target${s.shippingStatusFilter?" ts-filled":""}`,onClick:le},React.createElement("div",{className:"ts-filter-text"},oe),React.createElement("div",{className:"ts-down-icon"})),s.shippingStatusDropdownOpen&&t&&React.createElement("div",{className:"ts-field-popup-container"},React.createElement("div",{className:"ts-field-popup"},React.createElement("div",{className:"ts-term-dropdown ts-md-group"},React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list min-scroll"},React.createElement("li",null,React.createElement("a",{href:"#",className:"flexify",onClick:a=>{a.preventDefault(),M(null)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:!s.shippingStatusFilter,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,"All shipping statuses"))),Object.entries(t.shipping_statuses).map(([a,m])=>React.createElement("li",{key:a},React.createElement("a",{href:"#",className:"flexify",onClick:E=>{E.preventDefault(),M(a)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:s.shippingStatusFilter===a,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,m.label))))))))),t&&t.product_types&&t.product_types.length>0&&React.createElement("div",{className:"ts-form-group ts-inline-filter order-product-type-search",ref:v},React.createElement("div",{className:`ts-filter ts-popup-target${s.productTypeFilter?" ts-filled":""}`,onClick:ce},React.createElement("div",{className:"ts-filter-text"},ie),React.createElement("div",{className:"ts-down-icon"})),s.productTypeDropdownOpen&&t&&React.createElement("div",{className:"ts-field-popup-container"},React.createElement("div",{className:"ts-field-popup"},React.createElement("div",{className:"ts-term-dropdown ts-md-group"},React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list min-scroll"},React.createElement("li",null,React.createElement("a",{href:"#",className:"flexify",onClick:a=>{a.preventDefault(),D(null)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:!s.productTypeFilter,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,"All product types"))),t.product_types.map(a=>React.createElement("li",{key:a.key},React.createElement("a",{href:"#",className:"flexify",onClick:m=>{m.preventDefault(),D(a.key)}},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-radio"},React.createElement("input",{type:"radio",checked:s.productTypeFilter===a.key,disabled:!0,hidden:!0,readOnly:!0}),React.createElement("span",{className:"checkmark"}))),React.createElement("span",null,a.label))))))))),React.createElement("div",{className:"ts-form-group order-reset-button"},React.createElement("a",{href:"#",className:"ts-filter",onClick:a=>{a.preventDefault(),y()}},b(k(e.resetSearchIcon,"resetSearchIcon"))))),i&&React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-loader"})),u&&!i&&React.createElement("div",{className:"ts-no-posts"},b(k(e.infoIcon,"infoIcon")),React.createElement("p",null,u)),!i&&!u&&React.createElement(Re,{orders:l,config:t,attributes:e,isLoading:i,onOrderSelect:He,currentPage:N,totalPages:R,onPageChange:Ae})))}function U(){return fe()}function Q(){const e=window;return typeof window<"u"&&e.wpApiSettings?.nonce?e.wpApiSettings.nonce:""}function Ie(e){const t=e.querySelector("script.vxconfig");if(t&&t.textContent)try{return JSON.parse(t.textContent)}catch(l){console.error("Failed to parse vxconfig:",l)}return null}function Ce(e){const t={searchIcon:e.icons?.searchIcon??e.icons?.search_icon??{library:"icon",value:"las la-search"},noResultsIcon:e.icons?.noResultsIcon??e.icons?.no_results_icon??{library:"svg",value:""},resetSearchIcon:e.icons?.resetSearchIcon??e.icons?.reset_search_icon??{library:"icon",value:"las la-sync"},backIcon:e.icons?.backIcon??e.icons?.back_icon??{library:"icon",value:"las la-angle-left"},forwardIcon:e.icons?.forwardIcon??e.icons?.forward_icon??{library:"icon",value:"las la-angle-right"},downIcon:e.icons?.downIcon??e.icons?.down_icon??{library:"icon",value:"las la-angle-down"},inboxIcon:e.icons?.inboxIcon??e.icons?.inbox_icon??{library:"icon",value:"las la-inbox"},checkmarkIcon:e.icons?.checkmarkIcon??e.icons?.checkmark_icon??{library:"icon",value:"las la-check"},menuIcon:e.icons?.menuIcon??e.icons?.menu_icon??{library:"icon",value:"las la-ellipsis-h"},infoIcon:e.icons?.infoIcon??e.icons?.info_icon??{library:"icon",value:"las la-info-circle"},filesIcon:e.icons?.filesIcon??e.icons?.files_icon??{library:"icon",value:"las la-file"},trashIcon:e.icons?.trashIcon??e.icons?.trash_icon??{library:"icon",value:"las la-trash"},calendarIcon:e.icons?.calendarIcon??e.icons?.calendar_icon??{library:"icon",value:"las la-calendar"}};return{headHide:e.headHide??e.head_hide??!1,ordersTitle:e.ordersTitle??e.orders_title??"Orders",ordersSubtitle:e.ordersSubtitle??e.orders_subtitle??"View all orders related to your account",icons:t,titleColor:e.titleColor??e.title_color??"",subtitleColor:e.subtitleColor??e.subtitle_color??"",cardBackground:e.cardBackground??e.card_background??"",cardBackgroundHover:e.cardBackgroundHover??e.card_background_hover??"",cardBorderRadius:e.cardBorderRadius??e.card_border_radius??0,statusPendingColor:e.statusPendingColor??e.status_pending_color??"",statusCompletedColor:e.statusCompletedColor??e.status_completed_color??"",statusCancelledColor:e.statusCancelledColor??e.status_cancelled_color??"",statusRefundedColor:e.statusRefundedColor??e.status_refunded_color??"",primaryButtonBackground:e.primaryButtonBackground??e.primary_button_background??"",primaryButtonTextColor:e.primaryButtonTextColor??e.primary_button_text_color??"",secondaryButtonBackground:e.secondaryButtonBackground??e.secondary_button_background??"",secondaryButtonTextColor:e.secondaryButtonTextColor??e.secondary_button_text_color??"",filterBackground:e.filterBackground??e.filter_background??"",filterTextColor:e.filterTextColor??e.filter_text_color??""}}function Se(e){return{blockId:"",headHide:e.headHide||!1,ordersTitle:e.ordersTitle||"Orders",ordersSubtitle:e.ordersSubtitle||"View all orders related to your account",searchIcon:e.icons?.searchIcon||{library:"icon",value:"las la-search"},noResultsIcon:e.icons?.noResultsIcon||{library:"svg",value:""},resetSearchIcon:e.icons?.resetSearchIcon||{library:"icon",value:"las la-sync"},backIcon:e.icons?.backIcon||{library:"icon",value:"las la-angle-left"},forwardIcon:e.icons?.forwardIcon||{library:"icon",value:"las la-angle-right"},downIcon:e.icons?.downIcon||{library:"icon",value:"las la-angle-down"},inboxIcon:e.icons?.inboxIcon||{library:"icon",value:"las la-inbox"},checkmarkIcon:e.icons?.checkmarkIcon||{library:"icon",value:"las la-check"},menuIcon:e.icons?.menuIcon||{library:"icon",value:"las la-ellipsis-h"},infoIcon:e.icons?.infoIcon||{library:"icon",value:"las la-info-circle"},filesIcon:e.icons?.filesIcon||{library:"icon",value:"las la-file"},trashIcon:e.icons?.trashIcon||{library:"icon",value:"las la-trash"},calendarIcon:e.icons?.calendarIcon||{library:"icon",value:"las la-calendar"},titleTypography:{},subtitleTypography:{},titleColor:e.titleColor||"",subtitleColor:e.subtitleColor||"",cardBackground:e.cardBackground||"",cardBackgroundHover:e.cardBackgroundHover||"",cardBorderRadius:e.cardBorderRadius||0,cardPadding:{},cardPadding_tablet:{},cardPadding_mobile:{},statusPendingColor:e.statusPendingColor||"",statusCompletedColor:e.statusCompletedColor||"",statusCancelledColor:e.statusCancelledColor||"",statusRefundedColor:e.statusRefundedColor||"",primaryButtonBackground:e.primaryButtonBackground||"",primaryButtonBackgroundHover:"",primaryButtonTextColor:e.primaryButtonTextColor||"",primaryButtonTextColorHover:"",secondaryButtonBackground:e.secondaryButtonBackground||"",secondaryButtonBackgroundHover:"",secondaryButtonTextColor:e.secondaryButtonTextColor||"",secondaryButtonTextColorHover:"",filterBackground:e.filterBackground||"",filterBackgroundActive:"",filterTextColor:e.filterTextColor||"",filterTextColorActive:"",blockMargin:{},blockMargin_tablet:{},blockMargin_mobile:{},blockPadding:{},blockPadding_tablet:{},blockPadding_mobile:{},hideDesktop:!1,hideTablet:!1,hideMobile:!1,customClasses:"",customCSS:""}}async function Te(){const e=U(),t=Q();try{const l={"Content-Type":"application/json"};t&&(l["X-WP-Nonce"]=t);const o=await fetch(`${e}voxel-fse/v1/orders/config`,{credentials:"same-origin",headers:l});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(l){return console.error("Failed to fetch orders config:",l),null}}async function K(e=1,t,l,o,d){const i=U(),u=Q(),N=new URLSearchParams;N.set("page",String(e)),t&&N.set("status",t),l&&N.set("product_type",l),o&&N.set("search",o),d&&N.set("shipping_status",d);try{const R={"Content-Type":"application/json"};u&&(R["X-WP-Nonce"]=u);const h=await fetch(`${i}voxel-fse/v1/orders?${N.toString()}`,{credentials:"same-origin",headers:R});if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const r=await h.json();return{orders:r.orders,total:r.total,totalPages:r.total_pages}}catch(R){return console.error("Failed to fetch orders:",R),{orders:[],total:0,totalPages:0}}}async function Y(e){const t=U(),l=Q();try{const o={"Content-Type":"application/json"};l&&(o["X-WP-Nonce"]=l);const d=await fetch(`${t}voxel-fse/v1/orders/${e}`,{credentials:"same-origin",headers:o});if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);return(await d.json()).order}catch(o){return console.error("Failed to fetch order:",o),null}}async function De(e,t,l){const o=U(),d=Q();try{const i={"Content-Type":"application/json"};d&&(i["X-WP-Nonce"]=d);const u=await fetch(`${o}voxel-fse/v1/orders/${e}/action`,{method:"POST",credentials:"same-origin",headers:i,body:JSON.stringify({action:t,...l})});if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return!0}catch(i){return console.error("Failed to execute order action:",i),!1}}async function Oe(e,t){try{const l=window.Voxel_Config?.ajax_url||`${window.location.origin}/?vx=1`,o=new FormData;o.append("order_id",String(e)),t&&o.append("_wpnonce",t);const i=await(await fetch(`${l}&action=products.single_order.promotions.cancel_promotion`,{method:"POST",credentials:"same-origin",body:o})).json();if(!i.success){const u=i.message||window.Voxel_Config?.l10n?.ajaxError||"Failed to cancel promotion";return typeof window.Voxel?.alert=="function"?window.Voxel.alert(u,"error"):console.error(u),!1}return!0}catch(l){return console.error("Failed to cancel promotion:",l),!1}}function Be({attributes:e}){const[t,l]=c.useState(null),[o,d]=c.useState([]),[i,u]=c.useState(null),[N,R]=c.useState(!0),[h,r]=c.useState(null),[_,w]=c.useState(1),[p,C]=c.useState({searchQuery:"",status:null,shippingStatus:null,productType:null,page:1});c.useEffect(()=>{let f=!1;async function y(){const I=await Te();f||(I?l(I):r("Failed to load orders configuration"))}return y(),()=>{f=!0}},[]),c.useEffect(()=>{if(!t)return;let f=!1;async function y(){R(!0);const I=await K(p.page,p.status,p.productType,p.searchQuery,p.shippingStatus);f||(d(I.orders),w(I.totalPages),R(!1))}return y(),()=>{f=!0}},[t,p]);const O=c.useCallback(f=>{C(y=>({...y,searchQuery:f,page:1}))},[]),B=c.useCallback(f=>{C(y=>({...y,status:f,page:1}))},[]),P=c.useCallback(f=>{C(y=>({...y,shippingStatus:f,page:1}))},[]),A=c.useCallback(f=>{C(y=>({...y,productType:f,page:1}))},[]),F=c.useCallback(async f=>{R(!0);const y=await Y(f);u(y),R(!1)},[]),n=c.useCallback(()=>{u(null)},[]),v=c.useCallback(async(f,y,I)=>{if(await De(f,y,I)){if(i&&i.id===f){const W=await Y(f);u(W)}const D=await K(p.page,p.status,p.productType,p.searchQuery,p.shippingStatus);d(D.orders)}},[i,p]),s=c.useCallback(f=>{C(y=>({...y,page:f}))},[]),g=c.useCallback(async f=>{const y=t?.nonce;if(await Oe(f,y)){if(i&&i.id===f){const D=await Y(f);u(D)}const M=await K(p.page,p.status,p.productType,p.searchQuery,p.shippingStatus);d(M.orders)}},[t?.nonce,i,p]);return t&&!t.current_user_id?React.createElement("div",{className:"vx-orders-widget"},React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-loader"}),React.createElement("p",null,"Please log in to view your orders."))):React.createElement(xe,{attributes:e,config:t,orders:o,currentOrder:i,context:"frontend",isLoading:N,error:h,currentPage:p.page,totalPages:_,onSearch:O,onStatusFilter:B,onShippingStatusFilter:P,onProductTypeFilter:A,onOrderSelect:F,onOrderBack:n,onOrderAction:v,onPageChange:s,onCancelPromotion:g})}function L(){document.querySelectorAll(".voxel-fse-orders-frontend, .vx-orders-widget").forEach(t=>{if(t.dataset.reactMounted==="true")return;const l=Ie(t);if(!l){console.warn("Orders block: No vxconfig found");return}const o=Ce(l),d=Se(o);t.innerHTML="",t.dataset.reactMounted="true",pe.createRoot(t).render(React.createElement(Be,{attributes:d}))})}const se={};window.VX_Orders={reinit:()=>L(),registerComponent:(e,t)=>{se[e]=t},getComponent:e=>se[e]||null},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",L):L(),window.addEventListener("turbo:load",L),window.addEventListener("pjax:complete",L),typeof jQuery<"u"&&jQuery(document).on("voxel:markup-update",L)})(ReactDOM,React);
