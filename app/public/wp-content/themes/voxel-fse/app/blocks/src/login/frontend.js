var VoxelFSELogin=(function(z,Se,v){"use strict";var J,ne,M,se;J={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},ne=["(","?"],M={")":["("],":":["?","?:"]},se=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;function Ae(e){for(var a=[],r=[],o,u,l,d;o=e.match(se);){for(u=o[0],l=e.substr(0,o.index).trim(),l&&a.push(l);d=r.pop();){if(M[u]){if(M[u][0]===d){u=M[u][1]||u;break}}else if(ne.indexOf(d)>=0||J[d]<J[u]){r.push(d);break}a.push(d)}M[u]||r.push(u),e=e.substr(o.index+u.length)}return e=e.trim(),e&&a.push(e),a.concat(r.reverse())}var Ie={"!":function(e){return!e},"*":function(e,a){return e*a},"/":function(e,a){return e/a},"%":function(e,a){return e%a},"+":function(e,a){return e+a},"-":function(e,a){return e-a},"<":function(e,a){return e<a},"<=":function(e,a){return e<=a},">":function(e,a){return e>a},">=":function(e,a){return e>=a},"==":function(e,a){return e===a},"!=":function(e,a){return e!==a},"&&":function(e,a){return e&&a},"||":function(e,a){return e||a},"?:":function(e,a,r){if(e)throw a;return r}};function De(e,a){var r=[],o,u,l,d,i,y;for(o=0;o<e.length;o++){if(i=e[o],d=Ie[i],d){for(u=d.length,l=Array(u);u--;)l[u]=r.pop();try{y=d.apply(null,l)}catch(b){return b}}else a.hasOwnProperty(i)?y=a[i]:y=+i;r.push(y)}return r[0]}function Te(e){var a=Ae(e);return function(r){return De(a,r)}}function Pe(e){var a=Te(e);return function(r){return+a({n:r})}}var ce={contextDelimiter:"",onMissingKey:null};function Fe(e){var a,r,o;for(a=e.split(";"),r=0;r<a.length;r++)if(o=a[r].trim(),o.indexOf("plural=")===0)return o.substr(7)}function Q(e,a){var r;this.data=e,this.pluralForms={},this.options={};for(r in ce)this.options[r]=a!==void 0&&r in a?a[r]:ce[r]}Q.prototype.getPluralForm=function(e,a){var r=this.pluralForms[e],o,u,l;return r||(o=this.data[e][""],l=o["Plural-Forms"]||o["plural-forms"]||o.plural_forms,typeof l!="function"&&(u=Fe(o["Plural-Forms"]||o["plural-forms"]||o.plural_forms),l=Pe(u)),r=this.pluralForms[e]=l),r(a)},Q.prototype.dcnpgettext=function(e,a,r,o,u){var l,d,i;return u===void 0?l=0:l=this.getPluralForm(e,u),d=r,a&&(d=a+this.options.contextDelimiter+r),i=this.data[e][d],i&&i[l]?i[l]:(this.options.onMissingKey&&this.options.onMissingKey(r,e),l===0?r:o)};var le={"":{plural_forms(e){return e===1?0:1}}},je=/^i18n\.(n?gettext|has_translation)(_|$)/,Le=(e,a,r)=>{const o=new Q({}),u=new Set,l=()=>{u.forEach(p=>p())},d=p=>(u.add(p),()=>u.delete(p)),i=(p="default")=>o.data[p],y=(p,h="default")=>{o.data[h]={...o.data[h],...p},o.data[h][""]={...le[""],...o.data[h]?.[""]},delete o.pluralForms[h]},b=(p,h)=>{y(p,h),l()},g=(p,h="default")=>{o.data[h]={...o.data[h],...p,"":{...le[""],...o.data[h]?.[""],...p?.[""]}},delete o.pluralForms[h],l()},j=(p,h)=>{o.data={},o.pluralForms={},b(p,h)},N=(p="default",h,_,k,w)=>(o.data[p]||y(void 0,p),o.dcnpgettext(p,h,_,k,w)),D=p=>p||"default",F=(p,h)=>{let _=N(h,void 0,p);return r?(_=r.applyFilters("i18n.gettext",_,p,h),r.applyFilters("i18n.gettext_"+D(h),_,p,h)):_},T=(p,h,_)=>{let k=N(_,h,p);return r?(k=r.applyFilters("i18n.gettext_with_context",k,p,h,_),r.applyFilters("i18n.gettext_with_context_"+D(_),k,p,h,_)):k},A=(p,h,_,k)=>{let w=N(k,void 0,p,h,_);return r?(w=r.applyFilters("i18n.ngettext",w,p,h,_,k),r.applyFilters("i18n.ngettext_"+D(k),w,p,h,_,k)):w},G=(p,h,_,k,w)=>{let O=N(w,k,p,h,_);return r?(O=r.applyFilters("i18n.ngettext_with_context",O,p,h,_,k,w),r.applyFilters("i18n.ngettext_with_context_"+D(w),O,p,h,_,k,w)):O},B=()=>T("ltr","text direction")==="rtl",ae=(p,h,_)=>{const k=h?h+""+p:p;let w=!!o.data?.[_??"default"]?.[k];return r&&(w=r.applyFilters("i18n.has_translation",w,p,h,_),w=r.applyFilters("i18n.has_translation_"+D(_),w,p,h,_)),w};if(r){const p=h=>{je.test(h)&&l()};r.addAction("hookAdded","core/i18n",p),r.addAction("hookRemoved","core/i18n",p)}return{getLocaleData:i,setLocaleData:b,addLocaleData:g,resetLocaleData:j,subscribe:d,__:F,_x:T,_n:A,_nx:G,isRTL:B,hasTranslation:ae}};function Ue(e){return typeof e!="string"||e===""?(console.error("The namespace must be a non-empty string."),!1):/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)?!0:(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)}var oe=Ue;function Oe(e){return typeof e!="string"||e===""?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)?!0:(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)}var X=Oe;function Ve(e,a){return function(o,u,l,d=10){const i=e[a];if(!X(o)||!oe(u))return;if(typeof l!="function"){console.error("The hook callback must be a function.");return}if(typeof d!="number"){console.error("If specified, the hook priority must be a number.");return}const y={callback:l,priority:d,namespace:u};if(i[o]){const b=i[o].handlers;let g;for(g=b.length;g>0&&!(d>=b[g-1].priority);g--);g===b.length?b[g]=y:b.splice(g,0,y),i.__current.forEach(j=>{j.name===o&&j.currentIndex>=g&&j.currentIndex++})}else i[o]={handlers:[y],runs:0};o!=="hookAdded"&&e.doAction("hookAdded",o,u,l,d)}}var ie=Ve;function $e(e,a,r=!1){return function(u,l){const d=e[a];if(!X(u)||!r&&!oe(l))return;if(!d[u])return 0;let i=0;if(r)i=d[u].handlers.length,d[u]={runs:d[u].runs,handlers:[]};else{const y=d[u].handlers;for(let b=y.length-1;b>=0;b--)y[b].namespace===l&&(y.splice(b,1),i++,d.__current.forEach(g=>{g.name===u&&g.currentIndex>=b&&g.currentIndex--}))}return u!=="hookRemoved"&&e.doAction("hookRemoved",u,l),i}}var K=$e;function He(e,a){return function(o,u){const l=e[a];return typeof u<"u"?o in l&&l[o].handlers.some(d=>d.namespace===u):o in l}}var de=He;function qe(e,a,r,o){return function(l,...d){const i=e[a];i[l]||(i[l]={handlers:[],runs:0}),i[l].runs++;const y=i[l].handlers;if(!y||!y.length)return r?d[0]:void 0;const b={name:l,currentIndex:0};async function g(){try{i.__current.add(b);let N=r?d[0]:void 0;for(;b.currentIndex<y.length;)N=await y[b.currentIndex].callback.apply(null,d),r&&(d[0]=N),b.currentIndex++;return r?N:void 0}finally{i.__current.delete(b)}}function j(){try{i.__current.add(b);let N=r?d[0]:void 0;for(;b.currentIndex<y.length;)N=y[b.currentIndex].callback.apply(null,d),r&&(d[0]=N),b.currentIndex++;return r?N:void 0}finally{i.__current.delete(b)}}return(o?g:j)()}}var W=qe;function Ge(e,a){return function(){const o=e[a];return Array.from(o.__current).at(-1)?.name??null}}var ue=Ge;function Be(e,a){return function(o){const u=e[a];return typeof o>"u"?u.__current.size>0:Array.from(u.__current).some(l=>l.name===o)}}var me=Be;function Me(e,a){return function(o){const u=e[a];if(X(o))return u[o]&&u[o].runs?u[o].runs:0}}var pe=Me,Ye=class{actions;filters;addAction;addFilter;removeAction;removeFilter;hasAction;hasFilter;removeAllActions;removeAllFilters;doAction;doActionAsync;applyFilters;applyFiltersAsync;currentAction;currentFilter;doingAction;doingFilter;didAction;didFilter;constructor(){this.actions=Object.create(null),this.actions.__current=new Set,this.filters=Object.create(null),this.filters.__current=new Set,this.addAction=ie(this,"actions"),this.addFilter=ie(this,"filters"),this.removeAction=K(this,"actions"),this.removeFilter=K(this,"filters"),this.hasAction=de(this,"actions"),this.hasFilter=de(this,"filters"),this.removeAllActions=K(this,"actions",!0),this.removeAllFilters=K(this,"filters",!0),this.doAction=W(this,"actions",!1,!1),this.doActionAsync=W(this,"actions",!1,!0),this.applyFilters=W(this,"filters",!0,!1),this.applyFiltersAsync=W(this,"filters",!0,!0),this.currentAction=ue(this,"actions"),this.currentFilter=ue(this,"filters"),this.doingAction=me(this,"actions"),this.doingFilter=me(this,"filters"),this.didAction=pe(this,"actions"),this.didFilter=pe(this,"filters")}};function ze(){return new Ye}var Ke=ze,fe=Ke(),{addAction:Vt,addFilter:$t,removeAction:Ht,removeFilter:qt,hasAction:Gt,hasFilter:Bt,removeAllActions:Mt,removeAllFilters:Yt,doAction:zt,doActionAsync:Kt,applyFilters:Wt,applyFiltersAsync:Zt,currentAction:Jt,currentFilter:Qt,doingAction:Xt,doingFilter:ea,didAction:ta,didFilter:aa,actions:ra,filters:na}=fe,C=Le(void 0,void 0,fe);C.getLocaleData.bind(C),C.setLocaleData.bind(C),C.resetLocaleData.bind(C),C.subscribe.bind(C);var s=C.__.bind(C);C._x.bind(C),C._n.bind(C),C._nx.bind(C),C.isRTL.bind(C),C.hasTranslation.bind(C);function m(e,a){return!e||!e.value?null:e.library==="icon"||!e.library||e.library===""?React.createElement("i",{className:e.value}):e.library==="svg"&&e.value?e.value.startsWith("<svg")||e.value.startsWith("<?xml")?React.createElement("span",{className:"ts-icon-svg",dangerouslySetInnerHTML:{__html:e.value}}):React.createElement("img",{src:e.value,alt:"",className:"ts-icon-svg"}):null}function I(e){const a=window.Voxel_Config;return a?.ajax_url?`${a.ajax_url}&action=${e}`:`${a?.site_url||window.location.origin}/?vx=1&action=${e}`}function E(e,a="error"){const r=window.Voxel;r?.alert?r.alert(e,a):(console.warn(`[${a.toUpperCase()}] ${e}`),a==="error"&&alert(e))}function ee(e,a,r,o){const u=window.Voxel;u?.prompt?u.prompt(e,a,r,o):confirm(e)&&r[0]?.onClick?.()}function We(e){const a=window.Voxel;a?.copy?a.copy(e):navigator.clipboard.writeText(e).catch(console.error)}function R(e,a){return window.Voxel_Config?.l10n?.[e]??a}function V(e,a,r,o){if(!r||!a){o(null);return}const u=window.grecaptcha;u?u.ready(()=>{u.execute(a,{action:e}).then(o).catch(()=>o(null))}):o(null)}function q(e,a){switch(e){case"login":return a.loginTitle;case"register":return a.registerTitle;case"confirm_account":return a.confirmTitle;case"recover":return a.passwordRecoveryTitle;case"recover_confirm":return a.confirmCodeTitle;case"recover_set_password":return a.newPasswordTitle;case"security_update_password":return a.updatePasswordTitle;case"security_update_email":return a.updateEmailTitle;case"welcome":return a.welcomeTitle;default:return""}}function Ze({attributes:e,config:a,context:r,isLoading:o=!1}){const[u,l]=v.useState(r==="editor"?e.previewScreen:a?.screen||"login"),[d,i]=v.useState(!1),[y,b]=v.useState(!1),[g,j]=v.useState(null),[N,D]=v.useState({username:"",password:"",showPassword:!1,remember:!0}),[F,T]=v.useState({showPassword:!1,terms_agreed:!1,fieldValues:{}}),[A,G]=v.useState({email:"",code:"",password:"",confirm_password:""}),[B,ae]=v.useState(""),[p,h]=v.useState({current:"",new:"",confirm_new:"",successful:!1}),[_,k]=v.useState({new:"",code:"",state:"send_code"}),[w,O]=v.useState({qr_code:null,verify_code:"",disable_password:"",backup_codes:[]}),[L,Y]=v.useState({user_id:null,session_token:null,code:"",use_backup:!1,trust_device:!1}),[U,$]=v.useState({export_data:{pending:!1},delete_account:{pending:!1,password:"",code:""}}),he=v.useRef(null);v.useEffect(()=>{r==="editor"&&l(e.previewScreen)},[r,e.previewScreen]),v.useEffect(()=>{if(a?.registration?.roles){const t=Object.values(a.registration.roles),n=a.registration.default_role;n&&a.registration.roles[n]?j(a.registration.roles[n]):t.length>0&&!g&&j(t[0])}},[a,g]),v.useEffect(()=>{B.length===5&&!d&&u==="confirm_account"&&Re()},[B,d,u]);const rt=v.useCallback(()=>a?.registration?.roles&&Object.keys(a.registration.roles).length>0,[a]),P=v.useCallback(()=>a?.redirectUrl||window.location.href,[a]),Ee=v.useCallback(()=>{r!=="editor"&&V("vx_login",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{i(!0);const n=new FormData;n.append("username",N.username),n.append("password",N.password),n.append("remember",N.remember?"yes":""),n.append("redirect_to",P()),n.append("_wpnonce",a?.nonce||""),t&&n.append("_recaptcha",t),fetch(I("auth.login"),{method:"POST",body:n}).then(c=>c.json()).then(c=>{if(i(!1),c.success)if(c.requires_2fa)Y({user_id:c.user_id??null,session_token:c.session_token??null,code:"",use_backup:!1,trust_device:!1}),l("login_2fa_verify");else if(c.confirmed){const f=c.redirect_to||P();f==="{REDIRECT_URL}"?window.location.replace(P()):window.location.replace(f.replace("{REDIRECT_URL}",encodeURIComponent(P())))}else l("login_confirm_account");else E(c.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})})},[r,a,N,P]),Z=v.useCallback(t=>{r==="editor"||!g||V("vx_register",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,n=>{i(!0);const c=new FormData,f={};Object.values(g.fields||{}).forEach(x=>{const H=F.fieldValues[x.key]??x.value;if(x._is_auth_field)x.key==="voxel:auth-username"?c.append("username",H||""):x.key==="voxel:auth-email"?c.append("email",H||""):x.key==="voxel:auth-password"&&c.append("password",H||"");else if(H!=null)if(["file","image","profile-avatar"].includes(x.type)){const Ot=H;f[x.key]=[],Ot?.forEach(re=>{re.source==="new_upload"&&re.item&&(c.append(`files[${x.id}][]`,re.item),f[x.key].push("uploaded_file"))})}else f[x.key]=H}),c.append("postdata",JSON.stringify(f)),c.append("terms_agreed",F.terms_agreed?"yes":""),c.append("_wpnonce",a?.nonce||""),n&&c.append("_recaptcha",n),c.append("role",g.key),c.append("redirect_to",P());const S=new URLSearchParams(window.location.search).get("plan");S&&c.append("plan",S),t&&c.append("_confirmation_code",t),fetch(I("auth.register"),{method:"POST",body:c}).then(x=>x.json()).then(x=>{if(i(!1),x.success)if(x.verification_required)l("confirm_account");else{const H=x.redirect_to||P();H==="{REDIRECT_URL}"?window.location.replace(P()):window.location.replace(H.replace("{REDIRECT_URL}",encodeURIComponent(P())))}else E(x.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})})},[r,a,g,F,P]),Re=v.useCallback(()=>{Z(B)},[Z,B]),nt=v.useCallback(()=>{r==="editor"||!g||V("vx_resend_confirmation_code",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{b(!0);const n=new FormData,c=F.fieldValues["voxel:auth-username"]||"",f=F.fieldValues["voxel:auth-email"]||"";n.append("username",c),n.append("email",f),n.append("_wpnonce",a?.nonce||""),t&&n.append("_recaptcha",t),fetch(I("auth.register.resend_confirmation_code"),{method:"POST",body:n}).then(S=>S.json()).then(S=>{b(!1),S.success?E(S.message||s("Confirmation code sent","voxel-fse"),"info"):E(S.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{b(!1),E(R("ajaxError","An error occurred"),"error")})})},[r,a,g,F.fieldValues]),ge=v.useCallback(()=>{r!=="editor"&&V("vx_recover",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{i(!0);const n=new FormData;n.append("email",A.email),n.append("_wpnonce",a?.nonce||""),t&&n.append("_recaptcha",t),fetch(I("auth.recover"),{method:"POST",body:n}).then(c=>c.json()).then(c=>{i(!1),c.success?l("recover_confirm"):E(c.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})})},[r,a,A.email]),be=v.useCallback(()=>{r!=="editor"&&V("vx_recover_confirm",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{i(!0);const n=new FormData;n.append("email",A.email),n.append("code",A.code),n.append("_wpnonce",a?.nonce||""),t&&n.append("_recaptcha",t),fetch(I("auth.recover_confirm"),{method:"POST",body:n}).then(c=>c.json()).then(c=>{i(!1),c.success?l("recover_set_password"):E(c.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})})},[r,a,A.email,A.code]),_e=v.useCallback(()=>{r!=="editor"&&V("vx_recover_set_password",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{i(!0);const n=new FormData;n.append("email",A.email),n.append("code",A.code),n.append("password",A.password),n.append("confirm_password",A.confirm_password),n.append("_wpnonce",a?.nonce||""),t&&n.append("_recaptcha",t),fetch(I("auth.recover_set_password"),{method:"POST",body:n}).then(c=>c.json()).then(c=>{i(!1),c.success?(D(f=>({...f,username:A.email})),G({email:"",code:"",password:"",confirm_password:""}),l("login"),he.current?.focus()):E(c.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})})},[r,a,A]),ye=v.useCallback(()=>{r!=="editor"&&V("vx_update_password",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{i(!0);const n=new FormData;n.append("current",p.current),n.append("new",p.new),n.append("confirm_new",p.confirm_new),n.append("_wpnonce",a?.nonce||""),t&&n.append("_recaptcha",t),fetch(I("auth.update_password"),{method:"POST",body:n}).then(c=>c.json()).then(c=>{i(!1),c.success?h(f=>({...f,successful:!0})):E(c.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})})},[r,a,p]),we=v.useCallback(()=>{r!=="editor"&&V("vx_update_email",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{i(!0);const n=new FormData;n.append("new",_.new),n.append("code",_.code),n.append("state",_.state),n.append("_wpnonce",a?.nonce||""),t&&n.append("_recaptcha",t),fetch(I("auth.update_email"),{method:"POST",body:n}).then(c=>c.json()).then(c=>{i(!1),c.success?k(f=>({...f,state:c.state||"success"})):E(c.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})})},[r,a,_]),st=v.useCallback(()=>{if(r==="editor")return;i(!0);const t=new FormData;t.append("_wpnonce",a?.nonce||""),fetch(I("auth.2fa_setup"),{method:"POST",body:t}).then(n=>n.json()).then(n=>{i(!1),n.success?(O(c=>({...c,qr_code:n.qr_code||null,verify_code:""})),l("security_2fa_setup")):E(n.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})},[r,a]),Ne=v.useCallback(()=>{if(r==="editor")return;i(!0);const t=new FormData;t.append("code",w.verify_code),t.append("_wpnonce",a?.nonce||""),fetch(I("auth.2fa_enable"),{method:"POST",body:t}).then(n=>n.json()).then(n=>{i(!1),n.success?(O(c=>({...c,backup_codes:n.backup_codes||[]})),l("security_2fa_backup_codes"),E(a?.l10n?.twofa_enabled||s("Two-factor authentication enabled","voxel-fse"),"success")):E(n.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})},[r,a,w.verify_code]),ct=v.useCallback(()=>{r!=="editor"&&ee(a?.l10n?.twofa_disable_confirm||s("Are you sure you want to disable two-factor authentication?","voxel-fse"),"warning",[{label:R("yes","Yes"),onClick:()=>{i(!0);const t=new FormData;t.append("password",w.disable_password),t.append("_wpnonce",a?.nonce||""),fetch(I("auth.2fa_disable"),{method:"POST",body:t}).then(n=>n.json()).then(n=>{i(!1),n.success?(O(c=>({...c,disable_password:""})),l("security"),E(a?.l10n?.twofa_disabled||s("Two-factor authentication disabled","voxel-fse"),"success")):E(n.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})}},{label:R("no","No"),onClick:()=>{}}],7500)},[r,a,w.disable_password]),lt=v.useCallback(()=>{r!=="editor"&&ee(a?.l10n?.twofa_regenerate_backups_confirm||s("Generate new backup codes? Old codes will stop working.","voxel-fse"),"warning",[{label:R("yes","Yes"),onClick:()=>{i(!0);const t=new FormData;t.append("_wpnonce",a?.nonce||""),fetch(I("auth.2fa_regenerate_backups"),{method:"POST",body:t}).then(n=>n.json()).then(n=>{i(!1),n.success?(O(c=>({...c,backup_codes:n.backup_codes||[]})),l("security_2fa_backup_codes"),E(a?.l10n?.twofa_backups_generated||s("Backup codes generated","voxel-fse"),"success")):E(n.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})}},{label:R("no","No"),onClick:()=>{}}],7500)},[r,a]),ot=v.useCallback(()=>{r!=="editor"&&ee(a?.l10n?.twofa_remove_trusted_devices_confirm||s("Remove all trusted devices?","voxel-fse"),"warning",[{label:R("yes","Yes"),onClick:()=>{i(!0);const t=new FormData;t.append("_wpnonce",a?.nonce||""),fetch(I("auth.2fa_remove_trusted_devices"),{method:"POST",body:t}).then(n=>n.json()).then(n=>{i(!1),n.success?E(a?.l10n?.twofa_trusted_devices_removed||s("Trusted devices removed","voxel-fse"),"success"):E(n.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})}},{label:R("no","No"),onClick:()=>{}}],7500)},[r,a]),xe=v.useCallback(()=>{if(r==="editor")return;i(!0);const t=new FormData;t.append("user_id",String(L.user_id||"")),t.append("session_token",L.session_token||""),t.append("code",L.code),t.append("use_backup",L.use_backup?"yes":"no"),t.append("trust_device",L.trust_device?"yes":"no"),t.append("remember",N.remember?"yes":"no"),t.append("redirect_to",P()),t.append("_wpnonce",a?.nonce||""),fetch(I("auth.verify_2fa"),{method:"POST",body:t}).then(n=>n.json()).then(n=>{if(i(!1),n.success){const c=n.redirect_to||P();c==="{REDIRECT_URL}"?window.location.replace(P()):window.location.replace(c.replace("{REDIRECT_URL}",encodeURIComponent(P())))}else E(n.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{i(!1),E(R("ajaxError","An error occurred"),"error")})},[r,a,L,N.remember,P]),it=v.useCallback(()=>{r!=="editor"&&V("vx_request_personal_data",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{$(c=>({...c,export_data:{pending:!0}}));const n=new FormData;n.append("_wpnonce",a?.nonce||""),t&&n.append("_recaptcha",t),fetch(I("auth.request_personal_data"),{method:"POST",body:n}).then(c=>c.json()).then(c=>{$(f=>({...f,export_data:{pending:!1}})),c.success?E(c.message||s("Request submitted","voxel-fse"),"success"):E(c.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{$(c=>({...c,export_data:{pending:!1}})),E(R("ajaxError","An error occurred"),"error")})})},[r,a]),ke=v.useCallback((t=!1)=>{if(r==="editor")return;V(t?"vx_delete_account_permanently":"vx_delete_account",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,c=>{$(S=>({...S,delete_account:{...S.delete_account,pending:!0}}));const f=new FormData;f.append("password",U.delete_account.password),f.append("_wpnonce",a?.nonce||""),c&&f.append("_recaptcha",c),f.append("confirmation_code",U.delete_account.code),f.append("confirmed",t?"yes":""),fetch(I("auth.delete_account_permanently"),{method:"POST",body:f}).then(S=>S.json()).then(S=>{$(x=>({...x,delete_account:{...x.delete_account,pending:!1}})),S.success?t?window.location.reload():($(x=>({...x,delete_account:{...x.delete_account,code:S.confirmation_code||""}})),l("security_delete_account_confirm")):E(S.message||R("ajaxError","An error occurred"),"error")}).catch(()=>{$(S=>({...S,delete_account:{...S.delete_account,pending:!1}})),E(R("ajaxError","An error occurred"),"error")})})},[r,a,U.delete_account]),dt=v.useCallback(()=>{const t=w.backup_codes.join(`
`);We(t),E(s("Backup codes copied to clipboard","voxel-fse"),"success")},[w.backup_codes]),ut=v.useCallback(t=>{t.preventDefault(),Ee()},[Ee]),mt=v.useCallback(t=>{t.preventDefault(),Z()},[Z]),pt=v.useCallback(t=>{t.preventDefault(),ge()},[ge]),ft=v.useCallback(t=>{t.preventDefault(),be()},[be]),vt=v.useCallback(t=>{t.preventDefault(),_e()},[_e]),ht=v.useCallback(t=>{t.preventDefault(),ye()},[ye]),Et=v.useCallback(t=>{t.preventDefault(),we()},[we]),Rt=v.useCallback(t=>{t.preventDefault(),Ne()},[Ne]),gt=v.useCallback(t=>{t.preventDefault(),xe()},[xe]),Ce=()=>React.createElement("form",{onSubmit:ut},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},q("login",e))),a?.google?.enabled&&React.createElement("div",{className:"login-section"},React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},s("Social connect","voxel-fse")),React.createElement("div",{className:"or-line"})),React.createElement("div",{className:"ts-form-group ts-social-connect"},React.createElement("a",{href:r==="frontend"?a.google.loginUrl:"#",className:"ts-btn ts-google-btn ts-btn-large ts-btn-1",onClick:t=>r==="editor"&&t.preventDefault()},m(e.googleIcon),s("Sign in with Google","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},s("Enter details","voxel-fse")),React.createElement("div",{className:"or-line"})),React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"ts-input-icon flexify"},m(e.usernameIcon),React.createElement("input",{className:"ts-filter autofocus",type:"text",value:N.username,onChange:t=>D(n=>({...n,username:t.target.value})),placeholder:s("Username","voxel-fse"),name:"login_username",disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group ts-password-field"},React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter autofocus",type:N.showPassword?"text":"password",value:N.password,onChange:t=>D(n=>({...n,password:t.target.value})),ref:he,placeholder:s("Password","voxel-fse"),name:"login_password",disabled:r==="editor"}),React.createElement("div",{className:`view-password ${N.showPassword?"active":""}`,onClick:()=>D(t=>({...t,showPassword:!t.showPassword}))},m(e.eyeIcon)))),React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:N.remember,onChange:t=>D(n=>({...n,remember:t.target.checked})),disabled:r==="editor"}),React.createElement("span",{className:"checkmark"})),React.createElement("span",null,s("Remember me","voxel-fse")))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},m(e.usernameIcon),s("Log in","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},s("Forgot password?","voxel-fse")," ",React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),l("recover")}},s("Recover account","voxel-fse"))))),rt()&&React.createElement("div",{className:"login-section"},React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},s("Don't have an account?","voxel-fse")),React.createElement("div",{className:"or-line"})),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{className:"ts-btn ts-btn-1 ts-btn-large",href:"#",onClick:t=>{t.preventDefault(),l("register")}},m(e.signUpIcon),s("Sign up","voxel-fse"))))),bt=()=>{const t=a?.registration?.roles?Object.values(a.registration.roles):[];return React.createElement("form",{onSubmit:mt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},q("register",e))),t.length>=2&&React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Join the platform as:","voxel-fse")),React.createElement("div",{className:"role-selection-hold"},React.createElement("div",{className:"role-selection"},t.map(n=>React.createElement("a",{key:n.key,href:"#",className:g?.key===n.key?"selected-role":"",onClick:c=>{c.preventDefault(),j(n)}},n.label)))))),g&&React.createElement(React.Fragment,null,a?.google?.enabled&&g.allow_social_login&&React.createElement("div",{className:"login-section"},React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},s("Social connect","voxel-fse")),React.createElement("div",{className:"or-line"})),React.createElement("div",{className:"ts-form-group ts-social-connect"},React.createElement("a",{href:r==="frontend"&&g.social_login?.google_register||"#",className:"ts-btn ts-google-btn ts-btn-large ts-btn-1",onClick:n=>r==="editor"&&n.preventDefault()},m(e.googleIcon),s("Sign in with Google","voxel-fse")))),React.createElement("div",{className:"login-section"},a?.google?.enabled&&React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},s("Or enter your details","voxel-fse")),React.createElement("div",{className:"or-line"})),g.fields?.map(n=>_t(n))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group tos-group"},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:F.terms_agreed,onChange:n=>T(c=>({...c,terms_agreed:n.target.checked})),tabIndex:0,disabled:r==="editor"}),React.createElement("span",{className:"checkmark"}))),React.createElement("p",{className:"field-info"},s("I agree to the","voxel-fse")," ",React.createElement("a",{href:a?.urls?.terms||"#",target:"_blank",rel:"noopener noreferrer"},s("Terms and Conditions","voxel-fse"))," ",s("and","voxel-fse")," ",React.createElement("a",{href:a?.urls?.privacy||"#",target:"_blank",rel:"noopener noreferrer"},s("Privacy Policy","voxel-fse"))))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},m(e.usernameIcon),s("Sign up","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},s("Have an account already?","voxel-fse")," ",React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),l("login")}},s("Log in instead","voxel-fse")))))))},_t=t=>{const n=F.fieldValues[t.key]??t.value??"";if(t._is_auth_field){if(t.key==="voxel:auth-username")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:"ts-input-icon flexify"},m(e.usernameIcon),React.createElement("input",{className:"ts-filter",type:"text",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.placeholder||"",disabled:r==="editor"})));if(t.key==="voxel:auth-email")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:"ts-input-icon flexify"},m(e.emailIcon),React.createElement("input",{className:"ts-filter",type:"email",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.placeholder||"",autoComplete:"email",disabled:r==="editor"})));if(t.key==="voxel:auth-password")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter",type:F.showPassword?"text":"password",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.placeholder||"",autoComplete:"new-password",disabled:r==="editor"}),React.createElement("div",{className:`view-password ${F.showPassword?"active":""}`,onClick:()=>T(c=>({...c,showPassword:!c.showPassword}))},m(e.eyeIcon))))}return["text","title","profile-name","profile-first-name","profile-last-name"].includes(t.type)?React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},s("Optional","voxel-fse")),t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("input",{className:"ts-filter",type:"text",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.props?.placeholder||"",disabled:r==="editor"})):t.type==="phone"?React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},s("Optional","voxel-fse"))),React.createElement("div",{className:"ts-input-icon flexify"},m(e.phoneIcon),React.createElement("input",{className:"ts-filter",type:"tel",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.props?.placeholder||"",disabled:r==="editor"}))):t.type==="url"?React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},s("Optional","voxel-fse"))),React.createElement("div",{className:"ts-input-icon flexify"},m(e.linkIcon),React.createElement("input",{className:"ts-filter",type:"url",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.props?.placeholder||"",disabled:r==="editor"}))):t.type==="email"?React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},s("Optional","voxel-fse"))),React.createElement("div",{className:"ts-input-icon flexify"},m(e.emailIcon),React.createElement("input",{className:"ts-filter",type:"email",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.props?.placeholder||"",disabled:r==="editor"}))):t.type==="switcher"?React.createElement("div",{key:t.key,className:"ts-form-group switcher-label"},React.createElement("label",null,React.createElement("div",{className:"switch-slider"},React.createElement("div",{className:"onoffswitch"},React.createElement("input",{id:`_switcher:${t.key}`,type:"checkbox",className:"onoffswitch-checkbox",checked:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.checked}})),disabled:r==="editor"}),React.createElement("label",{className:"onoffswitch-label",htmlFor:`_switcher:${t.key}`}))),t.label,!t.required&&React.createElement("span",{className:"is-required"},s("Optional","voxel-fse")))):["textarea","description","profile-bio"].includes(t.type)?React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},s("Optional","voxel-fse"))),React.createElement("textarea",{className:"ts-filter",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.props?.placeholder||"",disabled:r==="editor"})):t.type==="number"?React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},s("Optional","voxel-fse"))),React.createElement("input",{className:"ts-filter",type:"number",value:n,onChange:c=>T(f=>({...f,fieldValues:{...f.fieldValues,[t.key]:c.target.value}})),placeholder:t.props?.placeholder||"",disabled:r==="editor"})):React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},s("Optional","voxel-fse"))),React.createElement("input",{className:"ts-filter",type:"text",placeholder:`[${t.type} field]`,disabled:!0}))},yt=()=>React.createElement("form",{onSubmit:t=>{t.preventDefault(),Re()}},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},q("confirm_account",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Confirmation code","voxel-fse"),React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,s("Please type the confirmation code which was sent to your email address","voxel-fse"))))),React.createElement("div",{className:"ts-input-icon flexify"},m(e.emailIcon),React.createElement("input",{className:"ts-filter autofocus",type:"text",maxLength:5,value:B,onChange:t=>ae(t.target.value),placeholder:s("Enter code","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},s("Submit","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("p",{className:"field-info"},s("Didn't receive code?","voxel-fse")," ",React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),nt()},className:y?"vx-pending":""},s("Resend email","voxel-fse"))))),wt=()=>React.createElement("form",{onSubmit:pt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},q("recover",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Your email","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.emailIcon),React.createElement("input",{className:"ts-filter autofocus",type:"email",value:A.email,onChange:t=>G(n=>({...n,email:t.target.value})),placeholder:s("Your account email","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},m(e.emailIcon),s("Reset password","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("login")}},m(e.leftChevronIcon),s("Go back","voxel-fse"))))),Nt=()=>React.createElement("form",{onSubmit:ft},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},q("recover_confirm",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Confirmation code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.emailIcon),React.createElement("input",{className:"ts-filter autofocus",type:"text",maxLength:5,value:A.code,onChange:t=>G(n=>({...n,code:t.target.value})),placeholder:s("Enter code","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},s("Submit","voxel-fse"))))),xt=()=>React.createElement("form",{onSubmit:vt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},q("recover_set_password",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group ts-password-field"},React.createElement("label",null,s("New password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter autofocus",type:"password",value:A.password,onChange:t=>G(n=>({...n,password:t.target.value})),placeholder:s("Enter new password","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group ts-password-field"},React.createElement("label",null,s("Confirm password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter",type:"password",value:A.confirm_password,onChange:t=>G(n=>({...n,confirm_password:t.target.value})),placeholder:s("Confirm new password","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},s("Update password","voxel-fse"))))),kt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-welcome-message ts-form-group"},m(e.welcomeIcon),React.createElement("h2",null,q("welcome",e))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:a?.editProfileUrl||"#",className:"ts-btn ts-btn-2 ts-btn-large",onClick:t=>r==="editor"&&t.preventDefault()},m(e.usernameIcon),s("Complete profile","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:a?.redirectUrl||"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>r==="editor"&&t.preventDefault()},s("Do it later","voxel-fse")))),Ct=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("security_update_email")}},m(e.emailIcon),s("Update email address","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("security_update_password")}},m(e.passwordIcon),s("Update password","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),a?.twofa?.enabled?l("security_2fa_manage"):st()}},m(e.shieldIcon),s("Authenticator","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("security_privacy")}},m(e.privacyIcon),s("Privacy","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:a?.logoutUrl||"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>r==="editor"&&t.preventDefault()},m(e.logoutIcon),s("Log out","voxel-fse")))),St=()=>p.successful?React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},s("Password updated successfully!","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),h({current:"",new:"",confirm_new:"",successful:!1}),l("security")}},m(e.leftChevronIcon),s("Go back","voxel-fse")))):React.createElement("form",{onSubmit:ht},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},q("security_update_password",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Current password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter",type:"password",value:p.current,onChange:t=>h(n=>({...n,current:t.target.value})),placeholder:s("Current password","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("New password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter",type:"password",value:p.new,onChange:t=>h(n=>({...n,new:t.target.value})),placeholder:s("New password","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Confirm new password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter",type:"password",value:p.confirm_new,onChange:t=>h(n=>({...n,confirm_new:t.target.value})),placeholder:s("Confirm new password","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},s("Update password","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("security")}},m(e.leftChevronIcon),s("Go back","voxel-fse"))))),At=()=>React.createElement("form",{onSubmit:Et},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},q("security_update_email",e))),React.createElement("div",{className:"login-section"},_.state==="send_code"&&React.createElement(React.Fragment,null,React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("New email address","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.emailIcon),React.createElement("input",{className:"ts-filter",type:"email",value:_.new,onChange:t=>k(n=>({...n,new:t.target.value})),placeholder:s("New email address","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},s("Send verification code","voxel-fse")))),_.state==="verify_code"&&React.createElement(React.Fragment,null,React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Verification code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.emailIcon),React.createElement("input",{className:"ts-filter",type:"text",maxLength:6,value:_.code,onChange:t=>k(n=>({...n,code:t.target.value})),placeholder:s("Enter code","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},s("Verify code","voxel-fse")))),_.state==="success"&&React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},s("Email updated successfully!","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),k({new:"",code:"",state:"send_code"}),l("security")}},m(e.leftChevronIcon),s("Go back","voxel-fse"))))),It=()=>React.createElement("form",{onSubmit:Rt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},s("Setup Authenticator","voxel-fse"))),React.createElement("div",{className:"login-section"},w.qr_code&&React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"twofa-qr-code"},React.createElement("img",{src:w.qr_code,alt:"QR Code"})),React.createElement("p",{className:"field-info"},s("Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Verification code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.shieldIcon),React.createElement("input",{className:"ts-filter",type:"text",maxLength:6,value:w.verify_code,onChange:t=>O(n=>({...n,verify_code:t.target.value})),placeholder:s("Enter 6-digit code","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},s("Enable 2FA","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("security")}},m(e.leftChevronIcon),s("Go back","voxel-fse"))))),Dt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},s("Backup Codes","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},s("Save these backup codes in a safe place. You can use them to access your account if you lose your authenticator.","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"backup-codes-list"},w.backup_codes.map((t,n)=>React.createElement("code",{key:n,className:"backup-code"},t)))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:"ts-btn ts-btn-1 ts-btn-large",onClick:dt},m(e.copyIcon),s("Copy codes","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-2 ts-btn-large",onClick:t=>{t.preventDefault(),l("security")}},s("Done","voxel-fse")))),Tt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},s("Two-Factor Authentication","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},s("Two-factor authentication is enabled on your account.","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:"ts-btn ts-btn-1 ts-btn-large",onClick:lt,disabled:d},m(e.copyIcon),s("Regenerate backup codes","voxel-fse"))),(a?.twofa?.trusted_devices_count??0)>0&&React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:"ts-btn ts-btn-1 ts-btn-large",onClick:ot,disabled:d},m(e.deviceIcon),s("Remove trusted devices","voxel-fse")," (",a?.twofa?.trusted_devices_count,")")),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Enter password to disable 2FA","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter",type:"password",value:w.disable_password,onChange:t=>O(n=>({...n,disable_password:t.target.value})),placeholder:s("Your password","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:"ts-btn ts-btn-1 ts-btn-large",onClick:ct,disabled:r==="editor"||d||!w.disable_password},m(e.trashIcon),s("Disable 2FA","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("security")}},m(e.leftChevronIcon),s("Go back","voxel-fse")))),Pt=()=>React.createElement("form",{onSubmit:gt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},s("Two-Factor Authentication","voxel-fse"))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,L.use_backup?s("Backup code","voxel-fse"):s("Authentication code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.shieldIcon),React.createElement("input",{className:"ts-filter autofocus",type:"text",maxLength:L.use_backup?8:6,value:L.code,onChange:t=>Y(n=>({...n,code:t.target.value})),placeholder:L.use_backup?s("Enter backup code","voxel-fse"):s("Enter 6-digit code","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:L.trust_device,onChange:t=>Y(n=>({...n,trust_device:t.target.checked})),disabled:r==="editor"}),React.createElement("span",{className:"checkmark"})),React.createElement("span",null,s("Trust this device for 30 days","voxel-fse")))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${d?"vx-pending":""}`,disabled:r==="editor"||d},s("Verify","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),Y(n=>({...n,use_backup:!n.use_backup,code:""}))}},L.use_backup?s("Use authentication code instead","voxel-fse"):s("Use backup code instead","voxel-fse"))))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),Y({user_id:null,session_token:null,code:"",use_backup:!1,trust_device:!1}),l("login")}},m(e.leftChevronIcon),s("Go back","voxel-fse"))))),Ft=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},s("Privacy","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:`ts-btn ts-btn-1 ts-btn-large ${U.export_data.pending?"vx-pending":""}`,onClick:it,disabled:r==="editor"||U.export_data.pending},m(e.cloudIcon),s("Export my data","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("security_delete_account")}},m(e.trashIcon),s("Delete my account","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),l("security")}},m(e.leftChevronIcon),s("Go back","voxel-fse")))),jt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},s("Delete Account","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info",style:{color:"var(--vx-danger-color, #dc3545)"}},s("Warning: This action cannot be undone. All your data will be permanently deleted.","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Enter your password to confirm","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.passwordIcon),React.createElement("input",{className:"ts-filter",type:"password",value:U.delete_account.password,onChange:t=>$(n=>({...n,delete_account:{...n.delete_account,password:t.target.value}})),placeholder:s("Your password","voxel-fse"),disabled:r==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:`ts-btn ts-btn-1 ts-btn-large ${U.delete_account.pending?"vx-pending":""}`,onClick:()=>ke(!1),disabled:r==="editor"||U.delete_account.pending||!U.delete_account.password,style:{backgroundColor:"var(--vx-danger-color, #dc3545)"}},m(e.trashIcon),s("Delete my account","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),$(n=>({...n,delete_account:{pending:!1,password:"",code:""}})),l("security_privacy")}},m(e.leftChevronIcon),s("Go back","voxel-fse")))),Lt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},s("Confirm Deletion","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},s("A confirmation code has been sent to your email. Enter it below to confirm account deletion.","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,s("Confirmation code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},m(e.emailIcon),React.createElement("input",{className:"ts-filter",type:"text",value:U.delete_account.code,readOnly:!0,disabled:!0}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:`ts-btn ts-btn-1 ts-btn-large ${U.delete_account.pending?"vx-pending":""}`,onClick:()=>ke(!0),disabled:r==="editor"||U.delete_account.pending,style:{backgroundColor:"var(--vx-danger-color, #dc3545)"}},m(e.trashIcon),s("Confirm deletion","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),$(n=>({...n,delete_account:{pending:!1,password:"",code:""}})),l("security_privacy")}},m(e.leftChevronIcon),s("Cancel","voxel-fse")))),Ut=()=>{switch(u){case"login":return Ce();case"register":return bt();case"confirm_account":return yt();case"recover":return wt();case"recover_confirm":return Nt();case"recover_set_password":return xt();case"welcome":return kt();case"security":return Ct();case"security_update_password":return St();case"security_update_email":return At();case"security_2fa_setup":return It();case"security_2fa_backup_codes":return Dt();case"security_2fa_manage":return Tt();case"login_2fa_verify":return Pt();case"security_privacy":return Ft();case"security_delete_account":return jt();case"security_delete_account_confirm":return Lt();default:return Ce()}};return o?React.createElement("div",{className:"ts-auth"},React.createElement("div",{className:"ts-form ts-login"},React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("span",null,s("Loading...","voxel-fse")))))):React.createElement("div",{className:`ts-auth ${e.customClasses||""}`},React.createElement("div",{className:`ts-form ts-login ${u==="welcome"?"ts-welcome":""}`},Ut()))}function Je(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const a=e.getAttribute("href");if(a)return a.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function Qe(){const e=Je();try{return new URL(e).pathname.replace(/\/$/,"")}catch{return""}}function Xe(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const a=document.querySelector('link[rel="https://api.w.org/"]');if(a){const r=a.getAttribute("href");if(r)return r}}const e=Qe();return typeof window<"u"?window.location.origin+e+"/wp-json/":"/wp-json/"}function et(e){return{googleIcon:e.google,signUpIcon:e.signUp,usernameIcon:e.username,passwordIcon:e.password,eyeIcon:e.eye,emailIcon:e.email,welcomeIcon:e.welcome,leftChevronIcon:e.leftChevron,privacyIcon:e.privacy,trashIcon:e.trash,logoutIcon:e.logout,phoneIcon:e.phone,linkIcon:e.link,calendarIcon:e.calendar,taxonomyIcon:e.taxonomy,uploadIcon:e.upload,copyIcon:e.copy,cloudIcon:e.cloud,deviceIcon:e.device,shieldIcon:e.shield}}function tt(e){return{icons:{google:e.icons?.google??e.icons?.googleIcon??{},signUp:e.icons?.signUp??e.icons?.sign_up??e.icons?.signUpIcon??{},username:e.icons?.username??e.icons?.usernameIcon??{},password:e.icons?.password??e.icons?.passwordIcon??{},eye:e.icons?.eye??e.icons?.eyeIcon??{},email:e.icons?.email??e.icons?.emailIcon??{},welcome:e.icons?.welcome??e.icons?.welcomeIcon??{},leftChevron:e.icons?.leftChevron??e.icons?.left_chevron??e.icons?.leftChevronIcon??{},privacy:e.icons?.privacy??e.icons?.privacyIcon??{},trash:e.icons?.trash??e.icons?.trashIcon??{},logout:e.icons?.logout??e.icons?.logoutIcon??{},phone:e.icons?.phone??e.icons?.phoneIcon??{},link:e.icons?.link??e.icons?.linkIcon??{},calendar:e.icons?.calendar??e.icons?.calendarIcon??{},taxonomy:e.icons?.taxonomy??e.icons?.taxonomyIcon??{},upload:e.icons?.upload??e.icons?.uploadIcon??{},copy:e.icons?.copy??e.icons?.copyIcon??{},cloud:e.icons?.cloud??e.icons?.cloudIcon??{},device:e.icons?.device??e.icons?.deviceIcon??{},shield:e.icons?.shield??e.icons?.shieldIcon??{}},previewScreen:e.previewScreen??e.preview_screen??"login",loginTitle:e.loginTitle??e.login_title??"Log in to your account",registerTitle:e.registerTitle??e.register_title??"Create an account",confirmTitle:e.confirmTitle??e.confirm_title??"Confirm account",passwordRecoveryTitle:e.passwordRecoveryTitle??e.password_recovery_title??"Password recovery",confirmCodeTitle:e.confirmCodeTitle??e.confirm_code_title??"Enter confirmation code",newPasswordTitle:e.newPasswordTitle??e.new_password_title??"Set new password",updatePasswordTitle:e.updatePasswordTitle??e.update_password_title??"Update password",updateEmailTitle:e.updateEmailTitle??e.update_email_title??"Update email",welcomeTitle:e.welcomeTitle??e.welcome_title??"Welcome!",roleSource:e.roleSource??e.role_source??"auto",manualRoles:Array.isArray(e.manualRoles)?e.manualRoles:Array.isArray(e.manual_roles)?e.manual_roles:[]}}function at(e,a){const r=et(e.icons);return{blockId:a,previewScreen:e.previewScreen,loginTitle:e.loginTitle,registerTitle:e.registerTitle,confirmTitle:e.confirmTitle,passwordRecoveryTitle:e.passwordRecoveryTitle,confirmCodeTitle:e.confirmCodeTitle,newPasswordTitle:e.newPasswordTitle,updatePasswordTitle:e.updatePasswordTitle,updateEmailTitle:e.updateEmailTitle,welcomeTitle:e.welcomeTitle,roleSource:e.roleSource,manualRoles:e.manualRoles,...r}}function ve({vxconfig:e,blockId:a}){const[r,o]=v.useState(null),[u,l]=v.useState(!0),[d,i]=v.useState(null),y=at(e,a),b=v.useCallback(async()=>{l(!0),i(null);try{const g=new URLSearchParams({role_source:e.roleSource});e.roleSource==="manual"&&e.manualRoles.length>0&&e.manualRoles.forEach(F=>{g.append("manual_roles[]",F)});const j=Xe(),N=await fetch(`${j}voxel-fse/v1/auth-config?${g.toString()}`);if(!N.ok)throw new Error(`HTTP error! status: ${N.status}`);const D=await N.json();o(D)}catch(g){i(g instanceof Error?g.message:"Failed to load config"),console.error("Login block: Failed to fetch auth config",g)}finally{l(!1)}},[e.roleSource,e.manualRoles]);return v.useEffect(()=>{b()},[b]),d?React.createElement("div",{className:"ts-auth"},React.createElement("div",{className:"ts-form ts-login"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},y.loginTitle)),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info",style:{color:"var(--vx-danger-color, #dc3545)"}},"Error loading login form. Please refresh the page."))))):React.createElement(Ze,{attributes:y,config:r,context:"frontend",isLoading:u})}function te(){document.querySelectorAll(".wp-block-voxel-fse-login").forEach((a,r)=>{const o=a.querySelector("script.vxconfig");if(!o){console.warn("Login block: No vxconfig found",a);return}let u;try{const y=JSON.parse(o.textContent||"{}");u=tt(y)}catch(y){console.error("Login block: Failed to parse vxconfig",y);return}const l=a.id||`login-block-${r}`;a.id||(a.id=l);const d=a.querySelector(".ts-auth");if(!d){console.warn("Login block: No .ts-auth container found",a);return}Se.createRoot(d.parentElement||a).render(React.createElement(ve,{vxconfig:u,blockId:l})),o.remove()})}return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",te):te(),z.FrontendLogin=ve,z.initLoginBlocks=te,Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}),z})({},ReactDOM,React);
