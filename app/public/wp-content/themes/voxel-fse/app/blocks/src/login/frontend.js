var VoxelFSELogin=(function(ne,Me,f){"use strict";var de,Ee,le,Re;de={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},Ee=["(","?"],le={")":["("],":":["?","?:"]},Re=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;function Ge(e){for(var a=[],s=[],c,i,o,m;c=e.match(Re);){for(i=c[0],o=e.substr(0,c.index).trim(),o&&a.push(o);m=s.pop();){if(le[i]){if(le[i][0]===m){i=le[i][1]||i;break}}else if(Ee.indexOf(m)>=0||de[m]<de[i]){s.push(m);break}a.push(m)}le[i]||s.push(i),e=e.substr(c.index+i.length)}return e=e.trim(),e&&a.push(e),a.concat(s.reverse())}var Be={"!":function(e){return!e},"*":function(e,a){return e*a},"/":function(e,a){return e/a},"%":function(e,a){return e%a},"+":function(e,a){return e+a},"-":function(e,a){return e-a},"<":function(e,a){return e<a},"<=":function(e,a){return e<=a},">":function(e,a){return e>a},">=":function(e,a){return e>=a},"==":function(e,a){return e===a},"!=":function(e,a){return e!==a},"&&":function(e,a){return e&&a},"||":function(e,a){return e||a},"?:":function(e,a,s){if(e)throw a;return s}};function ze(e,a){var s=[],c,i,o,m,d,w;for(c=0;c<e.length;c++){if(d=e[c],m=Be[d],m){for(i=m.length,o=Array(i);i--;)o[i]=s.pop();try{w=m.apply(null,o)}catch(N){return N}}else a.hasOwnProperty(d)?w=a[d]:w=+d;s.push(w)}return s[0]}function We(e){var a=Ge(e);return function(s){return ze(a,s)}}function Ye(e){var a=We(e);return function(s){return+a({n:s})}}var ge={contextDelimiter:"",onMissingKey:null};function Ze(e){var a,s,c;for(a=e.split(";"),s=0;s<a.length;s++)if(c=a[s].trim(),c.indexOf("plural=")===0)return c.substr(7)}function me(e,a){var s;this.data=e,this.pluralForms={},this.options={};for(s in ge)this.options[s]=a!==void 0&&s in a?a[s]:ge[s]}me.prototype.getPluralForm=function(e,a){var s=this.pluralForms[e],c,i,o;return s||(c=this.data[e][""],o=c["Plural-Forms"]||c["plural-forms"]||c.plural_forms,typeof o!="function"&&(i=Ze(c["Plural-Forms"]||c["plural-forms"]||c.plural_forms),o=Ye(i)),s=this.pluralForms[e]=o),s(a)},me.prototype.dcnpgettext=function(e,a,s,c,i){var o,m,d;return i===void 0?o=0:o=this.getPluralForm(e,i),m=s,a&&(m=a+this.options.contextDelimiter+s),d=this.data[e][m],d&&d[o]?d[o]:(this.options.onMissingKey&&this.options.onMissingKey(s,e),o===0?s:c)};var ye={"":{plural_forms(e){return e===1?0:1}}},Je=/^i18n\.(n?gettext|has_translation)(_|$)/,Ke=(e,a,s)=>{const c=new me({}),i=new Set,o=()=>{i.forEach(v=>v())},m=v=>(i.add(v),()=>i.delete(v)),d=(v="default")=>c.data[v],w=(v,h="default")=>{c.data[h]={...c.data[h],...v},c.data[h][""]={...ye[""],...c.data[h]?.[""]},delete c.pluralForms[h]},N=(v,h)=>{w(v,h),o()},y=(v,h="default")=>{c.data[h]={...c.data[h],...v,"":{...ye[""],...c.data[h]?.[""],...v?.[""]}},delete c.pluralForms[h],o()},G=(v,h)=>{c.data={},c.pluralForms={},N(v,h)},S=(v="default",h,x,L,k)=>(c.data[v]||w(void 0,v),c.dcnpgettext(v,h,x,L,k)),H=v=>v||"default",U=(v,h)=>{let x=S(h,void 0,v);return s?(x=s.applyFilters("i18n.gettext",x,v,h),s.applyFilters("i18n.gettext_"+H(h),x,v,h)):x},D=(v,h,x)=>{let L=S(x,h,v);return s?(L=s.applyFilters("i18n.gettext_with_context",L,v,h,x),s.applyFilters("i18n.gettext_with_context_"+H(x),L,v,h,x)):L},j=(v,h,x,L)=>{let k=S(L,void 0,v,h,x);return s?(k=s.applyFilters("i18n.ngettext",k,v,h,x,L),s.applyFilters("i18n.ngettext_"+H(L),k,v,h,x,L)):k},ae=(v,h,x,L,k)=>{let Y=S(k,L,v,h,x);return s?(Y=s.applyFilters("i18n.ngettext_with_context",Y,v,h,x,L,k),s.applyFilters("i18n.ngettext_with_context_"+H(k),Y,v,h,x,L,k)):Y},se=()=>D("ltr","text direction")==="rtl",he=(v,h,x)=>{const L=h?h+""+v:v;let k=!!c.data?.[x??"default"]?.[L];return s&&(k=s.applyFilters("i18n.has_translation",k,v,h,x),k=s.applyFilters("i18n.has_translation_"+H(x),k,v,h,x)),k};if(s){const v=h=>{Je.test(h)&&o()};s.addAction("hookAdded","core/i18n",v),s.addAction("hookRemoved","core/i18n",v)}return{getLocaleData:d,setLocaleData:N,addLocaleData:y,resetLocaleData:G,subscribe:m,__:U,_x:D,_n:j,_nx:ae,isRTL:se,hasTranslation:he}};function Qe(e){return typeof e!="string"||e===""?(console.error("The namespace must be a non-empty string."),!1):/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)?!0:(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)}var be=Qe;function Xe(e){return typeof e!="string"||e===""?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)?!0:(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)}var ue=Xe;function et(e,a){return function(c,i,o,m=10){const d=e[a];if(!ue(c)||!be(i))return;if(typeof o!="function"){console.error("The hook callback must be a function.");return}if(typeof m!="number"){console.error("If specified, the hook priority must be a number.");return}const w={callback:o,priority:m,namespace:i};if(d[c]){const N=d[c].handlers;let y;for(y=N.length;y>0&&!(m>=N[y-1].priority);y--);y===N.length?N[y]=w:N.splice(y,0,w),d.__current.forEach(G=>{G.name===c&&G.currentIndex>=y&&G.currentIndex++})}else d[c]={handlers:[w],runs:0};c!=="hookAdded"&&e.doAction("hookAdded",c,i,o,m)}}var _e=et;function tt(e,a,s=!1){return function(i,o){const m=e[a];if(!ue(i)||!s&&!be(o))return;if(!m[i])return 0;let d=0;if(s)d=m[i].handlers.length,m[i]={runs:m[i].runs,handlers:[]};else{const w=m[i].handlers;for(let N=w.length-1;N>=0;N--)w[N].namespace===o&&(w.splice(N,1),d++,m.__current.forEach(y=>{y.name===i&&y.currentIndex>=N&&y.currentIndex--}))}return i!=="hookRemoved"&&e.doAction("hookRemoved",i,o),d}}var ce=tt;function at(e,a){return function(c,i){const o=e[a];return typeof i<"u"?c in o&&o[c].handlers.some(m=>m.namespace===i):c in o}}var Ne=at;function st(e,a,s,c){return function(o,...m){const d=e[a];d[o]||(d[o]={handlers:[],runs:0}),d[o].runs++;const w=d[o].handlers;if(!w||!w.length)return s?m[0]:void 0;const N={name:o,currentIndex:0};async function y(){try{d.__current.add(N);let S=s?m[0]:void 0;for(;N.currentIndex<w.length;)S=await w[N.currentIndex].callback.apply(null,m),s&&(m[0]=S),N.currentIndex++;return s?S:void 0}finally{d.__current.delete(N)}}function G(){try{d.__current.add(N);let S=s?m[0]:void 0;for(;N.currentIndex<w.length;)S=w[N.currentIndex].callback.apply(null,m),s&&(m[0]=S),N.currentIndex++;return s?S:void 0}finally{d.__current.delete(N)}}return(c?y:G)()}}var oe=st;function lt(e,a){return function(){const c=e[a];return Array.from(c.__current).at(-1)?.name??null}}var we=lt;function rt(e,a){return function(c){const i=e[a];return typeof c>"u"?i.__current.size>0:Array.from(i.__current).some(o=>o.name===c)}}var xe=rt;function nt(e,a){return function(c){const i=e[a];if(ue(c))return i[c]&&i[c].runs?i[c].runs:0}}var ke=nt,ct=class{actions;filters;addAction;addFilter;removeAction;removeFilter;hasAction;hasFilter;removeAllActions;removeAllFilters;doAction;doActionAsync;applyFilters;applyFiltersAsync;currentAction;currentFilter;doingAction;doingFilter;didAction;didFilter;constructor(){this.actions=Object.create(null),this.actions.__current=new Set,this.filters=Object.create(null),this.filters.__current=new Set,this.addAction=_e(this,"actions"),this.addFilter=_e(this,"filters"),this.removeAction=ce(this,"actions"),this.removeFilter=ce(this,"filters"),this.hasAction=Ne(this,"actions"),this.hasFilter=Ne(this,"filters"),this.removeAllActions=ce(this,"actions",!0),this.removeAllFilters=ce(this,"filters",!0),this.doAction=oe(this,"actions",!1,!1),this.doActionAsync=oe(this,"actions",!1,!0),this.applyFilters=oe(this,"filters",!0,!1),this.applyFiltersAsync=oe(this,"filters",!0,!0),this.currentAction=we(this,"actions"),this.currentFilter=we(this,"filters"),this.doingAction=xe(this,"actions"),this.doingFilter=xe(this,"filters"),this.didAction=ke(this,"actions"),this.didFilter=ke(this,"filters")}};function ot(){return new ct}var it=ot,Ce=it(),{addAction:aa,addFilter:sa,removeAction:la,removeFilter:ra,hasAction:na,hasFilter:ca,removeAllActions:oa,removeAllFilters:ia,doAction:da,doActionAsync:ma,applyFilters:ua,applyFiltersAsync:pa,currentAction:fa,currentFilter:va,doingAction:ha,doingFilter:Ea,didAction:Ra,didFilter:ga,actions:ya,filters:ba}=Ce,V=Ke(void 0,void 0,Ce);V.getLocaleData.bind(V),V.setLocaleData.bind(V),V.resetLocaleData.bind(V),V.subscribe.bind(V);var r=V.__.bind(V);V._x.bind(V),V._n.bind(V),V._nx.bind(V),V.isRTL.bind(V),V.hasTranslation.bind(V);const Se={user:"las la-user",lock:"las la-lock",eye:"las la-eye",envelope:"las la-envelope",google:"lab la-google",chevronLeft:"las la-chevron-left",info:"las la-info-circle",happy:"las la-smile",phone:"las la-phone",link:"las la-link",calendar:"las la-calendar",upload:"las la-upload",copy:"las la-copy",cloud:"las la-cloud",device:"las la-laptop",shield:"las la-shield-alt",privacy:"las la-database",trash:"las la-trash",logout:"las la-sign-out-alt"};function p(e,a){return e&&e.value?e.library==="svg"?e.value.startsWith("<svg")||e.value.startsWith("<?xml")?React.createElement("span",{className:"ts-icon-svg",dangerouslySetInnerHTML:{__html:e.value}}):React.createElement("img",{src:e.value,alt:"",className:"ts-icon-svg"}):React.createElement("i",{className:e.value}):a&&Se[a]?React.createElement("i",{className:Se[a]}):null}function $(e){const a=window.Voxel_Config;return a?.ajax_url?`${a.ajax_url}&action=${e}`:`${a?.site_url||window.location.origin}/?vx=1&action=${e}`}function g(e,a="error"){const s=window.Voxel;s?.alert?s.alert(e,a):(console.warn(`[${a.toUpperCase()}] ${e}`),a==="error"&&alert(e))}function pe(e,a,s,c){const i=window.Voxel;i?.prompt?i.prompt(e,a,s,c):confirm(e)&&s[0]?.onClick?.()}function dt(e){const a=window.Voxel;a?.copy?a.copy(e):navigator.clipboard.writeText(e).catch(console.error)}function _(e,a){return window.Voxel_Config?.l10n?.[e]??a}function J(e,a,s,c){if(!s||!a){c(null);return}const i=window.grecaptcha;i?i.ready(()=>{i.execute(a,{action:e}).then(c).catch(()=>c(null))}):c(null)}const mt={"text:equals":(e,a)=>a===e.value,"text:not_equals":(e,a)=>a!==e.value,"text:empty":(e,a)=>!String(a||"").trim().length,"text:not_empty":(e,a)=>!!String(a||"").trim().length,"text:contains":(e,a)=>!!String(a||"").match(new RegExp(String(e.value),"i")),"taxonomy:contains":(e,a)=>Array.isArray(a)&&a.includes(e.value),"taxonomy:not_contains":(e,a)=>!(Array.isArray(a)&&a.includes(e.value)),"taxonomy:empty":(e,a)=>!Array.isArray(a)||!a.length,"taxonomy:not_empty":(e,a)=>Array.isArray(a)&&a.length>0,"switcher:checked":(e,a)=>!!a,"switcher:unchecked":(e,a)=>!a,"number:empty":(e,a)=>isNaN(parseFloat(String(a))),"number:equals":(e,a)=>parseFloat(String(a))===parseFloat(String(e.value)),"number:gt":(e,a)=>parseFloat(String(a))>parseFloat(String(e.value)),"number:gte":(e,a)=>parseFloat(String(a))>=parseFloat(String(e.value)),"number:lt":(e,a)=>parseFloat(String(a))<parseFloat(String(e.value)),"number:lte":(e,a)=>parseFloat(String(a))<=parseFloat(String(e.value)),"number:not_empty":(e,a)=>!isNaN(parseFloat(String(a))),"number:not_equals":(e,a)=>parseFloat(String(a))!==parseFloat(String(e.value)),"file:empty":(e,a)=>!Array.isArray(a)||!a.length,"file:not_empty":(e,a)=>Array.isArray(a)&&a.length>0,"date:empty":(e,a)=>{const s=a;return s?.date?!isFinite(new Date(s.date+" "+(s.time||"00:00:00")).getTime()):!0},"date:not_empty":(e,a)=>{const s=a;return s?.date?isFinite(new Date(s.date+" "+(s.time||"00:00:00")).getTime()):!1},"date:gt":(e,a)=>{const s=a;if(!s?.date)return!1;const c=new Date(s.date+" "+(s.time||"00:00:00")),i=new Date(String(e.value));return isFinite(c.getTime())&&isFinite(i.getTime())&&c>i},"date:lt":(e,a)=>{const s=a;if(!s?.date)return!1;const c=new Date(s.date+" "+(s.time||"00:00:00")),i=new Date(String(e.value));return isFinite(c.getTime())&&isFinite(i.getTime())&&c<i}};function ut(e,a,s){const c=e.source.split("."),i=c[0],o=c[1]||null,m=s[i];if(!m)return!1;let d=a[i]??m.value;o!==null&&d&&typeof d=="object"&&(d=d[o]);const w=mt[e.type];return w?fe(m,a,s)&&w(e,d):!1}function fe(e,a,s){if(!e.conditions||e.conditions.length===0)return!0;let c=!1;for(const i of e.conditions)if(i.length>0){let o=!0;for(const m of i)if(!ut(m,a,s)){o=!1;break}if(o){c=!0;break}}return e.conditions_behavior==="hide"?!c:c}function pt(e){return e.toLocaleDateString()}function ft(e=8){const a="abcdefghijklmnopqrstuvwxyz0123456789";let s="";for(let c=0;c<e;c++)s+=a.charAt(Math.floor(Math.random()*a.length));return s}function Q(e,a){switch(e){case"login":return a.loginTitle;case"register":return a.registerTitle;case"confirm_account":return a.confirmTitle;case"recover":return a.passwordRecoveryTitle;case"recover_confirm":return a.confirmCodeTitle;case"recover_set_password":return a.newPasswordTitle;case"security_update_password":return a.updatePasswordTitle;case"security_update_email":return a.updateEmailTitle;case"welcome":return a.welcomeTitle;default:return""}}function vt({attributes:e,config:a,context:s,isLoading:c=!1}){const[i,o]=f.useState(s==="editor"?e.previewScreen:a?.screen||"login"),[m,d]=f.useState(!1),[w,N]=f.useState(!1),[y,G]=f.useState(null),[S,H]=f.useState({username:"",password:"",showPassword:!1,remember:!0}),[U,D]=f.useState({showPassword:!1,terms_agreed:!1,fieldValues:{}}),[j,ae]=f.useState({email:"",code:"",password:"",confirm_password:""}),[se,he]=f.useState(""),[v,h]=f.useState({current:"",new:"",confirm_new:"",successful:!1}),[x,L]=f.useState({new:"",code:"",state:"send_code"}),[k,Y]=f.useState({qr_code:null,verify_code:"",disable_password:"",backup_codes:[]}),[B,re]=f.useState({user_id:null,session_token:null,code:"",use_backup:!1,trust_device:!1}),[z,K]=f.useState({export_data:{pending:!1},delete_account:{pending:!1,password:"",code:""}}),Ae=f.useRef(null);f.useEffect(()=>{s==="editor"&&o(e.previewScreen)},[s,e.previewScreen]),f.useEffect(()=>{if(a?.registration?.roles){const t=Object.values(a.registration.roles),l=a.registration.default_role;l&&a.registration.roles[l]?G(a.registration.roles[l]):t.length>0&&!y&&G(t[0])}},[a,y]),f.useEffect(()=>{se.length===5&&!m&&i==="confirm_account"&&Te()},[se,m,i]);const yt=f.useCallback(()=>a?.registration?.roles&&Object.keys(a.registration.roles).length>0,[a]),M=f.useCallback(()=>a?.redirectUrl||window.location.href,[a]),Ie=f.useCallback(()=>{s!=="editor"&&J("vx_login",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{d(!0);const l=new FormData;l.append("username",S.username),l.append("password",S.password),l.append("remember",S.remember?"yes":""),l.append("redirect_to",M()),l.append("_wpnonce",a?.nonce||""),t&&l.append("_recaptcha",t),fetch($("auth.login"),{method:"POST",body:l}).then(n=>n.json()).then(n=>{if(d(!1),n.success)if(n.requires_2fa)re({user_id:n.user_id??null,session_token:n.session_token??null,code:"",use_backup:!1,trust_device:!1}),o("login_2fa_verify");else if(n.confirmed){const u=n.redirect_to||M();u==="{REDIRECT_URL}"?window.location.replace(M()):window.location.replace(u.replace("{REDIRECT_URL}",encodeURIComponent(M())))}else o("login_confirm_account");else g(n.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})})},[s,a,S,M]),ie=f.useCallback(t=>{s==="editor"||!y||J("vx_register",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,l=>{d(!0);const n=new FormData,u={},E=Object.fromEntries((y.fields||[]).map(R=>[R.key,R]));Object.values(y.fields||{}).forEach(R=>{const T=U.fieldValues[R.key]??R.value;if(R._is_auth_field)R.key==="voxel:auth-username"?n.append("username",T||""):R.key==="voxel:auth-email"?n.append("email",T||""):R.key==="voxel:auth-password"&&n.append("password",T||"");else if(fe(R,U.fieldValues,E)&&T!==null&&T!==void 0)if(["file","image","profile-avatar"].includes(R.type)){const Z=T;u[R.key]=[],Z?.forEach(W=>{W.source==="new_upload"&&W.item&&(n.append(`files[${R.id}][]`,W.item),u[R.key].push("uploaded_file"))})}else u[R.key]=T}),n.append("postdata",JSON.stringify(u)),n.append("terms_agreed",U.terms_agreed?"yes":""),n.append("_wpnonce",a?.nonce||""),l&&n.append("_recaptcha",l),n.append("role",y.key),n.append("redirect_to",M());const F=new URLSearchParams(window.location.search).get("plan");F&&n.append("plan",F),t&&n.append("_confirmation_code",t),fetch($("auth.register"),{method:"POST",body:n}).then(R=>R.json()).then(R=>{if(d(!1),R.success)if(R.verification_required)o("confirm_account");else{const T=R.redirect_to||M();T==="{REDIRECT_URL}"?window.location.replace(M()):window.location.replace(T.replace("{REDIRECT_URL}",encodeURIComponent(M())))}else g(R.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})})},[s,a,y,U,M]),Te=f.useCallback(()=>{ie(se)},[ie,se]),bt=f.useCallback(()=>{s==="editor"||!y||J("vx_resend_confirmation_code",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{N(!0);const l=new FormData,n=U.fieldValues["voxel:auth-username"]||"",u=U.fieldValues["voxel:auth-email"]||"";l.append("username",n),l.append("email",u),l.append("_wpnonce",a?.nonce||""),t&&l.append("_recaptcha",t),fetch($("auth.register.resend_confirmation_code"),{method:"POST",body:l}).then(E=>E.json()).then(E=>{N(!1),E.success?g(E.message||r("Confirmation code sent","voxel-fse"),"info"):g(E.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{N(!1),g(_("ajaxError","An error occurred"),"error")})})},[s,a,y,U.fieldValues]),Fe=f.useCallback(()=>{s!=="editor"&&J("vx_recover",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{d(!0);const l=new FormData;l.append("email",j.email),l.append("_wpnonce",a?.nonce||""),t&&l.append("_recaptcha",t),fetch($("auth.recover"),{method:"POST",body:l}).then(n=>n.json()).then(n=>{d(!1),n.success?o("recover_confirm"):g(n.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})})},[s,a,j.email]),Pe=f.useCallback(()=>{s!=="editor"&&J("vx_recover_confirm",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{d(!0);const l=new FormData;l.append("email",j.email),l.append("code",j.code),l.append("_wpnonce",a?.nonce||""),t&&l.append("_recaptcha",t),fetch($("auth.recover_confirm"),{method:"POST",body:l}).then(n=>n.json()).then(n=>{d(!1),n.success?o("recover_set_password"):g(n.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})})},[s,a,j.email,j.code]),Le=f.useCallback(()=>{s!=="editor"&&J("vx_recover_set_password",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{d(!0);const l=new FormData;l.append("email",j.email),l.append("code",j.code),l.append("password",j.password),l.append("confirm_password",j.confirm_password),l.append("_wpnonce",a?.nonce||""),t&&l.append("_recaptcha",t),fetch($("auth.recover_set_password"),{method:"POST",body:l}).then(n=>n.json()).then(n=>{d(!1),n.success?(H(u=>({...u,username:j.email})),ae({email:"",code:"",password:"",confirm_password:""}),o("login"),Ae.current?.focus()):g(n.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})})},[s,a,j]),Ve=f.useCallback(()=>{s!=="editor"&&J("vx_update_password",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{d(!0);const l=new FormData;l.append("current",v.current),l.append("new",v.new),l.append("confirm_new",v.confirm_new),l.append("_wpnonce",a?.nonce||""),t&&l.append("_recaptcha",t),fetch($("auth.update_password"),{method:"POST",body:l}).then(n=>n.json()).then(n=>{d(!1),n.success?h(u=>({...u,successful:!0})):g(n.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})})},[s,a,v]),je=f.useCallback(()=>{s!=="editor"&&J("vx_update_email",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{d(!0);const l=new FormData;l.append("new",x.new),l.append("code",x.code),l.append("state",x.state),l.append("_wpnonce",a?.nonce||""),t&&l.append("_recaptcha",t),fetch($("auth.update_email"),{method:"POST",body:l}).then(n=>n.json()).then(n=>{d(!1),n.success?L(u=>({...u,state:n.state||"success"})):g(n.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})})},[s,a,x]),_t=f.useCallback(()=>{if(s==="editor")return;d(!0);const t=new FormData;t.append("_wpnonce",a?.nonce||""),fetch($("auth.2fa_setup"),{method:"POST",body:t}).then(l=>l.json()).then(l=>{d(!1),l.success?(Y(n=>({...n,qr_code:l.qr_code||null,verify_code:""})),o("security_2fa_setup")):g(l.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})},[s,a]),Oe=f.useCallback(()=>{if(s==="editor")return;d(!0);const t=new FormData;t.append("code",k.verify_code),t.append("_wpnonce",a?.nonce||""),fetch($("auth.2fa_enable"),{method:"POST",body:t}).then(l=>l.json()).then(l=>{d(!1),l.success?(Y(n=>({...n,backup_codes:l.backup_codes||[]})),o("security_2fa_backup_codes"),g(a?.l10n?.twofa_enabled||r("Two-factor authentication enabled","voxel-fse"),"success")):g(l.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})},[s,a,k.verify_code]),Nt=f.useCallback(()=>{s!=="editor"&&pe(a?.l10n?.twofa_disable_confirm||r("Are you sure you want to disable two-factor authentication?","voxel-fse"),"warning",[{label:_("yes","Yes"),onClick:()=>{d(!0);const t=new FormData;t.append("password",k.disable_password),t.append("_wpnonce",a?.nonce||""),fetch($("auth.2fa_disable"),{method:"POST",body:t}).then(l=>l.json()).then(l=>{d(!1),l.success?(Y(n=>({...n,disable_password:""})),o("security"),g(a?.l10n?.twofa_disabled||r("Two-factor authentication disabled","voxel-fse"),"success")):g(l.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})}},{label:_("no","No"),onClick:()=>{}}],7500)},[s,a,k.disable_password]),wt=f.useCallback(()=>{s!=="editor"&&pe(a?.l10n?.twofa_regenerate_backups_confirm||r("Generate new backup codes? Old codes will stop working.","voxel-fse"),"warning",[{label:_("yes","Yes"),onClick:()=>{d(!0);const t=new FormData;t.append("_wpnonce",a?.nonce||""),fetch($("auth.2fa_regenerate_backups"),{method:"POST",body:t}).then(l=>l.json()).then(l=>{d(!1),l.success?(Y(n=>({...n,backup_codes:l.backup_codes||[]})),o("security_2fa_backup_codes"),g(a?.l10n?.twofa_backups_generated||r("Backup codes generated","voxel-fse"),"success")):g(l.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})}},{label:_("no","No"),onClick:()=>{}}],7500)},[s,a]),xt=f.useCallback(()=>{s!=="editor"&&pe(a?.l10n?.twofa_remove_trusted_devices_confirm||r("Remove all trusted devices?","voxel-fse"),"warning",[{label:_("yes","Yes"),onClick:()=>{d(!0);const t=new FormData;t.append("_wpnonce",a?.nonce||""),fetch($("auth.2fa_remove_trusted_devices"),{method:"POST",body:t}).then(l=>l.json()).then(l=>{d(!1),l.success?g(a?.l10n?.twofa_trusted_devices_removed||r("Trusted devices removed","voxel-fse"),"success"):g(l.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})}},{label:_("no","No"),onClick:()=>{}}],7500)},[s,a]),qe=f.useCallback(()=>{if(s==="editor")return;d(!0);const t=new FormData;t.append("user_id",String(B.user_id||"")),t.append("session_token",B.session_token||""),t.append("code",B.code),t.append("use_backup",B.use_backup?"yes":"no"),t.append("trust_device",B.trust_device?"yes":"no"),t.append("remember",S.remember?"yes":"no"),t.append("redirect_to",M()),t.append("_wpnonce",a?.nonce||""),fetch($("auth.verify_2fa"),{method:"POST",body:t}).then(l=>l.json()).then(l=>{if(d(!1),l.success){const n=l.redirect_to||M();n==="{REDIRECT_URL}"?window.location.replace(M()):window.location.replace(n.replace("{REDIRECT_URL}",encodeURIComponent(M())))}else g(l.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{d(!1),g(_("ajaxError","An error occurred"),"error")})},[s,a,B,S.remember,M]),kt=f.useCallback(()=>{s!=="editor"&&J("vx_request_personal_data",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,t=>{K(n=>({...n,export_data:{pending:!0}}));const l=new FormData;l.append("_wpnonce",a?.nonce||""),t&&l.append("_recaptcha",t),fetch($("auth.request_personal_data"),{method:"POST",body:l}).then(n=>n.json()).then(n=>{K(u=>({...u,export_data:{pending:!1}})),n.success?g(n.message||r("Request submitted","voxel-fse"),"success"):g(n.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{K(n=>({...n,export_data:{pending:!1}})),g(_("ajaxError","An error occurred"),"error")})})},[s,a]),Ue=f.useCallback((t=!1)=>{if(s==="editor")return;J(t?"vx_delete_account_permanently":"vx_delete_account",a?.recaptcha?.key,a?.recaptcha?.enabled??!1,n=>{K(E=>({...E,delete_account:{...E.delete_account,pending:!0}}));const u=new FormData;u.append("password",z.delete_account.password),u.append("_wpnonce",a?.nonce||""),n&&u.append("_recaptcha",n),u.append("confirmation_code",z.delete_account.code),u.append("confirmed",t?"yes":""),fetch($("auth.delete_account_permanently"),{method:"POST",body:u}).then(E=>E.json()).then(E=>{K(F=>({...F,delete_account:{...F.delete_account,pending:!1}})),E.success?t?window.location.reload():(K(F=>({...F,delete_account:{...F.delete_account,code:E.confirmation_code||""}})),o("security_delete_account_confirm")):g(E.message||_("ajaxError","An error occurred"),"error")}).catch(()=>{K(E=>({...E,delete_account:{...E.delete_account,pending:!1}})),g(_("ajaxError","An error occurred"),"error")})})},[s,a,z.delete_account]),Ct=f.useCallback(()=>{const t=k.backup_codes.join(`
`);dt(t),g(r("Backup codes copied to clipboard","voxel-fse"),"success")},[k.backup_codes]),St=f.useCallback(t=>{t.preventDefault(),Ie()},[Ie]),Dt=f.useCallback(t=>{t.preventDefault(),ie()},[ie]),At=f.useCallback(t=>{t.preventDefault(),Fe()},[Fe]),It=f.useCallback(t=>{t.preventDefault(),Pe()},[Pe]),Tt=f.useCallback(t=>{t.preventDefault(),Le()},[Le]),Ft=f.useCallback(t=>{t.preventDefault(),Ve()},[Ve]),Pt=f.useCallback(t=>{t.preventDefault(),je()},[je]),Lt=f.useCallback(t=>{t.preventDefault(),Oe()},[Oe]),Vt=f.useCallback(t=>{t.preventDefault(),qe()},[qe]),$e=()=>React.createElement("form",{onSubmit:St},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},Q("login",e))),a?.google?.enabled&&React.createElement("div",{className:"login-section"},React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},r("Social connect","voxel-fse")),React.createElement("div",{className:"or-line"})),React.createElement("div",{className:"ts-form-group ts-social-connect"},React.createElement("a",{href:s==="frontend"?a.google.loginUrl:"#",className:"ts-btn ts-google-btn ts-btn-large ts-btn-1",onClick:t=>s==="editor"&&t.preventDefault()},p(e.googleIcon,"google"),r("Sign in with Google","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},r("Enter details","voxel-fse")),React.createElement("div",{className:"or-line"})),React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"ts-input-icon flexify"},p(e.usernameIcon,"user"),React.createElement("input",{className:"ts-filter autofocus",type:"text",value:S.username,onChange:t=>H(l=>({...l,username:t.target.value})),placeholder:r("Username","voxel-fse"),name:"login_username",disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group ts-password-field"},React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter autofocus",type:S.showPassword?"text":"password",value:S.password,onChange:t=>H(l=>({...l,password:t.target.value})),ref:Ae,placeholder:r("Password","voxel-fse"),name:"login_password",disabled:s==="editor"}),React.createElement("div",{className:`view-password ${S.showPassword?"active":""}`,onClick:()=>H(t=>({...t,showPassword:!t.showPassword}))},p(e.eyeIcon,"eye")))),React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:S.remember,onChange:t=>H(l=>({...l,remember:t.target.checked})),disabled:s==="editor"}),React.createElement("span",{className:"checkmark"})),React.createElement("span",null,r("Remember me","voxel-fse")))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},p(e.usernameIcon,"user"),r("Log in","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},r("Forgot password?","voxel-fse")," ",React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),o("recover")}},r("Recover account","voxel-fse"))))),yt()&&React.createElement("div",{className:"login-section"},React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},r("Don't have an account?","voxel-fse")),React.createElement("div",{className:"or-line"})),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{className:"ts-btn ts-btn-1 ts-btn-large",href:"#",onClick:t=>{t.preventDefault(),o("register")}},p(e.signUpIcon,"user"),r("Sign up","voxel-fse"))))),jt=()=>{const t=a?.registration?.roles?Object.values(a.registration.roles):[];return React.createElement("form",{onSubmit:Dt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},Q("register",e))),t.length>=2&&React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Join the platform as:","voxel-fse")),React.createElement("div",{className:"role-selection-hold"},React.createElement("div",{className:"role-selection"},t.map(l=>React.createElement("a",{key:l.key,href:"#",className:y?.key===l.key?"selected-role":"",onClick:n=>{n.preventDefault(),G(l)}},l.label)))))),y&&React.createElement(React.Fragment,null,a?.google?.enabled&&y.allow_social_login&&React.createElement("div",{className:"login-section"},React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},r("Social connect","voxel-fse")),React.createElement("div",{className:"or-line"})),React.createElement("div",{className:"ts-form-group ts-social-connect"},React.createElement("a",{href:s==="frontend"&&y.social_login?.google_register||"#",className:"ts-btn ts-google-btn ts-btn-large ts-btn-1",onClick:l=>s==="editor"&&l.preventDefault()},p(e.googleIcon,"google"),r("Sign in with Google","voxel-fse")))),React.createElement("div",{className:"login-section"},a?.google?.enabled&&React.createElement("div",{className:"or-group"},React.createElement("span",{className:"or-text"},r("Or enter your details","voxel-fse")),React.createElement("div",{className:"or-line"})),y.fields?.map(l=>{const n=Object.fromEntries((y.fields||[]).map(u=>[u.key,u]));return fe(l,U.fieldValues,n)?Ot(l):null})),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group tos-group"},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:U.terms_agreed,onChange:l=>D(n=>({...n,terms_agreed:l.target.checked})),tabIndex:0,disabled:s==="editor"}),React.createElement("span",{className:"checkmark"}))),React.createElement("p",{className:"field-info"},r("I agree to the","voxel-fse")," ",React.createElement("a",{href:a?.urls?.terms||"#",target:"_blank",rel:"noopener noreferrer"},r("Terms and Conditions","voxel-fse"))," ",r("and","voxel-fse")," ",React.createElement("a",{href:a?.urls?.privacy||"#",target:"_blank",rel:"noopener noreferrer"},r("Privacy Policy","voxel-fse"))))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},p(e.usernameIcon,"user"),r("Sign up","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},r("Have an account already?","voxel-fse")," ",React.createElement("a",{href:"#",onClick:l=>{l.preventDefault(),o("login")}},r("Log in instead","voxel-fse")))))))},Ot=t=>{const l=U.fieldValues[t.key]??t.value??"";if(t._is_auth_field){if(t.key==="voxel:auth-username")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:"ts-input-icon flexify"},p(e.usernameIcon,"user"),React.createElement("input",{className:"ts-filter",type:"text",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.placeholder||"",disabled:s==="editor"})));if(t.key==="voxel:auth-email")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:"ts-input-icon flexify"},p(e.emailIcon,"envelope"),React.createElement("input",{className:"ts-filter",type:"email",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.placeholder||"",autoComplete:"email",disabled:s==="editor"})));if(t.key==="voxel:auth-password")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter",type:U.showPassword?"text":"password",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.placeholder||"",autoComplete:"new-password",disabled:s==="editor"}),React.createElement("div",{className:`view-password ${U.showPassword?"active":""}`,onClick:()=>D(n=>({...n,showPassword:!n.showPassword}))},p(e.eyeIcon,"eye"))))}if(["text","title","profile-name","profile-first-name","profile-last-name"].includes(t.type))return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse")),t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("input",{className:"ts-filter",type:"text",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.props?.placeholder||"",disabled:s==="editor"}));if(t.type==="phone")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))),React.createElement("div",{className:"ts-input-icon flexify"},p(e.phoneIcon,"phone"),React.createElement("input",{className:"ts-filter",type:"tel",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.props?.placeholder||"",disabled:s==="editor"})));if(t.type==="url")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))),React.createElement("div",{className:"ts-input-icon flexify"},p(e.linkIcon,"link"),React.createElement("input",{className:"ts-filter",type:"url",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.props?.placeholder||"",disabled:s==="editor"})));if(t.type==="email")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))),React.createElement("div",{className:"ts-input-icon flexify"},p(e.emailIcon,"envelope"),React.createElement("input",{className:"ts-filter",type:"email",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.props?.placeholder||"",disabled:s==="editor"})));if(t.type==="switcher")return React.createElement("div",{key:t.key,className:"ts-form-group switcher-label"},React.createElement("label",null,React.createElement("div",{className:"switch-slider"},React.createElement("div",{className:"onoffswitch"},React.createElement("input",{id:`_switcher:${t.key}`,type:"checkbox",className:"onoffswitch-checkbox",checked:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.checked}})),disabled:s==="editor"}),React.createElement("label",{className:"onoffswitch-label",htmlFor:`_switcher:${t.key}`}))),t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))));if(["textarea","description","profile-bio"].includes(t.type))return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))),React.createElement("textarea",{className:"ts-filter",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.props?.placeholder||"",disabled:s==="editor"}));if(t.type==="number")return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))),React.createElement("input",{className:"ts-filter",type:"number",value:l,onChange:n=>D(u=>({...u,fieldValues:{...u.fieldValues,[t.key]:n.target.value}})),placeholder:t.props?.placeholder||"",disabled:s==="editor"}));if(t.type==="date"){const n=l||{date:null,time:null},u=n.date?pt(new Date(n.date+"T00:00:00")):"",E=t.props?.enable_timepicker;return React.createElement("div",{key:t.key,className:"ts-form-group ts-date-field"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse")),t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:"ts-filter ts-popup-target",tabIndex:0},React.createElement("div",{className:"ts-filter-text"},React.createElement("div",{className:"ts-input-icon flexify"},p(e.calendarIcon,"calendar"),React.createElement("input",{className:"ts-filter",type:"date",value:n.date||"",onChange:F=>{const R=F.target.value;D(T=>({...T,fieldValues:{...T.fieldValues,[t.key]:{...n,date:R||null}}}))},disabled:s==="editor"})),u&&React.createElement("span",{className:"ts-clear-value",onClick:()=>D(F=>({...F,fieldValues:{...F.fieldValues,[t.key]:{date:null,time:null}}}))},React.createElement("i",{className:"las la-times"})))),E&&React.createElement("div",{className:"ts-input-icon flexify",style:{marginTop:"8px"}},React.createElement("input",{className:"ts-filter",type:"time",value:n.time||"",onChange:F=>{D(R=>({...R,fieldValues:{...R.fieldValues,[t.key]:{...n,time:F.target.value||null}}}))},disabled:s==="editor"})))}if(t.type==="taxonomy"){const n=t.props?.terms||[],u=t.props?.selected||{},E=l||Object.keys(u),F=t.props?.multiple,R=t.props?.display_as,[T,Z]=f.useState(""),[W,X]=f.useState(!1),C=()=>{if(!E.length)return"";const b=[],I=(q,ee)=>{for(const te of q){if(te.slug===ee)return te.label;if(te.children){const He=I(te.children,ee);if(He)return He}}return null};return E.forEach(q=>{const ee=I(n,q);ee&&b.push(ee)}),b.join(", ")},O=f.useMemo(()=>{if(!T.trim())return null;const b=[],I=T.toLowerCase(),q=ee=>{for(const te of ee){if(te.label.toLowerCase().includes(I)&&(b.push(te),b.length>=100))return;te.children&&q(te.children)}};return q(n),b},[n,T]),P=b=>{let I=[...E];I.includes(b.slug)?I=I.filter(q=>q!==b.slug):F?I.push(b.slug):I=[b.slug],D(q=>({...q,fieldValues:{...q.fieldValues,[t.key]:I.length?I:null}})),!F&&R!=="inline"&&X(!1)},A=(b,I=0)=>React.createElement("ul",{className:`ts-term-list ${I>0?"ts-term-children":""}`},b.map(q=>React.createElement("li",{key:q.slug,className:E.includes(q.slug)?"ts-selected":""},React.createElement("a",{href:"#",onClick:ee=>{ee.preventDefault(),P(q)},style:{paddingLeft:`${I*16+12}px`}},p(e.taxonomyIcon,"info"),React.createElement("span",null,q.label),E.includes(q.slug)&&React.createElement("span",{className:"ts-term-checkmark"},React.createElement("i",{className:"las la-check"}))),q.children&&q.children.length>0&&A(q.children,I+1))));return R==="inline"?React.createElement("div",{key:t.key,className:"ts-form-group ts-taxonomy-field ts-inline-filter"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))),React.createElement("div",{className:"ts-term-dropdown"},A(n))):React.createElement("div",{key:t.key,className:"ts-form-group ts-taxonomy-field"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse")),t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:`ts-filter ts-popup-target ${W?"ts-active":""} ${C()?"ts-filled":""}`,onClick:()=>s!=="editor"&&X(!W),tabIndex:0},React.createElement("div",{className:"ts-filter-text"},p(e.taxonomyIcon,"info"),React.createElement("span",{className:C()?"":"ts-placeholder"},C()||t.placeholder||r("Select...","voxel-fse")),React.createElement("div",{className:"ts-down-icon"},React.createElement("i",{className:"las la-angle-down"})))),W&&s!=="editor"&&React.createElement("div",{className:"ts-field-popup ts-popup-show"},React.createElement("div",{className:"ts-popup-content-wrapper min-scroll"},React.createElement("div",{className:"ts-popup-head flexify"},React.createElement("div",{className:"ts-popup-search"},React.createElement("i",{className:"las la-search"}),React.createElement("input",{type:"text",placeholder:r("Search...","voxel-fse"),value:T,onChange:b=>Z(b.target.value),autoFocus:!0}))),React.createElement("div",{className:"ts-term-dropdown min-scroll"},A(O||n)),React.createElement("div",{className:"ts-popup-controller"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1",onClick:b=>{b.preventDefault(),Z(""),D(I=>({...I,fieldValues:{...I.fieldValues,[t.key]:null}}))}},r("Clear","voxel-fse")),React.createElement("a",{href:"#",className:"ts-btn ts-btn-2",onClick:b=>{b.preventDefault(),X(!1)}},r("Done","voxel-fse"))))))}if(["file","image","profile-avatar"].includes(t.type)){const n=l||[],u=t.props?.maxCount||1,F=(t.props?.allowedTypes||[]).join(", "),[R,T]=f.useState(!1),Z=C=>{const O={source:"new_upload",name:C.name,type:C.type,size:C.size,preview:URL.createObjectURL(C),item:C,_id:ft(8)};let P=[...n];u===1?P=[O]:P.push(O),D(A=>({...A,fieldValues:{...A.fieldValues,[t.key]:P}}))},W=C=>{const O=n.filter((P,A)=>A!==C);D(P=>({...P,fieldValues:{...P.fieldValues,[t.key]:O.length?O:null}}))},X=C=>{if(C.preventDefault(),T(!1),s==="editor")return;const O=C.dataTransfer.files;for(let P=0;P<O.length;P++)Z(O[P])};return React.createElement("div",{key:t.key,className:"ts-form-group ts-file-field"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse")),t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),n.length>0&&React.createElement("div",{className:"ts-file-list"},n.map((C,O)=>React.createElement("div",{key:C._id||C.id||O,className:"ts-file-entry",style:C.type?.startsWith("image/")&&C.preview?{backgroundImage:`url('${C.preview}')`}:void 0},React.createElement("span",{className:"ts-file-name"},C.name),React.createElement("a",{href:"#",className:"ts-remove-file",onClick:P=>{P.preventDefault(),W(O)}},React.createElement("i",{className:"las la-times"}))))),(n.length<u||u===1)&&React.createElement("div",{className:`ts-file-upload ${R?"ts-drag-active":""}`,onDragEnter:()=>T(!0),onDragLeave:()=>T(!1),onDragOver:C=>C.preventDefault(),onDrop:X},React.createElement("div",{className:"ts-upload-area"},p(e.uploadIcon,"upload"),React.createElement("span",null,r("Drag files here or","voxel-fse")),React.createElement("label",{className:"ts-upload-btn ts-btn ts-btn-1"},React.createElement("input",{type:"file",accept:F,multiple:u>1,onChange:C=>{if(s==="editor")return;const O=C.target.files;if(O)for(let P=0;P<O.length;P++)Z(O[P]);C.target.value=""},disabled:s==="editor",style:{display:"none"}}),r("Browse","voxel-fse")))))}if(t.type==="select"){const n=t.props?.choices||[],u=l;return n.find(E=>E.value===u),React.createElement("div",{key:t.key,className:"ts-form-group ts-select-field"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse")),t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("select",{className:"ts-filter",value:u||"",onChange:E=>{const F=E.target.value||null;D(R=>({...R,fieldValues:{...R.fieldValues,[t.key]:F}}))},disabled:s==="editor"},React.createElement("option",{value:""},t.placeholder||r("Select...","voxel-fse")),n.map(E=>React.createElement("option",{key:E.value,value:E.value},E.label))))}if(t.type==="multiselect"){const n=t.props?.choices||[],u=t.props?.selected||{},E=l||Object.keys(u),F=t.props?.display_as,[R,T]=f.useState(""),[Z,W]=f.useState(!1),X=()=>E.length?E.map(A=>n.find(b=>b.value===A)?.label||A).join(", "):"",C=f.useMemo(()=>{if(!R.trim())return null;const A=R.toLowerCase();return n.filter(b=>b.label.toLowerCase().includes(A)).slice(0,100)},[n,R]),O=A=>{let b=[...E];b.includes(A.value)?b=b.filter(I=>I!==A.value):b.push(A.value),D(I=>({...I,fieldValues:{...I.fieldValues,[t.key]:b.length?b:null}}))},P=A=>React.createElement("ul",{className:"ts-term-list"},A.map(b=>React.createElement("li",{key:b.value,className:E.includes(b.value)?"ts-selected":""},React.createElement("a",{href:"#",onClick:I=>{I.preventDefault(),O(b)}},React.createElement("span",null,b.label),E.includes(b.value)&&React.createElement("span",{className:"ts-term-checkmark"},React.createElement("i",{className:"las la-check"}))))));return F==="inline"?React.createElement("div",{key:t.key,className:"ts-form-group ts-multiselect-field ts-inline-filter"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))),React.createElement("div",{className:"ts-term-dropdown"},P(n))):React.createElement("div",{key:t.key,className:"ts-form-group ts-multiselect-field"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse")),t.description&&React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,t.description)))),React.createElement("div",{className:`ts-filter ts-popup-target ${Z?"ts-active":""} ${X()?"ts-filled":""}`,onClick:()=>s!=="editor"&&W(!Z),tabIndex:0},React.createElement("div",{className:"ts-filter-text"},React.createElement("span",{className:X()?"":"ts-placeholder"},X()||t.placeholder||r("Select...","voxel-fse")),React.createElement("div",{className:"ts-down-icon"},React.createElement("i",{className:"las la-angle-down"})))),Z&&s!=="editor"&&React.createElement("div",{className:"ts-field-popup ts-popup-show"},React.createElement("div",{className:"ts-popup-content-wrapper min-scroll"},React.createElement("div",{className:"ts-popup-head flexify"},React.createElement("div",{className:"ts-popup-search"},React.createElement("i",{className:"las la-search"}),React.createElement("input",{type:"text",placeholder:r("Search...","voxel-fse"),value:R,onChange:A=>T(A.target.value),autoFocus:!0}))),React.createElement("div",{className:"ts-term-dropdown min-scroll"},P(C||n)),React.createElement("div",{className:"ts-popup-controller"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1",onClick:A=>{A.preventDefault(),T(""),D(b=>({...b,fieldValues:{...b.fieldValues,[t.key]:null}}))}},r("Clear","voxel-fse")),React.createElement("a",{href:"#",className:"ts-btn ts-btn-2",onClick:A=>{A.preventDefault(),W(!1)}},r("Done","voxel-fse"))))))}return React.createElement("div",{key:t.key,className:"ts-form-group"},React.createElement("label",null,t.label,!t.required&&React.createElement("span",{className:"is-required"},r("Optional","voxel-fse"))),React.createElement("input",{className:"ts-filter",type:"text",placeholder:`[${t.type} field]`,disabled:!0}))},qt=()=>React.createElement("form",{onSubmit:t=>{t.preventDefault(),Te()}},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},Q("confirm_account",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Confirmation code","voxel-fse"),React.createElement("div",{className:"vx-dialog"},React.createElement("i",{className:"las la-info-circle"}),React.createElement("div",{className:"vx-dialog-content min-scroll"},React.createElement("p",null,r("Please type the confirmation code which was sent to your email address","voxel-fse"))))),React.createElement("div",{className:"ts-input-icon flexify"},p(e.emailIcon,"envelope"),React.createElement("input",{className:"ts-filter autofocus",type:"text",maxLength:5,value:se,onChange:t=>he(t.target.value),placeholder:r("Enter code","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},r("Submit","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("p",{className:"field-info"},r("Didn't receive code?","voxel-fse")," ",React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),bt()},className:w?"vx-pending":""},r("Resend email","voxel-fse"))))),Ut=()=>React.createElement("form",{onSubmit:At},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},Q("recover",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Your email","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.emailIcon,"envelope"),React.createElement("input",{className:"ts-filter autofocus",type:"email",value:j.email,onChange:t=>ae(l=>({...l,email:t.target.value})),placeholder:r("Your account email","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},p(e.emailIcon,"envelope"),r("Reset password","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("login")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse"))))),$t=()=>React.createElement("form",{onSubmit:It},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},Q("recover_confirm",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Confirmation code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.emailIcon,"envelope"),React.createElement("input",{className:"ts-filter autofocus",type:"text",maxLength:5,value:j.code,onChange:t=>ae(l=>({...l,code:t.target.value})),placeholder:r("Enter code","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},r("Submit","voxel-fse"))))),Ht=()=>React.createElement("form",{onSubmit:Tt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},Q("recover_set_password",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group ts-password-field"},React.createElement("label",null,r("New password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter autofocus",type:"password",value:j.password,onChange:t=>ae(l=>({...l,password:t.target.value})),placeholder:r("Enter new password","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group ts-password-field"},React.createElement("label",null,r("Confirm password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter",type:"password",value:j.confirm_password,onChange:t=>ae(l=>({...l,confirm_password:t.target.value})),placeholder:r("Confirm new password","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},r("Update password","voxel-fse"))))),Mt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-welcome-message ts-form-group"},p(e.welcomeIcon,"happy"),React.createElement("h2",null,Q("welcome",e))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:a?.editProfileUrl||"#",className:"ts-btn ts-btn-2 ts-btn-large",onClick:t=>s==="editor"&&t.preventDefault()},p(e.usernameIcon,"user"),r("Complete profile","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:a?.redirectUrl||"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>s==="editor"&&t.preventDefault()},r("Do it later","voxel-fse")))),Gt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security_update_email")}},p(e.emailIcon,"envelope"),r("Update email address","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security_update_password")}},p(e.passwordIcon,"lock"),r("Update password","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),a?.twofa?.enabled?o("security_2fa_manage"):_t()}},p(e.shieldIcon,"shield"),r("Authenticator","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security_privacy")}},p(e.privacyIcon,"privacy"),r("Privacy","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:a?.logoutUrl||"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>s==="editor"&&t.preventDefault()},p(e.logoutIcon,"logout"),r("Log out","voxel-fse")))),Bt=()=>v.successful?React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},r("Password updated successfully!","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),h({current:"",new:"",confirm_new:"",successful:!1}),o("security")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse")))):React.createElement("form",{onSubmit:Ft},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},Q("security_update_password",e))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Current password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter",type:"password",value:v.current,onChange:t=>h(l=>({...l,current:t.target.value})),placeholder:r("Current password","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("New password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter",type:"password",value:v.new,onChange:t=>h(l=>({...l,new:t.target.value})),placeholder:r("New password","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Confirm new password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter",type:"password",value:v.confirm_new,onChange:t=>h(l=>({...l,confirm_new:t.target.value})),placeholder:r("Confirm new password","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},r("Update password","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse"))))),zt=()=>React.createElement("form",{onSubmit:Pt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},Q("security_update_email",e))),React.createElement("div",{className:"login-section"},x.state==="send_code"&&React.createElement(React.Fragment,null,React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("New email address","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.emailIcon,"envelope"),React.createElement("input",{className:"ts-filter",type:"email",value:x.new,onChange:t=>L(l=>({...l,new:t.target.value})),placeholder:r("New email address","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},r("Send verification code","voxel-fse")))),x.state==="verify_code"&&React.createElement(React.Fragment,null,React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Verification code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.emailIcon,"envelope"),React.createElement("input",{className:"ts-filter",type:"text",maxLength:6,value:x.code,onChange:t=>L(l=>({...l,code:t.target.value})),placeholder:r("Enter code","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},r("Verify code","voxel-fse")))),x.state==="success"&&React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},r("Email updated successfully!","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),L({new:"",code:"",state:"send_code"}),o("security")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse"))))),Wt=()=>React.createElement("form",{onSubmit:Lt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},r("Setup Authenticator","voxel-fse"))),React.createElement("div",{className:"login-section"},k.qr_code&&React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"twofa-qr-code"},React.createElement("img",{src:k.qr_code,alt:"QR Code"})),React.createElement("p",{className:"field-info"},r("Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Verification code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.shieldIcon,"shield"),React.createElement("input",{className:"ts-filter",type:"text",maxLength:6,value:k.verify_code,onChange:t=>Y(l=>({...l,verify_code:t.target.value})),placeholder:r("Enter 6-digit code","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},r("Enable 2FA","voxel-fse")))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse"))))),Yt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},r("Backup Codes","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},r("Save these backup codes in a safe place. You can use them to access your account if you lose your authenticator.","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"backup-codes-list"},k.backup_codes.map((t,l)=>React.createElement("code",{key:l,className:"backup-code"},t)))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:"ts-btn ts-btn-1 ts-btn-large",onClick:Ct},p(e.copyIcon,"copy"),r("Copy codes","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-2 ts-btn-large",onClick:t=>{t.preventDefault(),o("security")}},r("Done","voxel-fse")))),Zt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},r("Authenticator is enabled!","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Two factor authentication is enabled when logging in to your account.","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Trusted devices:","voxel-fse")," ",a?.twofa?.trusted_devices_count??0),React.createElement("label",null,r("Backup codes remaining:","voxel-fse")," ",a?.twofa?.backup_codes_count??0)),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:`ts-btn ts-btn-1 ts-btn-large ${m?"vx-pending":""}`,onClick:t=>{t.preventDefault(),wt()}},p(e.cloudIcon,"cloud"),r("Generate new backup codes","voxel-fse"))),(a?.twofa?.trusted_devices_count??0)>0&&React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:`ts-btn ts-btn-1 ts-btn-large ${m?"vx-pending":""}`,onClick:t=>{t.preventDefault(),xt()}},p(e.deviceIcon,"device"),r("Remove all trusted devices","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security_2fa_disable")}},p(e.trashIcon,"trash"),r("Disable 2FA","voxel-fse"))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse"))))),Jt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},r("Disable Two-Factor Authentication","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Confirm your password","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter",type:"password",value:k.disable_password,onChange:t=>Y(l=>({...l,disable_password:t.target.value})),placeholder:r("Enter your password","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,onClick:t=>{t.preventDefault(),Nt()}},p(e.trashIcon,"trash"),r("Disable 2FA","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security_2fa_manage")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse")))),Kt=()=>React.createElement("form",{onSubmit:Vt},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},r("Two-Factor Authentication","voxel-fse"))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,B.use_backup?r("Backup code","voxel-fse"):r("Authentication code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.shieldIcon,"shield"),React.createElement("input",{className:"ts-filter autofocus",type:"text",maxLength:B.use_backup?8:6,value:B.code,onChange:t=>re(l=>({...l,code:t.target.value})),placeholder:B.use_backup?r("Enter backup code","voxel-fse"):r("Enter 6-digit code","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("div",{className:"ts-checkbox-container"},React.createElement("label",{className:"container-checkbox"},React.createElement("input",{type:"checkbox",checked:B.trust_device,onChange:t=>re(l=>({...l,trust_device:t.target.checked})),disabled:s==="editor"}),React.createElement("span",{className:"checkmark"})),React.createElement("span",null,r("Trust this device for 30 days","voxel-fse")))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"submit",className:`ts-btn ts-btn-2 ts-btn-large ${m?"vx-pending":""}`,disabled:s==="editor"||m},r("Verify","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),re(l=>({...l,use_backup:!l.use_backup,code:""}))}},B.use_backup?r("Use authentication code instead","voxel-fse"):r("Use backup code instead","voxel-fse"))))),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),re({user_id:null,session_token:null,code:"",use_backup:!1,trust_device:!1}),o("login")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse"))))),Qt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},r("Privacy","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:`ts-btn ts-btn-1 ts-btn-large ${z.export_data.pending?"vx-pending":""}`,onClick:kt,disabled:s==="editor"||z.export_data.pending},p(e.cloudIcon,"cloud"),r("Export my data","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security_delete_account")}},p(e.trashIcon,"trash"),r("Delete my account","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),o("security")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse")))),Xt=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},r("Delete Account","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info",style:{color:"var(--vx-danger-color, #dc3545)"}},r("Warning: This action cannot be undone. All your data will be permanently deleted.","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Enter your password to confirm","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.passwordIcon,"lock"),React.createElement("input",{className:"ts-filter",type:"password",value:z.delete_account.password,onChange:t=>K(l=>({...l,delete_account:{...l.delete_account,password:t.target.value}})),placeholder:r("Your password","voxel-fse"),disabled:s==="editor"}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:`ts-btn ts-btn-1 ts-btn-large ${z.delete_account.pending?"vx-pending":""}`,onClick:()=>Ue(!1),disabled:s==="editor"||z.delete_account.pending||!z.delete_account.password,style:{backgroundColor:"var(--vx-danger-color, #dc3545)"}},p(e.trashIcon,"trash"),r("Delete my account","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),K(l=>({...l,delete_account:{pending:!1,password:"",code:""}})),o("security_privacy")}},p(e.leftChevronIcon,"chevronLeft"),r("Go back","voxel-fse")))),ea=()=>React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},r("Confirm Deletion","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info"},r("A confirmation code has been sent to your email. Enter it below to confirm account deletion.","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("label",null,r("Confirmation code","voxel-fse")),React.createElement("div",{className:"ts-input-icon flexify"},p(e.emailIcon,"envelope"),React.createElement("input",{className:"ts-filter",type:"text",value:z.delete_account.code,readOnly:!0,disabled:!0}))),React.createElement("div",{className:"ts-form-group"},React.createElement("button",{type:"button",className:`ts-btn ts-btn-1 ts-btn-large ${z.delete_account.pending?"vx-pending":""}`,onClick:()=>Ue(!0),disabled:s==="editor"||z.delete_account.pending,style:{backgroundColor:"var(--vx-danger-color, #dc3545)"}},p(e.trashIcon,"trash"),r("Confirm deletion","voxel-fse"))),React.createElement("div",{className:"ts-form-group"},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1 ts-btn-large",onClick:t=>{t.preventDefault(),K(l=>({...l,delete_account:{pending:!1,password:"",code:""}})),o("security_privacy")}},p(e.leftChevronIcon,"chevronLeft"),r("Cancel","voxel-fse")))),ta=()=>{switch(i){case"login":return $e();case"register":return jt();case"confirm_account":case"login_confirm_account":return qt();case"recover":return Ut();case"recover_confirm":return $t();case"recover_set_password":return Ht();case"welcome":return Mt();case"security":return Gt();case"security_update_password":return Bt();case"security_update_email":return zt();case"security_2fa_setup":return Wt();case"security_2fa_backup_codes":return Yt();case"security_2fa_manage":return Zt();case"security_2fa_disable":return Jt();case"login_2fa_verify":return Kt();case"security_privacy":return Qt();case"security_delete_account":return Xt();case"security_delete_account_confirm":return ea();default:return $e()}};return c?React.createElement("div",{className:"ts-auth"},React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-loader","aria-label":r("Loading...","voxel-fse")}))):React.createElement("div",{className:`ts-auth ${e.customClasses||""}`},React.createElement("div",{className:`ts-form ts-login ${i==="welcome"?"ts-welcome":""}`},ta()))}function ht(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const a=e.getAttribute("href");if(a)return a}}if(typeof window<"u"&&window.location?.origin){const e=window.location.pathname.split("/").filter(Boolean),a=["wp-admin","wp-content","wp-includes","wp-json"];return e.length>0&&!a.includes(e[0])?window.location.origin+"/"+e[0]+"/wp-json/":window.location.origin+"/wp-json/"}return"/wp-json/"}function Et(e){return{googleIcon:e.google,signUpIcon:e.signUp,usernameIcon:e.username,passwordIcon:e.password,eyeIcon:e.eye,emailIcon:e.email,welcomeIcon:e.welcome,leftChevronIcon:e.leftChevron,privacyIcon:e.privacy,trashIcon:e.trash,logoutIcon:e.logout,phoneIcon:e.phone,linkIcon:e.link,calendarIcon:e.calendar,taxonomyIcon:e.taxonomy,uploadIcon:e.upload,copyIcon:e.copy,cloudIcon:e.cloud,deviceIcon:e.device,shieldIcon:e.shield}}function Rt(e){return{icons:{google:e.icons?.google??e.icons?.googleIcon??{},signUp:e.icons?.signUp??e.icons?.sign_up??e.icons?.signUpIcon??{},username:e.icons?.username??e.icons?.usernameIcon??{},password:e.icons?.password??e.icons?.passwordIcon??{},eye:e.icons?.eye??e.icons?.eyeIcon??{},email:e.icons?.email??e.icons?.emailIcon??{},welcome:e.icons?.welcome??e.icons?.welcomeIcon??{},leftChevron:e.icons?.leftChevron??e.icons?.left_chevron??e.icons?.leftChevronIcon??{},privacy:e.icons?.privacy??e.icons?.privacyIcon??{},trash:e.icons?.trash??e.icons?.trashIcon??{},logout:e.icons?.logout??e.icons?.logoutIcon??{},phone:e.icons?.phone??e.icons?.phoneIcon??{},link:e.icons?.link??e.icons?.linkIcon??{},calendar:e.icons?.calendar??e.icons?.calendarIcon??{},taxonomy:e.icons?.taxonomy??e.icons?.taxonomyIcon??{},upload:e.icons?.upload??e.icons?.uploadIcon??{},copy:e.icons?.copy??e.icons?.copyIcon??{},cloud:e.icons?.cloud??e.icons?.cloudIcon??{},device:e.icons?.device??e.icons?.deviceIcon??{},shield:e.icons?.shield??e.icons?.shieldIcon??{}},previewScreen:e.previewScreen??e.preview_screen??"login",loginTitle:e.loginTitle??e.login_title??"Log in to your account",registerTitle:e.registerTitle??e.register_title??"Create an account",confirmTitle:e.confirmTitle??e.confirm_title??"Confirm account",passwordRecoveryTitle:e.passwordRecoveryTitle??e.password_recovery_title??"Password recovery",confirmCodeTitle:e.confirmCodeTitle??e.confirm_code_title??"Enter confirmation code",newPasswordTitle:e.newPasswordTitle??e.new_password_title??"Set new password",updatePasswordTitle:e.updatePasswordTitle??e.update_password_title??"Update password",updateEmailTitle:e.updateEmailTitle??e.update_email_title??"Update email",welcomeTitle:e.welcomeTitle??e.welcome_title??"Welcome!",roleSource:e.roleSource??e.role_source??"auto",manualRoles:Array.isArray(e.manualRoles)?e.manualRoles:Array.isArray(e.manual_roles)?e.manual_roles:[]}}function gt(e,a){const s=Et(e.icons);return{blockId:a,previewScreen:e.previewScreen,loginTitle:e.loginTitle,registerTitle:e.registerTitle,confirmTitle:e.confirmTitle,passwordRecoveryTitle:e.passwordRecoveryTitle,confirmCodeTitle:e.confirmCodeTitle,newPasswordTitle:e.newPasswordTitle,updatePasswordTitle:e.updatePasswordTitle,updateEmailTitle:e.updateEmailTitle,welcomeTitle:e.welcomeTitle,roleSource:e.roleSource,manualRoles:e.manualRoles,...s}}function De({vxconfig:e,blockId:a}){const[s,c]=f.useState(null),[i,o]=f.useState(!0),[m,d]=f.useState(null),w=gt(e,a),N=f.useCallback(async()=>{o(!0),d(null);try{const y=new URLSearchParams({role_source:e.roleSource});e.roleSource==="manual"&&e.manualRoles.length>0&&e.manualRoles.forEach(j=>{y.append("manual_roles[]",j)});const G=ht(),S={},H=window.wpApiSettings?.nonce;H&&(S["X-WP-Nonce"]=H);const U=await fetch(`${G}voxel-fse/v1/auth-config?${y.toString()}`,{credentials:"same-origin",headers:S});if(!U.ok)throw new Error(`HTTP error! status: ${U.status}`);const D=await U.json();c(D)}catch(y){d(y instanceof Error?y.message:"Failed to load config"),console.error("Login block: Failed to fetch auth config",y)}finally{o(!1)}},[e.roleSource,e.manualRoles]);return f.useEffect(()=>{N()},[N]),m?React.createElement("div",{className:"ts-auth"},React.createElement("div",{className:"ts-form ts-login"},React.createElement("div",{className:"ts-login-head"},React.createElement("span",{className:"vx-step-title"},w.loginTitle)),React.createElement("div",{className:"login-section"},React.createElement("div",{className:"ts-form-group"},React.createElement("p",{className:"field-info",style:{color:"var(--vx-danger-color, #dc3545)"}},"Error loading login form. Please refresh the page."))))):React.createElement(vt,{attributes:w,config:s,context:"frontend",isLoading:i})}function ve(){document.querySelectorAll(".wp-block-voxel-fse-login").forEach((a,s)=>{const c=a.querySelector("script.vxconfig");if(!c){console.warn("Login block: No vxconfig found",a);return}let i;try{const w=JSON.parse(c.textContent||"{}");i=Rt(w)}catch(w){console.error("Login block: Failed to parse vxconfig",w);return}const o=a.id||`login-block-${s}`;a.id||(a.id=o);const m=a.querySelector(".ts-auth");if(!m){console.warn("Login block: No .ts-auth container found",a);return}Me.createRoot(m.parentElement||a).render(React.createElement(De,{vxconfig:i,blockId:o})),c.remove()})}return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",ve):ve(),ne.FrontendLogin=De,ne.initLoginBlocks=ve,Object.defineProperty(ne,Symbol.toStringTag,{value:"Module"}),ne})({},ReactDOM,React);
