(function(se,g,le){"use strict";var K,z,H,J;K={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},z=["(","?"],H={")":["("],":":["?","?:"]},J=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;function ae(e){for(var n=[],t=[],r,o,l,s;r=e.match(J);){for(o=r[0],l=e.substr(0,r.index).trim(),l&&n.push(l);s=t.pop();){if(H[o]){if(H[o][0]===s){o=H[o][1]||o;break}}else if(z.indexOf(s)>=0||K[s]<K[o]){t.push(s);break}n.push(s)}H[o]||t.push(o),e=e.substr(r.index+o.length)}return e=e.trim(),e&&n.push(e),n.concat(t.reverse())}var ie={"!":function(e){return!e},"*":function(e,n){return e*n},"/":function(e,n){return e/n},"%":function(e,n){return e%n},"+":function(e,n){return e+n},"-":function(e,n){return e-n},"<":function(e,n){return e<n},"<=":function(e,n){return e<=n},">":function(e,n){return e>n},">=":function(e,n){return e>=n},"==":function(e,n){return e===n},"!=":function(e,n){return e!==n},"&&":function(e,n){return e&&n},"||":function(e,n){return e||n},"?:":function(e,n,t){if(e)throw n;return t}};function ce(e,n){var t=[],r,o,l,s,f,u;for(r=0;r<e.length;r++){if(f=e[r],s=ie[f],s){for(o=s.length,l=Array(o);o--;)l[o]=t.pop();try{u=s.apply(null,l)}catch(m){return m}}else n.hasOwnProperty(f)?u=n[f]:u=+f;t.push(u)}return t[0]}function ue(e){var n=ae(e);return function(t){return ce(n,t)}}function de(e){var n=ue(e);return function(t){return+n({n:t})}}var W={contextDelimiter:"",onMissingKey:null};function fe(e){var n,t,r;for(n=e.split(";"),t=0;t<n.length;t++)if(r=n[t].trim(),r.indexOf("plural=")===0)return r.substr(7)}function $(e,n){var t;this.data=e,this.pluralForms={},this.options={};for(t in W)this.options[t]=n!==void 0&&t in n?n[t]:W[t]}$.prototype.getPluralForm=function(e,n){var t=this.pluralForms[e],r,o,l;return t||(r=this.data[e][""],l=r["Plural-Forms"]||r["plural-forms"]||r.plural_forms,typeof l!="function"&&(o=fe(r["Plural-Forms"]||r["plural-forms"]||r.plural_forms),l=de(o)),t=this.pluralForms[e]=l),t(n)},$.prototype.dcnpgettext=function(e,n,t,r,o){var l,s,f;return o===void 0?l=0:l=this.getPluralForm(e,o),s=t,n&&(s=n+this.options.contextDelimiter+t),f=this.data[e][s],f&&f[l]?f[l]:(this.options.onMissingKey&&this.options.onMissingKey(t,e),l===0?t:r)};var Z={"":{plural_forms(e){return e===1?0:1}}},pe=/^i18n\.(n?gettext|has_translation)(_|$)/,he=(e,n,t)=>{const r=new $({}),o=new Set,l=()=>{o.forEach(a=>a())},s=a=>(o.add(a),()=>o.delete(a)),f=(a="default")=>r.data[a],u=(a,i="default")=>{r.data[i]={...r.data[i],...a},r.data[i][""]={...Z[""],...r.data[i]?.[""]},delete r.pluralForms[i]},m=(a,i)=>{u(a,i),l()},v=(a,i="default")=>{r.data[i]={...r.data[i],...a,"":{...Z[""],...r.data[i]?.[""],...a?.[""]}},delete r.pluralForms[i],l()},w=(a,i)=>{r.data={},r.pluralForms={},m(a,i)},E=(a="default",i,y,b,k)=>(r.data[a]||u(void 0,a),r.dcnpgettext(a,i,y,b,k)),T=a=>a||"default",C=(a,i)=>{let y=E(i,void 0,a);return t?(y=t.applyFilters("i18n.gettext",y,a,i),t.applyFilters("i18n.gettext_"+T(i),y,a,i)):y},L=(a,i,y)=>{let b=E(y,i,a);return t?(b=t.applyFilters("i18n.gettext_with_context",b,a,i,y),t.applyFilters("i18n.gettext_with_context_"+T(y),b,a,i,y)):b},O=(a,i,y,b)=>{let k=E(b,void 0,a,i,y);return t?(k=t.applyFilters("i18n.ngettext",k,a,i,y,b),t.applyFilters("i18n.ngettext_"+T(b),k,a,i,y,b)):k},V=(a,i,y,b,k)=>{let M=E(k,b,a,i,y);return t?(M=t.applyFilters("i18n.ngettext_with_context",M,a,i,y,b,k),t.applyFilters("i18n.ngettext_with_context_"+T(k),M,a,i,y,b,k)):M},I=()=>L("ltr","text direction")==="rtl",p=(a,i,y)=>{const b=i?i+""+a:a;let k=!!r.data?.[y??"default"]?.[b];return t&&(k=t.applyFilters("i18n.has_translation",k,a,i,y),k=t.applyFilters("i18n.has_translation_"+T(y),k,a,i,y)),k};if(t){const a=i=>{pe.test(i)&&l()};t.addAction("hookAdded","core/i18n",a),t.addAction("hookRemoved","core/i18n",a)}return{getLocaleData:f,setLocaleData:m,addLocaleData:v,resetLocaleData:w,subscribe:s,__:C,_x:L,_n:O,_nx:V,isRTL:I,hasTranslation:p}};function me(e){return typeof e!="string"||e===""?(console.error("The namespace must be a non-empty string."),!1):/^[a-zA-Z][a-zA-Z0-9_.\-\/]*$/.test(e)?!0:(console.error("The namespace can only contain numbers, letters, dashes, periods, underscores and slashes."),!1)}var G=me;function ye(e){return typeof e!="string"||e===""?(console.error("The hook name must be a non-empty string."),!1):/^__/.test(e)?(console.error("The hook name cannot begin with `__`."),!1):/^[a-zA-Z][a-zA-Z0-9_.-]*$/.test(e)?!0:(console.error("The hook name can only contain numbers, letters, dashes, periods and underscores."),!1)}var Q=ye;function ge(e,n){return function(r,o,l,s=10){const f=e[n];if(!Q(r)||!G(o))return;if(typeof l!="function"){console.error("The hook callback must be a function.");return}if(typeof s!="number"){console.error("If specified, the hook priority must be a number.");return}const u={callback:l,priority:s,namespace:o};if(f[r]){const m=f[r].handlers;let v;for(v=m.length;v>0&&!(s>=m[v-1].priority);v--);v===m.length?m[v]=u:m.splice(v,0,u),f.__current.forEach(w=>{w.name===r&&w.currentIndex>=v&&w.currentIndex++})}else f[r]={handlers:[u],runs:0};r!=="hookAdded"&&e.doAction("hookAdded",r,o,l,s)}}var X=ge;function ve(e,n,t=!1){return function(o,l){const s=e[n];if(!Q(o)||!t&&!G(l))return;if(!s[o])return 0;let f=0;if(t)f=s[o].handlers.length,s[o]={runs:s[o].runs,handlers:[]};else{const u=s[o].handlers;for(let m=u.length-1;m>=0;m--)u[m].namespace===l&&(u.splice(m,1),f++,s.__current.forEach(v=>{v.name===o&&v.currentIndex>=m&&v.currentIndex--}))}return o!=="hookRemoved"&&e.doAction("hookRemoved",o,l),f}}var B=ve;function be(e,n){return function(r,o){const l=e[n];return typeof o<"u"?r in l&&l[r].handlers.some(s=>s.namespace===o):r in l}}var Y=be;function ke(e,n,t,r){return function(l,...s){const f=e[n];f[l]||(f[l]={handlers:[],runs:0}),f[l].runs++;const u=f[l].handlers;if(!u||!u.length)return t?s[0]:void 0;const m={name:l,currentIndex:0};async function v(){try{f.__current.add(m);let E=t?s[0]:void 0;for(;m.currentIndex<u.length;)E=await u[m.currentIndex].callback.apply(null,s),t&&(s[0]=E),m.currentIndex++;return t?E:void 0}finally{f.__current.delete(m)}}function w(){try{f.__current.add(m);let E=t?s[0]:void 0;for(;m.currentIndex<u.length;)E=u[m.currentIndex].callback.apply(null,s),t&&(s[0]=E),m.currentIndex++;return t?E:void 0}finally{f.__current.delete(m)}}return(r?v:w)()}}var U=ke;function Re(e,n){return function(){const r=e[n];return Array.from(r.__current).at(-1)?.name??null}}var ee=Re;function we(e,n){return function(r){const o=e[n];return typeof r>"u"?o.__current.size>0:Array.from(o.__current).some(l=>l.name===r)}}var te=we;function Ee(e,n){return function(r){const o=e[n];if(Q(r))return o[r]&&o[r].runs?o[r].runs:0}}var ne=Ee,_e=class{actions;filters;addAction;addFilter;removeAction;removeFilter;hasAction;hasFilter;removeAllActions;removeAllFilters;doAction;doActionAsync;applyFilters;applyFiltersAsync;currentAction;currentFilter;doingAction;doingFilter;didAction;didFilter;constructor(){this.actions=Object.create(null),this.actions.__current=new Set,this.filters=Object.create(null),this.filters.__current=new Set,this.addAction=X(this,"actions"),this.addFilter=X(this,"filters"),this.removeAction=B(this,"actions"),this.removeFilter=B(this,"filters"),this.hasAction=Y(this,"actions"),this.hasFilter=Y(this,"filters"),this.removeAllActions=B(this,"actions",!0),this.removeAllFilters=B(this,"filters",!0),this.doAction=U(this,"actions",!1,!1),this.doActionAsync=U(this,"actions",!1,!0),this.applyFilters=U(this,"filters",!0,!1),this.applyFiltersAsync=U(this,"filters",!0,!0),this.currentAction=ee(this,"actions"),this.currentFilter=ee(this,"filters"),this.doingAction=te(this,"actions"),this.doingFilter=te(this,"filters"),this.didAction=ne(this,"actions"),this.didFilter=ne(this,"filters")}};function Se(){return new _e}var xe=Se,re=xe(),{addAction:Je,addFilter:We,removeAction:Ze,removeFilter:Ge,hasAction:Xe,hasFilter:Ye,removeAllActions:et,removeAllFilters:tt,doAction:nt,doActionAsync:rt,applyFilters:ot,applyFiltersAsync:st,currentAction:lt,currentFilter:at,doingAction:it,doingFilter:ct,didAction:ut,didFilter:dt,actions:ft,filters:pt}=re,R=he(void 0,void 0,re);R.getLocaleData.bind(R),R.setLocaleData.bind(R),R.resetLocaleData.bind(R),R.subscribe.bind(R);var P=R.__.bind(R);R._x.bind(R),R._n.bind(R),R._nx.bind(R),R.isRTL.bind(R),R.hasTranslation.bind(R);function Te(e,n){let t=null;return(...r)=>{t&&clearTimeout(t),t=setTimeout(()=>e(...r),n)}}function Ae(){return typeof navigator<"u"&&(navigator.platform||"").includes("Mac")?"macOS":"other"}const F=()=>React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",width:"24",height:"24"},React.createElement("circle",{cx:"11",cy:"11",r:"8"}),React.createElement("path",{d:"m21 21-4.35-4.35"})),Ce=()=>React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",width:"24",height:"24"},React.createElement("path",{d:"M18 6 6 18"}),React.createElement("path",{d:"m6 6 12 12"})),oe=()=>React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",width:"24",height:"24"},React.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),React.createElement("polyline",{points:"14 2 14 8 20 8"})),Le=()=>React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",width:"24",height:"24"},React.createElement("circle",{cx:"12",cy:"12",r:"10"}),React.createElement("path",{d:"m15 9-6 6"}),React.createElement("path",{d:"m9 9 6 6"}));function x(e,n){return!e||!e.value||e.library===""?React.createElement(n,null):e.library==="svg"?React.createElement("img",{src:e.value,alt:""}):e.library==="icon"?React.createElement("i",{className:e.value}):React.createElement(n,null)}function Fe({attributes:e,postTypes:n,context:t,vxConfig:r}){const[o,l]=g.useState(!1),[s,f]=g.useState(""),[u,m]=g.useState(n[0]||null),[v,w]=g.useState([]),[E,T]=g.useState(!1),[C,L]=g.useState([]),O=g.useRef(null),V=g.useRef(null),I=g.useRef(""),p=r||{postTypes:{},displayMode:e.displayMode||"single",keywords:{minlength:2},singleMode:{submitTo:e.singleSubmitTo||null,filterKey:e.singleSubmitKey||"keywords"},icons:{search:e.searchIcon,close:e.closeIcon,result:e.resultIcon,clearSearches:e.clearSearchesIcon},buttonLabel:e.buttonLabel||"Quick search",hideCptTabs:e.hideCptTabs||!1};g.useEffect(()=>{if(t==="frontend")try{const h=localStorage.getItem("voxel:recent_searches");if(h){const d=JSON.parse(h);Array.isArray(d)&&L(d)}}catch{}},[t]),g.useEffect(()=>{n.length>0&&!u&&m(n[0])},[n,u]),g.useEffect(()=>{if(t!=="frontend")return;const h=d=>{(d.ctrlKey||d.metaKey)&&d.keyCode===75&&(d.preventDefault(),l(_=>!_)),d.keyCode===27&&l(!1)};return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[t]),g.useEffect(()=>{o&&O.current&&setTimeout(()=>O.current?.focus(),100)},[o]);const a=g.useCallback(async()=>{const h=s.trim();if(h.length<p.keywords.minlength){w([]),I.current="";return}if(h!==I.current){if(t==="editor"){I.current=h,w([{type:"post",key:"post:1",link:"#",title:`Search result for "${s}"`,logo:null,icon:null}]);return}I.current=h,T(!0);try{const d={};if(p.displayMode==="tabbed"&&u){const A=e.postTypeSettings?.[u.key]||{};d[u.key]={filter_key:A.filter||"keywords",taxonomies:A.taxonomies||[]}}else n.forEach(A=>{const q=e.postTypeSettings?.[A.key]||{};d[A.key]={filter_key:q.filter||"keywords",taxonomies:q.taxonomies||[]}});const N=`${window.Voxel_Config?.site_url||window.location.origin}/?vx=1`,j=await(await fetch(`${N}&action=quick_search&search=${encodeURIComponent(s.trim())}&post_types=${encodeURIComponent(JSON.stringify(d))}`)).json();if(j.success)w(j.data||[]);else{const A=window.Voxel,q=window.Voxel_Config,ze=j.message||q?.l10n?.ajaxError||"An error occurred";A?.alert&&A.alert(ze,"error"),w([])}}catch{const d=window.Voxel,S=window.Voxel_Config?.l10n?.ajaxError||"An error occurred";d?.alert&&d.alert(S,"error"),w([])}finally{T(!1)}}},[s,p,u,n,e.postTypeSettings,t]),i=g.useMemo(()=>Te(()=>a(),250),[a]);g.useEffect(()=>{i()},[s,i]);const y=g.useCallback(h=>{if(t!=="frontend")return;const d=C.filter(S=>S.key!==h.key);d.unshift(h);const _=d.slice(0,8);L(_),localStorage.setItem("voxel:recent_searches",JSON.stringify(_))},[t,C]),b=g.useCallback(()=>{if(t!=="frontend"||!s.trim())return;const h=`keywords:${s.trim()}`;let d="";if(p.displayMode==="tabbed"&&u){const S=new URL(u.archive||window.location.origin),N=e.postTypeSettings?.[u.key]||{};S.searchParams.set(N.filter||"keywords",s.trim()),d=S.toString()}else if(p.singleMode.submitTo){const S=new URL(p.singleMode.submitTo);S.searchParams.set(p.singleMode.filterKey,s.trim()),d=S.toString()}const _={type:"keywords",key:h,title:s.trim(),logo:null,link:d};y(_)},[t,s,p,u,e.postTypeSettings,y]),k=g.useCallback(()=>{if(t!=="frontend")return;let h;if(p.displayMode==="tabbed"&&u){h=new URL(u.archive||window.location.origin);const d=e.postTypeSettings?.[u.key]||{};h.searchParams.set(d.filter||"keywords",s.trim())}else if(p.singleMode.submitTo)h=new URL(p.singleMode.submitTo),h.searchParams.set(p.singleMode.filterKey,s.trim());else return;window.location.href=h.toString()},[t,p,u,e.postTypeSettings,s]),M=g.useCallback(()=>{t==="frontend"&&(L([]),localStorage.setItem("voxel:recent_searches",JSON.stringify([])))},[t]),Ue=g.useCallback(h=>{y(h)},[y]),qe=g.useCallback(h=>{const d=C.filter(_=>_.key!==h.key);d.unshift(h),L(d),localStorage.setItem("voxel:recent_searches",JSON.stringify(d))},[C]),Ke=Ae()==="macOS"?"⌘+K":"CTRL+K",$e=()=>{const h={postTypes:Object.fromEntries(n.map(d=>{const _=e.postTypeSettings?.[d.key]||{};return[d.key,{key:d.key,label:_.label||d.label,filter:_.filter||"keywords",taxonomies:_.taxonomies||[],archive:d.archive||"",results:{query:"",items:[]}}]})),displayMode:e.displayMode||"single",keywords:{minlength:2},singleMode:{submitTo:e.singleSubmitTo||null,filterKey:e.singleSubmitKey||"keywords"},icons:{search:e.searchIcon||{library:"",value:""},close:e.closeIcon||{library:"",value:""},result:e.resultIcon||{library:"",value:""},clearSearches:e.clearSearchesIcon||{library:"",value:""}},buttonLabel:e.buttonLabel||"Quick search",hideCptTabs:e.hideCptTabs||!1};return React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(h)}})},Qe=()=>{const h=p.displayMode==="tabbed"&&!p.hideCptTabs&&n.length>1,d=s.trim().length<p.keywords.minlength&&C.length>0,_=s.trim().length<p.keywords.minlength&&C.length===0,S=s.trim().length>=p.keywords.minlength,N=S&&v.length===0&&!E;return React.createElement("form",{onSubmit:c=>{c.preventDefault(),b(),k()}},React.createElement("div",{className:"ts-sticky-top qs-top uib b-bottom"},React.createElement("a",{href:"#",className:"ts-icon-btn hide-d",role:"button",onClick:c=>{c.preventDefault(),l(!1)}},x(p.icons.close,Ce)),React.createElement("div",{className:"ts-input-icon flexify"},x(p.icons.search,F),React.createElement("input",{ref:O,type:"text",value:s,onChange:c=>f(c.target.value),onKeyDown:c=>{c.key==="Enter"&&(c.preventDefault(),b(),k())},placeholder:p.buttonLabel,className:"autofocus",maxLength:100}))),h&&React.createElement("div",{className:"ts-form-group cpt-tabs"},React.createElement("ul",{className:"ts-generic-tabs flexify simplify-ul quick-cpt-select"},n.map(c=>{const j=e.postTypeSettings?.[c.key]||{};return React.createElement("li",{key:c.key,className:u?.key===c.key?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:A=>{A.preventDefault(),m(c),w([]),a()}},j.label||c.label))}))),React.createElement("div",{className:`ts-term-dropdown ts-md-group ts-multilevel-dropdown ${E?"vx-pending":""}`},_&&React.createElement("div",{className:"ts-empty-user-tab"},x(p.icons.search,F),React.createElement("p",null,P("No recent searches.","voxel-fse"))),d&&React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list quick-search-list"},C.map(c=>React.createElement("li",{key:c.key},React.createElement("a",{rel:"nofollow",href:c.link,onClick:()=>qe(c),className:"flexify"},c.logo&&React.createElement("div",{className:"ts-term-image"},React.createElement("span",{dangerouslySetInnerHTML:{__html:c.logo}})),!c.logo&&c.icon&&React.createElement("div",{className:"ts-term-icon"},React.createElement("span",{dangerouslySetInnerHTML:{__html:c.icon}})),!c.logo&&!c.icon&&React.createElement("div",{className:"ts-term-icon"},React.createElement("span",null,x(p.icons.result,oe))),React.createElement("span",null,c.title)))),React.createElement("li",null,React.createElement("a",{href:"#",className:"flexify",onClick:c=>{c.preventDefault(),M()}},React.createElement("div",{className:"ts-term-icon"},React.createElement("span",null,x(p.icons.clearSearches,Le))),React.createElement("span",null,P("Clear searches","voxel-fse"))))),N&&React.createElement("div",{className:"ts-empty-user-tab"},x(p.icons.search,F),React.createElement("p",null,P("No results found","voxel-fse"))),E&&S&&v.length===0&&React.createElement("div",{className:"ts-empty-user-tab"},x(p.icons.search,F),React.createElement("p",null,P("Searching","voxel-fse"))),S&&v.length>0&&React.createElement("ul",{className:"simplify-ul ts-term-dropdown-list quick-search-list"},v.map(c=>React.createElement("li",{key:c.key},React.createElement("a",{rel:"nofollow",href:c.link,onClick:()=>Ue(c),className:"flexify"},c.logo&&React.createElement("div",{className:"ts-term-image"},React.createElement("span",{dangerouslySetInnerHTML:{__html:c.logo}})),!c.logo&&c.icon&&React.createElement("div",{className:"ts-term-icon"},React.createElement("span",{dangerouslySetInnerHTML:{__html:c.icon}})),!c.logo&&!c.icon&&React.createElement("div",{className:"ts-term-icon"},React.createElement("span",null,x(p.icons.result,oe))),React.createElement("span",null,c.title)))),React.createElement("li",{className:"view-all"},React.createElement("a",{href:"#",onClick:c=>{c.preventDefault(),b(),k()},className:"flexify"},React.createElement("div",{className:"ts-term-icon"},React.createElement("span",null,x(p.icons.search,F))),React.createElement("span",null,P("Search for","voxel-fse")," ",React.createElement("strong",null,s)))))))},Ve=()=>{if(!o)return null;const h=React.createElement("div",{ref:V,className:"ts-quicksearch-popup lg-width lg-height ts-popup-content"},Qe());return t==="editor"?React.createElement("div",{className:"ts-popup-container ts-form-group quick-search-keyword"},h):le.createPortal(React.createElement("div",{className:"ts-popup-overlay"},React.createElement("div",{className:"ts-popup-backdrop",onClick:()=>l(!1)}),h),document.body)};return React.createElement(React.Fragment,null,$e(),React.createElement("div",{style:{display:"none"},className:"ts-form-group quick-search-keyword"}),React.createElement("div",{className:"ts-form-group quick-search-keyword"},React.createElement("button",{type:"button",className:"ts-filter ts-popup-target",onClick:()=>l(!0),"aria-label":p.buttonLabel},x(p.icons.search,F),React.createElement("div",{className:"ts-filter-text"},p.buttonLabel),!e.suffixHide&&React.createElement("span",{className:"ts-shortcut"},Ke))),Ve())}function Ie(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const n=e.getAttribute("href");if(n)return n.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function Me(){const e=Ie();try{return new URL(e).pathname.replace(/\/$/,"")}catch{return""}}function He(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const n=document.querySelector('link[rel="https://api.w.org/"]');if(n){const t=n.getAttribute("href");if(t)return t}}const e=Me();return typeof window<"u"?window.location.origin+e+"/wp-json/":"/wp-json/"}function Pe(){return He()}function De(e){const n=e.querySelector("script.vxconfig");if(n&&n.textContent)try{return JSON.parse(n.textContent)}catch(t){console.error("Failed to parse vxconfig:",t)}return null}function Oe(e){const n={},t=e.postTypes??e.post_types??{};return Array.isArray(t)?t.forEach(r=>{const o=r.key??r.slug??r.id;n[o]={key:o,label:r.label??r.name??o,filter:r.filter??r.filter_key??"keywords",taxonomies:r.taxonomies??[],archive:r.archive??r.archive_url??"",results:r.results??{query:"",items:[]}}}):typeof t=="object"&&Object.entries(t).forEach(([r,o])=>{n[r]={key:o.key??r,label:o.label??o.name??r,filter:o.filter??o.filter_key??"keywords",taxonomies:o.taxonomies??[],archive:o.archive??o.archive_url??"",results:o.results??{query:"",items:[]}}}),{postTypes:n,displayMode:e.displayMode??e.display_mode??"single",keywords:{minlength:e.keywords?.minlength??e.keywords?.min_length??2},singleMode:{submitTo:e.singleMode?.submitTo??e.single_mode?.submit_to??null,filterKey:e.singleMode?.filterKey??e.single_mode?.filter_key??"keywords"},icons:{search:e.icons?.search??{library:"",value:""},close:e.icons?.close??{library:"",value:""},result:e.icons?.result??{library:"",value:""},clearSearches:e.icons?.clearSearches??e.icons?.clear_searches??{library:"",value:""}},buttonLabel:e.buttonLabel??e.button_label??"Quick search",hideCptTabs:e.hideCptTabs??e.hide_cpt_tabs??!1}}async function Ne(e){if(!e||e.length===0)return[];const t=`${Pe()}voxel-fse/v1/quick-search/post-types?post_types=${encodeURIComponent(e.join(","))}`;try{const r=await fetch(t);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return(await r.json()).postTypes||[]}catch(r){return console.error("Failed to fetch post types:",r),[]}}function je(e){const n=Object.keys(e.postTypes||{}),t={};return Object.entries(e.postTypes||{}).forEach(([r,o])=>{t[r]={label:o.label||r,filter:o.filter||"keywords",taxonomies:o.taxonomies||[]}}),{blockId:"",postTypes:n,postTypeSettings:t,buttonLabel:e.buttonLabel||"Quick search",displayMode:e.displayMode||"single",hideCptTabs:e.hideCptTabs||!1,singleSubmitTo:e.singleMode?.submitTo||"",singleSubmitKey:e.singleMode?.filterKey||"keywords",searchIcon:e.icons?.search||{library:"",value:""},closeIcon:e.icons?.close||{library:"",value:""},resultIcon:e.icons?.result||{library:"",value:""},clearSearchesIcon:e.icons?.clearSearches||{library:"",value:""},buttonPadding:{},buttonPadding_tablet:{},buttonPadding_mobile:{},buttonHeight:50,buttonHeight_tablet:0,buttonHeight_mobile:0,buttonBackground:"",buttonTextColor:"",buttonBorderRadius:5,buttonIconColor:"",buttonIconSize:24,buttonIconSpacing:10,buttonBackgroundHover:"",buttonTextColorHover:"",buttonBorderColorHover:"",buttonIconColorHover:"",buttonBackgroundFilled:"",buttonTextColorFilled:"",buttonIconColorFilled:"",buttonBorderColorFilled:"",buttonBorderWidthFilled:0,suffixHide:!1,suffixPadding:{top:2,right:8,bottom:2,left:8},suffixTextColor:"",suffixBackground:"",suffixBorderRadius:50,suffixMargin:0,tabsJustify:"center",tabsPadding:{},tabsMargin:{top:10,right:0,bottom:10,left:0},tabsTextColor:"",tabsActiveTextColor:"",tabsBackground:"",tabsActiveBackground:"",tabsBorderRadius:0,tabsActiveBorderColor:"",popupCustomEnable:!1,popupBackdropBackground:"",popupPointerEvents:!1,popupCenterPosition:!1,popupMinWidth:538,popupMaxWidth:0,popupMaxHeight:0,popupTopBottomMargin:0,hideDesktop:!1,hideTablet:!1,hideMobile:!1,customClasses:""}}function Be({vxConfig:e,attributes:n}){const[t,r]=g.useState([]),[o,l]=g.useState(!0);return g.useEffect(()=>{let s=!1;async function f(){l(!0);try{const u=Object.keys(e.postTypes||{}),m=await Ne(u);if(!s){const v=m.map(w=>{const E=e.postTypes?.[w.key];return{...w,label:E?.label||w.label,filter:E?.filter||w.filter||"keywords",taxonomies:E?.taxonomies||w.taxonomies||[]}});r(v)}}catch(u){console.error("Failed to load post types:",u)}finally{s||l(!1)}}return f(),()=>{s=!0}},[e]),o?React.createElement("div",{className:"ts-form-group quick-search-keyword voxel-fse-loading"},React.createElement("button",{type:"button",className:"ts-filter ts-popup-target",disabled:!0},React.createElement("span",{className:"ts-loader"}))):React.createElement(Fe,{attributes:n,postTypes:t,context:"frontend",vxConfig:e})}function D(){document.querySelectorAll(".quick-search.voxel-fse-quick-search").forEach(n=>{if(n.dataset.hydrated==="true")return;const t=De(n);if(!t){console.error("Quick Search: No vxconfig found");return}const r=Oe(t),o=je(r);n.dataset.hydrated="true",n.innerHTML="",se.createRoot(n).render(React.createElement(Be,{vxConfig:r,attributes:o}))})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",D):D(),window.addEventListener("turbo:load",D),window.addEventListener("pjax:complete",D),typeof jQuery<"u"&&jQuery(document).on("voxel:markup-update",D)})(ReactDOM,React,ReactDOM);
