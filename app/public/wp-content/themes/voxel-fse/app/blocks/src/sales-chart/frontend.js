var VoxelFSESalesChart=(function(p,a,A){"use strict";const w=()=>a.createElement("svg",{width:"80",height:"80",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",transform:"rotate(0 0 0)"},a.createElement("path",{d:"M11.833 3.75C10.5904 3.75 9.58301 4.75736 9.58301 6V18.9991C9.58301 20.2417 10.5904 21.2491 11.833 21.2491H12.1663C13.409 21.2491 14.4163 20.2417 14.4163 18.9991V6C14.4163 4.75736 13.409 3.75 12.1663 3.75H11.833Z",fill:"#343C54"}),a.createElement("path",{d:"M5.5 12.5625C4.25736 12.5625 3.25 13.5699 3.25 14.8125V19C3.25 20.2426 4.25736 21.25 5.5 21.25H5.83333C7.07597 21.25 8.08333 20.2426 8.08333 19V14.8125C8.08333 13.5699 7.07598 12.5625 5.83333 12.5625H5.5Z",fill:"#343C54"}),a.createElement("path",{d:"M18.166 8.66016C16.9234 8.66016 15.916 9.66752 15.916 10.9102V19.0001C15.916 20.2427 16.9234 21.2501 18.166 21.2501H18.4993C19.742 21.2501 20.7493 20.2427 20.7493 19.0001V10.9102C20.7493 9.66752 19.742 8.66016 18.4993 8.66016H18.166Z",fill:"#343C54"})),V=()=>a.createElement("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",transform:"rotate(0 0 0)"},a.createElement("path",{d:"M10.746 6.00002C10.746 5.69663 10.5632 5.42312 10.2829 5.30707C10.0026 5.19101 9.67996 5.25526 9.4655 5.46986L3.51254 11.4266C3.35184 11.5642 3.25 11.7685 3.25 11.9966V11.9982C3.24959 12.1906 3.32276 12.3831 3.46949 12.53L9.46548 18.5302C9.67994 18.7448 10.0026 18.809 10.2829 18.693C10.5632 18.5769 10.746 18.3034 10.746 18L10.746 12.7466L20.0014 12.7466C20.4156 12.7466 20.7514 12.4108 20.7514 11.9966C20.7514 11.5824 20.4156 11.2466 20.0014 11.2466L10.746 11.2466V6.00002Z",fill:"#343C54"})),D=()=>a.createElement("svg",{width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",transform:"rotate(0 0 0)"},a.createElement("path",{d:"M14.5359 5.46986C14.3214 5.25526 13.9988 5.19101 13.7185 5.30707C13.4382 5.42312 13.2554 5.69663 13.2554 6.00002V11.2466L4 11.2466C3.58579 11.2466 3.25 11.5824 3.25 11.9966C3.25 12.4108 3.58579 12.7466 4 12.7466L13.2554 12.7466V18C13.2554 18.3034 13.4382 18.5769 13.7185 18.693C13.9988 18.809 14.3214 18.7448 14.5359 18.5302L20.5319 12.53C20.6786 12.3831 20.7518 12.1905 20.7514 11.9981L20.7514 11.9966C20.7514 11.7685 20.6495 11.5642 20.4888 11.4266L14.5359 5.46986Z",fill:"#343C54"}));function g(e){return!e||!e.value?null:e.library==="icon"?a.createElement("i",{className:e.value}):e.library==="svg"?a.createElement("img",{src:e.value,alt:"",className:"voxel-fse-icon-svg",style:{width:"1em",height:"1em"}}):null}function _(e,r="error"){const s=window,o=s.Voxel_Config?.l10n?.ajaxError||"An error occurred",t=e||o;s.Voxel?.alert?s.Voxel.alert(t,r):r==="error"?console.error("[SalesChart]",t):console.log("[SalesChart]",t)}function L({attributes:e,config:r,isLoading:s,error:o}){const[t,u]=a.useState(e.ts_active_chart),[d,x]=a.useState(r?.charts??null),[C,S]=a.useState(null),[y,b]=a.useState(!1),h=a.useRef(null),N=a.useRef(null),B=a.useRef({isDown:!1,startX:0,scrollLeft:0});a.useEffect(()=>{r?.charts&&x(r.charts)},[r]),a.useEffect(()=>{u(e.ts_active_chart)},[e.ts_active_chart]),a.useEffect(()=>{o&&_(o,"error")},[o]);const c=d?d[t]:null,X=a.useCallback((n,l)=>{if(S(l),h.current){const i=n.currentTarget.getBoundingClientRect();document.documentElement.dir==="rtl"?(h.current.style.right=`${window.innerWidth-i.left+10}px`,h.current.style.left="auto"):(h.current.style.left=`${i.left+i.width+10}px`,h.current.style.right="auto"),h.current.style.top=`${i.top}px`}},[]),U=a.useCallback(()=>{S(null)},[]),k=a.useCallback(async n=>{if(!(!c||y)){b(!0);try{const l=window.wpApiSettings?.root||"/wp-json/",i=new URLSearchParams({chart:t,date:c.meta.state.date??"",direction:n}),f=await fetch(`${l}voxel-fse/v1/sales-chart/load-more?${i.toString()}`);if(!f.ok)throw new Error(`HTTP ${f.status}`);const v=await f.json();v&&d&&x({...d,[t]:v})}catch(l){const i=l instanceof Error?l.message:void 0;_(i,"error")}finally{b(!1)}}},[t,c,y,d]);if(a.useEffect(()=>{const n=N.current;if(!n)return;const l=B.current,i=E=>{l.isDown=!0,l.startX=E.pageX-n.offsetLeft,l.scrollLeft=n.scrollLeft},f=()=>{l.isDown=!1},v=()=>{l.isDown=!1},M=E=>{if(!l.isDown)return;E.preventDefault();const z=E.pageX-n.offsetLeft-l.startX;n.scrollLeft=l.scrollLeft-z};return n.addEventListener("mousedown",i),n.addEventListener("mouseup",f),n.addEventListener("mouseleave",v),n.addEventListener("mousemove",M),()=>{n.removeEventListener("mousedown",i),n.removeEventListener("mouseup",f),n.removeEventListener("mouseleave",v),n.removeEventListener("mousemove",M)}},[t]),s)return React.createElement("div",{className:"ts-vendor-stats"},React.createElement("div",{className:"ts-no-posts"},React.createElement(w,null),React.createElement("p",null,"Loading chart data...")));const Z={activeChart:e.ts_active_chart,chartIcon:e.chart_icon,chevronRight:e.ts_chevron_right,chevronLeft:e.ts_chevron_left};return React.createElement(React.Fragment,null,React.createElement("script",{type:"application/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(Z)}}),React.createElement("div",{className:"ts-vendor-stats"},React.createElement("ul",{className:"ts-generic-tabs simplify-ul flexify bar-chart-tabs"},React.createElement("li",{className:t==="this-week"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),u("this-week")}},"Week")),React.createElement("li",{className:t==="this-month"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),u("this-month")}},"Month")),React.createElement("li",{className:t==="this-year"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),u("this-year")}},"Year")),React.createElement("li",{className:t==="all-time"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),u("all-time")}},"All time"))),c&&React.createElement("div",{className:`ts-chart chart-${t}${y?" vx-pending":""}`,key:t},c.meta.state.has_activity?React.createElement("div",{className:"chart-contain"},React.createElement("div",{className:"chart-content"},React.createElement("div",{className:"bar-item-con bar-values"},c.steps.map((n,l)=>React.createElement("span",{key:l},n)))),React.createElement("div",{className:"chart-content min-scroll min-scroll-h",ref:N},c.items.map((n,l)=>React.createElement("div",{key:l,className:"bar-item-con"},React.createElement("div",{className:"bi-hold"},React.createElement("div",{className:"bar-item bar-animate",style:{height:`${n.percent}%`},onMouseOver:i=>X(i,{label:n.label,earnings:n.earnings,orders:n.orders}),onMouseLeave:U})),React.createElement("span",null,n.label)))),React.createElement("ul",{ref:h,className:`flexify simplify-ul bar-item-data${C?" active":""}`},React.createElement("li",null,React.createElement("small",null,"Value"),C?.earnings??""),React.createElement("li",null,React.createElement("small",null,"Orders"),C?.orders??""))):React.createElement("div",{className:"ts-no-posts"},g(e.chart_icon)||React.createElement(w,null),React.createElement("p",null,"No activity")),React.createElement("div",{className:"ts-chart-nav"},React.createElement("p",null,c.meta.label),React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),c.meta.state.has_prev&&k("prev")},className:`ts-icon-btn${c.meta.state.has_prev?"":" vx-disabled"}`},g(e.ts_chevron_left)||React.createElement(V,null)),React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),c.meta.state.has_next&&k("next")},className:`ts-icon-btn${c.meta.state.has_next?"":" vx-disabled"}`},g(e.ts_chevron_right)||React.createElement(D,null)))),!c&&React.createElement("div",{className:"ts-chart"},React.createElement("div",{className:"ts-no-posts"},g(e.chart_icon)||React.createElement(w,null),React.createElement("p",null,"No chart data available")))))}function j(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const r=e.getAttribute("href");if(r)return r}}if(typeof window<"u"&&window.location?.origin){const e=window.location.pathname.split("/").filter(Boolean),r=["wp-admin","wp-content","wp-includes","wp-json"];return e.length>0&&!r.includes(e[0])?window.location.origin+"/"+e[0]+"/wp-json/":window.location.origin+"/wp-json/"}return"/wp-json/"}function I(e){const r=(t,u)=>typeof t=="string"?t:typeof t=="number"?String(t):u,s=t=>typeof t=="string"&&["this-week","this-month","this-year","all-time"].includes(t)?t:"this-week",o=t=>{const u=t&&typeof t=="object"?t:{};return{library:r(u.library,""),value:r(u.value,"")}};return{activeChart:s(e.activeChart??e.active_chart??e.ts_active_chart),chartIcon:o(e.chartIcon??e.chart_icon),chevronRight:o(e.chevronRight??e.chevron_right??e.ts_chevron_right),chevronLeft:o(e.chevronLeft??e.chevron_left??e.ts_chevron_left)}}function H(e){const r=e.querySelector("script.vxconfig");if(!r||!r.textContent)return console.error("[SalesChart] vxconfig script not found"),null;try{const s=JSON.parse(r.textContent);return I(s)}catch(s){return console.error("[SalesChart] Failed to parse vxconfig:",s),null}}function P(e){return{ts_active_chart:e.activeChart,chart_icon:e.chartIcon,ts_chevron_right:e.chevronRight,ts_chevron_left:e.chevronLeft}}function T(e,r="error"){const s=window,o=s.Voxel_Config?.l10n?.ajaxError||"An error occurred",t=e||o;s.Voxel?.alert?s.Voxel.alert(t,r):r==="error"?console.error("[SalesChart]",t):console.log("[SalesChart]",t)}async function O(){try{const e=window.wpApiSettings||{},r=j(),s=e.nonce||"",o={"Content-Type":"application/json"};s&&(o["X-WP-Nonce"]=s);const t=await fetch(`${r}voxel-fse/v1/sales-chart`,{credentials:"same-origin",headers:o});if(!t.ok)throw new Error(`HTTP ${t.status}`);return await t.json()}catch(e){const r=e instanceof Error?e.message:void 0;return T(r,"error"),null}}async function R(e){if(e.hasAttribute("data-react-mounted"))return;const r=H(e);if(!r)return;e.setAttribute("data-react-mounted","true");const s=P(r),o=A.createRoot(e);o.render(a.createElement(L,{attributes:s,config:null,isLoading:!0,error:null,context:"frontend"}));const t=await O();o.render(a.createElement(L,{attributes:s,config:t,isLoading:!1,error:null,context:"frontend"}))}function m(){document.querySelectorAll(".voxel-fse-sales-chart").forEach(r=>{R(r)})}return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m(),document.addEventListener("turbo:load",m),document.addEventListener("turbo:render",m),document.addEventListener("voxel:markup-update",m),p.initAllSalesCharts=m,p.initSalesChart=R,Object.defineProperty(p,Symbol.toStringTag,{value:"Module"}),p})({},React,ReactDOM);
