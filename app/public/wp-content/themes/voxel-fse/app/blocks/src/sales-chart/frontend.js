var VoxelFSESalesChart=(function(v,a,A){"use strict";const E=()=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor"},a.createElement("path",{d:"M3 12H5V21H3V12ZM19 8H21V21H19V8ZM11 2H13V21H11V2Z"})),D=()=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor"},a.createElement("path",{d:"M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"})),V=()=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor"},a.createElement("path",{d:"M13.1714 12.0007L8.22168 7.05093L9.63589 5.63672L15.9999 12.0007L9.63589 18.3646L8.22168 16.9504L13.1714 12.0007Z"}));function p(e){return!e||!e.value?null:e.library==="icon"?a.createElement("i",{className:e.value}):e.library==="svg"?a.createElement("img",{src:e.value,alt:"",className:"voxel-fse-icon-svg",style:{width:"1em",height:"1em"}}):null}function _(e,r="error"){const s=window,c=s.Voxel_Config?.l10n?.ajaxError||"An error occurred",t=e||c;s.Voxel?.alert?s.Voxel.alert(t,r):r==="error"?console.error("[SalesChart]",t):console.log("[SalesChart]",t)}function y({attributes:e,config:r,isLoading:s,error:c}){const[t,i]=a.useState(e.ts_active_chart),[f,x]=a.useState(r?.charts??null),[C,S]=a.useState(null),[L,b]=a.useState(!1),g=a.useRef(null),N=a.useRef(null),B=a.useRef({isDown:!1,startX:0,scrollLeft:0});a.useEffect(()=>{r?.charts&&x(r.charts)},[r]),a.useEffect(()=>{i(e.ts_active_chart)},[e.ts_active_chart]),a.useEffect(()=>{c&&_(c,"error")},[c]);const l=f?f[t]:null,X=a.useCallback((n,o)=>{if(S(o),g.current){const u=n.currentTarget.getBoundingClientRect();g.current.style.left=`${u.left+u.width+10}px`,g.current.style.top=`${u.top}px`}},[]),U=a.useCallback(()=>{S(null)},[]),k=a.useCallback(async n=>{if(!(!l||L)){b(!0);try{const o=window.wpApiSettings?.root||"/wp-json/",u=new URLSearchParams({chart:t,date:l.meta.state.date??"",direction:n}),m=await fetch(`${o}voxel-fse/v1/sales-chart/load-more?${u.toString()}`);if(!m.ok)throw new Error(`HTTP ${m.status}`);const d=await m.json();d&&f&&x({...f,[t]:d})}catch(o){const u=o instanceof Error?o.message:void 0;_(u,"error")}finally{b(!1)}}},[t,l,L,f]);if(a.useEffect(()=>{const n=N.current;if(!n)return;const o=B.current,u=w=>{o.isDown=!0,o.startX=w.pageX-n.offsetLeft,o.scrollLeft=n.scrollLeft},m=()=>{o.isDown=!1},d=()=>{o.isDown=!1},M=w=>{if(!o.isDown)return;w.preventDefault();const z=w.pageX-n.offsetLeft-o.startX;n.scrollLeft=o.scrollLeft-z};return n.addEventListener("mousedown",u),n.addEventListener("mouseup",m),n.addEventListener("mouseleave",d),n.addEventListener("mousemove",M),()=>{n.removeEventListener("mousedown",u),n.removeEventListener("mouseup",m),n.removeEventListener("mouseleave",d),n.removeEventListener("mousemove",M)}},[t]),s)return React.createElement("div",{className:"ts-vendor-stats"},React.createElement("div",{className:"ts-no-posts"},React.createElement(E,null),React.createElement("p",null,"Loading chart data...")));const Z={activeChart:e.ts_active_chart,chartIcon:e.chart_icon,chevronRight:e.ts_chevron_right,chevronLeft:e.ts_chevron_left};return React.createElement(React.Fragment,null,React.createElement("script",{type:"application/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(Z)}}),React.createElement("div",{className:"ts-vendor-stats"},React.createElement("ul",{className:"ts-generic-tabs simplify-ul flexify bar-chart-tabs"},React.createElement("li",{className:t==="this-week"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),i("this-week")}},"Week")),React.createElement("li",{className:t==="this-month"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),i("this-month")}},"Month")),React.createElement("li",{className:t==="this-year"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),i("this-year")}},"Year")),React.createElement("li",{className:t==="all-time"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),i("all-time")}},"All time"))),l&&React.createElement("div",{className:`ts-chart chart-${t}${L?" vx-pending":""}`,key:t},l.meta.state.has_activity?React.createElement("div",{className:"chart-contain"},React.createElement("div",{className:"chart-content"},React.createElement("div",{className:"bar-item-con bar-values"},l.steps.map((n,o)=>React.createElement("span",{key:o},n)))),React.createElement("div",{className:"chart-content min-scroll min-scroll-h",ref:N},l.items.map((n,o)=>React.createElement("div",{key:o,className:"bar-item-con"},React.createElement("div",{className:"bi-hold"},React.createElement("div",{className:"bar-item bar-animate",style:{height:`${n.percent}%`},onMouseOver:u=>X(u,{label:n.label,earnings:n.earnings,orders:n.orders}),onMouseLeave:U})),React.createElement("span",null,n.label)))),React.createElement("ul",{ref:g,className:`flexify simplify-ul bar-item-data${C?" active":""}`},React.createElement("li",null,React.createElement("small",null,"Value"),C?.earnings??""),React.createElement("li",null,React.createElement("small",null,"Orders"),C?.orders??""))):React.createElement("div",{className:"ts-no-posts"},p(e.chart_icon)||React.createElement(E,null),React.createElement("p",null,"No activity")),React.createElement("div",{className:"ts-chart-nav"},React.createElement("p",null,l.meta.label),React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),l.meta.state.has_prev&&k("prev")},className:`ts-icon-btn${l.meta.state.has_prev?"":" vx-disabled"}`},p(e.ts_chevron_left)||React.createElement(D,null)),React.createElement("a",{href:"#",onClick:n=>{n.preventDefault(),l.meta.state.has_next&&k("next")},className:`ts-icon-btn${l.meta.state.has_next?"":" vx-disabled"}`},p(e.ts_chevron_right)||React.createElement(V,null)))),!l&&React.createElement("div",{className:"ts-chart"},React.createElement("div",{className:"ts-no-posts"},p(e.chart_icon)||React.createElement(E,null),React.createElement("p",null,"No chart data available")))))}function j(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const r=e.getAttribute("href");if(r)return r}}if(typeof window<"u"&&window.location?.origin){const e=window.location.pathname.split("/").filter(Boolean),r=["wp-admin","wp-content","wp-includes","wp-json"];return e.length>0&&!r.includes(e[0])?window.location.origin+"/"+e[0]+"/wp-json/":window.location.origin+"/wp-json/"}return"/wp-json/"}function I(e){const r=(t,i)=>typeof t=="string"?t:typeof t=="number"?String(t):i,s=t=>typeof t=="string"&&["this-week","this-month","this-year","all-time"].includes(t)?t:"this-week",c=t=>{const i=t&&typeof t=="object"?t:{};return{library:r(i.library,""),value:r(i.value,"")}};return{activeChart:s(e.activeChart??e.active_chart??e.ts_active_chart),chartIcon:c(e.chartIcon??e.chart_icon),chevronRight:c(e.chevronRight??e.chevron_right??e.ts_chevron_right),chevronLeft:c(e.chevronLeft??e.chevron_left??e.ts_chevron_left)}}function H(e){const r=e.querySelector("script.vxconfig");if(!r||!r.textContent)return console.error("[SalesChart] vxconfig script not found"),null;try{const s=JSON.parse(r.textContent);return I(s)}catch(s){return console.error("[SalesChart] Failed to parse vxconfig:",s),null}}function P(e){return{ts_active_chart:e.activeChart,chart_icon:e.chartIcon,ts_chevron_right:e.chevronRight,ts_chevron_left:e.chevronLeft}}function T(e,r="error"){const s=window,c=s.Voxel_Config?.l10n?.ajaxError||"An error occurred",t=e||c;s.Voxel?.alert?s.Voxel.alert(t,r):r==="error"?console.error("[SalesChart]",t):console.log("[SalesChart]",t)}async function O(){try{const e=window.wpApiSettings||{},r=j(),s=e.nonce||"",c={"Content-Type":"application/json"};s&&(c["X-WP-Nonce"]=s);const t=await fetch(`${r}voxel-fse/v1/sales-chart`,{credentials:"same-origin",headers:c});if(!t.ok)throw new Error(`HTTP ${t.status}`);return await t.json()}catch(e){const r=e instanceof Error?e.message:void 0;return T(r,"error"),null}}async function R(e){if(e.hasAttribute("data-react-mounted"))return;const r=H(e);if(!r)return;e.setAttribute("data-react-mounted","true");const s=P(r),c=A.createRoot(e);c.render(a.createElement(y,{attributes:s,config:null,isLoading:!0,error:null,context:"frontend"}));const t=await O();c.render(a.createElement(y,{attributes:s,config:t,isLoading:!1,error:null,context:"frontend"}))}function h(){document.querySelectorAll(".voxel-fse-sales-chart").forEach(r=>{R(r)})}return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",h):h(),document.addEventListener("turbo:load",h),document.addEventListener("turbo:render",h),document.addEventListener("voxel:markup-update",h),v.initAllSalesCharts=h,v.initSalesChart=R,Object.defineProperty(v,Symbol.toStringTag,{value:"Module"}),v})({},React,ReactDOM);
