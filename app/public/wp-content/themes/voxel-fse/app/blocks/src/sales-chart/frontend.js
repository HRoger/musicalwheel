var VoxelFSESalesChart=(function(v,r,A){"use strict";const p=()=>r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor"},r.createElement("path",{d:"M3 12H5V21H3V12ZM19 8H21V21H19V8ZM11 2H13V21H11V2Z"})),D=()=>r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor"},r.createElement("path",{d:"M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"})),M=()=>r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor"},r.createElement("path",{d:"M13.1714 12.0007L8.22168 7.05093L9.63589 5.63672L15.9999 12.0007L9.63589 18.3646L8.22168 16.9504L13.1714 12.0007Z"}));function g(e){return!e||!e.value?null:e.library==="icon"?r.createElement("i",{className:e.value}):e.library==="svg"?r.createElement("img",{src:e.value,alt:"",className:"voxel-fse-icon-svg",style:{width:"1em",height:"1em"}}):null}function R({attributes:e,config:a,isLoading:s,error:o}){const[n,i]=r.useState(e.ts_active_chart),[f,C]=r.useState(a?.charts??null),[y,S]=r.useState(null),[L,b]=r.useState(!1),E=r.useRef(null),x=r.useRef(null),O=r.useRef({isDown:!1,startX:0,scrollLeft:0});r.useEffect(()=>{a?.charts&&C(a.charts)},[a]),r.useEffect(()=>{i(e.ts_active_chart)},[e.ts_active_chart]);const l=f?f[n]:null,B=r.useCallback((t,c)=>{if(S(c),E.current){const u=t.currentTarget.getBoundingClientRect();E.current.style.left=`${u.left+u.width+10}px`,E.current.style.top=`${u.top}px`}},[]),X=r.useCallback(()=>{S(null)},[]),N=r.useCallback(async t=>{if(!(!l||L)){b(!0);try{const c=window.wpApiSettings?.root||"/wp-json/",u=new URLSearchParams({chart:n,date:l.meta.state.date??"",direction:t}),m=await fetch(`${c}voxel-fse/v1/sales-chart/load-more?${u.toString()}`);if(!m.ok)throw new Error(`HTTP ${m.status}`);const d=await m.json();d&&f&&C({...f,[n]:d})}catch(c){console.error("[SalesChart] Load more failed:",c)}finally{b(!1)}}},[n,l,L,f]);if(r.useEffect(()=>{const t=x.current;if(!t)return;const c=O.current,u=w=>{c.isDown=!0,c.startX=w.pageX-t.offsetLeft,c.scrollLeft=t.scrollLeft},m=()=>{c.isDown=!1},d=()=>{c.isDown=!1},k=w=>{if(!c.isDown)return;w.preventDefault();const Z=w.pageX-t.offsetLeft-c.startX;t.scrollLeft=c.scrollLeft-Z};return t.addEventListener("mousedown",u),t.addEventListener("mouseup",m),t.addEventListener("mouseleave",d),t.addEventListener("mousemove",k),()=>{t.removeEventListener("mousedown",u),t.removeEventListener("mouseup",m),t.removeEventListener("mouseleave",d),t.removeEventListener("mousemove",k)}},[n]),s)return React.createElement("div",{className:"ts-vendor-stats"},React.createElement("div",{className:"ts-no-posts"},React.createElement(p,null),React.createElement("p",null,"Loading chart data...")));if(o)return React.createElement("div",{className:"ts-vendor-stats"},React.createElement("div",{className:"ts-no-posts"},React.createElement(p,null),React.createElement("p",null,o)));const F={activeChart:e.ts_active_chart,chartIcon:e.chart_icon,chevronRight:e.ts_chevron_right,chevronLeft:e.ts_chevron_left};return React.createElement(React.Fragment,null,React.createElement("script",{type:"application/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(F)}}),React.createElement("div",{className:"ts-vendor-stats"},React.createElement("ul",{className:"ts-generic-tabs simplify-ul flexify bar-chart-tabs"},React.createElement("li",{className:n==="this-week"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),i("this-week")}},"Week")),React.createElement("li",{className:n==="this-month"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),i("this-month")}},"Month")),React.createElement("li",{className:n==="this-year"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),i("this-year")}},"Year")),React.createElement("li",{className:n==="all-time"?"ts-tab-active":""},React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),i("all-time")}},"All time"))),l&&React.createElement("div",{className:`ts-chart chart-${n}${L?" vx-pending":""}`,key:n},l.meta.state.has_activity?React.createElement("div",{className:"chart-contain"},React.createElement("div",{className:"chart-content"},React.createElement("div",{className:"bar-item-con bar-values"},l.steps.map((t,c)=>React.createElement("span",{key:c},t)))),React.createElement("div",{className:"chart-content min-scroll min-scroll-h",ref:x},l.items.map((t,c)=>React.createElement("div",{key:c,className:"bar-item-con"},React.createElement("div",{className:"bi-hold"},React.createElement("div",{className:"bar-item bar-animate",style:{height:`${t.percent}%`},onMouseOver:u=>B(u,{label:t.label,earnings:t.earnings,orders:t.orders}),onMouseLeave:X})),React.createElement("span",null,t.label)))),React.createElement("ul",{ref:E,className:`flexify simplify-ul bar-item-data${y?" active":""}`},React.createElement("li",null,React.createElement("small",null,"Value"),y?.earnings??""),React.createElement("li",null,React.createElement("small",null,"Orders"),y?.orders??""))):React.createElement("div",{className:"ts-no-posts"},g(e.chart_icon)||React.createElement(p,null),React.createElement("p",null,"No activity")),React.createElement("div",{className:"ts-chart-nav"},React.createElement("p",null,l.meta.label),React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),l.meta.state.has_prev&&N("prev")},className:`ts-icon-btn${l.meta.state.has_prev?"":" vx-disabled"}`},g(e.ts_chevron_left)||React.createElement(D,null)),React.createElement("a",{href:"#",onClick:t=>{t.preventDefault(),l.meta.state.has_next&&N("next")},className:`ts-icon-btn${l.meta.state.has_next?"":" vx-disabled"}`},g(e.ts_chevron_right)||React.createElement(M,null)))),!l&&React.createElement("div",{className:"ts-chart"},React.createElement("div",{className:"ts-no-posts"},g(e.chart_icon)||React.createElement(p,null),React.createElement("p",null,"No chart data available")))))}function U(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root.replace(/\/wp-json\/?$/,"")+"?vx=1";if(typeof document<"u"){const e=document.querySelector('link[rel="https://api.w.org/"]');if(e){const a=e.getAttribute("href");if(a)return a.replace(/\/wp-json\/?$/,"")+"?vx=1"}}return typeof window<"u"?window.location.origin+"?vx=1":"/?vx=1"}function j(){const e=U();try{return new URL(e).pathname.replace(/\/$/,"")}catch{return""}}function I(){if(typeof window<"u"&&window.wpApiSettings?.root)return window.wpApiSettings.root;if(typeof document<"u"){const a=document.querySelector('link[rel="https://api.w.org/"]');if(a){const s=a.getAttribute("href");if(s)return s}}const e=j();return typeof window<"u"?window.location.origin+e+"/wp-json/":"/wp-json/"}function H(e){const a=(n,i)=>typeof n=="string"?n:typeof n=="number"?String(n):i,s=n=>typeof n=="string"&&["this-week","this-month","this-year","all-time"].includes(n)?n:"this-week",o=n=>{const i=n&&typeof n=="object"?n:{};return{library:a(i.library,""),value:a(i.value,"")}};return{activeChart:s(e.activeChart??e.active_chart??e.ts_active_chart),chartIcon:o(e.chartIcon??e.chart_icon),chevronRight:o(e.chevronRight??e.chevron_right??e.ts_chevron_right),chevronLeft:o(e.chevronLeft??e.chevron_left??e.ts_chevron_left)}}function P(e){const a=e.querySelector("script.vxconfig");if(!a||!a.textContent)return console.error("[SalesChart] vxconfig script not found"),null;try{const s=JSON.parse(a.textContent);return H(s)}catch(s){return console.error("[SalesChart] Failed to parse vxconfig:",s),null}}function V(e){return{ts_active_chart:e.activeChart,chart_icon:e.chartIcon,ts_chevron_right:e.chevronRight,ts_chevron_left:e.chevronLeft}}async function T(){try{const e=window.wpApiSettings||{},a=I(),s=e.nonce||"",o={"Content-Type":"application/json"};s&&(o["X-WP-Nonce"]=s);const n=await fetch(`${a}voxel-fse/v1/sales-chart`,{credentials:"same-origin",headers:o});if(!n.ok)throw new Error(`HTTP ${n.status}`);return await n.json()}catch(e){return console.error("[SalesChart] Failed to fetch chart data:",e),null}}async function _(e){if(e.hasAttribute("data-react-mounted"))return;const a=P(e);if(!a)return;e.setAttribute("data-react-mounted","true");const s=V(a),o=A.createRoot(e);o.render(r.createElement(R,{attributes:s,config:null,isLoading:!0,error:null,context:"frontend"}));const n=await T();o.render(r.createElement(R,{attributes:s,config:n,isLoading:!1,error:n?null:"Failed to load chart data",context:"frontend"}))}function h(){document.querySelectorAll(".voxel-fse-sales-chart").forEach(a=>{_(a)})}return document.readyState==="loading"?document.addEventListener("DOMContentLoaded",h):h(),document.addEventListener("turbo:load",h),document.addEventListener("turbo:render",h),document.addEventListener("voxel:markup-update",h),v.initAllSalesCharts=h,v.initSalesChart=_,Object.defineProperty(v,Symbol.toStringTag,{value:"Module"}),v})({},React,ReactDOM);
