(function(){"use strict";function _(t){const o=(e,i)=>typeof e=="string"?e:i,a=(e,i)=>{if(typeof e=="number")return e;if(typeof e=="string"){const s=parseFloat(e);if(!isNaN(s))return s}return i},c=(e,i)=>typeof e=="boolean"?e:e==="true"||e==="1"||e===1||e==="yes"?!0:e==="false"||e==="0"||e===0||e==="no"||e===""?!1:i,r=e=>({id:o(e.id??e.item_id,""),title:o(e.title??e.item_title,""),cssId:o(e.cssId??e.css_id??e.element_css_id,""),loop:e.loop??e._voxel_loop,visibility:e.visibility}),d=t.items??t.accordion_items??[],m=Array.isArray(d)?d.map(e=>r(e)):[],l=t.interactions??{},y={defaultState:o(l.defaultState??t.defaultState??t.default_state,"all_collapsed"),maxItemsExpanded:o(l.maxItemsExpanded??t.maxItemsExpanded??t.max_items_expended,"one"),animationDuration:a(l.animationDuration??t.animationDuration??t.n_accordion_animation_duration,400)},p=t.icons??{},h={expand:p.expand??t.expandIcon??t.accordion_item_title_icon??null,collapse:p.collapse??t.collapseIcon??t.accordion_item_title_icon_active??null,position:o(p.position??t.iconPosition??t.accordion_item_title_icon_position,"end")},n=o(t.titleTag??t.title_tag,"div"),u=c(t.faqSchema??t.faq_schema,!1);return{items:m,interactions:y,icons:h,titleTag:n,faqSchema:u}}function A(t){const o=t.dataset.vxconfig;if(o)try{const a=JSON.parse(o);return _(a)}catch(a){console.error("[NestedAccordion] Failed to parse vxconfig:",a)}return null}function g(t,o,a){const c=t.querySelector(".e-n-accordion-item-content");if(!c)return;const r=o?0:c.scrollHeight,d=o?c.scrollHeight:0;c.style.overflow="hidden";const m=c.animate([{height:`${r}px`},{height:`${d}px`}],{duration:a,easing:"ease-out",fill:"forwards"});m.onfinish=()=>{c.style.overflow="",c.style.height="",o||(t.open=!1)}}function E(t){const o=A(t);if(!o){console.error("[NestedAccordion] No vxconfig found");return}if(!t.querySelector(".e-n-accordion"))return;const c=Array.from(t.querySelectorAll(".e-n-accordion-item")),r=Array.from(t.querySelectorAll(".e-n-accordion-item-title")),d=o.interactions.animationDuration||400,m=o.interactions.maxItemsExpanded||"one",l=new Set(c.filter(n=>n.open));function y(n,u){const e=n.querySelector(".e-n-accordion-item-title"),i=n.open,s=u!==void 0?u:!i;s!==i&&(s?(m==="one"&&l.forEach(f=>{f!==n&&(f.querySelector(".e-n-accordion-item-title")?.setAttribute("aria-expanded","false"),g(f,!1,d),l.delete(f))}),n.open=!0,e?.setAttribute("aria-expanded","true"),g(n,!0,d),l.add(n)):(e?.setAttribute("aria-expanded","false"),g(n,!1,d),l.delete(n)))}function p(n){n.preventDefault();const e=n.currentTarget.closest("details");e&&y(e)}function h(n){const u=n.target,e=r.indexOf(u);if(e===-1)return;let i=e;switch(n.key){case"ArrowDown":n.preventDefault(),i=(e+1)%r.length;break;case"ArrowUp":n.preventDefault(),i=(e-1+r.length)%r.length;break;case"Home":n.preventDefault(),i=0;break;case"End":n.preventDefault(),i=r.length-1;break;case"Escape":{n.preventDefault();const s=u.closest("details");s?.open&&y(s,!1);return}case"Enter":case" ":return;default:return}r.forEach((s,f)=>{s.setAttribute("tabindex",f===i?"0":"-1")}),r[i]?.focus()}r.forEach(n=>{n.addEventListener("click",p),n.addEventListener("keydown",h)}),t.dataset.initialized="true"}function x(){document.querySelectorAll(".vxfse-nested-accordion:not([data-initialized])").forEach(E)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",x):x(),window.addEventListener("turbo:load",x),window.addEventListener("pjax:complete",x)})();
