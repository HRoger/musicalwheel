import _,{useRef as s,useState as j,useCallback as G,useEffect as g}from"react";import{createPortal as K}from"react-dom";function ee({isOpen:t,target:u,title:p="",icon:d,saveLabel:v="Save",clearLabel:R="Clear",showClear:o=!0,showSave:n=!0,onSave:w,onClear:a,onClose:r,children:y,className:N="",popupStyle:b}){const k=s(null),m=s(null),[$,A]=j({position:"absolute",top:"-9999px",left:"-9999px"}),B=s(""),E=G((e=!1)=>{if(!m.current||!u.current||!k.current)return;const c=u.current,i=k.current,f=m.current,S=document.body.clientWidth,l=c.getBoundingClientRect(),M=c.offsetWidth,h={left:l.left+window.pageXOffset,top:l.top+window.pageYOffset},H=i.getBoundingClientRect(),O=window.getComputedStyle(f),D=parseFloat(O.minWidth)||0,C=f.querySelector(".pika-single");let x;if(C){const Z=C.classList.contains("is-range")||C.querySelectorAll(".pika-lendar").length>1||f.closest(".ts-booking-date-range")!==null;x=Math.max(Z?640:420,D)}else x=Math.max(l.width,D);const T=h.left+M/2,X=S/2;let F;T>X+1?F=h.left-x+M:F=h.left;const J=window.innerHeight,P=H.height;let W=h.top+l.height;const V=l.bottom+P>J,Y=l.top-P>=0;V&&Y&&(W=h.top-P);const z={top:`${W}px`,left:`${F}px`,width:`${x}px`,position:"absolute"},I=JSON.stringify(z);I!==B.current&&(B.current=I,e?A(z):requestAnimationFrame(()=>A(z)))},[u]);if(g(()=>{if(!t)return;const e=i=>{const f=i.target;if(m.current?.contains(f))return;const S=[".interface-interface-skeleton__sidebar",".block-editor-block-inspector",".components-popover",".components-modal__screen-overlay",".edit-post-sidebar"];for(const l of S)if(f.closest(l))return;r()},c=requestAnimationFrame(()=>{document.addEventListener("mousedown",e)});return()=>{cancelAnimationFrame(c),document.removeEventListener("mousedown",e)}},[t,r]),g(()=>{if(!t)return;const e=c=>{c.key==="Escape"&&r()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,r]),g(()=>{if(!t)return;E(!0);const e=()=>E();window.addEventListener("scroll",e,!0);const c=()=>E();window.addEventListener("resize",c,!0);let i=null;return m.current&&(i=new ResizeObserver(()=>E(!0)),i.observe(m.current)),()=>{window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",c,!0),i?.disconnect()}},[t,E]),!t)return null;const L=()=>React.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M14 1.41L12.59 0L7 5.59L1.41 0L0 1.41L5.59 7L0 12.59L1.41 14L7 8.41L12.59 14L14 12.59L8.41 7L14 1.41Z",fill:"currentColor"})),q=()=>React.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z",fill:"currentColor"}));return K(React.createElement("div",{className:`elementor vx-popup ${N}`.trim()},React.createElement("div",{className:"ts-popup-root elementor-element"},React.createElement("div",{className:"ts-form elementor-element",style:$,ref:k},React.createElement("div",{className:"ts-field-popup-container"},React.createElement("div",{className:"ts-field-popup triggers-blur",ref:m,style:b},p&&React.createElement("div",{className:"ts-popup-head flexify ts-sticky-top"},React.createElement("div",{className:"ts-popup-name flexify"},d&&React.createElement("span",{dangerouslySetInnerHTML:{__html:d}}),React.createElement("span",null,p)),React.createElement("ul",{className:"flexify simplify-ul"},React.createElement("li",{className:"flexify ts-popup-close"},React.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),r()},className:"ts-icon-btn","aria-label":"Close"},React.createElement(L,null))))),React.createElement("div",{className:"ts-popup-content-wrapper min-scroll"},y),n||o?React.createElement("div",{className:"ts-popup-controller"},React.createElement("ul",{className:"flexify simplify-ul"},React.createElement("li",{className:"flexify ts-popup-close"},React.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),r()},className:"ts-icon-btn","aria-label":"Close"},React.createElement(L,null))),o&&a&&React.createElement("li",{className:"flexify hide-d",onClick:e=>{e.preventDefault(),a()}},React.createElement("a",{href:"#",className:"ts-icon-btn"},React.createElement(q,null))),o&&a&&React.createElement("li",{className:"flexify hide-m",onClick:e=>{e.preventDefault(),a()}},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1"},R)),n&&React.createElement("li",{className:"flexify"},React.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),w()},className:"ts-btn ts-btn-2"},v)))):React.createElement("div",{className:"ts-popup-controller hide-d"},React.createElement("ul",{className:"flexify simplify-ul"},React.createElement("li",{className:"flexify ts-popup-close"},React.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),r()},className:"ts-icon-btn","aria-label":"Close"},React.createElement(L,null)))))))))),document.body)}const te=({value:t,onChange:u,onSelect:p,pickerConfig:d,onPickerReady:v})=>{const R=s(null),o=s(null),n=s(null),w=s(u),a=s(p);w.current=u,a.current=p,g(()=>{if(!R.current||!o.current)return;const y=window.Pikaday;if(!y){console.error("Pikaday not loaded - window.Pikaday is undefined");return}const N=requestAnimationFrame(()=>{n.current=new y({field:o.current,container:R.current,bound:!1,firstDay:1,keyboardInput:!1,defaultDate:t||void 0,onSelect:b=>{w.current(b),a.current&&a.current(b)},...d}),v&&n.current&&v(n.current)});return()=>{cancelAnimationFrame(N),setTimeout(()=>{n.current?.destroy(),n.current=null},200)}},[]),g(()=>{n.current&&(t&&n.current.setDate(t,!0),n.current.draw(!0))},[t]);const r=d?.numberOfMonths>=2;return _.createElement("div",{className:`ts-booking-date ts-form-group${r?" ts-booking-date-range":""}`,ref:R},_.createElement("input",{type:"hidden",ref:o}))};export{te as D,ee as F};
