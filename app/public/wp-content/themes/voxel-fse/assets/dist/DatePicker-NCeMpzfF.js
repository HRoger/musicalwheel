import I,{useRef as s,useState as j,useCallback as G,useEffect as h}from"react";import{createPortal as K}from"react-dom";function ee({isOpen:t,target:u,title:p="",icon:g,saveLabel:v="Save",clearLabel:d="Clear",showClear:o=!0,showSave:n=!0,onSave:w,onClear:a,onClose:r,children:k,className:y="",popupStyle:_}){const x=s(null),m=s(null),[q,z]=j({position:"absolute",top:"-9999px",left:"-9999px"}),A=s(""),R=G((e=!1)=>{if(!m.current||!u.current||!x.current)return;const c=u.current,i=x.current,f=m.current,L=document.body.clientWidth,l=c.getBoundingClientRect(),B=c.offsetWidth,E={left:l.left+window.pageXOffset,top:l.top+window.pageYOffset},H=i.getBoundingClientRect(),O=window.getComputedStyle(f),S=parseFloat(O.minWidth)||0,D=f.querySelector(".pika-single");let b;if(D){const Z=D.classList.contains("is-range")||D.querySelectorAll(".pika-lendar").length>1||f.closest(".ts-booking-date-range")!==null;b=Math.max(Z?640:420,S)}else b=Math.max(l.width,S);const T=E.left+B/2,X=L/2;let C;T>X+1?C=E.left-b+B:C=E.left;const J=window.innerHeight,F=H.height;let M=E.top+l.height;const V=l.bottom+F>J,Y=l.top-F>=0;V&&Y&&(M=E.top-F);const P={top:`${M}px`,left:`${C}px`,width:`${b}px`,position:"absolute"},W=JSON.stringify(P);W!==A.current&&(A.current=W,e?z(P):requestAnimationFrame(()=>z(P)))},[u]);if(h(()=>{if(!t)return;const e=i=>{const f=i.target;if(m.current?.contains(f))return;const L=[".interface-interface-skeleton__sidebar",".block-editor-block-inspector",".components-popover",".components-modal__screen-overlay",".edit-post-sidebar"];for(const l of L)if(f.closest(l))return;r()},c=requestAnimationFrame(()=>{document.addEventListener("mousedown",e)});return()=>{cancelAnimationFrame(c),document.removeEventListener("mousedown",e)}},[t,r]),h(()=>{if(!t)return;const e=c=>{c.key==="Escape"&&r()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,r]),h(()=>{if(!t)return;R(!0);const e=()=>R();window.addEventListener("scroll",e,!0);const c=()=>R();window.addEventListener("resize",c,!0);let i=null;return m.current&&(i=new ResizeObserver(()=>R(!0)),i.observe(m.current)),()=>{window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",c,!0),i?.disconnect()}},[t,R]),!t)return null;const N=()=>React.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M14 1.41L12.59 0L7 5.59L1.41 0L0 1.41L5.59 7L0 12.59L1.41 14L7 8.41L12.59 14L14 12.59L8.41 7L14 1.41Z",fill:"currentColor"})),$=()=>React.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z",fill:"currentColor"}));return K(React.createElement("div",{className:`elementor vx-popup ${y}`.trim()},React.createElement("div",{className:"ts-popup-root elementor-element"},React.createElement("div",{className:"ts-form elementor-element",style:q,ref:x},React.createElement("div",{className:"ts-field-popup-container"},React.createElement("div",{className:"ts-field-popup triggers-blur",ref:m,style:_},p&&React.createElement("div",{className:"ts-popup-head flexify ts-sticky-top"},React.createElement("div",{className:"ts-popup-name flexify"},g&&React.createElement("span",{dangerouslySetInnerHTML:{__html:g}}),React.createElement("span",null,p)),React.createElement("ul",{className:"flexify simplify-ul"},React.createElement("li",{className:"flexify ts-popup-close"},React.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),r()},className:"ts-icon-btn","aria-label":"Close"},React.createElement(N,null))))),React.createElement("div",{className:"ts-popup-content-wrapper min-scroll"},k),n||o?React.createElement("div",{className:"ts-popup-controller"},React.createElement("ul",{className:"flexify simplify-ul"},React.createElement("li",{className:"flexify ts-popup-close"},React.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),r()},className:"ts-icon-btn","aria-label":"Close"},React.createElement(N,null))),o&&a&&React.createElement("li",{className:"flexify hide-d",onClick:e=>{e.preventDefault(),a()}},React.createElement("a",{href:"#",className:"ts-icon-btn"},React.createElement($,null))),o&&a&&React.createElement("li",{className:"flexify hide-m",onClick:e=>{e.preventDefault(),a()}},React.createElement("a",{href:"#",className:"ts-btn ts-btn-1"},d)),n&&React.createElement("li",{className:"flexify"},React.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),w()},className:"ts-btn ts-btn-2"},v)))):React.createElement("div",{className:"ts-popup-controller hide-d"},React.createElement("ul",{className:"flexify simplify-ul"},React.createElement("li",{className:"flexify ts-popup-close"},React.createElement("a",{href:"#",onClick:e=>{e.preventDefault(),r()},className:"ts-icon-btn","aria-label":"Close"},React.createElement(N,null)))))))))),document.body)}const te=({value:t,onChange:u,onSelect:p,pickerConfig:g,onPickerReady:v})=>{const d=s(null),o=s(null),n=s(null),w=s(u),a=s(p);return w.current=u,a.current=p,h(()=>{if(!d.current||!o.current)return;const r=window.Pikaday;if(!r){console.error("Pikaday not loaded - window.Pikaday is undefined");return}const k=requestAnimationFrame(()=>{n.current=new r({field:o.current,container:d.current,bound:!1,firstDay:1,keyboardInput:!1,numberOfMonths:2,defaultDate:t||void 0,onSelect:y=>{w.current(y),a.current&&a.current(y)},...g}),v&&n.current&&v(n.current)});return()=>{cancelAnimationFrame(k),setTimeout(()=>{n.current?.destroy(),n.current=null},200)}},[]),h(()=>{n.current&&(t&&n.current.setDate(t,!0),n.current.draw(!0))},[t]),I.createElement("div",{className:"ts-booking-date ts-booking-date-range ts-form-group",ref:d},I.createElement("input",{type:"hidden",ref:o}))};export{te as D,ee as F};
