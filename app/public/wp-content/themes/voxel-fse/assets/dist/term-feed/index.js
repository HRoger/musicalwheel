import{registerBlockType as ae}from"@wordpress/blocks";import{useBlockProps as Z,InspectorControls as te}from"@wordpress/block-editor";import{__ as l}from"@wordpress/i18n";import{useRef as re,useState as B,useCallback as P,useEffect as w}from"react";import N from"@wordpress/api-fetch";import{A as ee,a as F,k as D,R as S,o as q,E as ce,b as ie,C as M,B as de}from"../TypographyPopup-CAcEJ5NA.js";import{I as me}from"../InspectorTabs-Bq2wAh4W.js";import{SelectControl as $,TextControl as j,ToggleControl as J}from"@wordpress/components";import"@wordpress/data";/* empty css                            */import"../RepeaterControl-C7JnAhZL.js";import"../voxelShim-DB_Ue-9R.js";import{g as oe}from"../useAdvancedTabProps-BnJDQbKr.js";import{r as se}from"../backgroundElements-Ui-iCrLV.js";import{E as pe}from"../EmptyPlaceholder-BsL18qxN.js";import{r as X,V as K}from"../voxelIcons-B76o57vm.js";import{A as Q}from"../AdvancedIconControl-CJ_DCTeD.js";import{L as ve}from"../LoopElementModal-CaevVMh1.js";import{g as fe,R as ue,L as ye}from"../RepeaterControl-B_ulBkEL.js";import{V as ge}from"../VoxelGridIcon-D5dF5acW.js";import"react-dom";import"../generateAdvancedStyles-CRpLcHXt.js";import"../generateVoxelStyles-oZeaeuKH.js";const he="https://schemas.wp.org/trunk/block.json",Be=3,Ie="voxel-fse/term-feed",xe="1.0.0",Re="Term Feed (VX)",Ce="voxel-fse",Ee="Display taxonomy terms in a grid or carousel layout. FSE equivalent of Voxel's Term Feed widget.",Se=["term","taxonomy","feed","carousel","grid","voxel"],_e="voxel-fse",Te={html:!1,align:["wide","full"],anchor:!0,className:!0,customClassName:!0},Pe="file:./index.js",He="file:./frontend.js",ke="file:./render.php",ze={blockId:{type:"string",default:""},contentTabOpenPanel:{type:"string",default:"term-feed-settings"},styleTabOpenPanel:{type:"string",default:"carousel-navigation"},carouselNavState:{type:"string",default:"normal"},source:{type:"string",default:"filters",enum:["filters","manual"]},manualTerms:{type:"array",default:[],items:{type:"object",properties:{id:{type:"string"},term_id:{type:"number"},loopSource:{type:"string"},loopProperty:{type:"string"},loopLimit:{type:"string"},loopOffset:{type:"string"},rowVisibility:{type:"string"},visibilityRules:{type:"array",items:{type:"object"}}}}},taxonomy:{type:"string",default:""},parentTermId:{type:"number",default:0},order:{type:"string",default:"default",enum:["default","name"]},perPage:{type:"number",default:10},hideEmpty:{type:"boolean",default:!1},hideEmptyPostType:{type:"string",default:":all"},cardTemplate:{type:"string",default:"main"},layoutMode:{type:"string",default:"ts-feed-grid-default",enum:["ts-feed-grid-default","ts-feed-nowrap"]},carouselItemWidth:{type:"number",default:16},carouselItemWidth_tablet:{type:"number"},carouselItemWidth_mobile:{type:"number"},carouselItemWidthUnit:{type:"string",default:"%"},carouselAutoplay:{type:"boolean",default:!1},carouselAutoplayInterval:{type:"number",default:3e3},gridColumns:{type:"number",default:3},gridColumns_tablet:{type:"number"},gridColumns_mobile:{type:"number"},itemGap:{type:"number",default:20},itemGap_tablet:{type:"number"},itemGap_mobile:{type:"number"},scrollPadding:{type:"number",default:0},scrollPadding_tablet:{type:"number"},scrollPadding_mobile:{type:"number"},itemPadding:{type:"number",default:0},itemPadding_tablet:{type:"number"},itemPadding_mobile:{type:"number"},replaceAccentColor:{type:"boolean",default:!1},navHorizontalPosition:{type:"number"},navHorizontalPosition_tablet:{type:"number"},navHorizontalPosition_mobile:{type:"number"},navVerticalPosition:{type:"number"},navVerticalPosition_tablet:{type:"number"},navVerticalPosition_mobile:{type:"number"},navButtonIconColor:{type:"string",default:""},navButtonSize:{type:"number"},navButtonSize_tablet:{type:"number"},navButtonSize_mobile:{type:"number"},navButtonIconSize:{type:"number"},navButtonIconSize_tablet:{type:"number"},navButtonIconSize_mobile:{type:"number"},navButtonBackground:{type:"string",default:""},navBackdropBlur:{type:"number"},navBackdropBlur_tablet:{type:"number"},navBackdropBlur_mobile:{type:"number"},navBorderType:{type:"string",default:""},navBorderWidth:{type:"object",default:{}},navBorderColor:{type:"string",default:""},navBorderRadius:{type:"number"},navBorderRadius_tablet:{type:"number"},navBorderRadius_mobile:{type:"number"},navButtonSizeHover:{type:"number"},navButtonSizeHover_tablet:{type:"number"},navButtonSizeHover_mobile:{type:"number"},navButtonIconSizeHover:{type:"number"},navButtonIconSizeHover_tablet:{type:"number"},navButtonIconSizeHover_mobile:{type:"number"},navButtonIconColorHover:{type:"string",default:""},navButtonBackgroundHover:{type:"string",default:""},navButtonBorderColorHover:{type:"string",default:""},rightChevronIcon:{type:"object",default:{library:"",value:""}},leftChevronIcon:{type:"object",default:{library:"",value:""}},visibilityBehavior:{type:"string",default:"show",enum:["show","hide"]},visibilityRules:{type:"array",default:[],items:{type:"object"}},loopEnabled:{type:"boolean",default:!1},loopSource:{type:"string",default:""},loopProperty:{type:"string",default:""},loopLimit:{type:"string",default:""},loopOffset:{type:"string",default:""}},Y={$schema:he,apiVersion:Be,name:Ie,version:xe,title:Re,category:Ce,description:Ee,keywords:Se,textdomain:_e,supports:Te,editorScript:Pe,viewScript:He,render:ke,attributes:ze};function I(e,o,a,r,d="px"){const x=Array.isArray(r)?r:[r],m=[],T=[],u=[],y=R=>typeof d=="function"?d(R):`${R}${d}`;if(e[o]!==void 0&&e[o]!==""){const R=y(e[o]);m.push(`${a} { ${x.map(h=>`${h}: ${R}`).join("; ")}; }`)}const s=`${o}_tablet`;if(e[s]!==void 0&&e[s]!==""){const R=y(e[s]);T.push(`${a} { ${x.map(h=>`${h}: ${R}`).join("; ")}; }`)}const v=`${o}_mobile`;if(e[v]!==void 0&&e[v]!==""){const R=y(e[v]);u.push(`${a} { ${x.map(h=>`${h}: ${R}`).join("; ")}; }`)}let g=m.join(`
`);return T.length>0&&(g+=`
@media (max-width: 1024px) {
${T.join(`
`)}
}`),u.length>0&&(g+=`
@media (max-width: 767px) {
${u.join(`
`)}
}`),g}function ne(e,o){const a=[];a.push(`${o} { position: relative; max-width: 100%; min-width: 0; overflow: hidden; }`);const r=`${o} .post-feed-nav .ts-icon-btn`,d=`${o} .post-feed-nav .ts-icon-btn:hover`,x=`${o} .post-feed-nav li:first-child`,m=`${o} .post-feed-nav li:last-child`,T=`${o} .post-feed-nav li`;if(a.push(I(e,"navHorizontalPosition",x,"margin-left")),a.push(I(e,"navHorizontalPosition",m,"margin-right")),a.push(I(e,"navVerticalPosition",T,"margin-top")),e.navButtonIconColor&&a.push(`${r} { --ts-icon-color: ${e.navButtonIconColor}; color: ${e.navButtonIconColor}; }`),a.push(I(e,"navButtonSize",r,["width","height"])),a.push(I(e,"navButtonIconSize",r,"--ts-icon-size")),e.navButtonBackground&&a.push(`${r} { background-color: ${e.navButtonBackground}; }`),a.push(I(e,"navBackdropBlur",r,"backdrop-filter",y=>`blur(${y}px)`)),e.navBorderType&&e.navBorderType!=="none"){const{top:y,right:s,bottom:v,left:g}=e.navBorderWidth||{top:0,right:0,bottom:0,left:0};a.push(`${r} { border-style: ${e.navBorderType}; border-width: ${y}px ${s}px ${v}px ${g}px; border-color: ${e.navBorderColor}; }`)}a.push(I(e,"navBorderRadius",r,"border-radius")),a.push(I(e,"navButtonSizeHover",d,["width","height"])),a.push(I(e,"navButtonIconSizeHover",d,"--ts-icon-size")),e.navButtonIconColorHover&&a.push(`${d} { --ts-icon-color: ${e.navButtonIconColorHover}; color: ${e.navButtonIconColorHover}; }`),e.navButtonBackgroundHover&&a.push(`${d} { background-color: ${e.navButtonBackgroundHover}; }`),e.navButtonBorderColorHover&&a.push(`${d} { border-color: ${e.navButtonBorderColorHover}; }`);const u=`${o} .post-feed-grid`;if(a.push(I(e,"itemGap",u,"gap")),e.layoutMode==="ts-feed-grid-default")a.push(I(e,"gridColumns",u,"grid-template-columns",y=>`repeat(${y}, minmax(0, 1fr))`));else if(e.layoutMode==="ts-feed-nowrap"){a.push(I(e,"scrollPadding",u,["padding-left","padding-right","scroll-padding"]));const y=`${u} > div:last-of-type`;a.push(I(e,"scrollPadding",y,"margin-right"));const s=`${o} .ts-feed-nowrap .ts-preview`;a.push(I(e,"carouselItemWidth",s,["width","min-width","flex-basis"],v=>`${v}${e.carouselItemWidthUnit||"%"}`)),a.push(I(e,"itemPadding",s,"padding"))}return a.filter(Boolean).join(`
`)}function we(){return{}}function Le(e,o){const a={};return e.replaceAccentColor&&o&&(a["--e-global-color-accent"]=o),a}function $e(){return{navListItemStyle:{},navButtonStyle:{}}}function Ne({attributes:e,terms:o,isLoading:a,error:r,context:d,cssSelector:x}){const m=re(null),[T,u]=B(!1),[y,s]=B(!0),v=P(()=>{if(!m.current||e.layoutMode!=="ts-feed-nowrap")return;const t=m.current;u(Math.abs(t.scrollLeft)>10),s(t.scrollLeft+t.clientWidth+10<t.scrollWidth)},[e.layoutMode]);w(()=>{const t=m.current;if(!(!t||e.layoutMode!=="ts-feed-nowrap"))return requestAnimationFrame(()=>{if(!t)return;const p=t.scrollWidth>t.clientWidth;u(!1),s(p)}),t.addEventListener("scroll",v,{passive:!0}),window.addEventListener("resize",v),()=>{t.removeEventListener("scroll",v),window.removeEventListener("resize",v)}},[v,o,e.carouselItemWidth,e.itemGap,e.scrollPadding]);const g=P(t=>{t.preventDefault();const p=m.current;if(!p)return;const z=p.querySelector(".ts-preview")?.scrollWidth||300;p.scrollBy({left:-z,behavior:"smooth"})},[]),R=P(t=>{t.preventDefault();const p=m.current;if(!p)return;const z=p.querySelector(".ts-preview")?.scrollWidth||300;p.scrollBy({left:z,behavior:"smooth"})},[]);w(()=>{if(e.layoutMode!=="ts-feed-nowrap"||!e.carouselAutoplay||!m.current||d==="editor")return;const t=e.carouselAutoplayInterval||3e3;if(t<20)return;let p=!1;const k=m.current.closest(".voxel-fse-term-feed")||m.current,z=()=>{p=!0},W=()=>{p=!1};k?.addEventListener("mouseenter",z),k?.addEventListener("mouseleave",W);const G=setInterval(()=>{if(!p&&m.current){const O=m.current,b=O.querySelector(".ts-preview")?.scrollWidth||300;O.scrollBy({left:b,behavior:"smooth"})}},t);return()=>{clearInterval(G),k?.removeEventListener("mouseenter",z),k?.removeEventListener("mouseleave",W)}},[e.layoutMode,e.carouselAutoplay,e.carouselAutoplayInterval,d]);const h=P(t=>{if(d!=="editor")return;const p=t.target.closest("a");p&&!p.closest(".post-feed-nav")&&(t.preventDefault(),t.stopPropagation())},[d]),E={source:e.source,manualTermIds:e.manualTerms?.map(t=>t.term_id)||[],taxonomy:e.taxonomy,parentTermId:e.parentTermId,order:e.order,perPage:e.perPage,hideEmpty:e.hideEmpty,hideEmptyPostType:e.hideEmptyPostType,cardTemplate:e.cardTemplate,layoutMode:e.layoutMode,carouselItemWidth:e.carouselItemWidth,carouselItemWidthUnit:e.carouselItemWidthUnit,carouselAutoplay:e.carouselAutoplay,carouselAutoplayInterval:e.carouselAutoplayInterval,gridColumns:e.gridColumns,itemGap:e.itemGap,scrollPadding:e.scrollPadding,itemPadding:e.itemPadding,replaceAccentColor:e.replaceAccentColor,navHorizontalPosition:e.navHorizontalPosition,navVerticalPosition:e.navVerticalPosition,navButtonIconColor:e.navButtonIconColor,navButtonSize:e.navButtonSize,navButtonIconSize:e.navButtonIconSize,navButtonBackground:e.navButtonBackground,navBackdropBlur:e.navBackdropBlur,navBorderType:e.navBorderType,navBorderWidth:e.navBorderWidth,navBorderColor:e.navBorderColor,navBorderRadius:e.navBorderRadius,navButtonSizeHover:e.navButtonSizeHover,navButtonIconSizeHover:e.navButtonIconSizeHover,navButtonIconColorHover:e.navButtonIconColorHover,navButtonBackgroundHover:e.navButtonBackgroundHover,navButtonBorderColorHover:e.navButtonBorderColorHover,rightChevronIcon:e.rightChevronIcon,leftChevronIcon:e.leftChevronIcon,responsive:{}},L=we(),{navListItemStyle:_,navButtonStyle:H}=$e(),c=["post-feed-grid",e.layoutMode,e.layoutMode==="ts-feed-nowrap"?"min-scroll min-scroll-h":""].filter(Boolean).join(" "),i=x?ne(e,x):"";return a?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(E)}}),React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-loader"}))):r?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(E)}}),React.createElement("div",{className:"term-feed-error",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"48px",backgroundColor:"#fef2f2",color:"#991b1b"}},r)):!o||o.length===0?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(E)}}),React.createElement(pe,null)):React.createElement("div",{className:"term-feed-content",onClickCapture:h},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(E)}}),i&&React.createElement("style",{dangerouslySetInnerHTML:{__html:i}}),React.createElement("div",{ref:m,className:c,style:L,"data-auto-slide":e.carouselAutoplay?e.carouselAutoplayInterval:0},o.map(t=>React.createElement("div",{key:t.id,className:"ts-preview","data-term-id":t.id,style:Le(e,t.color)},t.cardHtml?React.createElement("div",{dangerouslySetInnerHTML:{__html:t.cardHtml}}):React.createElement("div",{className:"ts-term-card"},t.icon&&React.createElement("div",{className:"ts-term-icon",dangerouslySetInnerHTML:{__html:t.icon}}),React.createElement("div",{className:"ts-term-name"},t.name),t.count>0&&React.createElement("div",{className:"ts-term-count"},t.count," ",t.count===1?"item":"items"))))),e.layoutMode==="ts-feed-nowrap"&&React.createElement("ul",{className:"simplify-ul flexify post-feed-nav"},React.createElement("li",{style:_},React.createElement("a",{href:"#",className:`ts-icon-btn ts-prev-page ${T?"":"disabled"}`,"aria-label":"Previous",onClick:g,style:H},X(e.leftChevronIcon,K.chevronLeft))),React.createElement("li",{style:_},React.createElement("a",{href:"#",className:`ts-icon-btn ts-next-page ${y?"":"disabled"}`,"aria-label":"Next",onClick:R,style:H},X(e.rightChevronIcon,K.chevronRight)))))}function Me({attributes:e,setAttributes:o,taxonomies:a,postTypes:r,cardTemplates:d}){const[x,m]=B(!1),[T,u]=B(!1),[y,s]=B(!1),[v,g]=B(null),[R,h]=B(!1),[E,L]=B(null),[_,H]=B(!1),[c,i]=B(null),t=[{value:":all",label:l("Any post type","voxel-fse")},...r.map(n=>({value:n.key,label:n.label}))],p=a.map(n=>({value:n.key,label:n.label})),k=d.map(n=>({value:n.id,label:n.label})),z=P(()=>({id:fe(),term_id:0,rowVisibility:"show",visibilityRules:[]}),[]),W=P((n,C)=>`${l("Item","voxel-fse")} #${C+1}`,[]),G=P(n=>{L(n),h(!0)},[]),O=P(n=>{if(!E)return;const C=e.manualTerms.map(f=>f.id===E?{...f,visibilityRules:n}:f);o({manualTerms:C}),h(!1),L(null)},[E,e.manualTerms,o]),U=P(n=>{i(n),H(!0)},[]),b=P(n=>{if(!c)return;const C=e.manualTerms.map(f=>f.id===c?{...f,loopSource:n.loopSource,loopProperty:n.loopProperty||"",loopLimit:n.loopLimit,loopOffset:n.loopOffset}:f);o({manualTerms:C}),H(!1),i(null)},[c,e.manualTerms,o]),le=E?e.manualTerms.find(n=>n.id===E):null,V=c?e.manualTerms.find(n=>n.id===c):null,A=v?e.manualTerms.find(n=>n.id===v):null;return React.createElement(React.Fragment,null,React.createElement(ee,{attributes:e,setAttributes:o,stateAttribute:"contentTabOpenPanel",defaultPanel:"term-feed-settings"},React.createElement(F,{id:"term-feed-settings",title:l("Term feed settings","voxel-fse")},React.createElement($,{label:l("Data source","voxel-fse"),value:e.source,options:[{value:"filters",label:l("Filters","voxel-fse")},{value:"manual",label:l("Manual selection","voxel-fse")}],onChange:n=>o({source:n})}),e.source==="filters"&&React.createElement($,{label:l("Choose taxonomy","voxel-fse"),value:e.taxonomy,options:p,onChange:n=>o({taxonomy:n})}),e.source==="filters"&&React.createElement(React.Fragment,null,React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},React.createElement(D,{onClick:()=>m(!0)}),React.createElement("label",{style:{margin:0,fontWeight:500}},l("Direct children of (Term ID)","voxel-fse"))),React.createElement(j,{type:"number",value:String(e.parentTermId||""),onChange:n=>o({parentTermId:parseInt(n||"0",10)}),help:l("Enter 0 for top-level terms","voxel-fse"),label:""})),e.source==="filters"&&React.createElement($,{label:l("Order","voxel-fse"),value:e.order,options:[{value:"default",label:l("Default","voxel-fse")},{value:"name",label:l("Alphabetical","voxel-fse")}],onChange:n=>o({order:n})}),e.source==="filters"&&React.createElement(React.Fragment,null,React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},React.createElement(D,{onClick:()=>u(!0)}),React.createElement("label",{style:{margin:0,fontWeight:500}},l("Number of terms to load","voxel-fse"))),React.createElement(j,{type:"number",value:String(e.perPage||""),onChange:n=>o({perPage:parseInt(n||"10",10)}),help:l("Maximum 500 terms","voxel-fse"),label:""})),e.source==="manual"&&React.createElement(ue,{label:l("Choose terms","voxel-fse"),items:e.manualTerms,onChange:n=>o({manualTerms:n}),createItem:z,getItemLabel:W,addButtonText:l("Add Item","voxel-fse"),attributes:e,setAttributes:o,renderContent:({item:n,onUpdate:C})=>React.createElement("div",{className:"voxel-fse-term-item-editor"},React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},React.createElement(D,{onClick:()=>{g(n.id),s(!0)}}),React.createElement("label",{style:{margin:0,fontWeight:500}},l("Term ID","voxel-fse"))),React.createElement(j,{type:"number",value:String(n.term_id||""),onChange:f=>C({term_id:parseInt(f||"0",10)}),label:""}),React.createElement(ye,{showLoopSection:!0,loopSource:n.loopSource,loopProperty:n.loopProperty,loopLimit:String(n.loopLimit??""),loopOffset:String(n.loopOffset??""),onEditLoop:()=>U(n.id),onClearLoop:()=>C({loopSource:"",loopProperty:"",loopLimit:"",loopOffset:""}),onLoopLimitChange:f=>C({loopLimit:f}),onLoopOffsetChange:f=>C({loopOffset:f}),rowVisibility:n.rowVisibility||"show",visibilityRules:n.visibilityRules||[],onRowVisibilityChange:f=>C({rowVisibility:f}),onEditVisibilityRules:()=>G(n.id),onClearVisibilityRules:()=>C({visibilityRules:[],rowVisibility:"show"})}))}),React.createElement(J,{label:l("Hide empty terms?","voxel-fse"),checked:e.hideEmpty,onChange:n=>o({hideEmpty:n})}),e.hideEmpty&&React.createElement($,{label:l("Hide terms without a post in:","voxel-fse"),value:e.hideEmptyPostType,options:t,onChange:n=>o({hideEmptyPostType:n})}),React.createElement($,{label:l("Preview card template","voxel-fse"),value:e.cardTemplate,options:k,onChange:n=>o({cardTemplate:n})})),React.createElement(F,{id:"layout",title:l("Layout","voxel-fse")},React.createElement($,{label:l("Mode","voxel-fse"),value:e.layoutMode,options:[{value:"ts-feed-grid-default",label:l("Grid","voxel-fse")},{value:"ts-feed-nowrap",label:l("Carousel","voxel-fse")}],onChange:n=>o({layoutMode:n})}),e.layoutMode==="ts-feed-nowrap"&&React.createElement(React.Fragment,null,React.createElement(S,{label:l("Item width","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"carouselItemWidth",min:0,max:e.carouselItemWidthUnit==="%"?100:800,step:1,availableUnits:["px","%"],unitAttributeName:"carouselItemWidthUnit",help:l("Set the width of an individual item in the carousel","voxel-fse")}),React.createElement(J,{label:l("Auto slide?","voxel-fse"),checked:e.carouselAutoplay,onChange:n=>o({carouselAutoplay:n})}),e.carouselAutoplay&&React.createElement(j,{label:l("Auto slide interval (ms)","voxel-fse"),type:"number",value:String(e.carouselAutoplayInterval||""),onChange:n=>o({carouselAutoplayInterval:parseInt(n||"3000",10)}),help:l("Minimum 500ms recommended","voxel-fse")}),React.createElement(S,{label:l("Scroll padding","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"scrollPadding",min:0,max:100,step:1,help:l("Adds padding to the scrollable area, useful in full width layouts or in responsive mode","voxel-fse")}),React.createElement(S,{label:l("Item padding","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"itemPadding",min:0,max:100,step:1,help:l("Adds padding to an individual item","voxel-fse")})),e.layoutMode==="ts-feed-grid-default"&&React.createElement(S,{label:l("Number of columns","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"gridColumns",min:1,max:6,step:1}),React.createElement(S,{label:l("Item gap","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"itemGap",min:0,max:100,step:1,help:l("Adds gap between the items","voxel-fse")}),React.createElement(J,{label:l("Replace accent color?","voxel-fse"),checked:e.replaceAccentColor,onChange:n=>o({replaceAccentColor:n}),help:l("Replaces the color of any element utilizing accent color to the term color","voxel-fse")})),React.createElement(F,{id:"icons",title:l("Icons","voxel-fse")},React.createElement(Q,{label:l("Right chevron","voxel-fse"),value:e.rightChevronIcon,onChange:n=>o({rightChevronIcon:n}),supportsDynamicTags:!0}),React.createElement(Q,{label:l("Left chevron","voxel-fse"),value:e.leftChevronIcon,onChange:n=>o({leftChevronIcon:n}),supportsDynamicTags:!0}))),x&&React.createElement(q,{value:String(e.parentTermId||""),onSave:n=>{o({parentTermId:parseInt(n||"0",10)}),m(!1)},onClose:()=>m(!1),context:"term"}),T&&React.createElement(q,{value:String(e.perPage||""),onSave:n=>{o({perPage:parseInt(n||"10",10)}),u(!1)},onClose:()=>u(!1),context:"term"}),y&&A&&React.createElement(q,{value:String(A.term_id||""),onSave:n=>{const C=e.manualTerms.map(f=>f.id===v?{...f,term_id:parseInt(n||"0",10)}:f);o({manualTerms:C}),s(!1),g(null)},onClose:()=>{s(!1),g(null)},context:"term"}),React.createElement(ce,{isOpen:R,onClose:()=>{h(!1),L(null)},rules:le?.visibilityRules||[],onSave:O}),React.createElement(ve,{isOpen:_,onClose:()=>{H(!1),i(null)},config:{loopSource:V?.loopSource||"",loopProperty:V?.loopProperty||"",loopLimit:V?.loopLimit||"",loopOffset:V?.loopOffset||""},onSave:b}))}function We({attributes:e,setAttributes:o}){return React.createElement(ee,{attributes:e,setAttributes:o,stateAttribute:"styleTabOpenPanel",defaultPanel:"carousel-navigation"},React.createElement(F,{id:"carousel-navigation",title:l("Carousel navigation","voxel-fse")},React.createElement(ie,{attributeName:"carouselNavState",attributes:e,setAttributes:o,tabs:[{name:"normal",title:l("Normal","voxel-fse")},{name:"hover",title:l("Hover","voxel-fse")}]},a=>a.name==="normal"?React.createElement(React.Fragment,null,React.createElement(S,{label:l("Horizontal position","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navHorizontalPosition",min:-100,max:100,step:1}),React.createElement(S,{label:l("Vertical position","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navVerticalPosition",min:-500,max:500,step:1}),React.createElement(M,{label:l("Button icon color","voxel-fse"),value:e.navButtonIconColor,onChange:r=>o({navButtonIconColor:r||""})}),React.createElement(S,{label:l("Button size","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navButtonSize",min:0,max:100,step:1}),React.createElement(S,{label:l("Button icon size","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navButtonIconSize",min:0,max:100,step:1}),React.createElement(M,{label:l("Button background","voxel-fse"),value:e.navButtonBackground,onChange:r=>o({navButtonBackground:r||""})}),React.createElement(S,{label:l("Backdrop blur","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navBackdropBlur",min:0,max:10,step:1}),React.createElement(de,{label:l("Border","voxel-fse"),value:{borderType:e.navBorderType||"",borderWidth:e.navBorderWidth||{},borderColor:e.navBorderColor||""},onChange:r=>{const d={};r.borderType!==void 0&&(d.navBorderType=r.borderType),r.borderWidth!==void 0&&(d.navBorderWidth=r.borderWidth),r.borderColor!==void 0&&(d.navBorderColor=r.borderColor),o(d)},hideRadius:!0}),React.createElement(S,{label:l("Button border radius","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navBorderRadius",min:0,max:100,step:1})):React.createElement(React.Fragment,null,React.createElement(S,{label:l("Button size","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navButtonSizeHover",min:0,max:100,step:1}),React.createElement(S,{label:l("Button icon size","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navButtonIconSizeHover",min:0,max:100,step:1}),React.createElement(M,{label:l("Button icon color","voxel-fse"),value:e.navButtonIconColorHover,onChange:r=>o({navButtonIconColorHover:r||""})}),React.createElement(M,{label:l("Button background color","voxel-fse"),value:e.navButtonBackgroundHover,onChange:r=>o({navButtonBackgroundHover:r||""})}),React.createElement(M,{label:l("Button border color","voxel-fse"),value:e.navButtonBorderColorHover,onChange:r=>o({navButtonBorderColorHover:r||""})})))))}function Oe({attributes:e,setAttributes:o,clientId:a}){const[r,d]=B([]),[x,m]=B([]),[T,u]=B([]),[y,s]=B([]),[v,g]=B(!1),[R,h]=B(null);w(()=>{e.blockId||o({blockId:a})},[e.blockId,a,o]),w(()=>{const c="voxel-term-feed-css";if(!document.getElementById(c)){const i=document.createElement("link");i.id=c,i.rel="stylesheet";const p=(window.Voxel_Config?.site_url||window.location.origin).replace(/\/$/,"");i.href=`${p}/wp-content/themes/voxel/assets/dist/post-feed.css?ver=1.7.5.2`,document.head.appendChild(i)}},[]),w(()=>{N({path:"/voxel-fse/v1/term-feed/taxonomies"}).then(c=>{const i=c;d(i.taxonomies||[]),!e.taxonomy&&i.taxonomies?.length>0&&o({taxonomy:i.taxonomies[0].key})}).catch(c=>{console.error("Failed to fetch taxonomies:",c)})},[]),w(()=>{N({path:"/voxel-fse/v1/term-feed/post-types"}).then(c=>{m(c.postTypes||[])}).catch(c=>{console.error("Failed to fetch post types:",c)})},[]),w(()=>{N({path:"/voxel-fse/v1/term-feed/card-templates"}).then(c=>{u(c.templates||[])}).catch(c=>{console.error("Failed to fetch card templates:",c)})},[]);const E=P(async()=>{if(e.source==="manual"){const c=e.manualTerms.map(i=>i.term_id).filter(Boolean);if(c.length===0){s([]);return}g(!0),h(null);try{const i=await N({path:`/voxel-fse/v1/term-feed/terms?source=manual&term_ids=${c.join(",")}${e.hideEmpty?"&hide_empty=1":""}${e.hideEmptyPostType!==":all"?`&hide_empty_pt=${e.hideEmptyPostType}`:""}&card_template=${e.cardTemplate}`});s(i.terms||[])}catch(i){h(i instanceof Error?i.message:"Failed to load terms")}finally{g(!1)}}else{if(!e.taxonomy){s([]);return}g(!0),h(null);try{const c=new URLSearchParams({source:"filters",taxonomy:e.taxonomy,order:e.order,per_page:String(e.perPage),card_template:e.cardTemplate});e.parentTermId&&c.set("parent_term_id",String(e.parentTermId)),e.hideEmpty&&(c.set("hide_empty","1"),e.hideEmptyPostType!==":all"&&c.set("hide_empty_pt",e.hideEmptyPostType));const i=await N({path:`/voxel-fse/v1/term-feed/terms?${c.toString()}`});s(i.terms||[])}catch(c){h(c instanceof Error?c.message:"Failed to load terms")}finally{g(!1)}}},[e.source,e.manualTerms,e.taxonomy,e.parentTermId,e.order,e.perPage,e.hideEmpty,e.hideEmptyPostType,e.cardTemplate]);w(()=>{E()},[E]);const L=e.blockId||a,_=oe(e,{blockId:L,baseClass:"voxel-fse-term-feed"}),H=Z({id:_.elementId,className:_.className,style:{..._.styles,overflow:"hidden",minWidth:0},..._.customAttrs});return React.createElement("div",{...H},_.responsiveCSS&&React.createElement("style",{dangerouslySetInnerHTML:{__html:_.responsiveCSS}}),React.createElement(te,null,React.createElement(me,{tabs:[{id:"content",label:l("Content","voxel-fse"),icon:"",render:()=>React.createElement(Me,{attributes:e,setAttributes:o,taxonomies:r,postTypes:x,cardTemplates:T})},{id:"style",label:l("Style","voxel-fse"),icon:"",render:()=>React.createElement(We,{attributes:e,setAttributes:o})}],includeAdvancedTab:!0,includeVoxelTab:!0,attributes:e,setAttributes:o})),React.createElement(Ne,{attributes:e,terms:y,isLoading:v,error:R,context:"editor",cssSelector:_.uniqueSelector}))}function Ve({attributes:e}){const o=oe(e,{blockId:e.blockId||"term-feed",baseClass:"voxel-fse-term-feed"}),a=ne(e,o.uniqueSelector),r=[o.responsiveCSS,a].filter(Boolean).join(`
`),d=Z.save({id:o.elementId,className:o.className,style:o.styles,"data-visibility-behavior":e.visibilityBehavior||void 0,"data-visibility-rules":e.visibilityRules?.length?JSON.stringify(e.visibilityRules):void 0,"data-loop-source":e.loopSource||void 0,"data-loop-limit":e.loopLimit||void 0,"data-loop-offset":e.loopOffset||void 0,...o.customAttrs}),x={source:e.source,manualTermIds:e.manualTerms.map(m=>m.term_id),taxonomy:e.taxonomy,parentTermId:e.parentTermId,order:e.order,perPage:e.perPage,hideEmpty:e.hideEmpty,hideEmptyPostType:e.hideEmptyPostType,cardTemplate:e.cardTemplate,layoutMode:e.layoutMode,carouselItemWidth:e.carouselItemWidth,carouselItemWidthUnit:e.carouselItemWidthUnit,carouselAutoplay:e.carouselAutoplay,carouselAutoplayInterval:e.carouselAutoplayInterval,gridColumns:e.gridColumns,itemGap:e.itemGap,scrollPadding:e.scrollPadding,itemPadding:e.itemPadding,replaceAccentColor:e.replaceAccentColor,navHorizontalPosition:e.navHorizontalPosition,navVerticalPosition:e.navVerticalPosition,navButtonIconColor:e.navButtonIconColor,navButtonSize:e.navButtonSize,navButtonIconSize:e.navButtonIconSize,navButtonBackground:e.navButtonBackground,navBackdropBlur:e.navBackdropBlur,navBorderType:e.navBorderType,navBorderWidth:e.navBorderWidth,navBorderColor:e.navBorderColor,navBorderRadius:e.navBorderRadius,navButtonSizeHover:e.navButtonSizeHover,navButtonIconSizeHover:e.navButtonIconSizeHover,navButtonIconColorHover:e.navButtonIconColorHover,navButtonBackgroundHover:e.navButtonBackgroundHover,navButtonBorderColorHover:e.navButtonBorderColorHover,rightChevronIcon:e.rightChevronIcon,leftChevronIcon:e.leftChevronIcon,responsive:{carouselItemWidth_tablet:e.carouselItemWidth_tablet,carouselItemWidth_mobile:e.carouselItemWidth_mobile,gridColumns_tablet:e.gridColumns_tablet,gridColumns_mobile:e.gridColumns_mobile,itemGap_tablet:e.itemGap_tablet,itemGap_mobile:e.itemGap_mobile,scrollPadding_tablet:e.scrollPadding_tablet,scrollPadding_mobile:e.scrollPadding_mobile,itemPadding_tablet:e.itemPadding_tablet,itemPadding_mobile:e.itemPadding_mobile,navHorizontalPosition_tablet:e.navHorizontalPosition_tablet,navHorizontalPosition_mobile:e.navHorizontalPosition_mobile,navVerticalPosition_tablet:e.navVerticalPosition_tablet,navVerticalPosition_mobile:e.navVerticalPosition_mobile,navButtonSize_tablet:e.navButtonSize_tablet,navButtonSize_mobile:e.navButtonSize_mobile,navButtonIconSize_tablet:e.navButtonIconSize_tablet,navButtonIconSize_mobile:e.navButtonIconSize_mobile,navBackdropBlur_tablet:e.navBackdropBlur_tablet,navBackdropBlur_mobile:e.navBackdropBlur_mobile,navBorderRadius_tablet:e.navBorderRadius_tablet,navBorderRadius_mobile:e.navBorderRadius_mobile,navButtonSizeHover_tablet:e.navButtonSizeHover_tablet,navButtonSizeHover_mobile:e.navButtonSizeHover_mobile,navButtonIconSizeHover_tablet:e.navButtonIconSizeHover_tablet,navButtonIconSizeHover_mobile:e.navButtonIconSizeHover_mobile}};return React.createElement("div",{...d},r&&React.createElement("style",{dangerouslySetInnerHTML:{__html:r}}),se(e,!1,void 0,void 0,o.uniqueSelector),React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(x)}}),React.createElement("div",{className:"voxel-fse-block-placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f0f0f0",padding:"24px",minHeight:"120px"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"32",height:"32",fill:"currentColor",style:{opacity:.3}},React.createElement("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"}))))}ae(Y.name,{...Y,icon:ge,edit:Oe,save:Ve});
