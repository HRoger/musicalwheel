import{registerBlockType as te}from"@wordpress/blocks";import{useBlockProps as Z,InspectorControls as re}from"@wordpress/block-editor";import{__ as a}from"@wordpress/i18n";import{useRef as ce,useState as B,useCallback as P,useEffect as w}from"react";import N from"@wordpress/api-fetch";import{A as ee,a as F,k as D,R as _,o as q,E as ie,b as de,C as W,B as me}from"../TypographyPopup-CAcEJ5NA.js";import{I as se}from"../InspectorTabs-Bq2wAh4W.js";import{SelectControl as $,TextControl as j,ToggleControl as J}from"@wordpress/components";import"@wordpress/data";/* empty css                            */import"../RepeaterControl-DWypQkdS.js";import"../voxelShim-DB_Ue-9R.js";import{g as oe}from"../useAdvancedTabProps-BnJDQbKr.js";import{r as pe}from"../backgroundElements-Ui-iCrLV.js";import{E as ve}from"../EmptyPlaceholder-CnO9R1NI.js";import{r as K,V as Q}from"../voxelIcons-B76o57vm.js";import{A as Y}from"../AdvancedIconControl-CJ_DCTeD.js";import{L as fe}from"../LoopElementModal-CaevVMh1.js";import{g as ue,R as ye,L as ge}from"../RepeaterControl-B_4-vygy.js";import{V as he}from"../VoxelGridIcon-D5dF5acW.js";import"react-dom";import"../generateAdvancedStyles-CRpLcHXt.js";import"../generateVoxelStyles-oZeaeuKH.js";const Be="https://schemas.wp.org/trunk/block.json",Ie=3,xe="voxel-fse/term-feed",Re="1.0.0",Ce="Term Feed (VX)",Ee="voxel-fse",Se="Display taxonomy terms in a grid or carousel layout. FSE equivalent of Voxel's Term Feed widget.",_e=["term","taxonomy","feed","carousel","grid","voxel"],Te="voxel-fse",Pe={html:!1,align:["wide","full"],anchor:!0,className:!0,customClassName:!0},He="file:./index.js",ke="file:./frontend.js",ze="file:./render.php",we={blockId:{type:"string",default:""},contentTabOpenPanel:{type:"string",default:"term-feed-settings"},styleTabOpenPanel:{type:"string",default:"carousel-navigation"},carouselNavState:{type:"string",default:"normal"},source:{type:"string",default:"filters",enum:["filters","manual"]},manualTerms:{type:"array",default:[],items:{type:"object",properties:{id:{type:"string"},term_id:{type:"number"},loopSource:{type:"string"},loopProperty:{type:"string"},loopLimit:{type:"string"},loopOffset:{type:"string"},rowVisibility:{type:"string"},visibilityRules:{type:"array",items:{type:"object"}}}}},taxonomy:{type:"string",default:""},parentTermId:{type:"number",default:0},order:{type:"string",default:"default",enum:["default","name"]},perPage:{type:"number",default:10},hideEmpty:{type:"boolean",default:!1},hideEmptyPostType:{type:"string",default:":all"},cardTemplate:{type:"string",default:"main"},layoutMode:{type:"string",default:"ts-feed-grid-default",enum:["ts-feed-grid-default","ts-feed-nowrap"]},carouselItemWidth:{type:"number",default:16},carouselItemWidth_tablet:{type:"number"},carouselItemWidth_mobile:{type:"number"},carouselItemWidthUnit:{type:"string",default:"%"},carouselAutoplay:{type:"boolean",default:!1},carouselAutoplayInterval:{type:"number",default:3e3},gridColumns:{type:"number",default:3},gridColumns_tablet:{type:"number"},gridColumns_mobile:{type:"number"},itemGap:{type:"number",default:20},itemGap_tablet:{type:"number"},itemGap_mobile:{type:"number"},scrollPadding:{type:"number",default:0},scrollPadding_tablet:{type:"number"},scrollPadding_mobile:{type:"number"},itemPadding:{type:"number",default:0},itemPadding_tablet:{type:"number"},itemPadding_mobile:{type:"number"},replaceAccentColor:{type:"boolean",default:!1},navHorizontalPosition:{type:"number"},navHorizontalPosition_tablet:{type:"number"},navHorizontalPosition_mobile:{type:"number"},navVerticalPosition:{type:"number"},navVerticalPosition_tablet:{type:"number"},navVerticalPosition_mobile:{type:"number"},navButtonIconColor:{type:"string",default:""},navButtonSize:{type:"number"},navButtonSize_tablet:{type:"number"},navButtonSize_mobile:{type:"number"},navButtonIconSize:{type:"number"},navButtonIconSize_tablet:{type:"number"},navButtonIconSize_mobile:{type:"number"},navButtonBackground:{type:"string",default:""},navBackdropBlur:{type:"number"},navBackdropBlur_tablet:{type:"number"},navBackdropBlur_mobile:{type:"number"},navBorderType:{type:"string",default:""},navBorderWidth:{type:"object",default:{}},navBorderColor:{type:"string",default:""},navBorderRadius:{type:"number"},navBorderRadius_tablet:{type:"number"},navBorderRadius_mobile:{type:"number"},navButtonSizeHover:{type:"number"},navButtonSizeHover_tablet:{type:"number"},navButtonSizeHover_mobile:{type:"number"},navButtonIconSizeHover:{type:"number"},navButtonIconSizeHover_tablet:{type:"number"},navButtonIconSizeHover_mobile:{type:"number"},navButtonIconColorHover:{type:"string",default:""},navButtonBackgroundHover:{type:"string",default:""},navButtonBorderColorHover:{type:"string",default:""},rightChevronIcon:{type:"object",default:{library:"",value:""}},leftChevronIcon:{type:"object",default:{library:"",value:""}},visibilityBehavior:{type:"string",default:"show",enum:["show","hide"]},visibilityRules:{type:"array",default:[],items:{type:"object"}},loopEnabled:{type:"boolean",default:!1},loopSource:{type:"string",default:""},loopProperty:{type:"string",default:""},loopLimit:{type:"string",default:""},loopOffset:{type:"string",default:""}},U={$schema:Be,apiVersion:Ie,name:xe,version:Re,title:Ce,category:Ee,description:Se,keywords:_e,textdomain:Te,supports:Pe,editorScript:He,viewScript:ke,render:ze,attributes:we};function x(e,n,o,t,i="px"){const I=Array.isArray(t)?t:[t],m=[],E=[],v=[],y=R=>typeof i=="function"?i(R):`${R}${i}`;if(e[n]!==void 0&&e[n]!==""){const R=y(e[n]);m.push(`${o} { ${I.map(h=>`${h}: ${R}`).join("; ")}; }`)}const s=`${n}_tablet`;if(e[s]!==void 0&&e[s]!==""){const R=y(e[s]);E.push(`${o} { ${I.map(h=>`${h}: ${R}`).join("; ")}; }`)}const f=`${n}_mobile`;if(e[f]!==void 0&&e[f]!==""){const R=y(e[f]);v.push(`${o} { ${I.map(h=>`${h}: ${R}`).join("; ")}; }`)}let g=m.join(`
`);return E.length>0&&(g+=`
@media (max-width: 1024px) {
${E.join(`
`)}
}`),v.length>0&&(g+=`
@media (max-width: 767px) {
${v.join(`
`)}
}`),g}function ne(e,n){const o=[];o.push(`${n} { position: relative; max-width: 100%; min-width: 0; overflow: hidden; }`);const t=`${n} .post-feed-nav .ts-icon-btn`,i=`${n} .post-feed-nav .ts-icon-btn:hover`,I=`${n} .post-feed-nav li:first-child`,m=`${n} .post-feed-nav li:last-child`,E=`${n} .post-feed-nav li`;if(o.push(x(e,"navHorizontalPosition",I,"margin-left")),o.push(x(e,"navHorizontalPosition",m,"margin-right")),o.push(x(e,"navVerticalPosition",E,"margin-top")),e.navButtonIconColor&&o.push(`${t} { --ts-icon-color: ${e.navButtonIconColor}; color: ${e.navButtonIconColor}; }`),o.push(x(e,"navButtonSize",t,["width","height"])),o.push(x(e,"navButtonIconSize",t,"--ts-icon-size")),e.navButtonBackground&&o.push(`${t} { background-color: ${e.navButtonBackground}; }`),o.push(x(e,"navBackdropBlur",t,"backdrop-filter",y=>`blur(${y}px)`)),e.navBorderType&&e.navBorderType!=="none"){const{top:y,right:s,bottom:f,left:g}=e.navBorderWidth||{top:0,right:0,bottom:0,left:0};o.push(`${t} { border-style: ${e.navBorderType}; border-width: ${y}px ${s}px ${f}px ${g}px; border-color: ${e.navBorderColor}; }`)}o.push(x(e,"navBorderRadius",t,"border-radius")),o.push(x(e,"navButtonSizeHover",i,["width","height"])),o.push(x(e,"navButtonIconSizeHover",i,"--ts-icon-size")),e.navButtonIconColorHover&&o.push(`${i} { --ts-icon-color: ${e.navButtonIconColorHover}; color: ${e.navButtonIconColorHover}; }`),e.navButtonBackgroundHover&&o.push(`${i} { background-color: ${e.navButtonBackgroundHover}; }`),e.navButtonBorderColorHover&&o.push(`${i} { border-color: ${e.navButtonBorderColorHover}; }`);const v=`${n} .post-feed-grid`;if(o.push(x(e,"itemGap",v,"gap")),e.layoutMode==="ts-feed-grid-default")o.push(x(e,"gridColumns",v,"grid-template-columns",y=>`repeat(${y}, minmax(0, 1fr))`));else if(e.layoutMode==="ts-feed-nowrap"){o.push(x(e,"scrollPadding",v,["padding-left","padding-right","scroll-padding"]));const y=`${v} > div:last-of-type`;o.push(x(e,"scrollPadding",y,"margin-right"));const s=`${n} .ts-feed-nowrap .ts-preview`;o.push(x(e,"carouselItemWidth",s,["width","min-width","flex-basis"],f=>`${f}${e.carouselItemWidthUnit||"%"}`)),o.push(x(e,"itemPadding",s,"padding"))}return o.filter(Boolean).join(`
`)}function Le(){return{}}function $e(e,n){const o={};return e.replaceAccentColor&&n&&(o["--e-global-color-accent"]=n),o}function Ne(){return{navListItemStyle:{},navButtonStyle:{}}}function We({attributes:e,terms:n,isLoading:o,error:t,context:i,cssSelector:I}){const m=ce(null),[E,v]=B(!1),[y,s]=B(!0),f=P(()=>{if(!m.current||e.layoutMode!=="ts-feed-nowrap")return;const r=m.current;v(Math.abs(r.scrollLeft)>10),s(r.scrollLeft+r.clientWidth+10<r.scrollWidth)},[e.layoutMode]);w(()=>{const r=m.current;if(!(!r||e.layoutMode!=="ts-feed-nowrap"))return requestAnimationFrame(()=>{if(!r)return;const p=r.scrollWidth>r.clientWidth;v(!1),s(p)}),r.addEventListener("scroll",f,{passive:!0}),window.addEventListener("resize",f),()=>{r.removeEventListener("scroll",f),window.removeEventListener("resize",f)}},[f,n,e.carouselItemWidth,e.itemGap,e.scrollPadding]);const g=P(r=>{r.preventDefault();const p=m.current;if(!p)return;const z=p.querySelector(".ts-preview")?.scrollWidth||300;p.scrollBy({left:-z,behavior:"smooth"})},[]),R=P(r=>{r.preventDefault();const p=m.current;if(!p)return;const z=p.querySelector(".ts-preview")?.scrollWidth||300;p.scrollBy({left:z,behavior:"smooth"})},[]);w(()=>{if(e.layoutMode!=="ts-feed-nowrap"||!e.carouselAutoplay||!m.current||i==="editor")return;const r=e.carouselAutoplayInterval||3e3;if(r<20)return;let p=!1;const k=m.current.closest(".voxel-fse-term-feed")||m.current,z=()=>{p=!0},M=()=>{p=!1};k?.addEventListener("mouseenter",z),k?.addEventListener("mouseleave",M);const G=setInterval(()=>{if(!p&&m.current){const O=m.current,b=O.querySelector(".ts-preview")?.scrollWidth||300;O.scrollBy({left:b,behavior:"smooth"})}},r);return()=>{clearInterval(G),k?.removeEventListener("mouseenter",z),k?.removeEventListener("mouseleave",M)}},[e.layoutMode,e.carouselAutoplay,e.carouselAutoplayInterval,i]);const h=P(r=>{if(i!=="editor")return;const p=r.target.closest("a");p&&!p.closest(".post-feed-nav")&&(r.preventDefault(),r.stopPropagation())},[i]),S={source:e.source,manualTermIds:e.manualTerms?.map(r=>r.term_id)||[],taxonomy:e.taxonomy,parentTermId:e.parentTermId,order:e.order,perPage:e.perPage,hideEmpty:e.hideEmpty,hideEmptyPostType:e.hideEmptyPostType,cardTemplate:e.cardTemplate,layoutMode:e.layoutMode,carouselItemWidth:e.carouselItemWidth,carouselItemWidthUnit:e.carouselItemWidthUnit,carouselAutoplay:e.carouselAutoplay,carouselAutoplayInterval:e.carouselAutoplayInterval,gridColumns:e.gridColumns,itemGap:e.itemGap,scrollPadding:e.scrollPadding,itemPadding:e.itemPadding,replaceAccentColor:e.replaceAccentColor,navHorizontalPosition:e.navHorizontalPosition,navVerticalPosition:e.navVerticalPosition,navButtonIconColor:e.navButtonIconColor,navButtonSize:e.navButtonSize,navButtonIconSize:e.navButtonIconSize,navButtonBackground:e.navButtonBackground,navBackdropBlur:e.navBackdropBlur,navBorderType:e.navBorderType,navBorderWidth:e.navBorderWidth,navBorderColor:e.navBorderColor,navBorderRadius:e.navBorderRadius,navButtonSizeHover:e.navButtonSizeHover,navButtonIconSizeHover:e.navButtonIconSizeHover,navButtonIconColorHover:e.navButtonIconColorHover,navButtonBackgroundHover:e.navButtonBackgroundHover,navButtonBorderColorHover:e.navButtonBorderColorHover,rightChevronIcon:e.rightChevronIcon,leftChevronIcon:e.leftChevronIcon,responsive:{}},L=Le(),{navListItemStyle:T,navButtonStyle:H}=Ne(),c=["post-feed-grid",e.layoutMode,e.layoutMode==="ts-feed-nowrap"?"min-scroll min-scroll-h":""].filter(Boolean).join(" "),d=I?ne(e,I):"";return o?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(S)}}),React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-loader"}))):t?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(S)}}),React.createElement("div",{className:"term-feed-error",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"48px",backgroundColor:"#fef2f2",color:"#991b1b"}},t)):!n||n.length===0?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(S)}}),i==="editor"&&React.createElement(ve,null)):React.createElement("div",{className:"term-feed-content",onClickCapture:h},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(S)}}),d&&React.createElement("style",{dangerouslySetInnerHTML:{__html:d}}),React.createElement("div",{ref:m,className:c,style:L,"data-auto-slide":e.carouselAutoplay?e.carouselAutoplayInterval:0},n.map(r=>React.createElement("div",{key:r.id,className:"ts-preview","data-term-id":r.id,style:$e(e,r.color)},r.cardHtml?React.createElement("div",{dangerouslySetInnerHTML:{__html:r.cardHtml}}):React.createElement("div",{className:"ts-term-card"},r.icon&&React.createElement("div",{className:"ts-term-icon",dangerouslySetInnerHTML:{__html:r.icon}}),React.createElement("div",{className:"ts-term-name"},r.name),r.count>0&&React.createElement("div",{className:"ts-term-count"},r.count," ",r.count===1?"item":"items"))))),e.layoutMode==="ts-feed-nowrap"&&React.createElement("ul",{className:"simplify-ul flexify post-feed-nav"},React.createElement("li",{style:T},React.createElement("a",{href:"#",className:`ts-icon-btn ts-prev-page ${E?"":"disabled"}`,"aria-label":"Previous",onClick:g,style:H},K(e.leftChevronIcon,Q.chevronLeft))),React.createElement("li",{style:T},React.createElement("a",{href:"#",className:`ts-icon-btn ts-next-page ${y?"":"disabled"}`,"aria-label":"Next",onClick:R,style:H},K(e.rightChevronIcon,Q.chevronRight)))))}function Me({attributes:e,setAttributes:n,taxonomies:o,postTypes:t,cardTemplates:i}){const[I,m]=B(!1),[E,v]=B(!1),[y,s]=B(!1),[f,g]=B(null),[R,h]=B(!1),[S,L]=B(null),[T,H]=B(!1),[c,d]=B(null),r=[{value:":all",label:a("Any post type","voxel-fse")},...t.map(l=>({value:l.key,label:l.label}))],p=o.map(l=>({value:l.key,label:l.label})),k=i.map(l=>({value:l.id,label:l.label})),z=P(()=>({id:ue(),term_id:0,rowVisibility:"show",visibilityRules:[]}),[]),M=P((l,C)=>`${a("Item","voxel-fse")} #${C+1}`,[]),G=P(l=>{L(l),h(!0)},[]),O=P(l=>{if(!S)return;const C=e.manualTerms.map(u=>u.id===S?{...u,visibilityRules:l}:u);n({manualTerms:C}),h(!1),L(null)},[S,e.manualTerms,n]),A=P(l=>{d(l),H(!0)},[]),b=P(l=>{if(!c)return;const C=e.manualTerms.map(u=>u.id===c?{...u,loopSource:l.loopSource,loopProperty:l.loopProperty||"",loopLimit:l.loopLimit,loopOffset:l.loopOffset}:u);n({manualTerms:C}),H(!1),d(null)},[c,e.manualTerms,n]),ae=S?e.manualTerms.find(l=>l.id===S):null,V=c?e.manualTerms.find(l=>l.id===c):null,X=f?e.manualTerms.find(l=>l.id===f):null;return React.createElement(React.Fragment,null,React.createElement(ee,{attributes:e,setAttributes:n,stateAttribute:"contentTabOpenPanel",defaultPanel:"term-feed-settings"},React.createElement(F,{id:"term-feed-settings",title:a("Term feed settings","voxel-fse")},React.createElement($,{label:a("Data source","voxel-fse"),value:e.source,options:[{value:"filters",label:a("Filters","voxel-fse")},{value:"manual",label:a("Manual selection","voxel-fse")}],onChange:l=>n({source:l})}),e.source==="filters"&&React.createElement($,{label:a("Choose taxonomy","voxel-fse"),value:e.taxonomy,options:p,onChange:l=>n({taxonomy:l})}),e.source==="filters"&&React.createElement(React.Fragment,null,React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},React.createElement(D,{onClick:()=>m(!0)}),React.createElement("label",{style:{margin:0,fontWeight:500}},a("Direct children of (Term ID)","voxel-fse"))),React.createElement(j,{type:"number",value:String(e.parentTermId||""),onChange:l=>n({parentTermId:parseInt(l||"0",10)}),help:a("Enter 0 for top-level terms","voxel-fse"),label:""})),e.source==="filters"&&React.createElement($,{label:a("Order","voxel-fse"),value:e.order,options:[{value:"default",label:a("Default","voxel-fse")},{value:"name",label:a("Alphabetical","voxel-fse")}],onChange:l=>n({order:l})}),e.source==="filters"&&React.createElement(React.Fragment,null,React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},React.createElement(D,{onClick:()=>v(!0)}),React.createElement("label",{style:{margin:0,fontWeight:500}},a("Number of terms to load","voxel-fse"))),React.createElement(j,{type:"number",value:String(e.perPage||""),onChange:l=>n({perPage:parseInt(l||"10",10)}),help:a("Maximum 500 terms","voxel-fse"),label:""})),e.source==="manual"&&React.createElement(ye,{label:a("Choose terms","voxel-fse"),items:e.manualTerms,onChange:l=>n({manualTerms:l}),createItem:z,getItemLabel:M,addButtonText:a("Add Item","voxel-fse"),attributes:e,setAttributes:n,renderContent:({item:l,onUpdate:C})=>React.createElement("div",{className:"voxel-fse-term-item-editor"},React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},React.createElement(D,{onClick:()=>{g(l.id),s(!0)}}),React.createElement("label",{style:{margin:0,fontWeight:500}},a("Term ID","voxel-fse"))),React.createElement(j,{type:"number",value:String(l.term_id||""),onChange:u=>C({term_id:parseInt(u||"0",10)}),label:""}),React.createElement(ge,{showLoopSection:!0,loopSource:l.loopSource,loopProperty:l.loopProperty,loopLimit:String(l.loopLimit??""),loopOffset:String(l.loopOffset??""),onEditLoop:()=>A(l.id),onClearLoop:()=>C({loopSource:"",loopProperty:"",loopLimit:"",loopOffset:""}),onLoopLimitChange:u=>C({loopLimit:u}),onLoopOffsetChange:u=>C({loopOffset:u}),rowVisibility:l.rowVisibility||"show",visibilityRules:l.visibilityRules||[],onRowVisibilityChange:u=>C({rowVisibility:u}),onEditVisibilityRules:()=>G(l.id),onClearVisibilityRules:()=>C({visibilityRules:[],rowVisibility:"show"})}))}),React.createElement(J,{label:a("Hide empty terms?","voxel-fse"),checked:e.hideEmpty,onChange:l=>n({hideEmpty:l})}),e.hideEmpty&&React.createElement($,{label:a("Hide terms without a post in:","voxel-fse"),value:e.hideEmptyPostType,options:r,onChange:l=>n({hideEmptyPostType:l})}),React.createElement($,{label:a("Preview card template","voxel-fse"),value:e.cardTemplate,options:k,onChange:l=>n({cardTemplate:l})})),React.createElement(F,{id:"layout",title:a("Layout","voxel-fse")},React.createElement($,{label:a("Mode","voxel-fse"),value:e.layoutMode,options:[{value:"ts-feed-grid-default",label:a("Grid","voxel-fse")},{value:"ts-feed-nowrap",label:a("Carousel","voxel-fse")}],onChange:l=>n({layoutMode:l})}),e.layoutMode==="ts-feed-nowrap"&&React.createElement(React.Fragment,null,React.createElement(_,{label:a("Item width","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"carouselItemWidth",min:0,max:e.carouselItemWidthUnit==="%"?100:800,step:1,availableUnits:["px","%"],unitAttributeName:"carouselItemWidthUnit",help:a("Set the width of an individual item in the carousel","voxel-fse")}),React.createElement(J,{label:a("Auto slide?","voxel-fse"),checked:e.carouselAutoplay,onChange:l=>n({carouselAutoplay:l})}),e.carouselAutoplay&&React.createElement(j,{label:a("Auto slide interval (ms)","voxel-fse"),type:"number",value:String(e.carouselAutoplayInterval||""),onChange:l=>n({carouselAutoplayInterval:parseInt(l||"3000",10)}),help:a("Minimum 500ms recommended","voxel-fse")}),React.createElement(_,{label:a("Scroll padding","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"scrollPadding",min:0,max:100,step:1,help:a("Adds padding to the scrollable area, useful in full width layouts or in responsive mode","voxel-fse")}),React.createElement(_,{label:a("Item padding","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"itemPadding",min:0,max:100,step:1,help:a("Adds padding to an individual item","voxel-fse")})),e.layoutMode==="ts-feed-grid-default"&&React.createElement(_,{label:a("Number of columns","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"gridColumns",min:1,max:6,step:1}),React.createElement(_,{label:a("Item gap","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"itemGap",min:0,max:100,step:1,help:a("Adds gap between the items","voxel-fse")}),React.createElement(J,{label:a("Replace accent color?","voxel-fse"),checked:e.replaceAccentColor,onChange:l=>n({replaceAccentColor:l}),help:a("Replaces the color of any element utilizing accent color to the term color","voxel-fse")})),React.createElement(F,{id:"icons",title:a("Icons","voxel-fse")},React.createElement(Y,{label:a("Right chevron","voxel-fse"),value:e.rightChevronIcon,onChange:l=>n({rightChevronIcon:l}),supportsDynamicTags:!0}),React.createElement(Y,{label:a("Left chevron","voxel-fse"),value:e.leftChevronIcon,onChange:l=>n({leftChevronIcon:l}),supportsDynamicTags:!0}))),I&&React.createElement(q,{value:String(e.parentTermId||""),onSave:l=>{n({parentTermId:parseInt(l||"0",10)}),m(!1)},onClose:()=>m(!1),context:"term"}),E&&React.createElement(q,{value:String(e.perPage||""),onSave:l=>{n({perPage:parseInt(l||"10",10)}),v(!1)},onClose:()=>v(!1),context:"term"}),y&&X&&React.createElement(q,{value:String(X.term_id||""),onSave:l=>{const C=e.manualTerms.map(u=>u.id===f?{...u,term_id:parseInt(l||"0",10)}:u);n({manualTerms:C}),s(!1),g(null)},onClose:()=>{s(!1),g(null)},context:"term"}),React.createElement(ie,{isOpen:R,onClose:()=>{h(!1),L(null)},rules:ae?.visibilityRules||[],onSave:O}),React.createElement(fe,{isOpen:T,onClose:()=>{H(!1),d(null)},config:{loopSource:V?.loopSource||"",loopProperty:V?.loopProperty||"",loopLimit:V?.loopLimit||"",loopOffset:V?.loopOffset||""},onSave:b}))}function Oe({attributes:e,setAttributes:n}){return React.createElement(ee,{attributes:e,setAttributes:n,stateAttribute:"styleTabOpenPanel",defaultPanel:"carousel-navigation"},React.createElement(F,{id:"carousel-navigation",title:a("Carousel navigation","voxel-fse")},React.createElement(de,{attributeName:"carouselNavState",attributes:e,setAttributes:n,tabs:[{name:"normal",title:a("Normal","voxel-fse")},{name:"hover",title:a("Hover","voxel-fse")}]},o=>o.name==="normal"?React.createElement(React.Fragment,null,React.createElement(_,{label:a("Horizontal position","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"navHorizontalPosition",min:-100,max:100,step:1}),React.createElement(_,{label:a("Vertical position","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"navVerticalPosition",min:-500,max:500,step:1}),React.createElement(W,{label:a("Button icon color","voxel-fse"),value:e.navButtonIconColor,onChange:t=>n({navButtonIconColor:t||""})}),React.createElement(_,{label:a("Button size","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"navButtonSize",min:0,max:100,step:1}),React.createElement(_,{label:a("Button icon size","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"navButtonIconSize",min:0,max:100,step:1}),React.createElement(W,{label:a("Button background","voxel-fse"),value:e.navButtonBackground,onChange:t=>n({navButtonBackground:t||""})}),React.createElement(_,{label:a("Backdrop blur","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"navBackdropBlur",min:0,max:10,step:1}),React.createElement(me,{label:a("Border","voxel-fse"),value:{borderType:e.navBorderType||"",borderWidth:e.navBorderWidth||{},borderColor:e.navBorderColor||""},onChange:t=>{const i={};t.borderType!==void 0&&(i.navBorderType=t.borderType),t.borderWidth!==void 0&&(i.navBorderWidth=t.borderWidth),t.borderColor!==void 0&&(i.navBorderColor=t.borderColor),n(i)},hideRadius:!0}),React.createElement(_,{label:a("Button border radius","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"navBorderRadius",min:0,max:100,step:1})):React.createElement(React.Fragment,null,React.createElement(_,{label:a("Button size","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"navButtonSizeHover",min:0,max:100,step:1}),React.createElement(_,{label:a("Button icon size","voxel-fse"),attributes:e,setAttributes:n,attributeBaseName:"navButtonIconSizeHover",min:0,max:100,step:1}),React.createElement(W,{label:a("Button icon color","voxel-fse"),value:e.navButtonIconColorHover,onChange:t=>n({navButtonIconColorHover:t||""})}),React.createElement(W,{label:a("Button background color","voxel-fse"),value:e.navButtonBackgroundHover,onChange:t=>n({navButtonBackgroundHover:t||""})}),React.createElement(W,{label:a("Button border color","voxel-fse"),value:e.navButtonBorderColorHover,onChange:t=>n({navButtonBorderColorHover:t||""})})))))}function Ve({attributes:e,setAttributes:n,clientId:o}){const[t,i]=B([]),[I,m]=B([]),[E,v]=B([]),[y,s]=B([]),[f,g]=B(!1),[R,h]=B(null);w(()=>{e.blockId||n({blockId:o})},[e.blockId,o,n]),w(()=>{const c="voxel-term-feed-css";if(!document.getElementById(c)){const d=document.createElement("link");d.id=c,d.rel="stylesheet";const p=(window.Voxel_Config?.site_url||window.location.origin).replace(/\/$/,"");d.href=`${p}/wp-content/themes/voxel/assets/dist/post-feed.css?ver=1.7.5.2`,document.head.appendChild(d)}},[]),w(()=>{N({path:"/voxel-fse/v1/term-feed/taxonomies"}).then(c=>{const d=c;i(d.taxonomies||[]),!e.taxonomy&&d.taxonomies?.length>0&&n({taxonomy:d.taxonomies[0].key})}).catch(c=>{console.error("Failed to fetch taxonomies:",c)})},[]),w(()=>{N({path:"/voxel-fse/v1/term-feed/post-types"}).then(c=>{m(c.postTypes||[])}).catch(c=>{console.error("Failed to fetch post types:",c)})},[]),w(()=>{N({path:"/voxel-fse/v1/term-feed/card-templates"}).then(c=>{v(c.templates||[])}).catch(c=>{console.error("Failed to fetch card templates:",c)})},[]);const S=P(async()=>{if(e.source==="manual"){const c=e.manualTerms.map(d=>d.term_id).filter(Boolean);if(c.length===0){s([]);return}g(!0),h(null);try{const d=await N({path:`/voxel-fse/v1/term-feed/terms?source=manual&term_ids=${c.join(",")}${e.hideEmpty?"&hide_empty=1":""}${e.hideEmptyPostType!==":all"?`&hide_empty_pt=${e.hideEmptyPostType}`:""}&card_template=${e.cardTemplate}`});s(d.terms||[])}catch(d){h(d instanceof Error?d.message:"Failed to load terms")}finally{g(!1)}}else{if(!e.taxonomy){s([]);return}g(!0),h(null);try{const c=new URLSearchParams({source:"filters",taxonomy:e.taxonomy,order:e.order,per_page:String(e.perPage),card_template:e.cardTemplate});e.parentTermId&&c.set("parent_term_id",String(e.parentTermId)),e.hideEmpty&&(c.set("hide_empty","1"),e.hideEmptyPostType!==":all"&&c.set("hide_empty_pt",e.hideEmptyPostType));const d=await N({path:`/voxel-fse/v1/term-feed/terms?${c.toString()}`});s(d.terms||[])}catch(c){h(c instanceof Error?c.message:"Failed to load terms")}finally{g(!1)}}},[e.source,e.manualTerms,e.taxonomy,e.parentTermId,e.order,e.perPage,e.hideEmpty,e.hideEmptyPostType,e.cardTemplate]);w(()=>{S()},[S]);const L=e.blockId||o,T=oe(e,{blockId:L,baseClass:"voxel-fse-term-feed"}),H=Z({id:T.elementId,className:T.className,style:{...T.styles,overflow:"hidden",minWidth:0},...T.customAttrs});return React.createElement("div",{...H},T.responsiveCSS&&React.createElement("style",{dangerouslySetInnerHTML:{__html:T.responsiveCSS}}),React.createElement(re,null,React.createElement(se,{tabs:[{id:"content",label:a("Content","voxel-fse"),icon:"",render:()=>React.createElement(Me,{attributes:e,setAttributes:n,taxonomies:t,postTypes:I,cardTemplates:E})},{id:"style",label:a("Style","voxel-fse"),icon:"",render:()=>React.createElement(Oe,{attributes:e,setAttributes:n})}],includeAdvancedTab:!0,includeVoxelTab:!0,attributes:e,setAttributes:n})),React.createElement(We,{attributes:e,terms:y,isLoading:f,error:R,context:"editor",cssSelector:T.uniqueSelector}))}function le(e){return function({attributes:o}){const t=oe(o,{blockId:o.blockId||"term-feed",baseClass:"voxel-fse-term-feed"}),i=ne(o,t.uniqueSelector),I=[t.responsiveCSS,i].filter(Boolean).join(`
`),m=Z.save({id:t.elementId,className:t.className,style:t.styles,"data-visibility-behavior":o.visibilityBehavior||void 0,"data-visibility-rules":o.visibilityRules?.length?JSON.stringify(o.visibilityRules):void 0,"data-loop-source":o.loopSource||void 0,"data-loop-limit":o.loopLimit||void 0,"data-loop-offset":o.loopOffset||void 0,...t.customAttrs}),E={source:o.source,manualTermIds:o.manualTerms.map(v=>v.term_id),taxonomy:o.taxonomy,parentTermId:o.parentTermId,order:o.order,perPage:o.perPage,hideEmpty:o.hideEmpty,hideEmptyPostType:o.hideEmptyPostType,cardTemplate:o.cardTemplate,layoutMode:o.layoutMode,carouselItemWidth:o.carouselItemWidth,carouselItemWidthUnit:o.carouselItemWidthUnit,carouselAutoplay:o.carouselAutoplay,carouselAutoplayInterval:o.carouselAutoplayInterval,gridColumns:o.gridColumns,itemGap:o.itemGap,scrollPadding:o.scrollPadding,itemPadding:o.itemPadding,replaceAccentColor:o.replaceAccentColor,navHorizontalPosition:o.navHorizontalPosition,navVerticalPosition:o.navVerticalPosition,navButtonIconColor:o.navButtonIconColor,navButtonSize:o.navButtonSize,navButtonIconSize:o.navButtonIconSize,navButtonBackground:o.navButtonBackground,navBackdropBlur:o.navBackdropBlur,navBorderType:o.navBorderType,navBorderWidth:o.navBorderWidth,navBorderColor:o.navBorderColor,navBorderRadius:o.navBorderRadius,navButtonSizeHover:o.navButtonSizeHover,navButtonIconSizeHover:o.navButtonIconSizeHover,navButtonIconColorHover:o.navButtonIconColorHover,navButtonBackgroundHover:o.navButtonBackgroundHover,navButtonBorderColorHover:o.navButtonBorderColorHover,rightChevronIcon:o.rightChevronIcon,leftChevronIcon:o.leftChevronIcon,responsive:{carouselItemWidth_tablet:o.carouselItemWidth_tablet,carouselItemWidth_mobile:o.carouselItemWidth_mobile,gridColumns_tablet:o.gridColumns_tablet,gridColumns_mobile:o.gridColumns_mobile,itemGap_tablet:o.itemGap_tablet,itemGap_mobile:o.itemGap_mobile,scrollPadding_tablet:o.scrollPadding_tablet,scrollPadding_mobile:o.scrollPadding_mobile,itemPadding_tablet:o.itemPadding_tablet,itemPadding_mobile:o.itemPadding_mobile,navHorizontalPosition_tablet:o.navHorizontalPosition_tablet,navHorizontalPosition_mobile:o.navHorizontalPosition_mobile,navVerticalPosition_tablet:o.navVerticalPosition_tablet,navVerticalPosition_mobile:o.navVerticalPosition_mobile,navButtonSize_tablet:o.navButtonSize_tablet,navButtonSize_mobile:o.navButtonSize_mobile,navButtonIconSize_tablet:o.navButtonIconSize_tablet,navButtonIconSize_mobile:o.navButtonIconSize_mobile,navBackdropBlur_tablet:o.navBackdropBlur_tablet,navBackdropBlur_mobile:o.navBackdropBlur_mobile,navBorderRadius_tablet:o.navBorderRadius_tablet,navBorderRadius_mobile:o.navBorderRadius_mobile,navButtonSizeHover_tablet:o.navButtonSizeHover_tablet,navButtonSizeHover_mobile:o.navButtonSizeHover_mobile,navButtonIconSizeHover_tablet:o.navButtonIconSizeHover_tablet,navButtonIconSizeHover_mobile:o.navButtonIconSizeHover_mobile}};return React.createElement("div",{...m},I&&React.createElement("style",{dangerouslySetInnerHTML:{__html:I}}),pe(o,!1,void 0,void 0,t.uniqueSelector),React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(E)}}),e&&React.createElement("div",{className:"voxel-fse-block-placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f0f0f0",padding:"24px",minHeight:"120px"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"32",height:"32",fill:"currentColor",style:{opacity:.3}},React.createElement("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"}))))}}const je=le(!1),Fe=le(!0),Ge=[{attributes:U.attributes,save:Fe}];te(U.name,{...U,icon:he,edit:Ve,save:je,deprecated:Ge});
