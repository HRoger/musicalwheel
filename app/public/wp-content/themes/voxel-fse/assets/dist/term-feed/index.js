import{registerBlockType as U}from"@wordpress/blocks";import{useBlockProps as F,InspectorControls as J}from"@wordpress/block-editor";import{__ as n}from"@wordpress/i18n";import{useRef as q,useState as R,useCallback as O,useEffect as E,useMemo as X}from"react";import P from"@wordpress/api-fetch";import{A as G,a as k,k as w,R as x,o as W,b as K,C as T,B as Q}from"../TypographyPopup-CAcEJ5NA.js";import{I as Y}from"../InspectorTabs-Bq2wAh4W.js";import{SelectControl as S,TextControl as z,ToggleControl as N}from"@wordpress/components";import"@wordpress/data";/* empty css                            */import"../RepeaterControl-C7JnAhZL.js";import"../voxelShim-DB_Ue-9R.js";import{g as D}from"../useAdvancedTabProps-BnJDQbKr.js";import{r as Z}from"../backgroundElements-Ui-iCrLV.js";import{E as ee}from"../EmptyPlaceholder-BsL18qxN.js";import{r as M,V as L}from"../voxelIcons-B76o57vm.js";import{A as j}from"../AdvancedIconControl-CJ_DCTeD.js";import{V as oe}from"../VoxelGridIcon-D5dF5acW.js";import"react-dom";import"../generateAdvancedStyles-CRpLcHXt.js";import"../generateVoxelStyles-oZeaeuKH.js";const ne="https://schemas.wp.org/trunk/block.json",le=3,ae="voxel-fse/term-feed",te="1.0.0",re="Term Feed (VX)",ce="voxel-fse",de="Display taxonomy terms in a grid or carousel layout. FSE equivalent of Voxel's Term Feed widget.",ie=["term","taxonomy","feed","carousel","grid","voxel"],me="voxel-fse",se={html:!1,align:["wide","full"],anchor:!0,className:!0,customClassName:!0},pe="file:./index.js",ve="file:./frontend.js",fe="file:./render.php",ue={blockId:{type:"string",default:""},contentTabOpenPanel:{type:"string",default:"term-feed-settings"},styleTabOpenPanel:{type:"string",default:"carousel-navigation"},carouselNavState:{type:"string",default:"normal"},source:{type:"string",default:"filters",enum:["filters","manual"]},manualTerms:{type:"array",default:[],items:{type:"object",properties:{term_id:{type:"number"}}}},taxonomy:{type:"string",default:""},parentTermId:{type:"number",default:0},order:{type:"string",default:"default",enum:["default","name"]},perPage:{type:"number",default:10},hideEmpty:{type:"boolean",default:!1},hideEmptyPostType:{type:"string",default:":all"},cardTemplate:{type:"string",default:"main"},layoutMode:{type:"string",default:"ts-feed-grid-default",enum:["ts-feed-grid-default","ts-feed-nowrap"]},carouselItemWidth:{type:"number",default:16},carouselItemWidth_tablet:{type:"number"},carouselItemWidth_mobile:{type:"number"},carouselItemWidthUnit:{type:"string",default:"%"},carouselAutoplay:{type:"boolean",default:!1},carouselAutoplayInterval:{type:"number",default:3e3},gridColumns:{type:"number",default:3},gridColumns_tablet:{type:"number"},gridColumns_mobile:{type:"number"},itemGap:{type:"number",default:20},itemGap_tablet:{type:"number"},itemGap_mobile:{type:"number"},scrollPadding:{type:"number",default:0},scrollPadding_tablet:{type:"number"},scrollPadding_mobile:{type:"number"},itemPadding:{type:"number",default:0},itemPadding_tablet:{type:"number"},itemPadding_mobile:{type:"number"},replaceAccentColor:{type:"boolean",default:!1},navHorizontalPosition:{type:"number",default:-15},navHorizontalPosition_tablet:{type:"number"},navHorizontalPosition_mobile:{type:"number"},navVerticalPosition:{type:"number",default:0},navVerticalPosition_tablet:{type:"number"},navVerticalPosition_mobile:{type:"number"},navButtonIconColor:{type:"string",default:""},navButtonSize:{type:"number"},navButtonSize_tablet:{type:"number"},navButtonSize_mobile:{type:"number"},navButtonIconSize:{type:"number"},navButtonIconSize_tablet:{type:"number"},navButtonIconSize_mobile:{type:"number"},navButtonBackground:{type:"string",default:""},navBackdropBlur:{type:"number"},navBackdropBlur_tablet:{type:"number"},navBackdropBlur_mobile:{type:"number"},navBorderType:{type:"string",default:""},navBorderWidth:{type:"object",default:{}},navBorderColor:{type:"string",default:""},navBorderRadius:{type:"number",default:50},navBorderRadius_tablet:{type:"number"},navBorderRadius_mobile:{type:"number"},navButtonSizeHover:{type:"number"},navButtonSizeHover_tablet:{type:"number"},navButtonSizeHover_mobile:{type:"number"},navButtonIconSizeHover:{type:"number"},navButtonIconSizeHover_tablet:{type:"number"},navButtonIconSizeHover_mobile:{type:"number"},navButtonIconColorHover:{type:"string",default:""},navButtonBackgroundHover:{type:"string",default:""},navButtonBorderColorHover:{type:"string",default:""},rightChevronIcon:{type:"object",default:{library:"",value:""}},leftChevronIcon:{type:"object",default:{library:"",value:""}},visibilityBehavior:{type:"string",default:"show",enum:["show","hide"]},visibilityRules:{type:"array",default:[],items:{type:"object"}},loopEnabled:{type:"boolean",default:!1},loopSource:{type:"string",default:""},loopProperty:{type:"string",default:""},loopLimit:{type:"string",default:""},loopOffset:{type:"string",default:""}},V={$schema:ne,apiVersion:le,name:ae,version:te,title:re,category:ce,description:de,keywords:ie,textdomain:me,supports:se,editorScript:pe,viewScript:ve,render:fe,attributes:ue};function ye(){return{}}function he(e,o){const a={};return e.replaceAccentColor&&o&&(a["--e-global-color-accent"]=o),a}function ge(){return{navListItemStyle:{},navButtonStyle:{}}}function Be({attributes:e,terms:o,isLoading:a,error:t,context:d}){const i=q(null),[g,I]=R(!1),[u,v]=R(!0),s=O(()=>{if(!i.current||e.layoutMode!=="ts-feed-nowrap")return;const c=i.current,y=c.scrollLeft,r=c.scrollWidth,m=c.clientWidth;I(y>0),v(y+m<r-1)},[e.layoutMode]);E(()=>{s();const c=i.current;return c&&(c.addEventListener("scroll",s),window.addEventListener("resize",s)),()=>{c&&c.removeEventListener("scroll",s),window.removeEventListener("resize",s)}},[s,o]);const B=c=>{if(c.preventDefault(),!i.current)return;const y=i.current,r=y.clientWidth*.8;y.scrollBy({left:-r,behavior:"smooth"})},l=c=>{if(c.preventDefault(),!i.current)return;const y=i.current,r=y.clientWidth*.8;y.scrollBy({left:r,behavior:"smooth"})};E(()=>{if(e.layoutMode!=="ts-feed-nowrap"||!e.carouselAutoplay||!i.current||d==="editor")return;const c=setInterval(()=>{if(!i.current)return;const y=i.current,r=y.scrollLeft,m=y.scrollWidth,$=y.clientWidth;r+$>=m-1?y.scrollTo({left:0,behavior:"smooth"}):y.scrollBy({left:$*.8,behavior:"smooth"})},e.carouselAutoplayInterval);return()=>clearInterval(c)},[e.layoutMode,e.carouselAutoplay,e.carouselAutoplayInterval,d]);const f={source:e.source,manualTermIds:e.manualTerms?.map(c=>c.term_id)||[],taxonomy:e.taxonomy,parentTermId:e.parentTermId,order:e.order,perPage:e.perPage,hideEmpty:e.hideEmpty,hideEmptyPostType:e.hideEmptyPostType,cardTemplate:e.cardTemplate,layoutMode:e.layoutMode,carouselItemWidth:e.carouselItemWidth,carouselItemWidthUnit:e.carouselItemWidthUnit,carouselAutoplay:e.carouselAutoplay,carouselAutoplayInterval:e.carouselAutoplayInterval,gridColumns:e.gridColumns,itemGap:e.itemGap,scrollPadding:e.scrollPadding,itemPadding:e.itemPadding,replaceAccentColor:e.replaceAccentColor,navHorizontalPosition:e.navHorizontalPosition,navVerticalPosition:e.navVerticalPosition,navButtonIconColor:e.navButtonIconColor,navButtonSize:e.navButtonSize,navButtonIconSize:e.navButtonIconSize,navButtonBackground:e.navButtonBackground,navBackdropBlur:e.navBackdropBlur,navBorderType:e.navBorderType,navBorderWidth:e.navBorderWidth,navBorderColor:e.navBorderColor,navBorderRadius:e.navBorderRadius,navButtonSizeHover:e.navButtonSizeHover,navButtonIconSizeHover:e.navButtonIconSizeHover,navButtonIconColorHover:e.navButtonIconColorHover,navButtonBackgroundHover:e.navButtonBackgroundHover,navButtonBorderColorHover:e.navButtonBorderColorHover,rightChevronIcon:e.rightChevronIcon,leftChevronIcon:e.leftChevronIcon,responsive:{}},p=ye(),{navListItemStyle:_,navButtonStyle:H}=ge(),C=["post-feed-grid",e.layoutMode,e.layoutMode==="ts-feed-nowrap"?"min-scroll min-scroll-h":""].filter(Boolean).join(" ");return a?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(f)}}),React.createElement("div",{className:"ts-no-posts"},React.createElement("span",{className:"ts-loader"}))):t?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(f)}}),React.createElement("div",{className:"term-feed-error",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"48px",backgroundColor:"#fef2f2",color:"#991b1b"}},t)):!o||o.length===0?React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(f)}}),React.createElement(ee,null)):React.createElement("div",{className:"term-feed-content"},React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(f)}}),React.createElement("div",{ref:i,className:C,style:p,"data-auto-slide":e.carouselAutoplay?e.carouselAutoplayInterval:0},o.map(c=>React.createElement("div",{key:c.id,className:"ts-preview","data-term-id":c.id,style:he(e,c.color)},c.cardHtml?React.createElement("div",{dangerouslySetInnerHTML:{__html:c.cardHtml}}):React.createElement("div",{className:"ts-term-card"},c.icon&&React.createElement("div",{className:"ts-term-icon",dangerouslySetInnerHTML:{__html:c.icon}}),React.createElement("div",{className:"ts-term-name"},c.name),c.count>0&&React.createElement("div",{className:"ts-term-count"},c.count," ",c.count===1?"item":"items"))))),e.layoutMode==="ts-feed-nowrap"&&React.createElement("ul",{className:"simplify-ul flexify post-feed-nav"},React.createElement("li",{style:_},React.createElement("a",{href:"#",className:`ts-icon-btn ts-prev-page ${g?"":"disabled"}`,"aria-label":"Previous",onClick:B,style:H},M(e.leftChevronIcon,L.chevronLeft))),React.createElement("li",{style:_},React.createElement("a",{href:"#",className:`ts-icon-btn ts-next-page ${u?"":"disabled"}`,"aria-label":"Next",onClick:l,style:H},M(e.rightChevronIcon,L.chevronRight)))))}function xe({attributes:e,setAttributes:o,taxonomies:a,postTypes:t,cardTemplates:d}){const[i,g]=R(!1),[I,u]=R(!1),v=[{value:":all",label:n("Any post type","voxel-fse")},...t.map(l=>({value:l.key,label:l.label}))],s=a.map(l=>({value:l.key,label:l.label})),B=d.map(l=>({value:l.id,label:l.label}));return React.createElement(React.Fragment,null,React.createElement(G,{attributes:e,setAttributes:o,stateAttribute:"contentTabOpenPanel",defaultPanel:"term-feed-settings"},React.createElement(k,{id:"term-feed-settings",title:n("Term feed settings","voxel-fse")},React.createElement(S,{label:n("Data source","voxel-fse"),value:e.source,options:[{value:"filters",label:n("Filters","voxel-fse")},{value:"manual",label:n("Manual selection","voxel-fse")}],onChange:l=>o({source:l})}),e.source==="filters"&&React.createElement(S,{label:n("Choose taxonomy","voxel-fse"),value:e.taxonomy,options:s,onChange:l=>o({taxonomy:l})}),e.source==="filters"&&React.createElement(React.Fragment,null,React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},React.createElement(w,{onClick:()=>g(!0)}),React.createElement("label",{style:{margin:0,fontWeight:500}},n("Direct children of (Term ID)","voxel-fse"))),React.createElement(z,{type:"number",value:String(e.parentTermId||""),onChange:l=>o({parentTermId:parseInt(l||"0",10)}),help:n("Enter 0 for top-level terms","voxel-fse"),label:""})),e.source==="filters"&&React.createElement(S,{label:n("Order","voxel-fse"),value:e.order,options:[{value:"default",label:n("Default","voxel-fse")},{value:"name",label:n("Alphabetical","voxel-fse")}],onChange:l=>o({order:l})}),e.source==="filters"&&React.createElement(React.Fragment,null,React.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"}},React.createElement(w,{onClick:()=>u(!0)}),React.createElement("label",{style:{margin:0,fontWeight:500}},n("Number of terms to load","voxel-fse"))),React.createElement(z,{type:"number",value:String(e.perPage||""),onChange:l=>o({perPage:parseInt(l||"10",10)}),help:n("Maximum 500 terms","voxel-fse"),label:""})),e.source==="manual"&&React.createElement("div",{style:{marginBottom:"16px"}},React.createElement(z,{label:n("Term IDs (comma-separated)","voxel-fse"),value:e.manualTerms.map(l=>l.term_id).join(","),onChange:l=>{const f=l.split(",").map(p=>parseInt(p.trim(),10)).filter(p=>!isNaN(p)&&p>0);o({manualTerms:f.map(p=>({term_id:p}))})},help:n("Enter term IDs separated by commas","voxel-fse")})),React.createElement(N,{label:n("Hide empty terms?","voxel-fse"),checked:e.hideEmpty,onChange:l=>o({hideEmpty:l})}),e.hideEmpty&&React.createElement(S,{label:n("Hide terms without a post in:","voxel-fse"),value:e.hideEmptyPostType,options:v,onChange:l=>o({hideEmptyPostType:l})}),React.createElement(S,{label:n("Preview card template","voxel-fse"),value:e.cardTemplate,options:B,onChange:l=>o({cardTemplate:l})})),React.createElement(k,{id:"layout",title:n("Layout","voxel-fse")},React.createElement(S,{label:n("Mode","voxel-fse"),value:e.layoutMode,options:[{value:"ts-feed-grid-default",label:n("Grid","voxel-fse")},{value:"ts-feed-nowrap",label:n("Carousel","voxel-fse")}],onChange:l=>o({layoutMode:l})}),e.layoutMode==="ts-feed-nowrap"&&React.createElement(React.Fragment,null,React.createElement(x,{label:n("Item width","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"carouselItemWidth",min:5,max:100,step:1,help:n("Set the width of an individual item in the carousel","voxel-fse")}),React.createElement(N,{label:n("Auto slide?","voxel-fse"),checked:e.carouselAutoplay,onChange:l=>o({carouselAutoplay:l})}),e.carouselAutoplay&&React.createElement(z,{label:n("Auto slide interval (ms)","voxel-fse"),type:"number",value:String(e.carouselAutoplayInterval||""),onChange:l=>o({carouselAutoplayInterval:parseInt(l||"3000",10)}),help:n("Minimum 500ms recommended","voxel-fse")}),React.createElement(x,{label:n("Scroll padding","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"scrollPadding",min:0,max:100,step:1,help:n("Adds padding to the scrollable area, useful in full width layouts or in responsive mode","voxel-fse")}),React.createElement(x,{label:n("Item padding","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"itemPadding",min:0,max:100,step:1,help:n("Adds padding to an individual item","voxel-fse")})),e.layoutMode==="ts-feed-grid-default"&&React.createElement(x,{label:n("Number of columns","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"gridColumns",min:1,max:6,step:1}),React.createElement(x,{label:n("Item gap","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"itemGap",min:0,max:100,step:1,help:n("Adds gap between the items","voxel-fse")}),React.createElement(N,{label:n("Replace accent color?","voxel-fse"),checked:e.replaceAccentColor,onChange:l=>o({replaceAccentColor:l}),help:n("Replaces the color of any element utilizing accent color to the term color","voxel-fse")})),React.createElement(k,{id:"icons",title:n("Icons","voxel-fse")},React.createElement(j,{label:n("Right chevron","voxel-fse"),value:e.rightChevronIcon,onChange:l=>o({rightChevronIcon:l}),supportsDynamicTags:!0}),React.createElement(j,{label:n("Left chevron","voxel-fse"),value:e.leftChevronIcon,onChange:l=>o({leftChevronIcon:l}),supportsDynamicTags:!0}))),i&&React.createElement(W,{value:String(e.parentTermId||""),onSave:l=>{o({parentTermId:parseInt(l||"0",10)}),g(!1)},onClose:()=>g(!1),context:"term"}),I&&React.createElement(W,{value:String(e.perPage||""),onSave:l=>{o({perPage:parseInt(l||"10",10)}),u(!1)},onClose:()=>u(!1),context:"term"}))}function Ie({attributes:e,setAttributes:o}){return React.createElement(G,{attributes:e,setAttributes:o,stateAttribute:"styleTabOpenPanel",defaultPanel:"carousel-navigation"},React.createElement(k,{id:"carousel-navigation",title:n("Carousel navigation","voxel-fse")},React.createElement(K,{attributeName:"carouselNavState",attributes:e,setAttributes:o,tabs:[{name:"normal",title:n("Normal","voxel-fse")},{name:"hover",title:n("Hover","voxel-fse")}]},a=>a.name==="normal"?React.createElement(React.Fragment,null,React.createElement(x,{label:n("Horizontal position","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navHorizontalPosition",min:-100,max:100,step:1}),React.createElement(x,{label:n("Vertical position","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navVerticalPosition",min:-500,max:500,step:1}),React.createElement(T,{label:n("Button icon color","voxel-fse"),value:e.navButtonIconColor,onChange:t=>o({navButtonIconColor:t||""})}),React.createElement(x,{label:n("Button size","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navButtonSize",min:0,max:100,step:1}),React.createElement(x,{label:n("Button icon size","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navButtonIconSize",min:0,max:100,step:1}),React.createElement(T,{label:n("Button background","voxel-fse"),value:e.navButtonBackground,onChange:t=>o({navButtonBackground:t||""})}),React.createElement(x,{label:n("Backdrop blur","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navBackdropBlur",min:0,max:10,step:1}),React.createElement(Q,{label:n("Border","voxel-fse"),value:{borderType:e.navBorderType||"",borderWidth:e.navBorderWidth||{},borderColor:e.navBorderColor||""},onChange:t=>{const d={};t.borderType!==void 0&&(d.navBorderType=t.borderType),t.borderWidth!==void 0&&(d.navBorderWidth=t.borderWidth),t.borderColor!==void 0&&(d.navBorderColor=t.borderColor),o(d)},hideRadius:!0}),React.createElement(x,{label:n("Button border radius","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navBorderRadius",min:0,max:100,step:1})):React.createElement(React.Fragment,null,React.createElement(x,{label:n("Button size","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navButtonSizeHover",min:0,max:100,step:1}),React.createElement(x,{label:n("Button icon size","voxel-fse"),attributes:e,setAttributes:o,attributeBaseName:"navButtonIconSizeHover",min:0,max:100,step:1}),React.createElement(T,{label:n("Button icon color","voxel-fse"),value:e.navButtonIconColorHover,onChange:t=>o({navButtonIconColorHover:t||""})}),React.createElement(T,{label:n("Button background color","voxel-fse"),value:e.navButtonBackgroundHover,onChange:t=>o({navButtonBackgroundHover:t||""})}),React.createElement(T,{label:n("Button border color","voxel-fse"),value:e.navButtonBorderColorHover,onChange:t=>o({navButtonBorderColorHover:t||""})})))))}function h(e,o,a,t,d="px"){const i=Array.isArray(t)?t:[t],g=[],I=[],u=[],v=f=>typeof d=="function"?d(f):`${f}${d}`;if(e[o]!==void 0&&e[o]!==""){const f=v(e[o]);g.push(`${a} { ${i.map(p=>`${p}: ${f}`).join("; ")}; }`)}const s=`${o}_tablet`;if(e[s]!==void 0&&e[s]!==""){const f=v(e[s]);I.push(`${a} { ${i.map(p=>`${p}: ${f}`).join("; ")}; }`)}const B=`${o}_mobile`;if(e[B]!==void 0&&e[B]!==""){const f=v(e[B]);u.push(`${a} { ${i.map(p=>`${p}: ${f}`).join("; ")}; }`)}let l=g.join(`
`);return I.length>0&&(l+=`
@media (max-width: 1024px) {
${I.join(`
`)}
}`),u.length>0&&(l+=`
@media (max-width: 767px) {
${u.join(`
`)}
}`),l}function A(e,o){const a=[],t=`${o} .ts-icon-btn`,d=`${o} .ts-icon-btn:hover`,i=`${o} .post-feed-nav li:first-child`,g=`${o} .post-feed-nav li:last-child`,I=`${o} .post-feed-nav li`;if(a.push(h(e,"navHorizontalPosition",i,"margin-left")),a.push(h(e,"navHorizontalPosition",g,"margin-right")),a.push(h(e,"navVerticalPosition",I,"margin-top")),e.navButtonIconColor&&a.push(`${t} { --ts-icon-color: ${e.navButtonIconColor}; color: ${e.navButtonIconColor}; }`),a.push(h(e,"navButtonSize",t,["width","height"])),a.push(h(e,"navButtonIconSize",t,"--ts-icon-size")),e.navButtonBackground&&a.push(`${t} { background-color: ${e.navButtonBackground}; }`),a.push(h(e,"navBackdropBlur",t,"backdrop-filter",v=>`blur(${v}px)`)),e.navBorderType&&e.navBorderType!=="none"){const{top:v,right:s,bottom:B,left:l}=e.navBorderWidth||{top:0,right:0,bottom:0,left:0};a.push(`${t} { border-style: ${e.navBorderType}; border-width: ${v}px ${s}px ${B}px ${l}px; border-color: ${e.navBorderColor}; }`)}a.push(h(e,"navBorderRadius",t,"border-radius")),a.push(h(e,"navButtonSizeHover",d,["width","height"])),a.push(h(e,"navButtonIconSizeHover",d,"--ts-icon-size")),e.navButtonIconColorHover&&a.push(`${d} { --ts-icon-color: ${e.navButtonIconColorHover}; color: ${e.navButtonIconColorHover}; }`),e.navButtonBackgroundHover&&a.push(`${d} { background-color: ${e.navButtonBackgroundHover}; }`),e.navButtonBorderColorHover&&a.push(`${d} { border-color: ${e.navButtonBorderColorHover}; }`);const u=`${o} .post-feed-grid`;if(a.push(h(e,"itemGap",u,"gap")),e.layoutMode==="ts-feed-grid-default")a.push(h(e,"gridColumns",u,"grid-template-columns",v=>`repeat(${v}, minmax(0, 1fr))`));else if(e.layoutMode==="ts-feed-nowrap"){a.push(h(e,"scrollPadding",u,["padding-left","padding-right","scroll-padding"]));const v=`${u} > div:last-of-type`;a.push(h(e,"scrollPadding",v,"margin-right"));const s=`${o} .ts-feed-nowrap .ts-preview`;a.push(h(e,"carouselItemWidth",s,["width","min-width","flex-basis"],B=>`${B}${e.carouselItemWidthUnit||"%"}`)),a.push(h(e,"itemPadding",s,"padding"))}return a.filter(Boolean).join(`
`)}function Ce({attributes:e,setAttributes:o,clientId:a}){const[t,d]=R([]),[i,g]=R([]),[I,u]=R([]),[v,s]=R([]),[B,l]=R(!1),[f,p]=R(null);E(()=>{e.blockId||o({blockId:a})},[e.blockId,a,o]),E(()=>{const r="voxel-post-feed-css";if(!document.getElementById(r)){const m=document.createElement("link");m.id=r,m.rel="stylesheet";const b=(window.Voxel_Config?.site_url||window.location.origin).replace(/\/$/,"");m.href=`${b}/wp-content/themes/voxel/assets/dist/post-feed.css?ver=1.7.5.2`,document.head.appendChild(m)}},[]),E(()=>{P({path:"/voxel-fse/v1/term-feed/taxonomies"}).then(r=>{const m=r;d(m.taxonomies||[]),!e.taxonomy&&m.taxonomies?.length>0&&o({taxonomy:m.taxonomies[0].key})}).catch(r=>{console.error("Failed to fetch taxonomies:",r)})},[]),E(()=>{P({path:"/voxel-fse/v1/term-feed/post-types"}).then(r=>{g(r.postTypes||[])}).catch(r=>{console.error("Failed to fetch post types:",r)})},[]),E(()=>{P({path:"/voxel-fse/v1/term-feed/card-templates"}).then(r=>{u(r.templates||[])}).catch(r=>{console.error("Failed to fetch card templates:",r)})},[]);const _=O(async()=>{if(e.source==="manual"){const r=e.manualTerms.map(m=>m.term_id).filter(Boolean);if(r.length===0){s([]);return}l(!0),p(null);try{const m=await P({path:`/voxel-fse/v1/term-feed/terms?source=manual&term_ids=${r.join(",")}${e.hideEmpty?"&hide_empty=1":""}${e.hideEmptyPostType!==":all"?`&hide_empty_pt=${e.hideEmptyPostType}`:""}&card_template=${e.cardTemplate}`});s(m.terms||[])}catch(m){p(m instanceof Error?m.message:"Failed to load terms")}finally{l(!1)}}else{if(!e.taxonomy){s([]);return}l(!0),p(null);try{const r=new URLSearchParams({source:"filters",taxonomy:e.taxonomy,order:e.order,per_page:String(e.perPage),card_template:e.cardTemplate});e.parentTermId&&r.set("parent_term_id",String(e.parentTermId)),e.hideEmpty&&(r.set("hide_empty","1"),e.hideEmptyPostType!==":all"&&r.set("hide_empty_pt",e.hideEmptyPostType));const m=await P({path:`/voxel-fse/v1/term-feed/terms?${r.toString()}`});s(m.terms||[])}catch(r){p(r instanceof Error?r.message:"Failed to load terms")}finally{l(!1)}}},[e.source,e.manualTerms,e.taxonomy,e.parentTermId,e.order,e.perPage,e.hideEmpty,e.hideEmptyPostType,e.cardTemplate]);E(()=>{_()},[_]);const H=e.blockId||a,C=D(e,{blockId:H,baseClass:"voxel-fse-term-feed"}),c=X(()=>A(e,C.uniqueSelector),[e,C.uniqueSelector]),y=F({id:C.elementId,className:C.className,style:C.styles,...C.customAttrs});return React.createElement("div",{...y},(C.responsiveCSS||c)&&React.createElement("style",{dangerouslySetInnerHTML:{__html:[C.responsiveCSS,c].filter(Boolean).join(`
`)}}),React.createElement(J,null,React.createElement(Y,{tabs:[{id:"content",label:n("Content","voxel-fse"),icon:"",render:()=>React.createElement(xe,{attributes:e,setAttributes:o,taxonomies:t,postTypes:i,cardTemplates:I})},{id:"style",label:n("Style","voxel-fse"),icon:"",render:()=>React.createElement(Ie,{attributes:e,setAttributes:o})}],includeAdvancedTab:!0,includeVoxelTab:!0,attributes:e,setAttributes:o})),React.createElement(Be,{attributes:e,terms:v,isLoading:B,error:f,context:"editor"}))}function Re({attributes:e}){const o=D(e,{blockId:e.blockId||"term-feed",baseClass:"voxel-fse-term-feed"}),a=A(e,o.uniqueSelector),t=[o.responsiveCSS,a].filter(Boolean).join(`
`),d=F.save({id:o.elementId,className:o.className,style:o.styles,"data-visibility-behavior":e.visibilityBehavior||void 0,"data-visibility-rules":e.visibilityRules?.length?JSON.stringify(e.visibilityRules):void 0,"data-loop-source":e.loopSource||void 0,"data-loop-limit":e.loopLimit||void 0,"data-loop-offset":e.loopOffset||void 0,...o.customAttrs}),i={source:e.source,manualTermIds:e.manualTerms.map(g=>g.term_id),taxonomy:e.taxonomy,parentTermId:e.parentTermId,order:e.order,perPage:e.perPage,hideEmpty:e.hideEmpty,hideEmptyPostType:e.hideEmptyPostType,cardTemplate:e.cardTemplate,layoutMode:e.layoutMode,carouselItemWidth:e.carouselItemWidth,carouselItemWidthUnit:e.carouselItemWidthUnit,carouselAutoplay:e.carouselAutoplay,carouselAutoplayInterval:e.carouselAutoplayInterval,gridColumns:e.gridColumns,itemGap:e.itemGap,scrollPadding:e.scrollPadding,itemPadding:e.itemPadding,replaceAccentColor:e.replaceAccentColor,navHorizontalPosition:e.navHorizontalPosition,navVerticalPosition:e.navVerticalPosition,navButtonIconColor:e.navButtonIconColor,navButtonSize:e.navButtonSize,navButtonIconSize:e.navButtonIconSize,navButtonBackground:e.navButtonBackground,navBackdropBlur:e.navBackdropBlur,navBorderType:e.navBorderType,navBorderWidth:e.navBorderWidth,navBorderColor:e.navBorderColor,navBorderRadius:e.navBorderRadius,navButtonSizeHover:e.navButtonSizeHover,navButtonIconSizeHover:e.navButtonIconSizeHover,navButtonIconColorHover:e.navButtonIconColorHover,navButtonBackgroundHover:e.navButtonBackgroundHover,navButtonBorderColorHover:e.navButtonBorderColorHover,rightChevronIcon:e.rightChevronIcon,leftChevronIcon:e.leftChevronIcon,responsive:{carouselItemWidth_tablet:e.carouselItemWidth_tablet,carouselItemWidth_mobile:e.carouselItemWidth_mobile,gridColumns_tablet:e.gridColumns_tablet,gridColumns_mobile:e.gridColumns_mobile,itemGap_tablet:e.itemGap_tablet,itemGap_mobile:e.itemGap_mobile,scrollPadding_tablet:e.scrollPadding_tablet,scrollPadding_mobile:e.scrollPadding_mobile,itemPadding_tablet:e.itemPadding_tablet,itemPadding_mobile:e.itemPadding_mobile,navHorizontalPosition_tablet:e.navHorizontalPosition_tablet,navHorizontalPosition_mobile:e.navHorizontalPosition_mobile,navVerticalPosition_tablet:e.navVerticalPosition_tablet,navVerticalPosition_mobile:e.navVerticalPosition_mobile,navButtonSize_tablet:e.navButtonSize_tablet,navButtonSize_mobile:e.navButtonSize_mobile,navButtonIconSize_tablet:e.navButtonIconSize_tablet,navButtonIconSize_mobile:e.navButtonIconSize_mobile,navBackdropBlur_tablet:e.navBackdropBlur_tablet,navBackdropBlur_mobile:e.navBackdropBlur_mobile,navBorderRadius_tablet:e.navBorderRadius_tablet,navBorderRadius_mobile:e.navBorderRadius_mobile,navButtonSizeHover_tablet:e.navButtonSizeHover_tablet,navButtonSizeHover_mobile:e.navButtonSizeHover_mobile,navButtonIconSizeHover_tablet:e.navButtonIconSizeHover_tablet,navButtonIconSizeHover_mobile:e.navButtonIconSizeHover_mobile}};return React.createElement("div",{...d},t&&React.createElement("style",{dangerouslySetInnerHTML:{__html:t}}),Z(e,!1,void 0,void 0,o.uniqueSelector),React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(i)}}),React.createElement("div",{className:"voxel-fse-block-placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f0f0f0",padding:"24px",minHeight:"120px"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"32",height:"32",fill:"currentColor",style:{opacity:.3}},React.createElement("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),React.createElement("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"}))))}U(V.name,{...V,icon:oe,edit:Ce,save:Re});
