import{registerBlockType as Ee}from"@wordpress/blocks";import{useBlockProps as he,InspectorControls as Ce}from"@wordpress/block-editor";import{__ as o}from"@wordpress/i18n";import{useState as T,useRef as H,useCallback as k,useEffect as ie,useMemo as fe}from"react";import _e from"@wordpress/api-fetch";import{A as be,a as se,S as q,E as we,R as P,C as L,T as $e}from"../TypographyPopup-CAcEJ5NA.js";import{I as ke}from"../InspectorTabs-Bq2wAh4W.js";import{SelectControl as U,TextControl as Z,ToggleControl as ne}from"@wordpress/components";import"@wordpress/data";/* empty css                            */import"../RepeaterControl-C7JnAhZL.js";import"../voxelShim-DB_Ue-9R.js";import{g as ye}from"../useAdvancedTabProps-BnJDQbKr.js";import{r as Se}from"../backgroundElements-Ui-iCrLV.js";import{A as G}from"../AdvancedIconControl-CJ_DCTeD.js";import{L as Te}from"../LoopElementModal-CaevVMh1.js";import{R as Ne,L as Me}from"../RepeaterControl-B_ulBkEL.js";import{P as Ie}from"../PopupCustomStyleControl-XQPXOL9P.js";import{F as le}from"../FormPopup-DDYHzYWU.js";import{E as oe}from"../EmptyPlaceholder-BsL18qxN.js";import{V as Ve}from"../VoxelGridIcon-D5dF5acW.js";import"react-dom";import"../generateAdvancedStyles-CRpLcHXt.js";import"../generateVoxelStyles-oZeaeuKH.js";const Be={_id:"",componentType:"notifications",chooseMenu:"",icon:{library:"icon",value:"las la-bell"},componentUrl:{url:"",is_external:!0,nofollow:!0},componentTitle:"",messagesTitle:"Messages",wpMenuTitle:"Menu",notificationsTitle:"Notifications",cartTitle:"Cart",labelVisibility:!1,labelVisibilityDesktop:"none",labelVisibilityTablet:"none",labelVisibilityMobile:"none",componentVisibility:!1,userBarVisibilityDesktop:"flex",userBarVisibilityTablet:"flex",userBarVisibilityMobile:"flex",rowVisibility:"show",visibilityRules:[]},Oe=[{label:o("Notifications","voxel-fse"),value:"notifications"},{label:o("Cart","voxel-fse"),value:"cart"},{label:o("Messages","voxel-fse"),value:"messages"},{label:o("User Menu","voxel-fse"),value:"user_menu"},{label:o("Menu","voxel-fse"),value:"select_wp_menu"},{label:o("Custom link","voxel-fse"),value:"link"}],ee=[{label:o("Show","voxel-fse"),value:"flex"},{label:o("Hide","voxel-fse"),value:"none"}];function je({attributes:e,setAttributes:l,navMenus:a}){const[c,m]=T(null),[r,h]=T(null),u=t=>{switch(t.componentType){case"notifications":return t.notificationsTitle||"Notifications";case"messages":return t.messagesTitle||"Messages";case"cart":return t.cartTitle||"Cart";case"user_menu":case"select_wp_menu":return t.wpMenuTitle||"Menu";case"link":return t.componentTitle||"Link";default:return t.componentType}},v=(t,f)=>{l({icons:{...e.icons,[t]:f}})},C=(t,f)=>{const _=[...e.items];_[t]={..._[t],...f},l({items:_})};return React.createElement(React.Fragment,null,React.createElement("div",{className:"voxel-inspector-section"},React.createElement(be,{defaultPanel:"items"},React.createElement(se,{id:"items",title:o("User area components","voxel-fse")},React.createElement(Ne,{items:e.items,onChange:t=>l({items:t}),getItemLabel:t=>u(t),createItem:()=>({...Be,_id:`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,rowVisibility:"show",visibilityRules:[],userBarVisibilityDesktop:"flex",userBarVisibilityTablet:"flex",userBarVisibilityMobile:"flex"}),renderContent:({item:t,index:f,onUpdate:_})=>{const p=(s,z)=>{_({[s]:z})};return React.createElement("div",{className:"voxel-repeater-content"},React.createElement(q,{label:o("Component details","voxel-fse")}),React.createElement(U,{label:o("Component type","voxel-fse"),value:t.componentType,options:Oe,onChange:s=>p("componentType",s)}),(t.componentType==="user_menu"||t.componentType==="select_wp_menu")&&React.createElement(U,{label:o("Choose menu","voxel-fse"),value:t.chooseMenu,options:a,onChange:s=>p("chooseMenu",s)}),React.createElement(G,{label:o("Icon","voxel-fse"),value:t.icon,onChange:s=>p("icon",s)}),t.componentType==="link"&&React.createElement(React.Fragment,null,React.createElement(Z,{label:o("Link URL","voxel-fse"),value:t.componentUrl.url,onChange:s=>p("componentUrl",{...t.componentUrl,url:s}),placeholder:"https://your-link.com"}),React.createElement(ne,{label:o("Open in new tab","voxel-fse"),checked:t.componentUrl.is_external,onChange:s=>p("componentUrl",{...t.componentUrl,is_external:s})})),t.componentType==="link"&&React.createElement(Z,{label:o("Label","voxel-fse"),value:t.componentTitle,onChange:s=>p("componentTitle",s)}),t.componentType==="messages"&&React.createElement(Z,{label:o("Label","voxel-fse"),value:t.messagesTitle,onChange:s=>p("messagesTitle",s)}),t.componentType==="select_wp_menu"&&React.createElement(Z,{label:o("Label","voxel-fse"),value:t.wpMenuTitle,onChange:s=>p("wpMenuTitle",s)}),t.componentType==="notifications"&&React.createElement(Z,{label:o("Label","voxel-fse"),value:t.notificationsTitle,onChange:s=>p("notificationsTitle",s)}),t.componentType==="cart"&&React.createElement(Z,{label:o("Label","voxel-fse"),value:t.cartTitle,onChange:s=>p("cartTitle",s)}),React.createElement("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #ddd"}}),React.createElement(ne,{label:o("Enable label visibility","voxel-fse"),checked:t.labelVisibility,onChange:s=>p("labelVisibility",s)}),t.labelVisibility&&React.createElement(React.Fragment,null,React.createElement(U,{label:o("Show on desktop","voxel-fse"),value:t.labelVisibilityDesktop,options:ee,onChange:s=>p("labelVisibilityDesktop",s)}),React.createElement(U,{label:o("Show on tablet","voxel-fse"),value:t.labelVisibilityTablet,options:ee,onChange:s=>p("labelVisibilityTablet",s)}),React.createElement(U,{label:o("Show on mobile","voxel-fse"),value:t.labelVisibilityMobile,options:ee,onChange:s=>p("labelVisibilityMobile",s)})),React.createElement("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #ddd"}}),React.createElement(ne,{label:o("Component visibility","voxel-fse"),checked:t.componentVisibility,onChange:s=>p("componentVisibility",s)}),t.componentVisibility&&React.createElement(React.Fragment,null,React.createElement(U,{label:o("Show on desktop","voxel-fse"),value:t.userBarVisibilityDesktop,options:ee,onChange:s=>p("userBarVisibilityDesktop",s)}),React.createElement(U,{label:o("Show on tablet","voxel-fse"),value:t.userBarVisibilityTablet,options:ee,onChange:s=>p("userBarVisibilityTablet",s)}),React.createElement(U,{label:o("Show on mobile","voxel-fse"),value:t.userBarVisibilityMobile,options:ee,onChange:s=>p("userBarVisibilityMobile",s)})),React.createElement(Me,{itemId:t._id,rowVisibility:t.rowVisibility||"show",onRowVisibilityChange:s=>p("rowVisibility",s),visibilityRules:t.visibilityRules||[],onEditVisibilityRules:()=>m(f),onClearVisibilityRules:()=>p("visibilityRules",[]),showLoopSection:!0,loopSource:t.loopSource,loopProperty:t.loopProperty,loopLimit:t.loopLimit,loopOffset:t.loopOffset,onEditLoop:()=>h(f),onClearLoop:()=>{p("loopSource",""),p("loopProperty","")},onLoopLimitChange:s=>p("loopLimit",s),onLoopOffsetChange:s=>p("loopOffset",s)}))}})),React.createElement(se,{id:"icons",title:o("Icons","voxel-fse")},React.createElement(G,{label:o("Down arrow","voxel-fse"),value:e.icons.downArrow,onChange:t=>v("downArrow",t)}),React.createElement(G,{label:o("Right arrow","voxel-fse"),value:e.icons.rightArrow,onChange:t=>v("rightArrow",t)}),React.createElement(G,{label:o("Left arrow","voxel-fse"),value:e.icons.leftArrow,onChange:t=>v("leftArrow",t)}),React.createElement(G,{label:o("Close icon","voxel-fse"),value:e.icons.close,onChange:t=>v("close",t)}),React.createElement(G,{label:o("Trash icon","voxel-fse"),value:e.icons.trash,onChange:t=>v("trash",t)}),React.createElement(G,{label:o("Inbox icon","voxel-fse"),value:e.icons.inbox,onChange:t=>v("inbox",t)}),React.createElement(G,{label:o("Load more icon","voxel-fse"),value:e.icons.loadMore,onChange:t=>v("loadMore",t)})))),c!==null&&React.createElement(we,{isOpen:!0,rules:e.items[c].visibilityRules||[],onClose:()=>m(null),onSave:t=>{C(c,{visibilityRules:t})}}),r!==null&&React.createElement(Te,{isOpen:!0,config:{source:e.items[r].loopSource,property:e.items[r].loopProperty},onClose:()=>h(null),onSave:t=>{C(r,{loopSource:t.source,loopProperty:t.property})}}))}const Le=[{label:o("Left","voxel-fse"),value:"left"},{label:o("Center","voxel-fse"),value:"center"},{label:o("Right","voxel-fse"),value:"right"},{label:o("Space between","voxel-fse"),value:"space-between"},{label:o("Space around","voxel-fse"),value:"space-around"}];function ze({attributes:e,setAttributes:l}){return React.createElement(React.Fragment,null,React.createElement("div",{className:"voxel-inspector-section"},React.createElement(be,{defaultPanel:"general"},React.createElement(se,{id:"general",title:o("User area: General","voxel-fse")},React.createElement(q,{label:o("Layout","voxel-fse")}),React.createElement(U,{label:o("Align items","voxel-fse"),value:e.itemsAlign,options:Le,onChange:a=>l({itemsAlign:a})}),React.createElement(ne,{label:o("Vertical orientation?","voxel-fse"),checked:e.verticalOrientation,onChange:a=>l({verticalOrientation:a})}),e.verticalOrientation&&React.createElement(U,{label:o("Align item content","voxel-fse"),value:e.itemContentAlign,options:[{label:o("Left","voxel-fse"),value:"left"},{label:o("Center","voxel-fse"),value:"center"},{label:o("Right","voxel-fse"),value:"right"}],onChange:a=>l({itemContentAlign:a})}),React.createElement(q,{label:o("Item","voxel-fse")}),React.createElement(P,{label:o("Gap","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"itemGap",min:0,max:50}),React.createElement(L,{label:o("Item background","voxel-fse"),value:e.itemBackground,onChange:a=>l({itemBackground:a??""})}),React.createElement(L,{label:o("Item background (hover)","voxel-fse"),value:e.itemBackgroundHover,onChange:a=>l({itemBackgroundHover:a??"#fff"})}),React.createElement(P,{label:o("Item border radius","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"itemBorderRadius",min:0,max:100}),React.createElement(P,{label:o("Item content gap","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"itemContentGap",min:0,max:50}),React.createElement(q,{label:o("Item icon","voxel-fse")}),React.createElement(P,{label:o("Container size","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"iconContainerSize",min:30,max:80}),React.createElement(P,{label:o("Container border radius","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"iconContainerRadius",min:0,max:100}),React.createElement(L,{label:o("Container background","voxel-fse"),value:e.iconContainerBackground,onChange:a=>l({iconContainerBackground:a??""})}),React.createElement(L,{label:o("Container background (hover)","voxel-fse"),value:e.iconContainerBackgroundHover,onChange:a=>l({iconContainerBackgroundHover:a??""})}),React.createElement(P,{label:o("Icon size","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"iconSize",min:10,max:50}),React.createElement(L,{label:o("Icon color","voxel-fse"),value:e.iconColor,onChange:a=>l({iconColor:a??""})}),React.createElement(L,{label:o("Icon color (hover)","voxel-fse"),value:e.iconColorHover,onChange:a=>l({iconColorHover:a??""})}),React.createElement(q,{label:o("Unread indicator","voxel-fse")}),React.createElement(L,{label:o("Unread indicator color","voxel-fse"),value:e.unreadIndicatorColor,onChange:a=>l({unreadIndicatorColor:a??""})}),React.createElement(P,{label:o("Indicator top margin","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"unreadIndicatorMargin",min:0,max:50}),React.createElement(P,{label:o("Indicator size","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"unreadIndicatorSize",min:0,max:50}),React.createElement(q,{label:o("Avatar","voxel-fse")}),React.createElement(P,{label:o("Avatar size","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"avatarSize",min:20,max:100}),React.createElement(P,{label:o("Avatar radius","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"avatarRadius",min:0,max:100}),React.createElement(q,{label:o("Item label","voxel-fse")}),React.createElement($e,{label:o("Typography","voxel-fse"),value:e.labelTypography,onChange:a=>l({labelTypography:a})}),React.createElement(L,{label:o("Color","voxel-fse"),value:e.labelColor,onChange:a=>l({labelColor:a??""})}),React.createElement(L,{label:o("Color (hover)","voxel-fse"),value:e.labelColorHover,onChange:a=>l({labelColorHover:a??""})}),React.createElement(q,{label:o("Chevron","voxel-fse")}),React.createElement(L,{label:o("Chevron color","voxel-fse"),value:e.chevronColor,onChange:a=>l({chevronColor:a??""})}),React.createElement(L,{label:o("Chevron color (hover)","voxel-fse"),value:e.chevronColorHover,onChange:a=>l({chevronColorHover:a??""})}),React.createElement(ne,{label:o("Hide chevron","voxel-fse"),checked:e.hideChevron,onChange:a=>l({hideChevron:a})})),React.createElement(se,{id:"popups",title:o("Popups: Custom style","voxel-fse")},React.createElement(Ie,{attributes:e,setAttributes:l})))))}function Y(){return window.VoxelFSEUserbar??null}function F(e){const l=window.Voxel_Config;return l?.ajax_url?`${l.ajax_url}&action=${e}`:`${l?.site_url||window.location.origin}/?vx=1&action=${e}`}function X(){const e=Y();return e?e.isLoggedIn:window.Voxel_Config?.is_logged_in??!1}function S(e,l="error"){const a=window.Voxel;a?.alert?a.alert(e,l):console.error(`[Userbar] ${l}: ${e}`)}function x(e,l){const a=Y();if(a?.l10n){const m=a.l10n;if(m[e])return m[e]}return window.Voxel_Config?.l10n?.[e]??l}function Re(e){return Y()?.nonces?.[e]??""}function ve(e,l){const a=window.Voxel;return a?.helpers?.currencyFormat?a.helpers.currencyFormat(e,l):`$${(e/100).toFixed(2)}`}function re(e){return!e||!e.value?null:e.library==="svg"&&e.value?React.createElement("img",{src:e.value,alt:"",style:{width:"1em",height:"1em"}}):e.library==="icon"&&e.value?React.createElement("i",{className:e.value,"aria-hidden":"true"}):null}function Ae({item:e,icons:l,context:a}){const[c,m]=T(!1),r=H(null),h=H(null),v=Y()?.unread?.notifications??0,[C,t]=T(null),[f,_]=T(!1),[p,s]=T(!0),[z,$]=T(!1),[g,V]=T(1),[w,A]=T(null),B=H(0),O=k(async(i=1)=>{$(!0);try{const y=F("notifications.list"),b=await(await fetch(`${y}&pg=${i}`)).json();b.success?(t(I=>i===1?b.list:[...I||[],...b.list]),_(b.has_more)):S(b.message||x("ajaxError","An error occurred"))}catch{S(x("ajaxError","An error occurred"))}finally{s(!1),$(!1)}},[]),J=k(()=>{a==="frontend"&&(C===null&&(t([]),h.current?.classList.add("hidden"),O(1)),m(!0))},[a,C,O]),ce=k(()=>{const i=g+1;V(i),O(i)},[g,O]),K=k(async()=>{const i=x("confirmClear","Clear all notifications?");if(window.confirm(i))try{const y=F("notifications.clear_all"),b=await(await fetch(y)).json();b.success?t([]):S(b.message||x("ajaxError","An error occurred"))}catch{S(x("ajaxError","An error occurred"))}},[]),ae=k(()=>{A(null),requestAnimationFrame(()=>{const i=document.querySelector(".min-scroll");i&&(i.scrollTop=B.current)})},[]),D=k(async i=>{if(i.links_to==="(details)"){const y=document.querySelector(".min-scroll");y&&(B.current=y.scrollTop),i.actions===void 0?(t(R=>R?.map(b=>b.id===i.id?{...b,seen:!0}:b)||null),Q(i)):(A(i),requestAnimationFrame(()=>{const R=document.querySelector(".min-scroll");R&&(R.scrollTop=0)}))}else{t(y=>y?.map(R=>R.id===i.id?{...R,_loading:!0}:R)||null);try{const y=F("notifications.open"),b=await(await fetch(`${y}&item_id=${i.id}`)).json();b.success?(t(I=>I?.map(n=>n.id===i.id?{...n,seen:!0,_loading:!1}:n)||null),b.redirect_to&&(window.location.href=b.redirect_to)):(S(b.message||x("ajaxError","An error occurred")),t(I=>I?.map(n=>n.id===i.id?{...n,_loading:!1}:n)||null))}catch{S(x("ajaxError","An error occurred")),t(y=>y?.map(R=>R.id===i.id?{...R,_loading:!1}:R)||null)}}},[]),Q=k(async(i,y=1)=>{t(R=>R?.map(b=>b.id===i.id?{...b,_loading:!0,actions_page:y}:b)||null);try{const R=F("notifications.get_actions"),I=await(await fetch(`${R}&item_id=${i.id}&pg=${y}`)).json();if(I.success){const n={...i,actions:y===1?I.actions:[...i.actions||[],...I.actions],actions_page:y,_loading:!1,seen:!0};t(d=>d?.map(E=>E.id===i.id?n:E)||null),A(n),y===1&&requestAnimationFrame(()=>{const d=document.querySelector(".min-scroll");d&&(d.scrollTop=0)})}else S(I.message||x("ajaxError","An error occurred")),t(n=>n?.map(d=>d.id===i.id?{...d,_loading:!1,seen:!0}:d)||null)}catch{S(x("ajaxError","An error occurred")),t(R=>R?.map(b=>b.id===i.id?{...b,_loading:!1}:b)||null)}},[]),W=k(async(i,y,R)=>{const b=R?.key||y.key;if(!b)return;const I=n=>{w&&A({...w,actions:w.actions?.map(d=>d===y?{...d,_loading:n}:d)})};I(!0);try{const n=F("notifications.run_action"),E=await(await fetch(`${n}&item_id=${i.id}&action_key=${b}&pg=${y._page||1}`)).json();if(E.success){if(E.updated_action&&w?.actions){const j=w.actions.indexOf(y);if(j!==-1){const M=[...w.actions];M[j]=E.updated_action,A({...w,actions:M})}}E.redirect_to&&(window.location.href=E.redirect_to)}else S(E.message||x("ajaxError","An error occurred"))}catch{S(x("ajaxError","An error occurred"))}finally{I(!1)}},[w]),te=i=>React.createElement("div",{key:i.id,className:`ts-notification-item ${i.seen?"":"ts-unread"} ${i._loading?"vx-pending":""}`,onClick:()=>D(i)},i.image_url&&React.createElement("div",{className:"ts-notification-image"},React.createElement("img",{src:i.image_url,alt:""})),React.createElement("div",{className:"ts-notification-body"},React.createElement("span",{className:"ts-notification-subject"},i.subject),React.createElement("span",{className:"ts-notification-time"},i.time))),de=(i,y)=>i.type==="list-item"?React.createElement("div",{key:i.key,className:`ts-action-item ${i._loading?"vx-pending":""}`,onClick:()=>i.links_to?window.location.href=i.links_to:W(y,i)},i.image_markup&&React.createElement("div",{className:"ts-action-image",dangerouslySetInnerHTML:{__html:i.image_markup}}),React.createElement("div",{className:"ts-action-body"},i.subject&&React.createElement("span",{className:"ts-action-subject"},i.subject),i.details&&React.createElement("span",{className:"ts-action-details"},i.details)),i.actions&&i.actions.length>0&&React.createElement("div",{className:"ts-action-buttons"},i.actions.map(R=>React.createElement("button",{key:R.key,className:"ts-btn ts-btn-1",onClick:b=>{b.stopPropagation(),W(y,i,R)}},R.label)))):i.type==="button"?React.createElement("button",{key:i.key,className:`ts-btn ts-btn-1 ${i._loading?"vx-pending":""}`,onClick:()=>W(y,i)},i.label):null;return React.createElement("li",{className:`ts-notifications-wrapper elementor-repeater-item-${e._id}`},React.createElement("a",{ref:r,href:"#",onClick:i=>{i.preventDefault(),J()},role:"button","aria-label":e.notificationsTitle||"Notifications"},React.createElement("div",{className:"ts-comp-icon flexify"},re(e.icon),a==="frontend"&&X()&&React.createElement("span",{ref:h,className:"unread-indicator",style:{display:v>0?void 0:"none"}})),React.createElement("span",{className:"ts_comp_label"},e.notificationsTitle||"Notifications")),a==="frontend"&&React.createElement(le,{isOpen:c,popupId:`notifications-popup-${e._id}`,target:r.current,title:e.notificationsTitle||"Notifications",icon:e.icon?.value?`<i class="${e.icon.value}"></i>`:"",onClose:()=>{m(!1),A(null)},showFooter:!1,popupClass:"md-width"},React.createElement("div",{className:"ts-notifications-list min-scroll"},C&&C.length>0&&!w&&React.createElement("div",{className:"ts-notifications-header flexify"},React.createElement("button",{className:"ts-btn ts-btn-1",onClick:K},x("clearAll","Clear all"))),p&&React.createElement(oe,null),w&&React.createElement("div",{className:"ts-notification-details"},React.createElement("button",{className:"ts-btn ts-btn-1 ts-back-btn",onClick:ae},React.createElement("i",{className:"las la-arrow-left"}),x("back","Back")),React.createElement("div",{className:"ts-notification-content"},React.createElement("span",{className:"ts-notification-subject"},w.subject),React.createElement("span",{className:"ts-notification-time"},w.time)),w.actions&&React.createElement("div",{className:"ts-notification-actions"},w.actions.map(i=>de(i,w))),w._loading&&React.createElement("div",{className:"ts-loader"})),!p&&!w&&React.createElement(React.Fragment,null,C&&C.length>0?React.createElement(React.Fragment,null,C.map(te),f&&React.createElement("button",{className:`ts-btn ts-btn-1 ts-load-more ${z?"vx-pending":""}`,onClick:ce,disabled:z},z?React.createElement("span",{className:"ts-loader"}):x("loadMore","Load more"))):React.createElement(oe,null)))))}function Pe({item:e,icons:l,context:a,nonce:c}){const[m,r]=T(!1),h=H(null),u=H(null),v=Y(),C=c||Re("chat"),t=v?.unread?.messages??!1,[f,_]=T({list:null,hasMore:!1,loading:!0,loadingMore:!1,page:1}),p=k(async(g=1)=>{_(V=>({...V,loadingMore:!0}));try{const V=F("inbox.list_chats"),w=new FormData;w.append("pg",g.toString()),C&&w.append("_wpnonce",C);const B=await(await fetch(V,{method:"POST",body:w})).json();B.success?_(O=>({...O,list:g===1?B.list:[...O.list||[],...B.list],hasMore:B.has_more,loading:!1,loadingMore:!1})):(S(B.message||x("ajaxError","An error occurred")),_(O=>({...O,loading:!1,loadingMore:!1})))}catch{S(x("ajaxError","An error occurred")),_(V=>({...V,loading:!1,loadingMore:!1}))}},[C]),s=k(()=>{a==="frontend"&&(r(!0),f.list===null&&(_(g=>({...g,list:[]})),u.current?.classList.add("hidden"),p(1)))},[a,f.list,p]),z=k(()=>{const g=f.page+1;_(V=>({...V,page:g})),p(g)},[f.page,p]),$=g=>React.createElement("a",{key:g.id,href:g.link,className:`ts-chat-item ${g.seen?"":"ts-unread"}`},React.createElement("div",{className:"ts-chat-avatar"},React.createElement("img",{src:g.target.avatar,alt:g.target.name})),React.createElement("div",{className:"ts-chat-body"},React.createElement("span",{className:"ts-chat-name"},g.target.name),React.createElement("span",{className:"ts-chat-excerpt"},g.excerpt),React.createElement("span",{className:"ts-chat-time"},g.time)));return React.createElement("li",{className:`ts-popup-messages elementor-repeater-item-${e._id}`},React.createElement("a",{ref:h,href:"#",onClick:g=>{g.preventDefault(),s()},role:"button","aria-label":e.messagesTitle||"Messages"},React.createElement("div",{className:"ts-comp-icon flexify"},re(e.icon),a==="frontend"&&X()&&React.createElement("span",{ref:u,className:"unread-indicator",style:{display:t?void 0:"none"}})),React.createElement("span",{className:"ts_comp_label"},e.messagesTitle||"Messages")),a==="frontend"&&React.createElement(le,{isOpen:m,popupId:`messages-popup-${e._id}`,target:h.current,title:e.messagesTitle||"Messages",icon:e.icon?.value?`<i class="${e.icon.value}"></i>`:"",onClose:()=>r(!1),showFooter:!1,popupClass:"md-width"},React.createElement("div",{className:"ts-chats-list min-scroll"},f.loading&&React.createElement("div",{className:"ts-empty-user-tab"},React.createElement("div",{className:"ts-loader"})),!f.loading&&React.createElement(React.Fragment,null,f.list&&f.list.length>0?React.createElement(React.Fragment,null,f.list.map($),f.hasMore&&React.createElement("button",{className:`ts-btn ts-btn-1 ts-load-more ${f.loadingMore?"vx-pending":""}`,onClick:z,disabled:f.loadingMore},f.loadingMore?React.createElement("span",{className:"ts-loader"}):x("loadMore","Load more"))):React.createElement(oe,null)))))}function Ue({item:e,icons:l,context:a,nonce:c,isCartEmpty:m}){const[r,h]=T(!1),u=H(null),v=H(null),C=Y(),t=c||Re("cart"),f=m??C?.isCartEmpty??!0,[_,p]=T(!0),[s,z]=T(!1),[$,g]=T(null),[V,w]=T(""),[A,B]=T(!1),O=H(!1),J=()=>!_&&$!==null&&Object.keys($).length>0,ce=()=>s?J():X()?!f:!!localStorage.getItem("voxel:guest_cart"),K=n=>n.product_mode==="regular"?n.value.stock?.quantity||0:n.product_mode==="variable"&&n.value.variations?.quantity||0,ae=()=>{if(!J()||!$)return 0;let n=0;return Object.values($).forEach(d=>{n+=d.pricing.total_amount}),n},D=k(()=>{if(!$||Object.keys($).length===0){localStorage.removeItem("voxel:guest_cart");return}const n={};Object.values($).forEach(d=>{n[d.key]=d.value}),localStorage.setItem("voxel:guest_cart",JSON.stringify(n))},[$]),Q=k(async()=>{const n=X(),d=n?"products.get_cart_items":"products.get_guest_cart_items";try{const E=F(d),j=new FormData;t&&j.append("_wpnonce",t),j.append("guest_cart",localStorage.getItem("voxel:guest_cart")||"");const N=await(await fetch(E,{method:"POST",body:j})).json();p(!1),z(!0),n&&localStorage.removeItem("voxel:guest_cart"),N.success?(g(Object.keys(N.items).length?N.items:{}),w(N.checkout_link),n||setTimeout(()=>D(),0)):S(N.message||x("ajaxError","An error occurred"))}catch{p(!1),z(!0),S(x("ajaxError","An error occurred"))}},[c,D]),W=k(()=>{if(a!=="frontend")return;const n=document.querySelector(".ts-checkout");if(n){window.Voxel?.scrollTo?.(n);return}h(!0),$===null&&(g({}),Q())},[a,$,Q]),te=k(async n=>{if(X()){g(d=>d?{...d,[n.key]:{...d[n.key],_disabled:!0}}:null);try{const d=F("products.remove_cart_item"),E=new FormData;E.append("item_key",n.key),t&&E.append("_wpnonce",t);const M=await(await fetch(d,{method:"POST",body:E})).json();M.success?g(N=>{if(!N)return null;const me={...N};return delete me[n.key],me}):(g(N=>N?{...N,[n.key]:{...N[n.key],_disabled:!1}}:null),S(M.message||x("ajaxError","An error occurred")))}catch{g(d=>d?{...d,[n.key]:{...d[n.key],_disabled:!1}}:null),S(x("ajaxError","An error occurred"))}}else g(d=>{if(!d)return null;const E={...d};return delete E[n.key],E}),setTimeout(()=>D(),0)},[c,D]),de=k(async()=>{if(X()){B(!0);try{const n=F("products.empty_cart"),d=new FormData;t&&d.append("_wpnonce",t);const j=await(await fetch(n,{method:"POST",body:d})).json();B(!1),j.success?g({}):S(j.message||x("ajaxError","An error occurred"))}catch{B(!1),S(x("ajaxError","An error occurred"))}}else g({}),localStorage.removeItem("voxel:guest_cart")},[c]),i=k(async(n,d)=>{g(M=>M?{...M,[n.key]:{...M[n.key],_disabled:!0}}:null);const E=X(),j=E?"products.update_cart_item_quantity":"products.update_guest_cart_item_quantity";try{const M=F(j),N=new FormData;N.append("item_key",n.key),N.append("item_quantity",d.toString()),E||N.append("guest_cart",localStorage.getItem("voxel:guest_cart")||""),t&&N.append("_wpnonce",t);const ue=await(await fetch(M,{method:"POST",body:N})).json();ue.success?(g(pe=>pe?{...pe,[n.key]:ue.item}:null),E||setTimeout(()=>D(),0)):S(ue.message||x("ajaxError","An error occurred"))}catch{S(x("ajaxError","An error occurred"))}finally{g(M=>M?{...M,[n.key]:{...M[n.key],_disabled:!1}}:null)}},[c,D]),y=k(n=>{const d=K(n)+1;i(n,d)},[i]),R=k(n=>{const d=K(n)-1;d<=0?te(n):i(n,d)},[i,te]),b=n=>{if(!$)return!1;let d=n.quantity.max;for(const E of Object.values($))if(E.stock_id===n.stock_id&&(d-=K(E),d<=0))return!1;return!0};ie(()=>{if(a!=="frontend")return;O.current||(O.current=!0,Object.defineProperty(window,"VX_Cart",{configurable:!0,get:()=>({open:W,getItems:Q,hasItems:J,getSubtotal:ae,get loading(){return _},get loaded(){return s},get items(){return $},get checkout_link(){return V}})}));const n=()=>{Q(),v.current?.classList.add("ts-cart-update"),setTimeout(()=>v.current?.classList.remove("ts-cart-update"),500)};return document.addEventListener("voxel:added_cart_item",n),()=>{document.removeEventListener("voxel:added_cart_item",n)}},[a,Q,W,J,ae,_,s,$,V]);const I=n=>React.createElement("div",{key:n.key,className:`ts-cart-item ${n._disabled?"vx-pending":""}`},React.createElement("div",{className:"ts-cart-item-image"},React.createElement("a",{href:n.link},React.createElement("img",{src:n.logo,alt:n.title}))),React.createElement("div",{className:"ts-cart-item-body"},React.createElement("a",{href:n.link,className:"ts-cart-item-title"},n.title),n.subtitle&&React.createElement("span",{className:"ts-cart-item-subtitle"},n.subtitle),React.createElement("span",{className:"ts-cart-item-price"},ve(n.pricing.total_amount,n.pricing._currency))),React.createElement("div",{className:"ts-cart-item-actions"},n.quantity.enabled&&React.createElement("div",{className:"ts-quantity-control"},React.createElement("button",{className:"ts-qty-btn ts-qty-minus",onClick:()=>R(n),disabled:n._disabled},React.createElement("i",{className:"las la-minus"})),React.createElement("span",{className:"ts-qty-value"},K(n)),React.createElement("button",{className:"ts-qty-btn ts-qty-plus",onClick:()=>y(n),disabled:n._disabled||!b(n)},React.createElement("i",{className:"las la-plus"}))),React.createElement("button",{className:"ts-remove-btn",onClick:()=>te(n),disabled:n._disabled},React.createElement("i",{className:"las la-times"}))));return React.createElement("li",{className:`ts-popup-cart elementor-repeater-item-${e._id}`},React.createElement("a",{ref:u,href:"#",onClick:n=>{n.preventDefault(),W()},role:"button","aria-label":e.cartTitle||"Cart"},React.createElement("div",{ref:v,className:"ts-comp-icon flexify"},re(e.icon),a==="frontend"&&ce()&&React.createElement("span",{className:"unread-indicator"})),React.createElement("span",{className:"ts_comp_label"},e.cartTitle||"Cart")),a==="frontend"&&React.createElement(le,{isOpen:r,popupId:`cart-popup-${e._id}`,target:u.current,title:e.cartTitle||"Cart",icon:e.icon?.value?`<i class="${e.icon.value}"></i>`:"",onClose:()=>h(!1),showFooter:!1,popupClass:"lg-width ts-cart-popup"},React.createElement("div",{className:"ts-cart-content min-scroll"},_&&React.createElement(oe,null),!_&&React.createElement(React.Fragment,null,J()&&$?React.createElement(React.Fragment,null,React.createElement("div",{className:"ts-cart-items"},Object.values($).map(I)),React.createElement("div",{className:"ts-cart-footer"},React.createElement("div",{className:"ts-cart-subtotal"},React.createElement("span",null,x("subtotal","Subtotal")),React.createElement("span",{className:"ts-subtotal-amount"},ve(ae()))),React.createElement("div",{className:"ts-cart-actions"},React.createElement("button",{className:`ts-btn ts-btn-1 ts-empty-cart ${A?"vx-pending":""}`,onClick:de,disabled:A},x("emptyCart","Empty cart")),V&&React.createElement("a",{href:V,className:"ts-btn ts-btn-2"},x("checkout","Checkout"))))):React.createElement(oe,null)))))}function Fe({item:e,icons:l,context:a,hideChevron:c}){const[m,r]=T(!1),h=H(null),v=Y()?.user??window.VoxelFSEUser,C=v?.displayName||"User",t=v?.avatarUrl||"",f=k(()=>{a==="frontend"&&r(!0)},[a]);return React.createElement("li",{className:`ts-popup-component ts-user-area-avatar elementor-repeater-item-${e._id}`},React.createElement("a",{ref:h,href:"#",onClick:_=>{_.preventDefault(),f()},role:"button","aria-label":C},React.createElement("div",{className:"ts-comp-icon flexify"},a==="editor"?React.createElement("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#ccc",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement("i",{className:"las la-user"})):t?React.createElement("img",{src:t,alt:C,style:{width:"32px",height:"32px",borderRadius:"50%"}}):React.createElement("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#ccc",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement("i",{className:"las la-user"}))),React.createElement("span",{className:"ts_comp_label"},C),!c&&React.createElement("div",{className:"ts-down-icon"})),a==="frontend"&&React.createElement(le,{isOpen:m,popupId:`user-menu-popup-${e._id}`,target:h.current,title:C,icon:t?`<img src="${t}" alt="" style="width:24px;height:24px;border-radius:50%;">`:"",onClose:()=>r(!1),showFooter:!1},React.createElement("div",{className:"ts-term-dropdown ts-md-group ts-multilevel-dropdown"},React.createElement("p",{style:{padding:"16px",textAlign:"center",color:"#666"}},"Menu not configured"))))}function He({item:e,icons:l,context:a}){const[c,m]=T(!1),r=H(null),h=k(()=>{a==="frontend"&&m(!0)},[a]);return React.createElement("li",{className:`ts-popup-component elementor-repeater-item-${e._id}`},React.createElement("a",{ref:r,href:"#",onClick:u=>{u.preventDefault(),h()},role:"button","aria-label":e.wpMenuTitle||"Menu"},React.createElement("div",{className:"ts-comp-icon flexify"},re(e.icon)),React.createElement("span",{className:"ts_comp_label"},e.wpMenuTitle||"Menu")),a==="frontend"&&React.createElement(le,{isOpen:c,popupId:`wp-menu-popup-${e._id}`,target:r.current,title:e.wpMenuTitle||"Menu",icon:e.icon?.value?`<i class="${e.icon.value}"></i>`:"",onClose:()=>m(!1),showFooter:!1},React.createElement("div",{className:"ts-term-dropdown ts-md-group ts-multilevel-dropdown"},React.createElement("p",{style:{padding:"16px",textAlign:"center",color:"#666"}},"Menu not configured"))))}function De({item:e,context:l}){const a={href:e.componentUrl.url||"#"};return e.componentUrl.is_external&&(a.target="_blank"),e.componentUrl.nofollow&&(a.rel="nofollow"),React.createElement("li",{className:`elementor-repeater-item-${e._id}`},React.createElement("a",{...a},React.createElement("div",{className:"ts-comp-icon flexify"},re(e.icon)),React.createElement("span",{className:"ts_comp_label"},e.componentTitle||"Link")))}function Ge(e,l,a,c,m,r){switch(e.componentType){case"notifications":return React.createElement(Ae,{key:e._id,item:e,icons:l,context:a});case"messages":return React.createElement(Pe,{key:e._id,item:e,icons:l,context:a,nonce:m});case"cart":return React.createElement(Ue,{key:e._id,item:e,icons:l,context:a,nonce:m,isCartEmpty:r});case"user_menu":return React.createElement(Fe,{key:e._id,item:e,icons:l,context:a,hideChevron:c});case"select_wp_menu":return React.createElement(He,{key:e._id,item:e,icons:l,context:a});case"link":return React.createElement(De,{key:e._id,item:e,context:a});default:return null}}function qe({attributes:e,context:l,config:a}){const c=a?.items||e.items,m=a?.icons||e.icons,r=a?.settings||{itemsAlign:e.itemsAlign,verticalOrientation:e.verticalOrientation,verticalOrientationTablet:e.verticalOrientationTablet,verticalOrientationMobile:e.verticalOrientationMobile,itemContentAlign:e.itemContentAlign,hideChevron:e.hideChevron,customPopupEnable:e.customPopupEnable},h=window.VoxelFSEUserbar,u=h?.nonce,v=h?.is_cart_empty??!0,C={justifyContent:r.itemsAlign};return!c||c.length===0?React.createElement("div",{className:"ts-user-area"},React.createElement("div",{className:"voxel-fse-empty-state",style:{padding:"20px",textAlign:"center",background:"#f5f5f5",borderRadius:"4px"}},React.createElement("p",{style:{margin:0,color:"#666"}},l==="editor"?"Add components using the sidebar panel":"No user bar components configured"))):React.createElement(React.Fragment,null,l==="frontend"&&a&&React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(a)}}),React.createElement("ul",{className:"flexify simplify-ul user-area-menu",style:C},c.map(t=>Ge(t,m,l,r.hideChevron,u,v))))}function Je(e){if(!e)return"";let l="";return e.fontFamily&&(l+=`font-family: ${e.fontFamily}; `),e.fontSize&&(l+=`font-size: ${e.fontSize}${e.fontSizeUnit||"px"}; `),e.fontWeight&&(l+=`font-weight: ${e.fontWeight}; `),e.fontStyle&&(l+=`font-style: ${e.fontStyle}; `),e.textTransform&&(l+=`text-transform: ${e.textTransform}; `),e.textDecoration&&(l+=`text-decoration: ${e.textDecoration}; `),e.lineHeight&&(l+=`line-height: ${e.lineHeight}${e.lineHeightUnit||""}; `),e.letterSpacing&&(l+=`letter-spacing: ${e.letterSpacing}${e.letterSpacingUnit||"px"}; `),l}function xe(e,l){const a=[],c=[],m=[],r=`.voxel-fse-userbar-${l}`;if(e.itemGap!==void 0&&a.push(`${r} .ts-user-area > ul { grid-gap: ${e.itemGap}px; }`),e.itemGapTablet!==void 0&&c.push(`${r} .ts-user-area > ul { grid-gap: ${e.itemGapTablet}px; }`),e.itemGapMobile!==void 0&&m.push(`${r} .ts-user-area > ul { grid-gap: ${e.itemGapMobile}px; }`),e.verticalOrientation&&(a.push(`${r} .ts-user-area > ul { flex-direction: column; }`),e.itemContentAlign&&a.push(`${r} .ts-user-area > ul > li > a { justify-content: ${e.itemContentAlign}; }`)),e.verticalOrientationTablet&&(c.push(`${r} .ts-user-area > ul { flex-direction: column; }`),e.itemContentAlign&&c.push(`${r} .ts-user-area > ul > li > a { justify-content: ${e.itemContentAlign}; }`)),e.verticalOrientationMobile&&(m.push(`${r} .ts-user-area > ul { flex-direction: column; }`),e.itemContentAlign&&m.push(`${r} .ts-user-area > ul > li > a { justify-content: ${e.itemContentAlign}; }`)),e.itemBackground&&a.push(`${r} .ts-user-area > ul > li > a { background-color: ${e.itemBackground}; }`),e.itemBackgroundHover&&a.push(`${r} .ts-user-area > ul > li > a:hover { background-color: ${e.itemBackgroundHover}; }`),e.itemBorderRadius!==void 0&&a.push(`${r} .ts-user-area > ul > li > a { border-radius: ${e.itemBorderRadius}px; }`),e.itemBorderRadiusTablet!==void 0&&c.push(`${r} .ts-user-area > ul > li > a { border-radius: ${e.itemBorderRadiusTablet}px; }`),e.itemBorderRadiusMobile!==void 0&&m.push(`${r} .ts-user-area > ul > li > a { border-radius: ${e.itemBorderRadiusMobile}px; }`),e.itemContentGap!==void 0&&a.push(`${r} .ts-user-area > ul > li > a { grid-gap: ${e.itemContentGap}px; }`),e.itemContentGapTablet!==void 0&&c.push(`${r} .ts-user-area > ul > li > a { grid-gap: ${e.itemContentGapTablet}px; }`),e.itemContentGapMobile!==void 0&&m.push(`${r} .ts-user-area > ul > li > a { grid-gap: ${e.itemContentGapMobile}px; }`),e.iconContainerSize!==void 0&&a.push(`${r} .ts-user-area .ts-comp-icon { width: ${e.iconContainerSize}px; height: ${e.iconContainerSize}px; }`),e.iconContainerSizeTablet!==void 0&&c.push(`${r} .ts-user-area .ts-comp-icon { width: ${e.iconContainerSizeTablet}px; height: ${e.iconContainerSizeTablet}px; }`),e.iconContainerSizeMobile!==void 0&&m.push(`${r} .ts-user-area .ts-comp-icon { width: ${e.iconContainerSizeMobile}px; height: ${e.iconContainerSizeMobile}px; }`),e.iconContainerRadius!==void 0&&a.push(`${r} .ts-user-area .ts-comp-icon { border-radius: ${e.iconContainerRadius}px; }`),e.iconContainerRadiusTablet!==void 0&&c.push(`${r} .ts-user-area .ts-comp-icon { border-radius: ${e.iconContainerRadiusTablet}px; }`),e.iconContainerRadiusMobile!==void 0&&m.push(`${r} .ts-user-area .ts-comp-icon { border-radius: ${e.iconContainerRadiusMobile}px; }`),e.iconContainerBackground&&a.push(`${r} .ts-user-area .ts-comp-icon { background-color: ${e.iconContainerBackground}; }`),e.iconContainerBackgroundHover&&a.push(`${r} .ts-user-area > ul > li > a:hover .ts-comp-icon { background-color: ${e.iconContainerBackgroundHover}; }`),e.iconSize!==void 0&&a.push(`${r} .ts-user-area .ts-comp-icon { --ts-icon-size: ${e.iconSize}px; }`),e.iconSizeTablet!==void 0&&c.push(`${r} .ts-user-area .ts-comp-icon { --ts-icon-size: ${e.iconSizeTablet}px; }`),e.iconSizeMobile!==void 0&&m.push(`${r} .ts-user-area .ts-comp-icon { --ts-icon-size: ${e.iconSizeMobile}px; }`),e.iconColor&&a.push(`${r} .ts-user-area .ts-comp-icon { --ts-icon-color: ${e.iconColor}; }`),e.iconColorHover&&a.push(`${r} .ts-user-area > ul > li > a:hover .ts-comp-icon { --ts-icon-color: ${e.iconColorHover}; }`),e.unreadIndicatorColor&&a.push(`${r} .ts-user-area span.unread-indicator { background: ${e.unreadIndicatorColor}; }`),e.unreadIndicatorMargin!==void 0&&a.push(`${r} .ts-user-area span.unread-indicator { top: ${e.unreadIndicatorMargin}px; }`),e.unreadIndicatorMarginTablet!==void 0&&c.push(`${r} .ts-user-area span.unread-indicator { top: ${e.unreadIndicatorMarginTablet}px; }`),e.unreadIndicatorMarginMobile!==void 0&&m.push(`${r} .ts-user-area span.unread-indicator { top: ${e.unreadIndicatorMarginMobile}px; }`),e.unreadIndicatorSize!==void 0&&a.push(`${r} .ts-user-area span.unread-indicator { width: ${e.unreadIndicatorSize}px; height: ${e.unreadIndicatorSize}px; }`),e.unreadIndicatorSizeTablet!==void 0&&c.push(`${r} .ts-user-area span.unread-indicator { width: ${e.unreadIndicatorSizeTablet}px; height: ${e.unreadIndicatorSizeTablet}px; }`),e.unreadIndicatorSizeMobile!==void 0&&m.push(`${r} .ts-user-area span.unread-indicator { width: ${e.unreadIndicatorSizeMobile}px; height: ${e.unreadIndicatorSizeMobile}px; }`),e.avatarSize!==void 0&&a.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { width: ${e.avatarSize}px; height: ${e.avatarSize}px; }`),e.avatarSizeTablet!==void 0&&c.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { width: ${e.avatarSizeTablet}px; height: ${e.avatarSizeTablet}px; }`),e.avatarSizeMobile!==void 0&&m.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { width: ${e.avatarSizeMobile}px; height: ${e.avatarSizeMobile}px; }`),e.avatarRadius!==void 0&&a.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { border-radius: ${e.avatarRadius}%; }`),e.avatarRadiusTablet!==void 0&&c.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { border-radius: ${e.avatarRadiusTablet}%; }`),e.avatarRadiusMobile!==void 0&&m.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { border-radius: ${e.avatarRadiusMobile}%; }`),e.items?.forEach(u=>{if(!u._id)return;const v=`${r} .elementor-repeater-item-${u._id}`;u.labelVisibility&&(u.labelVisibilityDesktop==="none"&&a.push(`${v} .ts_comp_label { display: none; }`),u.labelVisibilityTablet==="none"?c.push(`${v} .ts_comp_label { display: none; }`):u.labelVisibilityTablet==="flex"&&u.labelVisibilityDesktop==="none"&&c.push(`${v} .ts_comp_label { display: flex; }`),u.labelVisibilityMobile==="none"?m.push(`${v} .ts_comp_label { display: none; }`):u.labelVisibilityMobile==="flex"&&(u.labelVisibilityDesktop==="none"||u.labelVisibilityTablet==="none")&&m.push(`${v} .ts_comp_label { display: flex; }`)),u.componentVisibility&&(u.userBarVisibilityDesktop==="none"&&a.push(`${v} { display: none !important; }`),u.userBarVisibilityTablet==="none"?c.push(`${v} { display: none !important; }`):u.userBarVisibilityTablet==="flex"&&u.userBarVisibilityDesktop==="none"&&c.push(`${v} { display: flex !important; }`),u.userBarVisibilityMobile==="none"?m.push(`${v} { display: none !important; }`):u.userBarVisibilityMobile==="flex"&&(u.userBarVisibilityDesktop==="none"||u.userBarVisibilityTablet==="none")&&m.push(`${v} { display: flex !important; }`))}),e.labelTypography){const u=Je(e.labelTypography);u&&a.push(`${r} .ts-user-area .ts_comp_label { ${u} }`)}e.labelColor&&a.push(`${r} .ts-user-area .ts_comp_label { color: ${e.labelColor}; }`),e.labelColorHover&&a.push(`${r} .ts-user-area > ul > li > a:hover .ts_comp_label { color: ${e.labelColorHover}; }`),e.chevronColor&&a.push(`${r} .ts-down-icon { border-color: ${e.chevronColor}; }`),e.chevronColorHover&&a.push(`${r} .ts-user-area > ul > li > a:hover .ts-down-icon { border-color: ${e.chevronColorHover}; }`),e.hideChevron&&a.push(`${r} .ts-down-icon { display: none !important; }`);let h="";return a.length>0&&(h+=a.join(`
`)),c.length>0&&(h+=`
@media (max-width: 1024px) {
${c.join(`
`)}
}`),m.length>0&&(h+=`
@media (max-width: 767px) {
${m.join(`
`)}
}`),h}function Qe({attributes:e,setAttributes:l,clientId:a}){const c=e.blockId||a,[m,r]=T([{value:"",label:o("Select menu","voxel-fse")}]);ie(()=>{(async()=>{try{const f=await _e({path:"/voxel-fse/v1/navbar/locations"});if(f&&f.locations){const _=[{value:"",label:o("Select menu","voxel-fse")},...f.locations.map(p=>({value:p.slug,label:p.name}))];r(_)}}catch(f){console.error("Could not fetch nav menus:",f)}})()},[]),ie(()=>{e.blockId||l({blockId:a}),e.items||l({items:[]})},[e.blockId,e.items,a,l]),ie(()=>{const t="voxel-commons-css";if(!document.getElementById(t)){const f=document.createElement("link");f.id=t,f.rel="stylesheet";const p=(window.Voxel_Config?.site_url||window.location.origin).replace(/\/$/,"");f.href=`${p}/wp-content/themes/voxel/assets/dist/commons.css?ver=1.7.5.2`,document.head.appendChild(f)}},[]);const h=ye(e,{blockId:c,baseClass:"voxel-fse-userbar ts-user-area",selectorPrefix:"voxel-fse-userbar"}),u=fe(()=>xe(e,c),[e,c]),v=fe(()=>[h.responsiveCSS,u].filter(Boolean).join(`
`),[h.responsiveCSS,u]),C=he({id:h.elementId,className:h.className,style:h.styles,...h.customAttrs});return React.createElement("div",{...C},React.createElement(Ce,null,React.createElement(ke,{tabs:[{id:"content",label:o("Content","voxel-fse"),render:()=>React.createElement(je,{attributes:e,setAttributes:l,navMenus:m})},{id:"style",label:o("Style","voxel-fse"),render:()=>React.createElement(ze,{attributes:e,setAttributes:l})}],includeAdvancedTab:!0,includeVoxelTab:!0,attributes:e,setAttributes:l})),v&&React.createElement("style",{dangerouslySetInnerHTML:{__html:v}}),React.createElement(qe,{attributes:e,context:"editor"}))}function We({attributes:e}){const l=e.blockId||"userbar",a=ye(e,{blockId:l,baseClass:"voxel-fse-userbar ts-user-area"}),c=xe(e,l),m=[a.responsiveCSS,c].filter(Boolean).join(`
`),r=he.save({id:a.elementId,className:a.className,style:a.styles,"data-visibility-behavior":e.visibilityBehavior||void 0,"data-visibility-rules":e.visibilityRules?.length?JSON.stringify(e.visibilityRules):void 0,"data-loop-source":e.loopSource||void 0,"data-loop-limit":e.loopLimit||void 0,"data-loop-offset":e.loopOffset||void 0,...a.customAttrs}),h={items:e.items,icons:e.icons,settings:{itemsAlign:e.itemsAlign,verticalOrientation:e.verticalOrientation,verticalOrientationTablet:e.verticalOrientationTablet??!1,verticalOrientationMobile:e.verticalOrientationMobile??!1,itemContentAlign:e.itemContentAlign,hideChevron:e.hideChevron,customPopupEnable:e.customPopupEnable}};return React.createElement("div",{...r},m&&React.createElement("style",{dangerouslySetInnerHTML:{__html:m}}),Se(e,!1,void 0,void 0,a.uniqueSelector),React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(h)}}),React.createElement("div",{className:"voxel-fse-block-placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#e0e0e0",padding:"16px",minHeight:"48px"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor",style:{opacity:.4}},React.createElement("rect",{x:"4",y:"4",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"10",y:"4",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"16",y:"4",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"4",y:"10",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"10",y:"10",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"16",y:"10",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"4",y:"16",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"10",y:"16",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"16",y:"16",width:"4",height:"4",rx:"0.5"}))))}const Xe="https://schemas.wp.org/trunk/block.json",Ye=3,Ke="voxel-fse/userbar",Ze="1.0.0",ea="Userbar (VX)",aa="voxel-fse",ta="User bar with notifications, messages, cart, user menu, and custom links. FSE equivalent of Voxel's User bar widget.",na=["userbar","user","notifications","messages","cart","menu","voxel"],oa="voxel-fse",la={html:!1,align:["wide","full"],anchor:!0,className:!0,customClassName:!0},ra="file:./index.js",ia="file:./frontend.js",sa="file:./render.php",ca={blockId:{type:"string",default:""},items:{type:"array",default:[]},icons:{type:"object",default:{downArrow:{library:"",value:""},rightArrow:{library:"",value:""},leftArrow:{library:"",value:""},close:{library:"",value:""},trash:{library:"",value:""},inbox:{library:"",value:""},loadMore:{library:"",value:""}}},itemsAlign:{type:"string",default:"left"},verticalOrientation:{type:"boolean",default:!1},verticalOrientationTablet:{type:"boolean",default:!1},verticalOrientationMobile:{type:"boolean",default:!1},itemContentAlign:{type:"string",default:"left"},itemGap:{type:"number",default:0},itemGapTablet:{type:"number"},itemGapMobile:{type:"number"},itemMargin:{type:"object",default:{top:"",right:"",bottom:"",left:""}},itemPadding:{type:"object",default:{top:"",right:"",bottom:"",left:""}},itemBackground:{type:"string",default:""},itemBackgroundHover:{type:"string",default:"#fff"},itemBorderRadius:{type:"number",default:0},itemBorderRadiusTablet:{type:"number"},itemBorderRadiusMobile:{type:"number"},itemContentGap:{type:"number",default:0},itemContentGapTablet:{type:"number"},itemContentGapMobile:{type:"number"},iconContainerSize:{type:"number",default:40},iconContainerSizeTablet:{type:"number"},iconContainerSizeMobile:{type:"number"},iconContainerRadius:{type:"number",default:40},iconContainerRadiusTablet:{type:"number"},iconContainerRadiusMobile:{type:"number"},iconContainerBackground:{type:"string",default:""},iconContainerBackgroundHover:{type:"string",default:""},iconSize:{type:"number",default:20},iconSizeTablet:{type:"number"},iconSizeMobile:{type:"number"},iconColor:{type:"string",default:""},iconColorHover:{type:"string",default:""},unreadIndicatorColor:{type:"string",default:""},unreadIndicatorMargin:{type:"number",default:0},unreadIndicatorMarginTablet:{type:"number"},unreadIndicatorMarginMobile:{type:"number"},unreadIndicatorSize:{type:"number",default:8},unreadIndicatorSizeTablet:{type:"number"},unreadIndicatorSizeMobile:{type:"number"},avatarSize:{type:"number",default:32},avatarSizeTablet:{type:"number"},avatarSizeMobile:{type:"number"},avatarRadius:{type:"number",default:50},avatarRadiusTablet:{type:"number"},avatarRadiusMobile:{type:"number"},labelTypography:{type:"object",default:{}},labelColor:{type:"string",default:""},labelColorHover:{type:"string",default:""},chevronColor:{type:"string",default:""},chevronColorHover:{type:"string",default:""},hideChevron:{type:"boolean",default:!1},customPopupEnable:{type:"boolean",default:!1},popupBackdropColor:{type:"string",default:""},popupPointerEvents:{type:"boolean",default:!1},popupBoxShadow:{type:"object",default:{}},popupTopMargin:{type:"number",default:0},popupMaxHeight:{type:"number",default:0},_comment_voxel_tab:"VoxelTab attributes for visibility and loop features",visibilityBehavior:{type:"string",default:"show",enum:["show","hide"]},visibilityRules:{type:"array",default:[],items:{type:"object"}},loopEnabled:{type:"boolean",default:!1},loopSource:{type:"string",default:""},loopProperty:{type:"string",default:""},loopLimit:{type:"string",default:""},loopOffset:{type:"string",default:""}},ge={$schema:Xe,apiVersion:Ye,name:Ke,version:Ze,title:ea,category:aa,description:ta,keywords:na,textdomain:oa,supports:la,editorScript:ra,viewScript:ia,render:sa,attributes:ca};Ee(ge.name,{...ge,icon:Ve,edit:Qe,save:We});
