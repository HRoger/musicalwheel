import{registerBlockType as he}from"@wordpress/blocks";import{useBlockProps as pe,InspectorControls as be}from"@wordpress/block-editor";import{__ as o}from"@wordpress/i18n";import{useState as k,useRef as A,useCallback as w,useEffect as ne,useMemo as de}from"react";import ye from"@wordpress/api-fetch";import{A as fe,a as oe,S as F,E as Re,R as j,C as V,T as xe}from"../TypographyPopup-BXz72zyZ.js";import{I as Ee}from"../InspectorTabs-DmdaThza.js";import{SelectControl as L,TextControl as Q,ToggleControl as Z}from"@wordpress/components";import"@wordpress/data";/* empty css                            */import"../RepeaterControl-BJok1GGr.js";import"../voxelShim-DB_Ue-9R.js";import{g as ve}from"../useAdvancedTabProps-BnJDQbKr.js";import{r as Ce}from"../backgroundElements-Ui-iCrLV.js";import{A as U}from"../AdvancedIconControl-BPdxcRLY.js";import{L as _e}from"../LoopElementModal-CaevVMh1.js";import{R as we,L as $e}from"../RepeaterControl-xj2PJ-Sc.js";import{P as ke}from"../PopupCustomStyleControl-DvCsFGfS.js";import{F as ae}from"../FormPopup-DDYHzYWU.js";import{E as ee}from"../EmptyPlaceholder-BsL18qxN.js";import{V as Se}from"../VoxelGridIcon-D5dF5acW.js";import"react-dom";import"../generateAdvancedStyles-CRpLcHXt.js";import"../generateVoxelStyles-oZeaeuKH.js";const Te={_id:"",componentType:"notifications",chooseMenu:"",icon:{library:"icon",value:"las la-bell"},componentUrl:{url:"",is_external:!0,nofollow:!0},componentTitle:"",messagesTitle:"Messages",wpMenuTitle:"Menu",notificationsTitle:"Notifications",cartTitle:"Cart",labelVisibility:!1,labelVisibilityDesktop:"none",labelVisibilityTablet:"none",labelVisibilityMobile:"none",componentVisibility:!1,userBarVisibilityDesktop:"flex",userBarVisibilityTablet:"flex",userBarVisibilityMobile:"flex",rowVisibility:"show",visibilityRules:[]},Ne=[{label:o("Notifications","voxel-fse"),value:"notifications"},{label:o("Cart","voxel-fse"),value:"cart"},{label:o("Messages","voxel-fse"),value:"messages"},{label:o("User Menu","voxel-fse"),value:"user_menu"},{label:o("Menu","voxel-fse"),value:"select_wp_menu"},{label:o("Custom link","voxel-fse"),value:"link"}],W=[{label:o("Show","voxel-fse"),value:"flex"},{label:o("Hide","voxel-fse"),value:"none"}];function Me({attributes:e,setAttributes:l,navMenus:a}){const[c,f]=k(null),[r,v]=k(null),p=t=>{switch(t.componentType){case"notifications":return t.notificationsTitle||"Notifications";case"messages":return t.messagesTitle||"Messages";case"cart":return t.cartTitle||"Cart";case"user_menu":case"select_wp_menu":return t.wpMenuTitle||"Menu";case"link":return t.componentTitle||"Link";default:return t.componentType}},d=(t,x)=>{l({icons:{...e.icons,[t]:x}})},E=(t,x)=>{const I=[...e.items];I[t]={...I[t],...x},l({items:I})};return React.createElement(React.Fragment,null,React.createElement("div",{className:"voxel-inspector-section"},React.createElement(fe,{defaultPanel:"items"},React.createElement(oe,{id:"items",title:o("User area components","voxel-fse")},React.createElement(we,{items:e.items,onChange:t=>l({items:t}),getItemLabel:t=>p(t),createItem:()=>({...Te,_id:`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,rowVisibility:"show",visibilityRules:[],userBarVisibilityDesktop:"flex",userBarVisibilityTablet:"flex",userBarVisibilityMobile:"flex"}),renderContent:({item:t,index:x,onUpdate:I})=>{const m=(i,T)=>{I({[i]:T})};return React.createElement("div",{className:"voxel-repeater-content"},React.createElement(F,{label:o("Component details","voxel-fse")}),React.createElement(L,{label:o("Component type","voxel-fse"),value:t.componentType,options:Ne,onChange:i=>m("componentType",i)}),(t.componentType==="user_menu"||t.componentType==="select_wp_menu")&&React.createElement(L,{label:o("Choose menu","voxel-fse"),value:t.chooseMenu,options:a,onChange:i=>m("chooseMenu",i)}),React.createElement(U,{label:o("Icon","voxel-fse"),value:t.icon,onChange:i=>m("icon",i)}),t.componentType==="link"&&React.createElement(React.Fragment,null,React.createElement(Q,{label:o("Link URL","voxel-fse"),value:t.componentUrl.url,onChange:i=>m("componentUrl",{...t.componentUrl,url:i}),placeholder:"https://your-link.com"}),React.createElement(Z,{label:o("Open in new tab","voxel-fse"),checked:t.componentUrl.is_external,onChange:i=>m("componentUrl",{...t.componentUrl,is_external:i})})),t.componentType==="link"&&React.createElement(Q,{label:o("Label","voxel-fse"),value:t.componentTitle,onChange:i=>m("componentTitle",i)}),t.componentType==="messages"&&React.createElement(Q,{label:o("Label","voxel-fse"),value:t.messagesTitle,onChange:i=>m("messagesTitle",i)}),t.componentType==="select_wp_menu"&&React.createElement(Q,{label:o("Label","voxel-fse"),value:t.wpMenuTitle,onChange:i=>m("wpMenuTitle",i)}),t.componentType==="notifications"&&React.createElement(Q,{label:o("Label","voxel-fse"),value:t.notificationsTitle,onChange:i=>m("notificationsTitle",i)}),t.componentType==="cart"&&React.createElement(Q,{label:o("Label","voxel-fse"),value:t.cartTitle,onChange:i=>m("cartTitle",i)}),React.createElement("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #ddd"}}),React.createElement(Z,{label:o("Enable label visibility","voxel-fse"),checked:t.labelVisibility,onChange:i=>m("labelVisibility",i)}),t.labelVisibility&&React.createElement(React.Fragment,null,React.createElement(L,{label:o("Show on desktop","voxel-fse"),value:t.labelVisibilityDesktop,options:W,onChange:i=>m("labelVisibilityDesktop",i)}),React.createElement(L,{label:o("Show on tablet","voxel-fse"),value:t.labelVisibilityTablet,options:W,onChange:i=>m("labelVisibilityTablet",i)}),React.createElement(L,{label:o("Show on mobile","voxel-fse"),value:t.labelVisibilityMobile,options:W,onChange:i=>m("labelVisibilityMobile",i)})),React.createElement("hr",{style:{margin:"16px 0",border:"none",borderTop:"1px solid #ddd"}}),React.createElement(Z,{label:o("Component visibility","voxel-fse"),checked:t.componentVisibility,onChange:i=>m("componentVisibility",i)}),t.componentVisibility&&React.createElement(React.Fragment,null,React.createElement(L,{label:o("Show on desktop","voxel-fse"),value:t.userBarVisibilityDesktop,options:W,onChange:i=>m("userBarVisibilityDesktop",i)}),React.createElement(L,{label:o("Show on tablet","voxel-fse"),value:t.userBarVisibilityTablet,options:W,onChange:i=>m("userBarVisibilityTablet",i)}),React.createElement(L,{label:o("Show on mobile","voxel-fse"),value:t.userBarVisibilityMobile,options:W,onChange:i=>m("userBarVisibilityMobile",i)})),React.createElement($e,{itemId:t._id,rowVisibility:t.rowVisibility||"show",onRowVisibilityChange:i=>m("rowVisibility",i),visibilityRules:t.visibilityRules||[],onEditVisibilityRules:()=>f(x),onClearVisibilityRules:()=>m("visibilityRules",[]),showLoopSection:!0,loopSource:t.loopSource,loopProperty:t.loopProperty,loopLimit:t.loopLimit,loopOffset:t.loopOffset,onEditLoop:()=>v(x),onClearLoop:()=>{m("loopSource",""),m("loopProperty","")},onLoopLimitChange:i=>m("loopLimit",i),onLoopOffsetChange:i=>m("loopOffset",i)}))}})),React.createElement(oe,{id:"icons",title:o("Icons","voxel-fse")},React.createElement(U,{label:o("Down arrow","voxel-fse"),value:e.icons.downArrow,onChange:t=>d("downArrow",t)}),React.createElement(U,{label:o("Right arrow","voxel-fse"),value:e.icons.rightArrow,onChange:t=>d("rightArrow",t)}),React.createElement(U,{label:o("Left arrow","voxel-fse"),value:e.icons.leftArrow,onChange:t=>d("leftArrow",t)}),React.createElement(U,{label:o("Close icon","voxel-fse"),value:e.icons.close,onChange:t=>d("close",t)}),React.createElement(U,{label:o("Trash icon","voxel-fse"),value:e.icons.trash,onChange:t=>d("trash",t)}),React.createElement(U,{label:o("Inbox icon","voxel-fse"),value:e.icons.inbox,onChange:t=>d("inbox",t)}),React.createElement(U,{label:o("Load more icon","voxel-fse"),value:e.icons.loadMore,onChange:t=>d("loadMore",t)})))),c!==null&&React.createElement(Re,{isOpen:!0,rules:e.items[c].visibilityRules||[],onClose:()=>f(null),onSave:t=>{E(c,{visibilityRules:t})}}),r!==null&&React.createElement(_e,{isOpen:!0,config:{source:e.items[r].loopSource,property:e.items[r].loopProperty},onClose:()=>v(null),onSave:t=>{E(r,{loopSource:t.source,loopProperty:t.property})}}))}const Ie=[{label:o("Left","voxel-fse"),value:"left"},{label:o("Center","voxel-fse"),value:"center"},{label:o("Right","voxel-fse"),value:"right"},{label:o("Space between","voxel-fse"),value:"space-between"},{label:o("Space around","voxel-fse"),value:"space-around"}];function Ve({attributes:e,setAttributes:l}){return React.createElement(React.Fragment,null,React.createElement("div",{className:"voxel-inspector-section"},React.createElement(fe,{defaultPanel:"general"},React.createElement(oe,{id:"general",title:o("User area: General","voxel-fse")},React.createElement(F,{label:o("Layout","voxel-fse")}),React.createElement(L,{label:o("Align items","voxel-fse"),value:e.itemsAlign,options:Ie,onChange:a=>l({itemsAlign:a})}),React.createElement(Z,{label:o("Vertical orientation?","voxel-fse"),checked:e.verticalOrientation,onChange:a=>l({verticalOrientation:a})}),e.verticalOrientation&&React.createElement(L,{label:o("Align item content","voxel-fse"),value:e.itemContentAlign,options:[{label:o("Left","voxel-fse"),value:"left"},{label:o("Center","voxel-fse"),value:"center"},{label:o("Right","voxel-fse"),value:"right"}],onChange:a=>l({itemContentAlign:a})}),React.createElement(F,{label:o("Item","voxel-fse")}),React.createElement(j,{label:o("Gap","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"itemGap",min:0,max:50}),React.createElement(V,{label:o("Item background","voxel-fse"),value:e.itemBackground,onChange:a=>l({itemBackground:a??""})}),React.createElement(V,{label:o("Item background (hover)","voxel-fse"),value:e.itemBackgroundHover,onChange:a=>l({itemBackgroundHover:a??"#fff"})}),React.createElement(j,{label:o("Item border radius","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"itemBorderRadius",min:0,max:100}),React.createElement(j,{label:o("Item content gap","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"itemContentGap",min:0,max:50}),React.createElement(F,{label:o("Item icon","voxel-fse")}),React.createElement(j,{label:o("Container size","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"iconContainerSize",min:30,max:80}),React.createElement(j,{label:o("Container border radius","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"iconContainerRadius",min:0,max:100}),React.createElement(V,{label:o("Container background","voxel-fse"),value:e.iconContainerBackground,onChange:a=>l({iconContainerBackground:a??""})}),React.createElement(V,{label:o("Container background (hover)","voxel-fse"),value:e.iconContainerBackgroundHover,onChange:a=>l({iconContainerBackgroundHover:a??""})}),React.createElement(j,{label:o("Icon size","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"iconSize",min:10,max:50}),React.createElement(V,{label:o("Icon color","voxel-fse"),value:e.iconColor,onChange:a=>l({iconColor:a??""})}),React.createElement(V,{label:o("Icon color (hover)","voxel-fse"),value:e.iconColorHover,onChange:a=>l({iconColorHover:a??""})}),React.createElement(F,{label:o("Unread indicator","voxel-fse")}),React.createElement(V,{label:o("Unread indicator color","voxel-fse"),value:e.unreadIndicatorColor,onChange:a=>l({unreadIndicatorColor:a??""})}),React.createElement(j,{label:o("Indicator top margin","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"unreadIndicatorMargin",min:0,max:50}),React.createElement(j,{label:o("Indicator size","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"unreadIndicatorSize",min:0,max:50}),React.createElement(F,{label:o("Avatar","voxel-fse")}),React.createElement(j,{label:o("Avatar size","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"avatarSize",min:20,max:100}),React.createElement(j,{label:o("Avatar radius","voxel-fse"),attributes:e,setAttributes:l,attributeBaseName:"avatarRadius",min:0,max:100}),React.createElement(F,{label:o("Item label","voxel-fse")}),React.createElement(xe,{label:o("Typography","voxel-fse"),value:e.labelTypography,onChange:a=>l({labelTypography:a})}),React.createElement(V,{label:o("Color","voxel-fse"),value:e.labelColor,onChange:a=>l({labelColor:a??""})}),React.createElement(V,{label:o("Color (hover)","voxel-fse"),value:e.labelColorHover,onChange:a=>l({labelColorHover:a??""})}),React.createElement(F,{label:o("Chevron","voxel-fse")}),React.createElement(V,{label:o("Chevron color","voxel-fse"),value:e.chevronColor,onChange:a=>l({chevronColor:a??""})}),React.createElement(V,{label:o("Chevron color (hover)","voxel-fse"),value:e.chevronColorHover,onChange:a=>l({chevronColorHover:a??""})}),React.createElement(Z,{label:o("Hide chevron","voxel-fse"),checked:e.hideChevron,onChange:a=>l({hideChevron:a})})),React.createElement(oe,{id:"popups",title:o("Popups: Custom style","voxel-fse")},React.createElement(ke,{attributes:e,setAttributes:l})))))}function z(e){const l=window.Voxel_Config;return l?.ajax_url?`${l.ajax_url}&action=${e}`:`${l?.site_url||window.location.origin}/?vx=1&action=${e}`}function K(){return window.Voxel_Config?.is_logged_in??!1}function $(e,l="error"){const a=window.Voxel;a?.alert?a.alert(e,l):console.error(`[Userbar] ${l}: ${e}`)}function R(e,l){return window.Voxel_Config?.l10n?.[e]??l}function me(e,l){const a=window.Voxel;return a?.helpers?.currencyFormat?a.helpers.currencyFormat(e,l):`$${(e/100).toFixed(2)}`}function te(e){return!e||!e.value?null:e.library==="svg"&&e.value?React.createElement("img",{src:e.value,alt:"",style:{width:"1em",height:"1em"}}):e.library==="icon"&&e.value?React.createElement("i",{className:e.value,"aria-hidden":"true"}):null}function Be({item:e,icons:l,context:a}){const[c,f]=k(!1),r=A(null),v=A(null),[p,d]=k(null),[E,t]=k(!1),[x,I]=k(!0),[m,i]=k(!1),[T,H]=k(1),[C,N]=k(null),B=A(0),O=w(async(s=1)=>{i(!0);try{const b=z("notifications.list"),g=await(await fetch(`${b}&pg=${s}`)).json();g.success?(d(n=>s===1?g.list:[...n||[],...g.list]),t(g.has_more)):$(g.message||R("ajaxError","An error occurred"))}catch{$(R("ajaxError","An error occurred"))}finally{I(!1),i(!1)}},[]),le=w(()=>{a==="frontend"&&(p===null&&(d([]),v.current?.classList.add("hidden"),O(1)),f(!0))},[a,p,O]),q=w(()=>{const s=T+1;H(s),O(s)},[T,O]),X=w(async()=>{const s=R("confirmClear","Clear all notifications?");if(window.confirm(s))try{const b=z("notifications.clear_all"),g=await(await fetch(b)).json();g.success?d([]):$(g.message||R("ajaxError","An error occurred"))}catch{$(R("ajaxError","An error occurred"))}},[]),P=w(()=>{N(null),requestAnimationFrame(()=>{const s=document.querySelector(".min-scroll");s&&(s.scrollTop=B.current)})},[]),D=w(async s=>{if(s.links_to==="(details)"){const b=document.querySelector(".min-scroll");b&&(B.current=b.scrollTop),s.actions===void 0?(d(y=>y?.map(g=>g.id===s.id?{...g,seen:!0}:g)||null),Y(s)):(N(s),requestAnimationFrame(()=>{const y=document.querySelector(".min-scroll");y&&(y.scrollTop=0)}))}else{d(b=>b?.map(y=>y.id===s.id?{...y,_loading:!0}:y)||null);try{const b=z("notifications.open"),g=await(await fetch(`${b}&item_id=${s.id}`)).json();g.success?(d(n=>n?.map(u=>u.id===s.id?{...u,seen:!0,_loading:!1}:u)||null),g.redirect_to&&(window.location.href=g.redirect_to)):($(g.message||R("ajaxError","An error occurred")),d(n=>n?.map(u=>u.id===s.id?{...u,_loading:!1}:u)||null))}catch{$(R("ajaxError","An error occurred")),d(b=>b?.map(y=>y.id===s.id?{...y,_loading:!1}:y)||null)}}},[]),Y=w(async(s,b=1)=>{d(y=>y?.map(g=>g.id===s.id?{...g,_loading:!0,actions_page:b}:g)||null);try{const y=z("notifications.get_actions"),n=await(await fetch(`${y}&item_id=${s.id}&pg=${b}`)).json();if(n.success){const u={...s,actions:b===1?n.actions:[...s.actions||[],...n.actions],actions_page:b,_loading:!1,seen:!0};d(h=>h?.map(S=>S.id===s.id?u:S)||null),N(u),b===1&&requestAnimationFrame(()=>{const h=document.querySelector(".min-scroll");h&&(h.scrollTop=0)})}else $(n.message||R("ajaxError","An error occurred")),d(u=>u?.map(h=>h.id===s.id?{...h,_loading:!1,seen:!0}:h)||null)}catch{$(R("ajaxError","An error occurred")),d(y=>y?.map(g=>g.id===s.id?{...g,_loading:!1}:g)||null)}},[]),G=w(async(s,b,y)=>{const g=y?.key||b.key;if(!g)return;const n=u=>{C&&N({...C,actions:C.actions?.map(h=>h===b?{...h,_loading:u}:h)})};n(!0);try{const u=z("notifications.run_action"),S=await(await fetch(`${u}&item_id=${s.id}&action_key=${g}&pg=${b._page||1}`)).json();if(S.success){if(S.updated_action&&C?.actions){const M=C.actions.indexOf(b);if(M!==-1){const _=[...C.actions];_[M]=S.updated_action,N({...C,actions:_})}}S.redirect_to&&(window.location.href=S.redirect_to)}else $(S.message||R("ajaxError","An error occurred"))}catch{$(R("ajaxError","An error occurred"))}finally{n(!1)}},[C]),re=s=>React.createElement("div",{key:s.id,className:`ts-notification-item ${s.seen?"":"ts-unread"} ${s._loading?"vx-pending":""}`,onClick:()=>D(s)},s.image_url&&React.createElement("div",{className:"ts-notification-image"},React.createElement("img",{src:s.image_url,alt:""})),React.createElement("div",{className:"ts-notification-body"},React.createElement("span",{className:"ts-notification-subject"},s.subject),React.createElement("span",{className:"ts-notification-time"},s.time))),J=(s,b)=>s.type==="list-item"?React.createElement("div",{key:s.key,className:`ts-action-item ${s._loading?"vx-pending":""}`,onClick:()=>s.links_to?window.location.href=s.links_to:G(b,s)},s.image_markup&&React.createElement("div",{className:"ts-action-image",dangerouslySetInnerHTML:{__html:s.image_markup}}),React.createElement("div",{className:"ts-action-body"},s.subject&&React.createElement("span",{className:"ts-action-subject"},s.subject),s.details&&React.createElement("span",{className:"ts-action-details"},s.details)),s.actions&&s.actions.length>0&&React.createElement("div",{className:"ts-action-buttons"},s.actions.map(y=>React.createElement("button",{key:y.key,className:"ts-btn ts-btn-1",onClick:g=>{g.stopPropagation(),G(b,s,y)}},y.label)))):s.type==="button"?React.createElement("button",{key:s.key,className:`ts-btn ts-btn-1 ${s._loading?"vx-pending":""}`,onClick:()=>G(b,s)},s.label):null;return React.createElement("li",{className:`ts-notifications-wrapper elementor-repeater-item-${e._id}`},React.createElement("a",{ref:r,href:"#",onClick:s=>{s.preventDefault(),le()},role:"button","aria-label":e.notificationsTitle||"Notifications"},React.createElement("div",{className:"ts-comp-icon flexify"},te(e.icon),a==="frontend"&&React.createElement("span",{ref:v,className:"unread-indicator",style:{display:"none"}})),React.createElement("span",{className:"ts_comp_label"},e.notificationsTitle||"Notifications")),a==="frontend"&&React.createElement(ae,{isOpen:c,popupId:`notifications-popup-${e._id}`,target:r.current,title:e.notificationsTitle||"Notifications",icon:e.icon?.value?`<i class="${e.icon.value}"></i>`:"",onClose:()=>{f(!1),N(null)},showFooter:!1,popupClass:"md-width"},React.createElement("div",{className:"ts-notifications-list min-scroll"},p&&p.length>0&&!C&&React.createElement("div",{className:"ts-notifications-header flexify"},React.createElement("button",{className:"ts-btn ts-btn-1",onClick:X},R("clearAll","Clear all"))),x&&React.createElement(ee,null),C&&React.createElement("div",{className:"ts-notification-details"},React.createElement("button",{className:"ts-btn ts-btn-1 ts-back-btn",onClick:P},React.createElement("i",{className:"las la-arrow-left"}),R("back","Back")),React.createElement("div",{className:"ts-notification-content"},React.createElement("span",{className:"ts-notification-subject"},C.subject),React.createElement("span",{className:"ts-notification-time"},C.time)),C.actions&&React.createElement("div",{className:"ts-notification-actions"},C.actions.map(s=>J(s,C))),C._loading&&React.createElement("div",{className:"ts-loader"})),!x&&!C&&React.createElement(React.Fragment,null,p&&p.length>0?React.createElement(React.Fragment,null,p.map(re),E&&React.createElement("button",{className:`ts-btn ts-btn-1 ts-load-more ${m?"vx-pending":""}`,onClick:q,disabled:m},m?React.createElement("span",{className:"ts-loader"}):R("loadMore","Load more"))):React.createElement(ee,null)))))}function Oe({item:e,icons:l,context:a,nonce:c}){const[f,r]=k(!1),v=A(null),p=A(null),[d,E]=k({list:null,hasMore:!1,loading:!0,loadingMore:!1,page:1}),t=w(async(i=1)=>{E(T=>({...T,loadingMore:!0}));try{const T=z("inbox.list_chats"),H=new FormData;H.append("pg",i.toString()),c&&H.append("_wpnonce",c);const N=await(await fetch(T,{method:"POST",body:H})).json();N.success?E(B=>({...B,list:i===1?N.list:[...B.list||[],...N.list],hasMore:N.has_more,loading:!1,loadingMore:!1})):($(N.message||R("ajaxError","An error occurred")),E(B=>({...B,loading:!1,loadingMore:!1})))}catch{$(R("ajaxError","An error occurred")),E(T=>({...T,loading:!1,loadingMore:!1}))}},[c]),x=w(()=>{a==="frontend"&&(r(!0),d.list===null&&(E(i=>({...i,list:[]})),p.current?.classList.add("hidden"),t(1)))},[a,d.list,t]),I=w(()=>{const i=d.page+1;E(T=>({...T,page:i})),t(i)},[d.page,t]),m=i=>React.createElement("a",{key:i.id,href:i.link,className:`ts-chat-item ${i.seen?"":"ts-unread"}`},React.createElement("div",{className:"ts-chat-avatar"},React.createElement("img",{src:i.target.avatar,alt:i.target.name})),React.createElement("div",{className:"ts-chat-body"},React.createElement("span",{className:"ts-chat-name"},i.target.name),React.createElement("span",{className:"ts-chat-excerpt"},i.excerpt),React.createElement("span",{className:"ts-chat-time"},i.time)));return React.createElement("li",{className:`ts-popup-messages elementor-repeater-item-${e._id}`},React.createElement("a",{ref:v,href:"#",onClick:i=>{i.preventDefault(),x()},role:"button","aria-label":e.messagesTitle||"Messages"},React.createElement("div",{className:"ts-comp-icon flexify"},te(e.icon),a==="frontend"&&React.createElement("span",{ref:p,className:"unread-indicator",style:{display:"none"}})),React.createElement("span",{className:"ts_comp_label"},e.messagesTitle||"Messages")),a==="frontend"&&React.createElement(ae,{isOpen:f,popupId:`messages-popup-${e._id}`,target:v.current,title:e.messagesTitle||"Messages",icon:e.icon?.value?`<i class="${e.icon.value}"></i>`:"",onClose:()=>r(!1),showFooter:!1,popupClass:"md-width"},React.createElement("div",{className:"ts-chats-list min-scroll"},d.loading&&React.createElement("div",{className:"ts-empty-user-tab"},React.createElement("div",{className:"ts-loader"})),!d.loading&&React.createElement(React.Fragment,null,d.list&&d.list.length>0?React.createElement(React.Fragment,null,d.list.map(m),d.hasMore&&React.createElement("button",{className:`ts-btn ts-btn-1 ts-load-more ${d.loadingMore?"vx-pending":""}`,onClick:I,disabled:d.loadingMore},d.loadingMore?React.createElement("span",{className:"ts-loader"}):R("loadMore","Load more"))):React.createElement(ee,null)))))}function je({item:e,icons:l,context:a,nonce:c,isCartEmpty:f}){const[r,v]=k(!1),p=A(null),d=A(null),[E,t]=k(!0),[x,I]=k(!1),[m,i]=k(null),[T,H]=k(""),[C,N]=k(!1),B=A(!1),O=()=>!E&&m!==null&&Object.keys(m).length>0,le=()=>x?O():K()?!f:!!localStorage.getItem("voxel:guest_cart"),q=n=>n.product_mode==="regular"?n.value.stock?.quantity||0:n.product_mode==="variable"&&n.value.variations?.quantity||0,X=()=>{if(!O()||!m)return 0;let n=0;return Object.values(m).forEach(u=>{n+=u.pricing.total_amount}),n},P=w(()=>{if(!m||Object.keys(m).length===0){localStorage.removeItem("voxel:guest_cart");return}const n={};Object.values(m).forEach(u=>{n[u.key]=u.value}),localStorage.setItem("voxel:guest_cart",JSON.stringify(n))},[m]),D=w(async()=>{const n=K(),u=n?"products.get_cart_items":"products.get_guest_cart_items";try{const h=z(u),S=new FormData;c&&S.append("_wpnonce",c),S.append("guest_cart",localStorage.getItem("voxel:guest_cart")||"");const _=await(await fetch(h,{method:"POST",body:S})).json();t(!1),I(!0),n&&localStorage.removeItem("voxel:guest_cart"),_.success?(i(Object.keys(_.items).length?_.items:{}),H(_.checkout_link),n||setTimeout(()=>P(),0)):$(_.message||R("ajaxError","An error occurred"))}catch{t(!1),I(!0),$(R("ajaxError","An error occurred"))}},[c,P]),Y=w(()=>{if(a!=="frontend")return;const n=document.querySelector(".ts-checkout");if(n){window.Voxel?.scrollTo?.(n);return}v(!0),m===null&&(i({}),D())},[a,m,D]),G=w(async n=>{if(K()){i(u=>u?{...u,[n.key]:{...u[n.key],_disabled:!0}}:null);try{const u=z("products.remove_cart_item"),h=new FormData;h.append("item_key",n.key),c&&h.append("_wpnonce",c);const M=await(await fetch(u,{method:"POST",body:h})).json();M.success?i(_=>{if(!_)return null;const ie={..._};return delete ie[n.key],ie}):(i(_=>_?{..._,[n.key]:{..._[n.key],_disabled:!1}}:null),$(M.message||R("ajaxError","An error occurred")))}catch{i(u=>u?{...u,[n.key]:{...u[n.key],_disabled:!1}}:null),$(R("ajaxError","An error occurred"))}}else i(u=>{if(!u)return null;const h={...u};return delete h[n.key],h}),setTimeout(()=>P(),0)},[c,P]),re=w(async()=>{if(K()){N(!0);try{const n=z("products.empty_cart"),u=new FormData;c&&u.append("_wpnonce",c);const S=await(await fetch(n,{method:"POST",body:u})).json();N(!1),S.success?i({}):$(S.message||R("ajaxError","An error occurred"))}catch{N(!1),$(R("ajaxError","An error occurred"))}}else i({}),localStorage.removeItem("voxel:guest_cart")},[c]),J=w(async(n,u)=>{i(M=>M?{...M,[n.key]:{...M[n.key],_disabled:!0}}:null);const h=K(),S=h?"products.update_cart_item_quantity":"products.update_guest_cart_item_quantity";try{const M=z(S),_=new FormData;_.append("item_key",n.key),_.append("item_quantity",u.toString()),h||_.append("guest_cart",localStorage.getItem("voxel:guest_cart")||""),c&&_.append("_wpnonce",c);const se=await(await fetch(M,{method:"POST",body:_})).json();se.success?(i(ce=>ce?{...ce,[n.key]:se.item}:null),h||setTimeout(()=>P(),0)):$(se.message||R("ajaxError","An error occurred"))}catch{$(R("ajaxError","An error occurred"))}finally{i(M=>M?{...M,[n.key]:{...M[n.key],_disabled:!1}}:null)}},[c,P]),s=w(n=>{const u=q(n)+1;J(n,u)},[J]),b=w(n=>{const u=q(n)-1;u<=0?G(n):J(n,u)},[J,G]),y=n=>{if(!m)return!1;let u=n.quantity.max;for(const h of Object.values(m))if(h.stock_id===n.stock_id&&(u-=q(h),u<=0))return!1;return!0};ne(()=>{if(a!=="frontend")return;B.current||(B.current=!0,Object.defineProperty(window,"VX_Cart",{configurable:!0,get:()=>({open:Y,getItems:D,hasItems:O,getSubtotal:X,get loading(){return E},get loaded(){return x},get items(){return m},get checkout_link(){return T}})}));const n=()=>{D(),d.current?.classList.add("ts-cart-update"),setTimeout(()=>d.current?.classList.remove("ts-cart-update"),500)};return document.addEventListener("voxel:added_cart_item",n),()=>{document.removeEventListener("voxel:added_cart_item",n)}},[a,D,Y,O,X,E,x,m,T]);const g=n=>React.createElement("div",{key:n.key,className:`ts-cart-item ${n._disabled?"vx-pending":""}`},React.createElement("div",{className:"ts-cart-item-image"},React.createElement("a",{href:n.link},React.createElement("img",{src:n.logo,alt:n.title}))),React.createElement("div",{className:"ts-cart-item-body"},React.createElement("a",{href:n.link,className:"ts-cart-item-title"},n.title),n.subtitle&&React.createElement("span",{className:"ts-cart-item-subtitle"},n.subtitle),React.createElement("span",{className:"ts-cart-item-price"},me(n.pricing.total_amount,n.pricing._currency))),React.createElement("div",{className:"ts-cart-item-actions"},n.quantity.enabled&&React.createElement("div",{className:"ts-quantity-control"},React.createElement("button",{className:"ts-qty-btn ts-qty-minus",onClick:()=>b(n),disabled:n._disabled},React.createElement("i",{className:"las la-minus"})),React.createElement("span",{className:"ts-qty-value"},q(n)),React.createElement("button",{className:"ts-qty-btn ts-qty-plus",onClick:()=>s(n),disabled:n._disabled||!y(n)},React.createElement("i",{className:"las la-plus"}))),React.createElement("button",{className:"ts-remove-btn",onClick:()=>G(n),disabled:n._disabled},React.createElement("i",{className:"las la-times"}))));return React.createElement("li",{className:`ts-popup-cart elementor-repeater-item-${e._id}`},React.createElement("a",{ref:p,href:"#",onClick:n=>{n.preventDefault(),Y()},role:"button","aria-label":e.cartTitle||"Cart"},React.createElement("div",{ref:d,className:"ts-comp-icon flexify"},te(e.icon),a==="frontend"&&le()&&React.createElement("span",{className:"unread-indicator"})),React.createElement("span",{className:"ts_comp_label"},e.cartTitle||"Cart")),a==="frontend"&&React.createElement(ae,{isOpen:r,popupId:`cart-popup-${e._id}`,target:p.current,title:e.cartTitle||"Cart",icon:e.icon?.value?`<i class="${e.icon.value}"></i>`:"",onClose:()=>v(!1),showFooter:!1,popupClass:"lg-width ts-cart-popup"},React.createElement("div",{className:"ts-cart-content min-scroll"},E&&React.createElement(ee,null),!E&&React.createElement(React.Fragment,null,O()&&m?React.createElement(React.Fragment,null,React.createElement("div",{className:"ts-cart-items"},Object.values(m).map(g)),React.createElement("div",{className:"ts-cart-footer"},React.createElement("div",{className:"ts-cart-subtotal"},React.createElement("span",null,R("subtotal","Subtotal")),React.createElement("span",{className:"ts-subtotal-amount"},me(X()))),React.createElement("div",{className:"ts-cart-actions"},React.createElement("button",{className:`ts-btn ts-btn-1 ts-empty-cart ${C?"vx-pending":""}`,onClick:re,disabled:C},R("emptyCart","Empty cart")),T&&React.createElement("a",{href:T,className:"ts-btn ts-btn-2"},R("checkout","Checkout"))))):React.createElement(ee,null)))))}function Le({item:e,icons:l,context:a,hideChevron:c}){const[f,r]=k(!1),v=A(null),p=w(()=>{a==="frontend"&&r(!0)},[a]);return React.createElement("li",{className:`ts-popup-component ts-user-area-avatar elementor-repeater-item-${e._id}`},React.createElement("a",{ref:v,href:"#",onClick:d=>{d.preventDefault(),p()},role:"button","aria-label":"User menu"},React.createElement("div",{className:"ts-comp-icon flexify"},a==="editor"?React.createElement("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#ccc",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement("i",{className:"las la-user"})):window.VoxelFSEUser?.avatarUrl?React.createElement("img",{src:window.VoxelFSEUser.avatarUrl,alt:"Avatar",style:{width:"32px",height:"32px",borderRadius:"50%"}}):React.createElement("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#ccc",display:"flex",alignItems:"center",justifyContent:"center"}},React.createElement("i",{className:"las la-user"}))),React.createElement("span",{className:"ts_comp_label"},"User"),!c&&React.createElement("div",{className:"ts-down-icon"})),a==="frontend"&&React.createElement(ae,{isOpen:f,popupId:`user-menu-popup-${e._id}`,target:v.current,title:"User",onClose:()=>r(!1),showFooter:!1},React.createElement("div",{className:"ts-term-dropdown ts-md-group ts-multilevel-dropdown"},React.createElement("p",{style:{padding:"16px",textAlign:"center",color:"#666"}},"Menu not configured"))))}function ze({item:e,icons:l,context:a}){const[c,f]=k(!1),r=A(null),v=w(()=>{a==="frontend"&&f(!0)},[a]);return React.createElement("li",{className:`ts-popup-component elementor-repeater-item-${e._id}`},React.createElement("a",{ref:r,href:"#",onClick:p=>{p.preventDefault(),v()},role:"button","aria-label":e.wpMenuTitle||"Menu"},React.createElement("div",{className:"ts-comp-icon flexify"},te(e.icon)),React.createElement("span",{className:"ts_comp_label"},e.wpMenuTitle||"Menu")),a==="frontend"&&React.createElement(ae,{isOpen:c,popupId:`wp-menu-popup-${e._id}`,target:r.current,title:e.wpMenuTitle||"Menu",icon:e.icon?.value?`<i class="${e.icon.value}"></i>`:"",onClose:()=>f(!1),showFooter:!1},React.createElement("div",{className:"ts-term-dropdown ts-md-group ts-multilevel-dropdown"},React.createElement("p",{style:{padding:"16px",textAlign:"center",color:"#666"}},"Menu not configured"))))}function Ae({item:e,context:l}){const a={href:e.componentUrl.url||"#"};return e.componentUrl.is_external&&(a.target="_blank"),e.componentUrl.nofollow&&(a.rel="nofollow"),React.createElement("li",{className:`elementor-repeater-item-${e._id}`},React.createElement("a",{...a},React.createElement("div",{className:"ts-comp-icon flexify"},te(e.icon)),React.createElement("span",{className:"ts_comp_label"},e.componentTitle||"Link")))}function Pe(e,l,a,c,f,r){switch(e.componentType){case"notifications":return React.createElement(Be,{key:e._id,item:e,icons:l,context:a});case"messages":return React.createElement(Oe,{key:e._id,item:e,icons:l,context:a,nonce:f});case"cart":return React.createElement(je,{key:e._id,item:e,icons:l,context:a,nonce:f,isCartEmpty:r});case"user_menu":return React.createElement(Le,{key:e._id,item:e,icons:l,context:a,hideChevron:c});case"select_wp_menu":return React.createElement(ze,{key:e._id,item:e,icons:l,context:a});case"link":return React.createElement(Ae,{key:e._id,item:e,context:a});default:return null}}function Ue({attributes:e,context:l,config:a}){const c=a?.items||e.items,f=a?.icons||e.icons,r=a?.settings||{itemsAlign:e.itemsAlign,verticalOrientation:e.verticalOrientation,verticalOrientationTablet:e.verticalOrientationTablet,verticalOrientationMobile:e.verticalOrientationMobile,itemContentAlign:e.itemContentAlign,hideChevron:e.hideChevron,customPopupEnable:e.customPopupEnable},v=window.VoxelFSEUserbar,p=v?.nonce,d=v?.is_cart_empty??!0,E={justifyContent:r.itemsAlign};return!c||c.length===0?React.createElement("div",{className:"ts-user-area"},React.createElement("div",{className:"voxel-fse-empty-state",style:{padding:"20px",textAlign:"center",background:"#f5f5f5",borderRadius:"4px"}},React.createElement("p",{style:{margin:0,color:"#666"}},l==="editor"?"Add components using the sidebar panel":"No user bar components configured"))):React.createElement(React.Fragment,null,l==="frontend"&&a&&React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(a)}}),React.createElement("ul",{className:"flexify simplify-ul user-area-menu",style:E},c.map(t=>Pe(t,f,l,r.hideChevron,p,d))))}function Fe(e){if(!e)return"";let l="";return e.fontFamily&&(l+=`font-family: ${e.fontFamily}; `),e.fontSize&&(l+=`font-size: ${e.fontSize}${e.fontSizeUnit||"px"}; `),e.fontWeight&&(l+=`font-weight: ${e.fontWeight}; `),e.fontStyle&&(l+=`font-style: ${e.fontStyle}; `),e.textTransform&&(l+=`text-transform: ${e.textTransform}; `),e.textDecoration&&(l+=`text-decoration: ${e.textDecoration}; `),e.lineHeight&&(l+=`line-height: ${e.lineHeight}${e.lineHeightUnit||""}; `),e.letterSpacing&&(l+=`letter-spacing: ${e.letterSpacing}${e.letterSpacingUnit||"px"}; `),l}function ge(e,l){const a=[],c=[],f=[],r=`.voxel-fse-userbar-${l}`;if(e.itemGap!==void 0&&a.push(`${r} .ts-user-area > ul { grid-gap: ${e.itemGap}px; }`),e.itemGapTablet!==void 0&&c.push(`${r} .ts-user-area > ul { grid-gap: ${e.itemGapTablet}px; }`),e.itemGapMobile!==void 0&&f.push(`${r} .ts-user-area > ul { grid-gap: ${e.itemGapMobile}px; }`),e.verticalOrientation&&(a.push(`${r} .ts-user-area > ul { flex-direction: column; }`),e.itemContentAlign&&a.push(`${r} .ts-user-area > ul > li > a { justify-content: ${e.itemContentAlign}; }`)),e.verticalOrientationTablet&&(c.push(`${r} .ts-user-area > ul { flex-direction: column; }`),e.itemContentAlign&&c.push(`${r} .ts-user-area > ul > li > a { justify-content: ${e.itemContentAlign}; }`)),e.verticalOrientationMobile&&(f.push(`${r} .ts-user-area > ul { flex-direction: column; }`),e.itemContentAlign&&f.push(`${r} .ts-user-area > ul > li > a { justify-content: ${e.itemContentAlign}; }`)),e.itemBackground&&a.push(`${r} .ts-user-area > ul > li > a { background-color: ${e.itemBackground}; }`),e.itemBackgroundHover&&a.push(`${r} .ts-user-area > ul > li > a:hover { background-color: ${e.itemBackgroundHover}; }`),e.itemBorderRadius!==void 0&&a.push(`${r} .ts-user-area > ul > li > a { border-radius: ${e.itemBorderRadius}px; }`),e.itemBorderRadiusTablet!==void 0&&c.push(`${r} .ts-user-area > ul > li > a { border-radius: ${e.itemBorderRadiusTablet}px; }`),e.itemBorderRadiusMobile!==void 0&&f.push(`${r} .ts-user-area > ul > li > a { border-radius: ${e.itemBorderRadiusMobile}px; }`),e.itemContentGap!==void 0&&a.push(`${r} .ts-user-area > ul > li > a { grid-gap: ${e.itemContentGap}px; }`),e.itemContentGapTablet!==void 0&&c.push(`${r} .ts-user-area > ul > li > a { grid-gap: ${e.itemContentGapTablet}px; }`),e.itemContentGapMobile!==void 0&&f.push(`${r} .ts-user-area > ul > li > a { grid-gap: ${e.itemContentGapMobile}px; }`),e.iconContainerSize!==void 0&&a.push(`${r} .ts-user-area .ts-comp-icon { width: ${e.iconContainerSize}px; height: ${e.iconContainerSize}px; }`),e.iconContainerSizeTablet!==void 0&&c.push(`${r} .ts-user-area .ts-comp-icon { width: ${e.iconContainerSizeTablet}px; height: ${e.iconContainerSizeTablet}px; }`),e.iconContainerSizeMobile!==void 0&&f.push(`${r} .ts-user-area .ts-comp-icon { width: ${e.iconContainerSizeMobile}px; height: ${e.iconContainerSizeMobile}px; }`),e.iconContainerRadius!==void 0&&a.push(`${r} .ts-user-area .ts-comp-icon { border-radius: ${e.iconContainerRadius}px; }`),e.iconContainerRadiusTablet!==void 0&&c.push(`${r} .ts-user-area .ts-comp-icon { border-radius: ${e.iconContainerRadiusTablet}px; }`),e.iconContainerRadiusMobile!==void 0&&f.push(`${r} .ts-user-area .ts-comp-icon { border-radius: ${e.iconContainerRadiusMobile}px; }`),e.iconContainerBackground&&a.push(`${r} .ts-user-area .ts-comp-icon { background-color: ${e.iconContainerBackground}; }`),e.iconContainerBackgroundHover&&a.push(`${r} .ts-user-area > ul > li > a:hover .ts-comp-icon { background-color: ${e.iconContainerBackgroundHover}; }`),e.iconSize!==void 0&&a.push(`${r} .ts-user-area .ts-comp-icon { --ts-icon-size: ${e.iconSize}px; }`),e.iconSizeTablet!==void 0&&c.push(`${r} .ts-user-area .ts-comp-icon { --ts-icon-size: ${e.iconSizeTablet}px; }`),e.iconSizeMobile!==void 0&&f.push(`${r} .ts-user-area .ts-comp-icon { --ts-icon-size: ${e.iconSizeMobile}px; }`),e.iconColor&&a.push(`${r} .ts-user-area .ts-comp-icon { --ts-icon-color: ${e.iconColor}; }`),e.iconColorHover&&a.push(`${r} .ts-user-area > ul > li > a:hover .ts-comp-icon { --ts-icon-color: ${e.iconColorHover}; }`),e.unreadIndicatorColor&&a.push(`${r} .ts-user-area span.unread-indicator { background: ${e.unreadIndicatorColor}; }`),e.unreadIndicatorMargin!==void 0&&a.push(`${r} .ts-user-area span.unread-indicator { top: ${e.unreadIndicatorMargin}px; }`),e.unreadIndicatorMarginTablet!==void 0&&c.push(`${r} .ts-user-area span.unread-indicator { top: ${e.unreadIndicatorMarginTablet}px; }`),e.unreadIndicatorMarginMobile!==void 0&&f.push(`${r} .ts-user-area span.unread-indicator { top: ${e.unreadIndicatorMarginMobile}px; }`),e.unreadIndicatorSize!==void 0&&a.push(`${r} .ts-user-area span.unread-indicator { width: ${e.unreadIndicatorSize}px; height: ${e.unreadIndicatorSize}px; }`),e.unreadIndicatorSizeTablet!==void 0&&c.push(`${r} .ts-user-area span.unread-indicator { width: ${e.unreadIndicatorSizeTablet}px; height: ${e.unreadIndicatorSizeTablet}px; }`),e.unreadIndicatorSizeMobile!==void 0&&f.push(`${r} .ts-user-area span.unread-indicator { width: ${e.unreadIndicatorSizeMobile}px; height: ${e.unreadIndicatorSizeMobile}px; }`),e.avatarSize!==void 0&&a.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { width: ${e.avatarSize}px; height: ${e.avatarSize}px; }`),e.avatarSizeTablet!==void 0&&c.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { width: ${e.avatarSizeTablet}px; height: ${e.avatarSizeTablet}px; }`),e.avatarSizeMobile!==void 0&&f.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { width: ${e.avatarSizeMobile}px; height: ${e.avatarSizeMobile}px; }`),e.avatarRadius!==void 0&&a.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { border-radius: ${e.avatarRadius}%; }`),e.avatarRadiusTablet!==void 0&&c.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { border-radius: ${e.avatarRadiusTablet}%; }`),e.avatarRadiusMobile!==void 0&&f.push(`${r} .ts-user-area > ul > li.ts-user-area-avatar img { border-radius: ${e.avatarRadiusMobile}%; }`),e.items?.forEach(p=>{if(!p._id)return;const d=`${r} .elementor-repeater-item-${p._id}`;p.labelVisibility&&(p.labelVisibilityDesktop==="none"&&a.push(`${d} .ts_comp_label { display: none; }`),p.labelVisibilityTablet==="none"?c.push(`${d} .ts_comp_label { display: none; }`):p.labelVisibilityTablet==="flex"&&p.labelVisibilityDesktop==="none"&&c.push(`${d} .ts_comp_label { display: flex; }`),p.labelVisibilityMobile==="none"?f.push(`${d} .ts_comp_label { display: none; }`):p.labelVisibilityMobile==="flex"&&(p.labelVisibilityDesktop==="none"||p.labelVisibilityTablet==="none")&&f.push(`${d} .ts_comp_label { display: flex; }`)),p.componentVisibility&&(p.userBarVisibilityDesktop==="none"&&a.push(`${d} { display: none !important; }`),p.userBarVisibilityTablet==="none"?c.push(`${d} { display: none !important; }`):p.userBarVisibilityTablet==="flex"&&p.userBarVisibilityDesktop==="none"&&c.push(`${d} { display: flex !important; }`),p.userBarVisibilityMobile==="none"?f.push(`${d} { display: none !important; }`):p.userBarVisibilityMobile==="flex"&&(p.userBarVisibilityDesktop==="none"||p.userBarVisibilityTablet==="none")&&f.push(`${d} { display: flex !important; }`))}),e.labelTypography){const p=Fe(e.labelTypography);p&&a.push(`${r} .ts-user-area .ts_comp_label { ${p} }`)}e.labelColor&&a.push(`${r} .ts-user-area .ts_comp_label { color: ${e.labelColor}; }`),e.labelColorHover&&a.push(`${r} .ts-user-area > ul > li > a:hover .ts_comp_label { color: ${e.labelColorHover}; }`),e.chevronColor&&a.push(`${r} .ts-down-icon { border-color: ${e.chevronColor}; }`),e.chevronColorHover&&a.push(`${r} .ts-user-area > ul > li > a:hover .ts-down-icon { border-color: ${e.chevronColorHover}; }`),e.hideChevron&&a.push(`${r} .ts-down-icon { display: none !important; }`);let v="";return a.length>0&&(v+=a.join(`
`)),c.length>0&&(v+=`
@media (max-width: 1024px) {
${c.join(`
`)}
}`),f.length>0&&(v+=`
@media (max-width: 767px) {
${f.join(`
`)}
}`),v}function He({attributes:e,setAttributes:l,clientId:a}){const c=e.blockId||a,[f,r]=k([{value:"",label:o("Select menu","voxel-fse")}]);ne(()=>{(async()=>{try{const x=await ye({path:"/voxel-fse/v1/navbar/locations"});if(x&&x.locations){const I=[{value:"",label:o("Select menu","voxel-fse")},...x.locations.map(m=>({value:m.slug,label:m.name}))];r(I)}}catch(x){console.error("Could not fetch nav menus:",x)}})()},[]),ne(()=>{e.blockId||l({blockId:a}),e.items||l({items:[]})},[e.blockId,e.items,a,l]),ne(()=>{const t="voxel-commons-css";if(!document.getElementById(t)){const x=document.createElement("link");x.id=t,x.rel="stylesheet";const m=(window.Voxel_Config?.site_url||window.location.origin).replace(/\/$/,"");x.href=`${m}/wp-content/themes/voxel/assets/dist/commons.css?ver=1.7.5.2`,document.head.appendChild(x)}},[]);const v=ve(e,{blockId:c,baseClass:"voxel-fse-userbar ts-user-area",selectorPrefix:"voxel-fse-userbar"}),p=de(()=>ge(e,c),[e,c]),d=de(()=>[v.responsiveCSS,p].filter(Boolean).join(`
`),[v.responsiveCSS,p]),E=pe({id:v.elementId,className:v.className,style:v.styles,...v.customAttrs});return React.createElement("div",{...E},React.createElement(be,null,React.createElement(Ee,{tabs:[{id:"content",label:o("Content","voxel-fse"),render:()=>React.createElement(Me,{attributes:e,setAttributes:l,navMenus:f})},{id:"style",label:o("Style","voxel-fse"),render:()=>React.createElement(Ve,{attributes:e,setAttributes:l})}],includeAdvancedTab:!0,includeVoxelTab:!0,attributes:e,setAttributes:l})),d&&React.createElement("style",{dangerouslySetInnerHTML:{__html:d}}),React.createElement(Ue,{attributes:e,context:"editor"}))}function De({attributes:e}){const l=e.blockId||"userbar",a=ve(e,{blockId:l,baseClass:"voxel-fse-userbar ts-user-area"}),c=ge(e,l),f=[a.responsiveCSS,c].filter(Boolean).join(`
`),r=pe.save({id:a.elementId,className:a.className,style:a.styles,"data-visibility-behavior":e.visibilityBehavior||void 0,"data-visibility-rules":e.visibilityRules?.length?JSON.stringify(e.visibilityRules):void 0,"data-loop-source":e.loopSource||void 0,"data-loop-limit":e.loopLimit||void 0,"data-loop-offset":e.loopOffset||void 0,...a.customAttrs}),v={items:e.items,icons:e.icons,settings:{itemsAlign:e.itemsAlign,verticalOrientation:e.verticalOrientation,verticalOrientationTablet:e.verticalOrientationTablet??!1,verticalOrientationMobile:e.verticalOrientationMobile??!1,itemContentAlign:e.itemContentAlign,hideChevron:e.hideChevron,customPopupEnable:e.customPopupEnable}};return React.createElement("div",{...r},f&&React.createElement("style",{dangerouslySetInnerHTML:{__html:f}}),Ce(e,!1,void 0,void 0,a.uniqueSelector),React.createElement("script",{type:"text/json",className:"vxconfig",dangerouslySetInnerHTML:{__html:JSON.stringify(v)}}),React.createElement("div",{className:"voxel-fse-block-placeholder",style:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#e0e0e0",padding:"16px",minHeight:"48px"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor",style:{opacity:.4}},React.createElement("rect",{x:"4",y:"4",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"10",y:"4",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"16",y:"4",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"4",y:"10",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"10",y:"10",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"16",y:"10",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"4",y:"16",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"10",y:"16",width:"4",height:"4",rx:"0.5"}),React.createElement("rect",{x:"16",y:"16",width:"4",height:"4",rx:"0.5"}))))}const Ge="https://schemas.wp.org/trunk/block.json",qe=3,Je="voxel-fse/userbar",Qe="1.0.0",We="Userbar (VX)",Xe="voxel-fse",Ye="User bar with notifications, messages, cart, user menu, and custom links. FSE equivalent of Voxel's User bar widget.",Ke=["userbar","user","notifications","messages","cart","menu","voxel"],Ze="voxel-fse",ea={html:!1,align:["wide","full"],anchor:!0,className:!0,customClassName:!0},aa="file:./index.js",ta="file:./frontend.js",na="file:./render.php",oa={blockId:{type:"string",default:""},items:{type:"array",default:[]},icons:{type:"object",default:{downArrow:{library:"",value:""},rightArrow:{library:"",value:""},leftArrow:{library:"",value:""},close:{library:"",value:""},trash:{library:"",value:""},inbox:{library:"",value:""},loadMore:{library:"",value:""}}},itemsAlign:{type:"string",default:"left"},verticalOrientation:{type:"boolean",default:!1},verticalOrientationTablet:{type:"boolean",default:!1},verticalOrientationMobile:{type:"boolean",default:!1},itemContentAlign:{type:"string",default:"left"},itemGap:{type:"number",default:0},itemGapTablet:{type:"number"},itemGapMobile:{type:"number"},itemMargin:{type:"object",default:{top:"",right:"",bottom:"",left:""}},itemPadding:{type:"object",default:{top:"",right:"",bottom:"",left:""}},itemBackground:{type:"string",default:""},itemBackgroundHover:{type:"string",default:"#fff"},itemBorderRadius:{type:"number",default:0},itemBorderRadiusTablet:{type:"number"},itemBorderRadiusMobile:{type:"number"},itemContentGap:{type:"number",default:0},itemContentGapTablet:{type:"number"},itemContentGapMobile:{type:"number"},iconContainerSize:{type:"number",default:40},iconContainerSizeTablet:{type:"number"},iconContainerSizeMobile:{type:"number"},iconContainerRadius:{type:"number",default:40},iconContainerRadiusTablet:{type:"number"},iconContainerRadiusMobile:{type:"number"},iconContainerBackground:{type:"string",default:""},iconContainerBackgroundHover:{type:"string",default:""},iconSize:{type:"number",default:20},iconSizeTablet:{type:"number"},iconSizeMobile:{type:"number"},iconColor:{type:"string",default:""},iconColorHover:{type:"string",default:""},unreadIndicatorColor:{type:"string",default:""},unreadIndicatorMargin:{type:"number",default:0},unreadIndicatorMarginTablet:{type:"number"},unreadIndicatorMarginMobile:{type:"number"},unreadIndicatorSize:{type:"number",default:8},unreadIndicatorSizeTablet:{type:"number"},unreadIndicatorSizeMobile:{type:"number"},avatarSize:{type:"number",default:32},avatarSizeTablet:{type:"number"},avatarSizeMobile:{type:"number"},avatarRadius:{type:"number",default:50},avatarRadiusTablet:{type:"number"},avatarRadiusMobile:{type:"number"},labelTypography:{type:"object",default:{}},labelColor:{type:"string",default:""},labelColorHover:{type:"string",default:""},chevronColor:{type:"string",default:""},chevronColorHover:{type:"string",default:""},hideChevron:{type:"boolean",default:!1},customPopupEnable:{type:"boolean",default:!1},popupBackdropColor:{type:"string",default:""},popupPointerEvents:{type:"boolean",default:!1},popupBoxShadow:{type:"object",default:{}},popupTopMargin:{type:"number",default:0},popupMaxHeight:{type:"number",default:0},_comment_voxel_tab:"VoxelTab attributes for visibility and loop features",visibilityBehavior:{type:"string",default:"show",enum:["show","hide"]},visibilityRules:{type:"array",default:[],items:{type:"object"}},loopEnabled:{type:"boolean",default:!1},loopSource:{type:"string",default:""},loopProperty:{type:"string",default:""},loopLimit:{type:"string",default:""},loopOffset:{type:"string",default:""}},ue={$schema:Ge,apiVersion:qe,name:Je,version:Qe,title:We,category:Xe,description:Ye,keywords:Ke,textdomain:Ze,supports:ea,editorScript:aa,viewScript:ta,render:na,attributes:oa};he(ue.name,{...ue,icon:Se,edit:He,save:De});
